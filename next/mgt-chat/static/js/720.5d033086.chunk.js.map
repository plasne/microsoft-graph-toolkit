{"version":3,"file":"static/js/720.5d033086.chunk.js","mappings":"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","sources":["../../../packages/mgt-react/src/generated/search-box.ts","../../../packages/mgt-react/src/generated/login.ts","components/SimpleLogin.tsx","components/ThemeSwitcher.tsx","components/Header.tsx","components/SideNavigation.tsx","services/Navigation.tsx","../../../packages/mgt-components/dist/es6/styles/src/styles/theme-manager.ts","Layout.tsx","App.tsx","AppContext.ts","hooks/useIsSignedIn.ts","../../../packages/mgt-components/dist/es6/components/src/components/PersonCardInteraction.ts","../../../packages/mgt-components/dist/es6/components/mgt-file-list/src/components/mgt-file-list/mgt-file-list-css.ts","../../../packages/mgt-components/dist/es6/components/mgt-file-list/src/components/mgt-file-list/strings.ts","../../../packages/mgt-components/dist/es6/components/mgt-file-list/mgt-file-upload/src/components/mgt-file-list/mgt-file-upload/mgt-file-upload-css.ts","../../../packages/mgt-components/dist/es6/components/mgt-file-list/mgt-file-upload/src/components/mgt-file-list/mgt-file-upload/strings.ts","../../../packages/mgt-components/dist/es6/components/mgt-file-list/mgt-file-upload/src/components/mgt-file-list/mgt-file-upload/mgt-file-upload.ts","../../../packages/mgt-components/dist/es6/components/mgt-file-list/src/components/mgt-file-list/mgt-file-list.ts","../../../packages/mgt-components/dist/es6/components/mgt-file/src/components/mgt-file/mgt-file-css.ts","../../../packages/mgt-components/dist/es6/styles/src/styles/fluent-icons.ts","../../../packages/mgt-components/dist/es6/components/mgt-file/src/components/mgt-file/strings.ts","../../../packages/mgt-components/dist/es6/components/mgt-file/src/components/mgt-file/mgt-file.ts","../../../packages/mgt-components/dist/es6/components/mgt-person/src/components/mgt-person/mgt-person-css.ts","../../../packages/mgt-components/dist/es6/components/mgt-person/src/components/mgt-person/mgt-person-types.ts","../../../packages/mgt-components/dist/es6/components/mgt-person/src/components/mgt-person/strings.ts","../../../packages/mgt-components/dist/es6/utils/src/utils/PresenceService.ts","../../../packages/mgt-components/dist/es6/components/mgt-person/src/components/mgt-person/mgt-person.ts","../../../packages/mgt-components/dist/es6/utils/src/utils/WindowSegmentHelpers.ts","../../../packages/mgt-components/dist/es6/components/sub-components/mgt-flyout/src/components/sub-components/mgt-flyout/mgt-flyout-css.ts","../../../packages/mgt-components/dist/es6/components/sub-components/mgt-flyout/src/components/sub-components/mgt-flyout/mgt-flyout.ts","../../../packages/mgt-components/dist/es6/components/sub-components/mgt-spinner/src/components/sub-components/mgt-spinner/mgt-spinner-css.ts","../../../packages/mgt-components/dist/es6/components/sub-components/mgt-spinner/src/components/sub-components/mgt-spinner/mgt-spinner.ts","../../../packages/mgt-components/dist/es6/graph/src/graph/cacheStores.ts","../../../packages/mgt-components/dist/es6/graph/src/graph/entityType.ts","../../../packages/mgt-components/dist/es6/graph/src/graph/graph.files.ts","../../../packages/mgt-components/dist/es6/graph/src/graph/graph.people.ts","../../../packages/mgt-components/dist/es6/graph/src/graph/graph.photos.ts","../../../packages/mgt-components/dist/es6/graph/src/graph/graph.presence.ts","../../../packages/mgt-components/dist/es6/graph/src/graph/graph.user.ts","../../../packages/mgt-components/dist/es6/graph/src/graph/graph.userWithPhoto.ts","../../../packages/mgt-components/dist/es6/graph/src/graph/isGraphError.ts","../../../packages/mgt-components/dist/es6/graph/src/graph/types.ts","../../../packages/mgt-components/dist/es6/components/mgt-agenda/src/components/mgt-agenda/mgt-agenda-css.ts","../../../packages/mgt-components/dist/es6/components/mgt-agenda/src/components/mgt-agenda/mgt-agenda.graph.ts","../../../packages/mgt-components/dist/es6/components/mgt-people/src/components/mgt-people/mgt-people-css.ts","../../../packages/mgt-components/dist/es6/components/mgt-people/src/components/mgt-people/mgt-people.ts","../../../packages/mgt-components/dist/es6/components/mgt-agenda/src/components/mgt-agenda/mgt-agenda.ts","../../../packages/mgt-components/dist/es6/components/mgt-picker/src/components/mgt-picker/strings.ts","../../../packages/mgt-components/dist/es6/components/mgt-get/src/components/mgt-get/mgt-get.ts","../../../packages/mgt-components/dist/es6/components/mgt-picker/src/components/mgt-picker/mgt-picker-css.ts","../../../packages/mgt-components/dist/es6/components/mgt-picker/src/components/mgt-picker/mgt-picker.ts","../../../packages/mgt-components/dist/es6/components/mgt-taxonomy-picker/src/components/mgt-taxonomy-picker/strings.ts","../../../packages/mgt-components/dist/es6/components/mgt-taxonomy-picker/src/components/mgt-taxonomy-picker/mgt-taxonomy-picker-css.ts","../../../packages/mgt-components/dist/es6/components/mgt-taxonomy-picker/src/components/mgt-taxonomy-picker/mgt-taxonomy-picker.ts","../../../packages/mgt-components/dist/es6/components/mgt-login/src/components/mgt-login/mgt-login-css.ts","../../../packages/mgt-components/dist/es6/components/mgt-login/src/components/mgt-login/strings.ts","../../../packages/mgt-components/dist/es6/components/mgt-login/src/components/mgt-login/mgt-login.ts","../../../packages/mgt-components/dist/es6/graph/src/graph/graph.groups.ts","../../../packages/mgt-components/dist/es6/components/mgt-people-picker/src/components/mgt-people-picker/mgt-people-picker-css.ts","../../../packages/mgt-components/dist/es6/components/mgt-people-picker/src/components/mgt-people-picker/strings.ts","../../../packages/mgt-components/dist/es6/components/mgt-people-picker/src/components/mgt-people-picker/mgt-people-picker.ts","../../../packages/mgt-components/dist/es6/components/mgt-teams-channel-picker/src/components/mgt-teams-channel-picker/mgt-teams-channel-picker-css.ts","../../../packages/mgt-components/dist/es6/components/mgt-teams-channel-picker/src/components/mgt-teams-channel-picker/mgt-teams-channel-picker.graph.ts","../../../packages/mgt-components/dist/es6/components/mgt-teams-channel-picker/src/components/mgt-teams-channel-picker/strings.ts","../../../packages/mgt-components/dist/es6/components/mgt-teams-channel-picker/src/components/mgt-teams-channel-picker/mgt-teams-channel-picker.ts","../../../packages/mgt-components/dist/es6/components/mgt-todo/src/components/mgt-todo/graph.todo.ts","../../../packages/mgt-components/dist/es6/components/mgt-todo/src/components/mgt-todo/mgt-todo-css.ts","../../../packages/mgt-components/dist/es6/components/mgt-todo/src/components/mgt-todo/strings.ts","../../../packages/mgt-components/dist/es6/components/mgt-tasks-base/src/components/mgt-tasks-base/strings.ts","../../../packages/mgt-components/dist/es6/components/mgt-tasks-base/src/components/mgt-tasks-base/mgt-tasks-base.ts","../../../packages/mgt-components/dist/es6/components/mgt-todo/src/components/mgt-todo/mgt-todo.ts","../../../packages/mgt-components/dist/es6/utils/src/utils/isDark.ts","../../../packages/mgt-components/dist/es6/components/mgt-search-box/src/components/mgt-search-box/strings.ts","../../../packages/mgt-components/dist/es6/components/mgt-search-box/src/components/mgt-search-box/mgt-search-box-css.ts","../../../packages/mgt-components/dist/es6/components/mgt-search-box/src/components/mgt-search-box/mgt-search-box.ts","../../../packages/mgt-components/dist/es6/components/mgt-search-results/src/components/mgt-search-results/strings.ts","../../../packages/mgt-components/dist/es6/components/mgt-search-results/src/components/mgt-search-results/mgt-search-results-css.ts","../../../packages/mgt-components/dist/es6/components/mgt-search-results/src/components/mgt-search-results/mgt-search-results.ts","../../../packages/mgt-components/dist/es6/utils/src/utils/FluentComponents.ts","../../../packages/mgt-components/dist/es6/utils/src/utils/SvgHelper.ts","../../../packages/mgt-components/dist/es6/utils/src/utils/Utils.ts","../../../packages/mgt-element/dist/es6/src/BetaGraph.ts","../../../packages/mgt-element/dist/es6/components/src/components/baseComponent.ts","../../../packages/mgt-element/dist/es6/components/src/components/baseTaskComponent.ts","../../../packages/mgt-element/dist/es6/utils/src/utils/TemplateHelper.ts","../../../packages/mgt-element/dist/es6/components/src/components/templatedTaskComponent.ts","../../../packages/mgt-element/dist/es6/utils/src/utils/CacheStore.ts","../../../packages/mgt-element/dist/es6/utils/src/utils/CacheService.ts","../../../packages/mgt-element/dist/es6/utils/src/utils/GraphPageIterator.ts","../../../packages/mgt-element/dist/es6/utils/src/utils/LocalizationHelper.ts","../../../packages/mgt-element/dist/es6/utils/src/utils/equals.ts","../../../packages/mgt-element/dist/es6/utils/src/utils/mgtHtml.ts","../../../packages/mgt-element/dist/es6/utils/src/utils/registerComponent.ts","../../../packages/mgt-react/src/Mgt.ts","../../../packages/mgt-react/src/generated/person.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable @typescript-eslint/consistent-type-definitions */\nimport { registerMgtSearchBoxComponent } from '@microsoft/mgt-components';\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport * as MicrosoftGraph from '@microsoft/microsoft-graph-types';\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport * as MicrosoftGraphBeta from '@microsoft/microsoft-graph-types-beta';\nimport {wrapMgt} from '../Mgt';\n\nexport type SearchBoxProps = {\n\tplaceholder?: string;\n\tsearchTerm?: string;\n\tdebounceDelay?: number;\n\tsearchTermChanged?: (e: CustomEvent<string>) => void;\n}\n\nexport const SearchBox = wrapMgt<SearchBoxProps>('search-box', registerMgtSearchBoxComponent);\n\n","/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable @typescript-eslint/consistent-type-definitions */\nimport { IDynamicPerson,LoginViewType } from '@microsoft/mgt-components';\nimport { registerMgtLoginComponent } from '@microsoft/mgt-components';\nimport { TemplateContext,TemplateRenderedData } from '@microsoft/mgt-element';\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport * as MicrosoftGraph from '@microsoft/microsoft-graph-types';\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport * as MicrosoftGraphBeta from '@microsoft/microsoft-graph-types-beta';\nimport {wrapMgt} from '../Mgt';\n\nexport type LoginProps = {\n\tuserDetails?: IDynamicPerson;\n\tshowPresence?: boolean;\n\tloginView?: LoginViewType;\n\ttemplateContext?: TemplateContext;\n\tloginInitiated?: (e: CustomEvent<undefined>) => void;\n\tloginCompleted?: (e: CustomEvent<undefined>) => void;\n\tloginFailed?: (e: CustomEvent<undefined>) => void;\n\tlogoutInitiated?: (e: CustomEvent<undefined>) => void;\n\tlogoutCompleted?: (e: CustomEvent<undefined>) => void;\n\ttemplateRendered?: (e: CustomEvent<TemplateRenderedData>) => void;\n}\n\nexport const Login = wrapMgt<LoginProps>('login', registerMgtLoginComponent);\n\n","import * as React from 'react';\nimport { Person } from '@microsoft/mgt-react';\nimport { MgtTemplateProps } from '@microsoft/mgt-react';\nimport { makeStyles } from '@fluentui/react-components';\n\nconst useStyles = makeStyles({\n  simpleLogin: {\n    '--person-avatar-size-small': '32px'\n  }\n});\nexport const SimpleLogin: React.FunctionComponent<MgtTemplateProps> = (props: MgtTemplateProps) => {\n  const styles = useStyles();\n  const { personDetails } = props.dataContext;\n  return <Person userId={personDetails.id} avatarSize={'auto'} className={styles.simpleLogin} />;\n};\n","import * as React from 'react';\nimport {\n  Menu,\n  MenuButton,\n  MenuItem,\n  MenuList,\n  MenuPopover,\n  MenuTrigger,\n  webDarkTheme,\n  webLightTheme,\n  teamsLightTheme,\n  teamsDarkTheme\n} from '@fluentui/react-components';\nimport { BrightnessHighRegular, WeatherMoonFilled, PeopleTeamRegular, PeopleTeamFilled } from '@fluentui/react-icons';\nimport { useAppContext } from '../AppContext';\n\nconst availableThemes = [\n  {\n    key: 'light',\n    displayName: 'Web Light',\n    icon: <BrightnessHighRegular />\n  },\n  {\n    key: 'dark',\n    displayName: 'Web Dark',\n    icon: <WeatherMoonFilled />\n  },\n  {\n    key: 'teamsLight',\n    displayName: 'Teams Light',\n    icon: <PeopleTeamRegular />\n  },\n  {\n    key: 'teamsDark',\n    displayName: 'Teams Dark',\n    icon: <PeopleTeamFilled />\n  }\n];\n\nexport const ThemeSwitcher = () => {\n  const [selectedTheme, setSelectedTheme] = React.useState<any>(availableThemes[0]);\n  const appContext = useAppContext();\n\n  const onThemeChanged = (theme: any) => {\n    setSelectedTheme(theme);\n    // Applies the theme to the Fluent UI components\n    switch (theme.key) {\n      case 'teamsLight':\n        appContext.setState({\n          ...appContext.state,\n          theme: { key: 'light', fluentTheme: teamsLightTheme }\n        });\n        break;\n      case 'teamsDark':\n        appContext.setState({\n          ...appContext.state,\n          theme: { key: 'dark', fluentTheme: teamsDarkTheme }\n        });\n        break;\n      case 'light':\n        appContext.setState({\n          ...appContext.state,\n          theme: { key: theme.key, fluentTheme: webLightTheme }\n        });\n        break;\n      case 'dark':\n        appContext.setState({\n          ...appContext.state,\n          theme: { key: theme.key, fluentTheme: webDarkTheme }\n        });\n        break;\n    }\n  };\n\n  return (\n    <Menu>\n      <MenuTrigger>\n        <MenuButton icon={selectedTheme.icon}>{selectedTheme.displayName}</MenuButton>\n      </MenuTrigger>\n\n      <MenuPopover>\n        <MenuList>\n          {availableThemes.map(theme => (\n            <MenuItem icon={theme.icon} key={theme.key} onClick={() => onThemeChanged(theme)}>\n              {theme.displayName}\n            </MenuItem>\n          ))}\n        </MenuList>\n      </MenuPopover>\n    </Menu>\n  );\n};\n","import * as React from 'react';\nimport { Login, SearchBox } from '@microsoft/mgt-react';\nimport { PACKAGE_VERSION } from '@microsoft/mgt-element';\nimport { InfoButton } from '@fluentui/react-components/unstable';\nimport { SimpleLogin } from './SimpleLogin';\nimport { useIsSignedIn } from '../hooks/useIsSignedIn';\nimport { useNavigate } from 'react-router-dom';\nimport { ThemeSwitcher } from './ThemeSwitcher';\nimport { useAppContext } from '../AppContext';\nimport { Label, makeStyles, mergeClasses, shorthands, tokens } from '@fluentui/react-components';\nimport { GridDotsRegular } from '@fluentui/react-icons';\nimport { useLocation } from 'react-router-dom';\n\nconst useStyles = makeStyles({\n  root: {\n    '--login-signed-in-hover-background': 'transparent'\n  },\n\n  header: {\n    display: 'flex',\n    flexDirection: 'row',\n    flexWrap: 'nowrap',\n    width: '100%',\n    height: 'auto',\n    boxSizing: 'border-box',\n    alignItems: 'center',\n    backgroundColor: tokens.colorNeutralForeground1Static,\n    zIndex: '1',\n    minHeight: '50px'\n  },\n\n  name: {\n    color: tokens.colorNeutralForegroundOnBrand,\n    fontWeight: tokens.fontWeightSemibold,\n    fontSize: tokens.fontSizeBase400,\n    paddingLeft: '12px'\n  },\n\n  wafffleIcon: {\n    fontSize: tokens.fontSizeBase600,\n    paddingTop: '5px',\n    color: tokens.colorNeutralForegroundOnBrand\n  },\n\n  waffle: {\n    display: 'flex',\n    width: 'auto',\n    height: 'auto',\n    boxSizing: 'border-box',\n    flexGrow: '1',\n    alignItems: 'center',\n    minWidth: 'max-content',\n    paddingLeft: '8px'\n  },\n\n  waffleLogo: {\n    ...shorthands.flex('none')\n  },\n\n  waffleTitle: {\n    ...shorthands.flex('auto'),\n    display: 'flex',\n    alignItems: 'center'\n  },\n\n  search: {\n    display: 'flex',\n    width: '100%',\n    height: 'auto',\n    boxSizing: 'border-box',\n    flexGrow: '1',\n    justifyContent: 'center'\n  },\n\n  searchBox: {\n    minWidth: '320px',\n    maxWidth: '468px',\n    paddingRight: '1em',\n    paddingLeft: '1em',\n    width: '100%'\n  },\n\n  infoIcon: {\n    color: tokens.colorNeutralForegroundOnBrand,\n    ':hover': {\n      color: tokens.colorNeutralForegroundOnBrand,\n      ':active': {\n        color: tokens.colorNeutralForegroundOnBrand\n      }\n    }\n  },\n\n  login: {\n    display: 'flex',\n    width: 'auto',\n    height: 'auto',\n    boxSizing: 'border-box',\n    flexGrow: '1',\n    alignItems: 'center',\n    minWidth: 'max-content'\n  },\n\n  signedOut: {\n    ...shorthands.padding('4px', '8px')\n  },\n\n  signedIn: {\n    ...shorthands.padding('0px', '10px')\n  }\n});\n\nconst HeaderComponent: React.FunctionComponent = () => {\n  const styles = useStyles();\n  const [isSignedIn] = useIsSignedIn();\n  const appContext = useAppContext();\n  const setAppContext = appContext.setState;\n  const location = useLocation();\n  const navigate = useNavigate();\n\n  const onSearchTermChanged = (e: CustomEvent) => {\n    if (!(e.detail === '' && appContext.state.searchTerm === '*') && e.detail !== appContext.state.searchTerm) {\n      appContext.setState({ ...appContext.state, searchTerm: e.detail === '' ? '*' : e.detail });\n\n      if (e.detail === '') {\n        navigate('/search');\n      } else {\n        navigate('/search?q=' + e.detail);\n      }\n    }\n  };\n\n  React.useLayoutEffect(() => {\n    if (location.pathname === '/search') {\n      const searchTerm = decodeURI(location.search.replace('?q=', ''));\n      setAppContext(previous => {\n        return { ...previous, searchTerm: searchTerm === '' ? '*' : searchTerm };\n      });\n    }\n  }, [location, setAppContext]);\n\n  return (\n    <div className={styles.header}>\n      <div className={styles.waffle}>\n        <div className={styles.waffleLogo}>\n          <a href={'https://www.office.com/apps?auth=2'} target=\"_blank\" rel=\"noreferrer\">\n            <GridDotsRegular className={styles.wafffleIcon} />\n          </a>\n        </div>\n\n        <div className={styles.waffleTitle}>\n          <Label className={styles.name}>{process.env.REACT_APP_SITE_NAME} </Label>\n          <InfoButton\n            className={styles.infoIcon}\n            size=\"medium\"\n            info={<>Using the Graph Toolkit v{PACKAGE_VERSION}</>}\n          />\n        </div>\n      </div>\n      <div className={styles.search}>\n        <SearchBox\n          className={styles.searchBox}\n          searchTermChanged={onSearchTermChanged}\n          searchTerm={appContext.state.searchTerm !== '*' ? appContext.state.searchTerm : ''}\n        ></SearchBox>\n      </div>\n\n      <div className={styles.login}>\n        <ThemeSwitcher />\n        <div className={mergeClasses(!isSignedIn ? styles.signedOut : styles.signedIn, styles.root)}>\n          <Login>\n            <SimpleLogin template=\"signed-in-button-content\" />\n          </Login>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport const Header = React.memo(HeaderComponent);\n","import { Tab, TabList, makeStyles, mergeClasses, tokens } from '@fluentui/react-components';\nimport * as React from 'react';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport { NavigationRegular } from '@fluentui/react-icons';\nimport { useAppContext } from '../AppContext';\nimport { NavigationItem } from '../models/NavigationItem';\n\nexport interface ISideNavigationProps {\n  items: any[];\n}\n\nconst useStyles = makeStyles({\n  tab: {\n    paddingTop: '12px',\n    paddingBottom: '12px'\n  },\n  activeTab: {\n    backgroundColor: tokens.colorSubtleBackgroundHover\n  }\n});\n\nexport const SideNavigation: React.FunctionComponent<ISideNavigationProps> = props => {\n  const navigate = useNavigate();\n  const location = useLocation();\n  const { items } = props;\n  const [selectedTab, setSelectedTab] = React.useState<any>('');\n  const [isMinimized, setIsMinimized] = React.useState<boolean>(false);\n  const styles = useStyles();\n  const appContext = useAppContext();\n\n  const performNavigation = (event: any, data: any) => {\n    if (data.value === 'navigation') {\n      const futureIsMinimized = !isMinimized;\n      setIsMinimized(futureIsMinimized);\n      appContext.setState({\n        ...appContext.state,\n        sidebar: { ...appContext.state.sidebar, isMinimized: futureIsMinimized }\n      });\n    } else {\n      navigate(data.value, { relative: 'route' });\n    }\n  };\n\n  React.useLayoutEffect(() => {\n    setSelectedTab(location.pathname.substring(1));\n  }, [location]);\n\n  return (\n    <>\n      <TabList size=\"medium\" appearance=\"subtle\" vertical onTabSelect={performNavigation} selectedValue={selectedTab}>\n        <Tab icon={<NavigationRegular />} value={'navigation'} className={styles.tab}></Tab>\n        {items.map((item: NavigationItem, index) => (\n          <Tab\n            icon={item.icon}\n            value={item.url}\n            key={index}\n            className={mergeClasses(styles.tab, item.url === selectedTab && styles.activeTab)}\n          >\n            {!isMinimized ? item.name : ''}\n          </Tab>\n        ))}\n      </TabList>\n    </>\n  );\n};\n","import { lazy, Suspense } from 'react';\nimport { NavigationItem } from '../models/NavigationItem';\nimport {\n  HomeRegular,\n  SearchRegular,\n  TextBulletListSquareRegular,\n  CalendarMailRegular,\n  DocumentRegular,\n  TagMultipleRegular,\n  ChatRegular\n} from '@fluentui/react-icons';\nconst DashboardPage = lazy(() => import('../pages/DashboardPage'));\nconst OutlookPage = lazy(() => import('../pages/OutlookPage'));\nconst SearchPage = lazy(() => import('../pages/SearchPage'));\nconst HomePage = lazy(() => import('../pages/HomePage'));\nconst FilesPage = lazy(() => import('../pages/FilesPage'));\nconst TaxonomyPage = lazy(() => import('../pages/TaxonomyPage'));\nconst ChatPage = lazy(() => import('../pages/ChatPage'));\n\nexport const getNavigation = (isSignedIn: boolean) => {\n  let navItems: NavigationItem[] = [];\n\n  navItems.push({\n    name: 'Home',\n    url: '',\n    icon: <HomeRegular />,\n    key: 'home',\n    requiresLogin: false,\n    component: (\n      <Suspense fallback=\"Loading...\">\n        <HomePage />\n      </Suspense>\n    ),\n    exact: true\n  });\n\n  if (isSignedIn) {\n    navItems.push({\n      name: 'Dashboard',\n      url: 'dashboard',\n      icon: <TextBulletListSquareRegular />,\n      key: 'dashboard',\n      requiresLogin: true,\n      component: (\n        <Suspense fallback=\"Loading...\">\n          <DashboardPage />\n        </Suspense>\n      ),\n      exact: true\n    });\n\n    navItems.push({\n      name: 'Mail and Calendar',\n      url: 'outlook',\n      icon: <CalendarMailRegular />,\n      key: 'outlook',\n      requiresLogin: true,\n      component: (\n        <Suspense fallback=\"Loading...\">\n          <OutlookPage />\n        </Suspense>\n      ),\n      exact: true\n    });\n\n    navItems.push({\n      name: 'Files',\n      url: 'files',\n      icon: <DocumentRegular />,\n      key: 'files',\n      requiresLogin: true,\n      component: (\n        <Suspense fallback=\"Loading...\">\n          <FilesPage />\n        </Suspense>\n      ),\n      exact: true\n    });\n\n    navItems.push({\n      name: 'Taxonomy',\n      url: 'taxonomy',\n      icon: <TagMultipleRegular />,\n      key: 'files',\n      requiresLogin: true,\n      component: (\n        <Suspense fallback=\"Loading...\">\n          <TaxonomyPage />\n        </Suspense>\n      ),\n      exact: true\n    });\n\n    navItems.push({\n      name: 'Chat',\n      url: 'chat',\n      icon: <ChatRegular />,\n      key: 'chat',\n      requiresLogin: true,\n      component: (\n        <Suspense fallback=\"Loading...\">\n          <ChatPage />\n        </Suspense>\n      ),\n      exact: true\n    });\n\n    navItems.push({\n      name: 'Search',\n      url: 'search',\n      pattern: '/search/:query',\n      icon: <SearchRegular />,\n      key: 'search',\n      requiresLogin: true,\n      component: (\n        <Suspense fallback=\"Loading...\">\n          <SearchPage />\n        </Suspense>\n      ),\n      exact: false\n    });\n  }\n  return navItems;\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport {\n  accentBaseColor,\n  accentFillActive,\n  accentFillFocus,\n  accentFillHover,\n  accentFillRest,\n  accentForegroundActive,\n  accentForegroundFocus,\n  accentForegroundHover,\n  accentForegroundRest,\n  accentStrokeControlActive,\n  accentStrokeControlFocus,\n  accentStrokeControlHover,\n  accentStrokeControlRest,\n  baseLayerLuminance,\n  foregroundOnAccentActive,\n  foregroundOnAccentFocus,\n  foregroundOnAccentHover,\n  foregroundOnAccentRest,\n  neutralBaseColor,\n  StandardLuminance,\n  SwatchRGB\n} from '@fluentui/web-components';\nimport { DesignToken } from '@microsoft/fast-foundation';\n// @microsoft/fast-colors is a transitive dependency of @fluentui/web-components, no need to explicitly add it to package.json\nimport { parseColorHexRGB } from '@microsoft/fast-colors';\n\n/**\n * Available predefined themes\n */\ntype Theme = 'light' | 'dark' | 'default' | 'contrast';\n\nconst secondaryTextDefault = '#717171';\nconst secondaryTextColor = DesignToken.create<string>('secondary-text-color').withDefault(secondaryTextDefault);\nconst secondaryTextHoverDefault = '#1a1a1a';\nconst secondaryTextHoverColor =\n  DesignToken.create<string>('secondary-text-hover-color').withDefault(secondaryTextHoverDefault);\n\n/**\n * Helper function to apply fluent ui theme to an element\n *\n * @export\n * @param {Theme} theme - theme name, if an unknown theme is provided, the light theme will be applied\n * @param {HTMLElement} [element=document.body]\n */\nexport const applyTheme = (theme: Theme, element: HTMLElement = document.body): void => {\n  const settings = getThemeSettings(theme);\n  applyColorScheme(settings, element);\n};\n\n/**\n * Simple data holder for theme settings\n */\ninterface ColorScheme {\n  /**\n   * Hex color string for accent base color\n   *\n   * @type {string}\n   */\n  accentBaseColor: string;\n  /**\n   * Hex color string for neutral base color\n   *\n   * @type {string}\n   */\n  neutralBaseColor: string;\n  /**\n   * Base layer luminance for the theme\n   * in the range of 0 to 1\n   *\n   * @type {number}\n   */\n  baseLayerLuminance: number;\n\n  /**\n   * Optional function to override design tokens\n   */\n  designTokenOverrides?: (element: HTMLElement) => void;\n}\n\n/**\n * Helper function to apply fluent ui color scheme to an element\n *\n * @param {ColorScheme} settings\n * @param {HTMLElement} [element=document.body]\n */\nconst applyColorScheme = (settings: ColorScheme, element: HTMLElement = document.body): void => {\n  accentBaseColor.setValueFor(element, SwatchRGB.from(parseColorHexRGB(settings.accentBaseColor)));\n  neutralBaseColor.setValueFor(element, SwatchRGB.from(parseColorHexRGB(settings.neutralBaseColor)));\n  baseLayerLuminance.setValueFor(element, settings.baseLayerLuminance);\n  settings.designTokenOverrides?.(element);\n};\n\n/**\n * Helper function to translate theme name to theme settings\n *\n * @param {Theme} theme\n * @return {*}  {ThemeSettings}\n */\nconst getThemeSettings = (theme: Theme): ColorScheme => {\n  switch (theme) {\n    case 'contrast':\n      return {\n        accentBaseColor: '#7f85f5',\n        neutralBaseColor: '#adadad',\n        baseLayerLuminance: StandardLuminance.DarkMode\n      };\n    case 'default': // this is the Teams light theme\n      return {\n        accentBaseColor: '#5b5fc7',\n        neutralBaseColor: '#616161',\n        baseLayerLuminance: StandardLuminance.LightMode\n      };\n    case 'dark': // Both MGT default dark and Teams Dark theme\n      return {\n        accentBaseColor: '#479ef5',\n        neutralBaseColor: '#adadad',\n        baseLayerLuminance: StandardLuminance.DarkMode,\n        designTokenOverrides: element => {\n          accentFillRest.setValueFor(element, SwatchRGB.from(parseColorHexRGB('#115ea3')));\n          accentFillHover.setValueFor(element, SwatchRGB.from(parseColorHexRGB('#0f6cbd')));\n          accentFillActive.setValueFor(element, SwatchRGB.from(parseColorHexRGB('#0c3b5e')));\n          accentFillFocus.setValueFor(element, SwatchRGB.from(parseColorHexRGB('#0f548c')));\n          accentForegroundRest.setValueFor(element, SwatchRGB.from(parseColorHexRGB('#479EF5')));\n          accentForegroundHover.setValueFor(element, SwatchRGB.from(parseColorHexRGB('#62abf5')));\n          accentForegroundActive.setValueFor(element, SwatchRGB.from(parseColorHexRGB('#2886de')));\n          accentForegroundFocus.setValueFor(element, SwatchRGB.from(parseColorHexRGB('#479ef5')));\n          accentStrokeControlRest.setValueFor(element, SwatchRGB.from(parseColorHexRGB('#115ea3')));\n          accentStrokeControlHover.setValueFor(element, SwatchRGB.from(parseColorHexRGB('#0f6cbd')));\n          accentStrokeControlActive.setValueFor(element, SwatchRGB.from(parseColorHexRGB('#0c3b5e')));\n          accentStrokeControlFocus.setValueFor(element, SwatchRGB.from(parseColorHexRGB('#0f548c')));\n          foregroundOnAccentActive.setValueFor(element, SwatchRGB.from(parseColorHexRGB('#ffffff')));\n          foregroundOnAccentRest.setValueFor(element, SwatchRGB.from(parseColorHexRGB('#ffffff')));\n          foregroundOnAccentHover.setValueFor(element, SwatchRGB.from(parseColorHexRGB('#ffffff')));\n          foregroundOnAccentFocus.setValueFor(element, SwatchRGB.from(parseColorHexRGB('#ffffff')));\n          secondaryTextColor.setValueFor(element, '#8e8e8e');\n          secondaryTextHoverColor.setValueFor(element, '#ffffff');\n        }\n      };\n    case 'light':\n    default:\n      return {\n        accentBaseColor: '#0f6cbd',\n        neutralBaseColor: '#616161',\n        baseLayerLuminance: StandardLuminance.LightMode,\n        designTokenOverrides: element => {\n          secondaryTextColor.setValueFor(element, secondaryTextDefault);\n          secondaryTextHoverColor.setValueFor(element, secondaryTextHoverDefault);\n        }\n      };\n  }\n};\n","import React, { Suspense, lazy } from 'react';\nimport { BrowserRouter, Route, Routes } from 'react-router-dom';\nimport { Header } from './components/Header';\nimport { SideNavigation } from './components/SideNavigation';\nimport { useIsSignedIn } from './hooks/useIsSignedIn';\nimport { NavigationItem } from './models/NavigationItem';\nimport { getNavigation } from './services/Navigation';\nimport { FluentProvider, makeStyles, mergeClasses, shorthands } from '@fluentui/react-components';\nimport { tokens } from '@fluentui/react-theme';\nimport { applyTheme } from '@microsoft/mgt-react';\nimport { useAppContext } from './AppContext';\nconst HomePage = lazy(() => import('./pages/HomePage'));\n\nconst useStyles = makeStyles({\n  sidebar: {\n    display: 'flex',\n    flexDirection: 'column',\n    flexWrap: 'nowrap',\n    height: '100%',\n    minWidth: '295px',\n    boxSizing: 'border-box',\n    backgroundColor: tokens.colorNeutralBackground6\n  },\n  main: {\n    backgroundColor: tokens.colorNeutralBackground1,\n    display: 'flex',\n    flexDirection: 'row',\n    width: 'auto',\n    height: 'calc(100vh - 50px)',\n    boxSizing: 'border-box'\n  },\n  minimized: {\n    minWidth: 'auto'\n  },\n  page: {\n    display: 'flex',\n    flexDirection: 'column',\n    flexWrap: 'nowrap'\n  },\n  content: {\n    display: 'flex',\n    flexDirection: 'column',\n    flexWrap: 'nowrap',\n    width: '100%',\n    height: 'auto',\n    boxSizing: 'border-box',\n    ...shorthands.margin('10px'),\n    ...shorthands.overflow('auto')\n  }\n});\n\nexport const Layout: React.FunctionComponent = theme => {\n  const styles = useStyles();\n  const [navigationItems, setNavigationItems] = React.useState<NavigationItem[]>([]);\n  const [isSignedIn] = useIsSignedIn();\n  const appContext = useAppContext();\n\n  React.useEffect(() => {\n    setNavigationItems(getNavigation(isSignedIn));\n  }, [isSignedIn]);\n\n  React.useEffect(() => {\n    // Applies the theme to the MGT components\n    applyTheme(appContext.state.theme.key as any);\n  }, [appContext]);\n\n  return (\n    <FluentProvider theme={appContext.state.theme.fluentTheme}>\n      <div className={styles.page}>\n        <BrowserRouter basename={process.env.REACT_APP_BASE_DIR ?? '/'}>\n          <Header></Header>\n          <div className={styles.main}>\n            <div\n              className={mergeClasses(\n                styles.sidebar,\n                `${appContext.state.sidebar.isMinimized ? styles.minimized : ''}`\n              )}\n            >\n              <SideNavigation items={navigationItems}></SideNavigation>\n            </div>\n            <div className={styles.content}>\n              <Routes>\n                {navigationItems.map(\n                  item =>\n                    ((item.requiresLogin && isSignedIn) || !item.requiresLogin) && (\n                      <Route path={item.url} element={item.component} key={item.key} />\n                    )\n                )}\n                <Route\n                  path=\"*\"\n                  element={\n                    <Suspense fallback=\"Loading...\">\n                      <HomePage />\n                    </Suspense>\n                  }\n                />\n              </Routes>\n            </div>\n          </div>\n        </BrowserRouter>\n      </div>\n    </FluentProvider>\n  );\n};\n","import React from 'react';\nimport { AppContext } from './AppContext';\nimport { Layout } from './Layout';\nimport { webLightTheme } from '@fluentui/react-components';\n\nconst App: React.FunctionComponent = theme => {\n  const [state, setState] = React.useState({\n    searchTerm: '*',\n    sidebar: {\n      isMinimized: false\n    },\n    theme: { key: 'light', fluentTheme: webLightTheme }\n  });\n\n  return (\n    <AppContext.Provider value={{ state, setState }}>\n      <Layout />\n    </AppContext.Provider>\n  );\n};\n\nexport default App;\n","import { Theme } from '@fluentui/react-components';\nimport React from 'react';\nimport { Dispatch, SetStateAction } from 'react';\n\ntype AppContextState = {\n  searchTerm: string;\n  sidebar: { isMinimized: boolean };\n  theme: { key: string; fluentTheme: Theme };\n};\n\ntype AppContextValue = {\n  state: AppContextState;\n  setState: Dispatch<SetStateAction<AppContextState>>;\n};\n\nexport const AppContext = React.createContext<AppContextValue | undefined>(undefined);\n\nexport function useAppContext() {\n  const value = React.useContext(AppContext);\n  if (value === undefined) throw new Error('Expected an AppProvider somewhere in the react tree to set context value');\n  return value; // now has type AppContextValue\n  // or even provide domain methods for better encapsulation\n}\n","import { useState, useEffect } from 'react';\nimport { Providers, ProvidersChangedState, ProviderState } from '@microsoft/mgt-element';\n\nexport function useIsSignedIn(): [boolean] {\n  const [isSignedIn, setIsSignedIn] = useState(false);\n\n  useEffect(() => {\n    const updateState = (stateEvent: ProvidersChangedState) => {\n      if (stateEvent === ProvidersChangedState.ProviderStateChanged) {\n        setIsSignedIn(Providers.globalProvider.state === ProviderState.SignedIn);\n      }\n    };\n\n    setIsSignedIn(Providers.globalProvider.state === ProviderState.SignedIn);\n    Providers.onProviderUpdated(updateState);\n\n    return () => {\n      Providers.removeProviderUpdatedListener(updateState);\n    };\n  }, []);\n\n  return [isSignedIn];\n}\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nconst interactions = ['none', 'hover', 'click'] as const;\n\n/**\n * Defines how a person card is shown when a user interacts with\n * a person component\n *\n */\nexport type PersonCardInteraction = (typeof interactions)[number];\n\nexport const isPersonCardInteraction = (value: unknown): value is PersonCardInteraction =>\n  typeof value === 'string' && interactions.includes(value as PersonCardInteraction);\n\nexport const personCardConverter = (\n  value: string,\n  defaultValue: PersonCardInteraction = 'none'\n): PersonCardInteraction => {\n  if (isPersonCardInteraction(value)) {\n    return value;\n  }\n  return defaultValue;\n};\n","// THIS FILE IS AUTO GENERATED\n// ANY CHANGES WILL BE LOST DURING BUILD\n// MODIFY THE .SCSS FILE INSTEAD\n\nimport { css, CSSResult } from 'lit';\n/**\n * exports lit-element css\n * @export styles\n */\nexport const styles: CSSResult[] = [\n  css`\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, \"Segoe UI\", \"Segoe UI Web (West European)\", \"Segoe UI\", -apple-system, \"BlinkMacSystemFont\", \"Roboto\", \"Helvetica Neue\", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:\"\\\\\\e70d\"}.ms-icon-chevron-up::before{content:\"\\\\\\e70e\"}.ms-icon-contact::before{content:\"\\\\\\e77b\"}.ms-icon-add-friend::before{content:\"\\\\\\e8fa\"}.ms-icon-outlook-logo-inverser::before{content:\"\\\\\\eb6d\"}:host{font-size:var(--default-font-size)}:host .title{font-size:14px;font-weight:600;padding:20px 0 12px;line-height:19px}:host .file-list-wrapper{background-color:var(--file-list-background-color,var(--neutral-layer-floating));border:var(--file-list-border,none);position:relative;display:flex;flex-direction:column;border-radius:8px}:host .file-list-wrapper .title{font-size:14px;font-weight:600;margin:0 20px -15px}:host .file-list-wrapper .file-list{display:flex;padding:var(--file-list-padding,0);margin:var(--file-list-margin,0);flex-direction:column;list-style:none}:host .file-list-wrapper .file-list .file-item{cursor:pointer;border-radius:var(--file-border-radius)}:host .file-list-wrapper .file-list .file-item:focus,:host .file-list-wrapper .file-list .file-item:focus-within{--file-background-color:var(--file-background-color-focus, var(--neutral-layer-2))}:host .file-list-wrapper .file-list .file-item.selected{--file-background-color:var(--file-background-color-active, var(--neutral-layer-3))}:host .file-list-wrapper .file-list .file-item .mgt-file-item{--file-padding:10px 20px 10px 20px;--file-padding-inline-start:24px;--file-border-radius:2px;--file-background-color:var(--file-item-background-color, var(--neutral-layer-1))}:host .file-list-wrapper .progress-ring{margin:4px auto;width:var(--progress-ring-size,24px);height:var(--progress-ring-size,24px)}:host .file-list-wrapper .show-more{text-align:center;font-size:var(--show-more-button-font-size,12px);padding:var(--show-more-button-padding,0);border-radius:0 0 var(--show-more-button-border-bottom-right-radius,var(--file-list-border-radius,8px)) var(--show-more-button-border-bottom-left-radius,var(--file-list-border-radius,8px));background-color:var(--show-more-button-background-color,var(--neutral-stroke-divider-rest))}:host .file-list-wrapper .show-more:hover{background-color:var(--show-more-button-background-color-hover,var(--neutral-fill-input-alt-active))}:host .file-list-wrapper .show-more-text{font-size:var(--show-more-button-font-size,12px)}\n`];","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nexport const strings = {\n  showMoreSubtitle: 'Show more items',\n  filesSectionTitle: 'Files',\n  sharedTextSubtitle: 'Shared'\n};\n","// THIS FILE IS AUTO GENERATED\n// ANY CHANGES WILL BE LOST DURING BUILD\n// MODIFY THE .SCSS FILE INSTEAD\n\nimport { css, CSSResult } from 'lit';\n/**\n * exports lit-element css\n * @export styles\n */\nexport const styles: CSSResult[] = [\n  css`\n:host .file-upload-area-button{width:auto;display:flex;align-items:end;justify-content:end;margin-inline-end:36px;margin-top:30px}:host fluent-button .upload-icon path{fill:var(--file-upload-button-text-color,var(--foreground-on-accent-rest))}:host fluent-button.file-upload-button::part(control){border:var(--file-upload-button-border,none);background:var(--file-upload-button-background-color,var(--accent-fill-rest))}:host fluent-button.file-upload-button::part(control):hover{background:var(--file-upload-button-background-color-hover,var(--accent-fill-hover))}:host fluent-button.file-upload-button .upload-text{color:var(--file-upload-button-text-color,var(--foreground-on-accent-rest));font-weight:400;line-height:20px}:host input{display:none}:host fluent-progress.file-upload-bar{width:180px;margin-top:10px}:host fluent-dialog::part(overlay){opacity:.5}:host fluent-dialog::part(control){--dialog-width:$file-upload-dialog-width;--dialog-height:$file-upload-dialog-height;padding:var(--file-upload-dialog-padding,24px);border:var(--file-upload-dialog-border,1px solid var(--neutral-fill-rest))}:host fluent-dialog .file-upload-dialog-ok{background:var(--file-upload-dialog-keep-both-button-background-color,var(--accent-fill-rest));border:var(--file-upload-dialog-keep-both-button-border,none);color:var(--file-upload-dialog-keep-both-button-text-color,var(--foreground-on-accent-rest))}:host fluent-dialog .file-upload-dialog-ok:hover{background:var(--file-upload-dialog-keep-both-button-background-color-hover,var(--accent-fill-hover))}:host fluent-dialog .file-upload-dialog-cancel{background:var(--file-upload-dialog-replace-button-background-color,var(--accent-fill-rest));border:var(--file-upload-dialog-replace-button-border,1px solid var(--neutral-foreground-rest));color:var(--file-upload-dialog-replace-button-text-color,var(--neutral-foreground-rest))}:host fluent-dialog .file-upload-dialog-cancel:hover{background:var(--file-upload-dialog-replace-button-background-color-hover,var(--accent-fill-hover))}:host fluent-checkbox{margin-top:12px}:host fluent-checkbox .file-upload-dialog-check{color:var(--file-upload-dialog-text-color,--foreground-on-accent-rest)}:host .file-upload-table{display:flex}:host .file-upload-table.upload{display:flex}:host .file-upload-table .file-upload-cell{padding:1px 0 1px 1px;display:table-cell;vertical-align:middle;position:relative}:host .file-upload-table .file-upload-cell.percent-indicator{padding-inline-start:10px}:host .file-upload-table .file-upload-cell .description{opacity:.5;position:relative}:host .file-upload-table .file-upload-cell .file-upload-filename{max-width:250px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:host .file-upload-table .file-upload-cell .file-upload-status{position:absolute;left:28px}:host .file-upload-table .file-upload-cell .file-upload-cancel{cursor:pointer;margin-inline-start:20px}:host .file-upload-table .file-upload-cell .file-upload-name{width:auto}:host .file-upload-table .file-upload-cell .cancel-icon{fill:var(--file-upload-dialog-text-color,var(--neutral-foreground-rest))}:host .mgt-file-item{--file-background-color:transparent;--file-padding:0 12px;--file-padding-inline-start:24px}:host .file-upload-template{clear:both}:host .file-upload-template .file-upload-folder-tab{padding-inline-start:20px}:host .file-upload-dialog{display:none}:host .file-upload-dialog .file-upload-dialog-content{background-color:var(--file-upload-dialog-background-color,var(--accent-fill-rest));color:var(--file-upload-dialog-text-color,var(--neutral-foreground-rest))}:host .file-upload-dialog .file-upload-dialog-content-text{margin-bottom:36px}:host .file-upload-dialog .file-upload-dialog-title{margin-top:0}:host .file-upload-dialog .file-upload-dialog-editor{display:flex;align-items:end;justify-content:end;gap:5px}:host .file-upload-dialog .file-upload-dialog-close{float:right;cursor:pointer}:host .file-upload-dialog .file-upload-dialog-close svg{fill:var(--file-upload-dialog-text-color,var(--neutral-foreground-rest));padding-right:5px}:host .file-upload-dialog.visible{display:block}:host fluent-checkbox.file-upload-dialog-check.hide{display:none}:host .file-upload-dialog-success{cursor:pointer;opacity:.5}:host #file-upload-border{display:none}:host #file-upload-border.visible{border:var(--file-upload-border-drag,1px dashed #0078d4);background-color:var(--file-upload-background-color-drag,rgba(0,120,212,.1));position:absolute;inset:0;z-index:1;display:inline-block}[dir=rtl] :host .file-upload-status{left:0;right:28px}\n`];","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nexport const strings = {\n  failUploadFile: 'File upload fail.',\n  cancelUploadFile: 'File cancel.',\n  buttonUploadFile: 'Upload Files',\n  maximumFilesTitle: 'Maximum files',\n  maximumFiles:\n    'Sorry, the maximum number of files you can upload at once is {MaxNumber}. Do you want to upload the first {MaxNumber} files or reselect?',\n  maximumFileSizeTitle: 'Maximum files size',\n  maximumFileSize: 'Sorry, the maximum file size to upload is {FileSize}. The file \"{FileName}\" has ',\n  fileTypeTitle: 'File type',\n  fileType: 'Sorry, the format of following file \"{FileName}\" cannot be uploaded.',\n  checkAgain: \"Don't show again\",\n  checkApplyAll: 'Apply to all',\n  buttonOk: 'OK',\n  buttonCancel: 'Cancel',\n  buttonUpload: 'Upload',\n  buttonKeep: 'Keep both',\n  buttonReplace: 'Replace',\n  buttonReselect: 'Reselect',\n  fileReplaceTitle: 'Replace file',\n  fileReplace: 'Do you want to replace the file \"{FileName}\" or keep both files?',\n  uploadButtonLabel: 'File upload button'\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { fluentButton, fluentCheckbox, fluentDialog, fluentProgress } from '@fluentui/web-components';\nimport { IGraph, MgtBaseComponent, mgtHtml } from '@microsoft/mgt-element';\nimport { html, TemplateResult } from 'lit';\nimport { property } from 'lit/decorators.js';\nimport { DriveItem } from '@microsoft/microsoft-graph-types';\nimport { classMap } from 'lit/directives/class-map.js';\nimport {\n  clearFilesCache,\n  getGraphfile,\n  getUploadSession,\n  sendFileContent,\n  sendFileChunk,\n  deleteSessionFile,\n  isUploadSession\n} from '../../../graph/graph.files';\nimport { ViewType } from '../../../graph/types';\nimport { registerFluentComponents } from '../../../utils/FluentComponents';\nimport { getSvg, SvgIcon } from '../../../utils/SvgHelper';\nimport { formatBytes } from '../../../utils/Utils';\nimport { styles } from './mgt-file-upload-css';\nimport { strings } from './strings';\nimport { registerComponent } from '@microsoft/mgt-element';\nimport { registerMgtFileComponent } from '../../mgt-file/mgt-file';\n\n/**\n * Simple union type for file system entry and directory entry types\n */\ntype FileEntry = (FileSystemDirectoryEntry | FileSystemFileEntry | FileSystemEntry) & {\n  /**\n   * This is a hack to get around the fact that the FileSystemEntry filePath is not writable\n   */\n  fullPath: string;\n};\n\n/**\n * Type guard for FileSystemDirectoryEntry\n *\n * @param {FileEntry} entry\n * @return {*}  {entry is FileSystemDirectoryEntry}\n */\nconst isFileSystemDirectoryEntry = (entry: FileEntry): entry is FileSystemDirectoryEntry => {\n  return entry.isDirectory;\n};\n\n/**\n * Type guard for FileSystemDirectoryEntry\n *\n * @param {FileEntry} entry\n * @return {*}  {entry is FileSystemDirectoryEntry}\n */\nconst isFileSystemFileEntry = (entry: FileEntry): entry is FileSystemFileEntry => {\n  return entry.isFile;\n};\n\ninterface FutureDataTransferItem extends DataTransferItem {\n  /**\n   * Possible future implementation of webkitGetAsEntry\n   */\n  getAsEntry: typeof DataTransferItem.prototype.webkitGetAsEntry;\n}\n\nconst isFutureDataTransferItem = (item: DataTransferItem): item is FutureDataTransferItem =>\n  'getAsEntry' in item && typeof item.getAsEntry === 'function';\n\nconst isDataTransferItem = (item: DataTransferItem | File): item is DataTransferItem =>\n  ('getAsFile' in item && typeof item.getAsFile === 'function') ||\n  ('webkitGetAsEntry' in item && typeof item.webkitGetAsEntry === 'function');\n\nconst conflictBehaviors = ['rename', 'replace'] as const;\n/**\n * Upload conflict behavior status\n */\nexport type MgtFileUploadConflictBehavior = (typeof conflictBehaviors)[number];\n\n/**\n * MgtFileUpload upload item lifecycle object.\n *\n * @export\n * @interface MgtFileUploadItem\n */\nexport interface MgtFileUploadItem {\n  /**\n   * Session url to keep upload progress open untill all chuncks are sent\n   */\n  uploadUrl?: string;\n\n  /**\n   * Upload file progress value\n   */\n  percent?: number;\n\n  /**\n   * Validate if File has any conflict Behavior\n   */\n  conflictBehavior?: MgtFileUploadConflictBehavior;\n\n  /**\n   * Output \"Success\" or \"Fail\" icon base on upload response\n   */\n  iconStatus?: TemplateResult;\n\n  /**\n   * File object to be upload.\n   */\n  file?: File;\n\n  /**\n   * Full file Path to be upload.\n   */\n  fullPath?: string;\n\n  /**\n   * Mgt-File View state change on upload response\n   */\n  view?: ViewType;\n\n  /**\n   * Manipulate fileDetails on upload lifecycle\n   */\n  driveItem?: DriveItem;\n\n  /**\n   * Mgt-File line2Property output field message\n   */\n  fieldUploadResponse?: string;\n\n  /**\n   * Validates state of upload progress\n   */\n  completed?: boolean;\n\n  /**\n   * Load large Files into ArrayBuffer to send by chuncks\n   */\n  mimeStreamString?: ArrayBuffer;\n\n  /**\n   * Max chunck size to upload file by slice\n   */\n  maxSize?: number;\n\n  /**\n   * Minimal chunck size to upload file by slice\n   */\n  minSize?: number;\n}\n\n/**\n * MgtFileUpload configuration object with MgtFileList Properties.\n *\n * @export\n * @interface MgtFileUploadConfig\n */\nexport interface MgtFileUploadConfig {\n  /**\n   * MS Graph APIs connector\n   *\n   * @type {IGraph}\n   */\n  graph: IGraph;\n\n  /**\n   * allows developer to provide site id for a file\n   *\n   * @type {string}\n   */\n  siteId?: string;\n\n  /**\n   * DriveId to upload Files\n   *\n   * @type {string}\n   */\n  driveId?: string;\n\n  /**\n   * GroupId to upload Files\n   *\n   * @type {string}\n   */\n  groupId?: string;\n\n  /**\n   * allows developer to provide item id for a file\n   *\n   * @type {string}\n   */\n  itemId?: string;\n\n  /**\n   * allows developer to provide item path for a file\n   *\n   * @type {string}\n   */\n  itemPath?: string;\n\n  /**\n   * allows developer to provide user id for a file\n   *\n   * @type {string}\n   */\n  userId?: string;\n\n  /**\n   * A number value indication for file size upload (KB)\n   *\n   * @type {Number}\n   */\n  maxFileSize?: number;\n\n  /**\n   * A number value to indicate the number of files to upload.\n   *\n   * @type {Number}\n   */\n  maxUploadFile?: number;\n\n  /**\n   * A Array of file extensions to be excluded from file upload.\n   *\n   * @type {string[]}\n   */\n  excludedFileExtensions?: string[];\n}\n\ninterface FileWithPath extends File {\n  fullPath: string;\n}\n\nexport const registerMgtFileUploadComponent = () => {\n  registerFluentComponents(fluentProgress, fluentButton, fluentCheckbox, fluentDialog);\n\n  registerMgtFileComponent();\n  registerComponent('file-upload', MgtFileUpload);\n};\n\nconst calculateConflictBehavior = (behavior: (number | true | MgtFileUploadConflictBehavior)[]) => {\n  if (behavior?.length > 1) {\n    return behavior[1] === 'replace' ? 'replace' : 'rename';\n  }\n  return null;\n};\n\n/**\n * A component to upload files to OneDrive or SharePoint Sites\n *\n * @export\n * @class MgtFileUpload\n * @extends {MgtBaseComponent}\n *\n * @cssprop --file-upload-background-color-drag - {Color} background color of the file list when you upload by drag and drop.\n * @cssprop --file-upload-button-background-color - {Color} background color of the file upload button.\n * @cssprop --file-upload-button-background-color-hover - {Color} background color of the file upload button on hover.\n * @cssprop --file-upload-button-text-color - {Color} text color of the file upload button.\n * @cssprop --file-upload-dialog-background-color - {Color} background color of the file upload dialog box (appears when uploaded files exist).\n * @cssprop --file-upload-dialog-text-color - {Color} text color of the file upload dialog box content.\n * @cssprop --file-upload-dialog-replace-button-background-color - {Color} background color of the replace button in the dialog box.\n * @cssprop --file-upload-dialog-replace-button-background-color-hover - {Color} background color of the replace button in the dialog box when you hover on it.\n * @cssprop --file-upload-dialog-replace-button-text-color - {Color} text color of the replace button in the dialog box.\n * @cssprop --file-upload-dialog-keep-both-button-background-color - {Color} background color of the keep-both button in the dialog box.\n * @cssprop --file-upload-dialog-keep-both-button-background-color-hover - {Color} background color of the keep-both button in the dialog box when you hover on it.\n * @cssprop --file-upload-dialog-keep-both-button-text-color - {Color} text color of the keep-both button in the dialog box.\n * @cssprop --file-upload-border-drag - {String} the border of the file list when you upload files via drag and drop. Default value is 1px dashed #0078d4.\n * @cssprop --file-upload-button-border - {String} the border of the file upload button. Default value is none.\n * @cssprop --file-upload-dialog-replace-button-border - {String} the border of the file upload replace button in the dialog box. Default value is\n * @cssprop --file-upload-dialog-keep-both-button-border - {String} the border of the file upload keep both button in the dialog box. Default value is none.\n * @cssprop --file-upload-dialog-border - {String} the border of the file upload dialog box. Default value is \"1px solid var(--neutral-fill-rest)\".\n * @cssprop --file-upload-dialog-width - {String} the width of the file upload dialog box. Default value is auto.\n * @cssprop --file-upload-dialog-height - {String} the height of the file upload dialog box. Default value is auto.\n * @cssprop --file-upload-dialog-padding - {String} the padding of the file upload dialog box. Default value is 24px;\n */\nexport class MgtFileUpload extends MgtBaseComponent {\n  /**\n   * Array of styles to apply to the element. The styles should be defined\n   * using the `css` tag function.\n   */\n  static get styles() {\n    return styles;\n  }\n\n  protected get strings() {\n    return strings;\n  }\n\n  /**\n   * Allows developer to provide an array of MgtFileUploadItem to upload\n   *\n   * @type {MgtFileUploadItem[]}\n   * @memberof MgtFileUpload\n   */\n  @property({ type: Object })\n  public filesToUpload: MgtFileUploadItem[];\n\n  /**\n   * List of mgt-file-list properties used to upload files.\n   *\n   * @type {MgtFileUploadConfig}\n   * @memberof MgtFileUpload\n   */\n  @property({ type: Object })\n  public fileUploadList: MgtFileUploadConfig;\n\n  /**\n   * Get the scopes required for file upload\n   *\n   * @static\n   * @return {*}  {string[]}\n   * @memberof MgtFileUpload\n   */\n  public static get requiredScopes(): string[] {\n    return [...new Set(['files.readwrite', 'files.readwrite.all', 'sites.readwrite.all'])];\n  }\n\n  // variable manage drag style when mouse over\n  private _dragCounter = 0;\n  // variable avoids removal of files after drag and drop, https://developer.mozilla.org/en-US/docs/Web/API/DataTransfer/dropEffect\n  private get _dropEffect(): DataTransfer['dropEffect'] {\n    return 'copy';\n  }\n  // variable defined max chuck size \"4MB\" for large files .\n  private readonly _maxChunkSize: number = 4 * 1024 * 1024;\n  private _dialogTitle = '';\n  private _dialogContent = '';\n  private _dialogPrimaryButton = '';\n  private _dialogSecondaryButton = '';\n  private _dialogCheckBox = '';\n  private _applyAll = false;\n  private _applyAllConflictBehavior: number = null;\n  private _maximumFileSize = false;\n  private _excludedFileType = false;\n\n  constructor() {\n    super();\n    this.filesToUpload = [];\n  }\n\n  /**\n   * Render the file upload component\n   *\n   * @returns\n   */\n  public render(): TemplateResult {\n    if (this.parentElement !== null) {\n      const root = this.parentElement;\n      root.addEventListener('dragenter', this.handleonDragEnter);\n      root.addEventListener('dragleave', this.handleonDragLeave);\n      root.addEventListener('dragover', this.handleonDragOver);\n      root.addEventListener('drop', this.handleonDrop);\n    }\n\n    return html`\n        <div id=\"file-upload-dialog\" class=\"file-upload-dialog\">\n          <!-- Modal content -->\n          <fluent-dialog modal=\"true\" class=\"file-upload-dialog-content\">\n            <span\n              class=\"file-upload-dialog-close\"\n              id=\"file-upload-dialog-close\">\n                ${getSvg(SvgIcon.Cancel)}\n            </span>\n            <div class=\"file-upload-dialog-content-text\">\n              <h2 class=\"file-upload-dialog-title\">${this._dialogTitle}</h2>\n              <div>${this._dialogContent}</div>\n                <fluent-checkbox\n                  id=\"file-upload-dialog-check\"\n                  class=\"file-upload-dialog-check\">\n                    ${this._dialogCheckBox}\n                </fluent-checkbox>\n            </div>\n            <div class=\"file-upload-dialog-editor\">\n              <fluent-button\n                appearance=\"accent\"\n                class=\"file-upload-dialog-ok\">\n                ${this._dialogPrimaryButton}\n              </fluent-button>\n              <fluent-button\n                appearance=\"outline\"\n                class=\"file-upload-dialog-cancel\">\n                ${this._dialogSecondaryButton}\n              </fluent-button>\n            </div>\n          </fluent-dialog>\n        </div>\n        <div id=\"file-upload-border\"></div>\n        <div class=\"file-upload-area-button\">\n          <input\n            id=\"file-upload-input\"\n            title=\"${this.strings.uploadButtonLabel}\"\n            tabindex=\"-1\"\n            aria-label=\"file upload input\"\n            type=\"file\"\n            multiple\n            @change=\"${this.onFileUploadChange}\"\n          />\n          <fluent-button\n            appearance=\"accent\"\n            class=\"file-upload-button\"\n            @click=${this.onFileUploadClick}\n            label=${this.strings.uploadButtonLabel}>\n              <span slot=\"start\">${getSvg(SvgIcon.Upload)}</span>\n              <span class=\"upload-text\">${this.strings.buttonUploadFile}</span>\n          </fluent-button>\n        </div>\n        <div class=\"file-upload-template\">\n          ${this.renderFolderTemplate(this.filesToUpload)}\n        </div>\n       `;\n  }\n\n  /**\n   * Render Folder structure of files to upload\n   *\n   * @param fileItems\n   * @returns\n   */\n  protected renderFolderTemplate(fileItems: MgtFileUploadItem[]) {\n    const folderStructure: string[] = [];\n    if (fileItems.length > 0) {\n      const templateFileItems = fileItems.map(fileItem => {\n        if (folderStructure.indexOf(fileItem.fullPath.substring(0, fileItem.fullPath.lastIndexOf('/'))) === -1) {\n          if (!fileItem.fullPath.endsWith('/')) {\n            folderStructure.push(fileItem.fullPath.substring(0, fileItem.fullPath.lastIndexOf('/')));\n            return mgtHtml`\n            <div class='file-upload-table'>\n              <div class='file-upload-cell'>\n                <mgt-file\n                  .fileDetails=${{\n                    name: fileItem.fullPath.substring(1, fileItem.fullPath.lastIndexOf('/')),\n                    folder: 'Folder'\n                  }}\n                  view=\"oneline\"\n                  class=\"mgt-file-item\">\n                </mgt-file>\n              </div>\n            </div>\n            ${this.renderFileTemplate(fileItem, 'file-upload-folder-tab')}`;\n          } else {\n            return html`${this.renderFileTemplate(fileItem, '')}`;\n          }\n        } else {\n          return html`${this.renderFileTemplate(fileItem, 'file-upload-folder-tab')}`;\n        }\n      });\n      return html`${templateFileItems}`;\n    }\n    return html``;\n  }\n\n  /**\n   * Render file upload area\n   *\n   * @param fileItem\n   * @returns\n   */\n  protected renderFileTemplate(fileItem: MgtFileUploadItem, folderTabStyle: string) {\n    const completed = classMap({\n      'file-upload-table': true,\n      upload: fileItem.completed\n    });\n    const folder =\n      folderTabStyle + (fileItem.fieldUploadResponse === 'lastModifiedDateTime' ? ' file-upload-dialog-success' : '');\n\n    const description = classMap({\n      description: fileItem.fieldUploadResponse === 'description'\n    });\n\n    const completedTemplate = !fileItem.completed ? this.renderFileUploadTemplate(fileItem) : html``;\n\n    return mgtHtml`\n        <div class=\"${completed}\">\n          <div class=\"${folder}\">\n            <div class='file-upload-cell'>\n              <div class=\"${description}\">\n                <div class=\"file-upload-status\">\n                  ${fileItem.iconStatus}\n                </div>\n                <mgt-file\n                  .fileDetails=${fileItem.driveItem}\n                  .view=${fileItem.view}\n                  .line2Property=${fileItem.fieldUploadResponse}\n                  part=\"upload\"\n                  class=\"mgt-file-item\">\n                </mgt-file>\n              </div>\n            </div>\n              ${completedTemplate}\n            </div>\n          </div>\n        </div>`;\n  }\n\n  /**\n   * Render file upload progress\n   *\n   * @param fileItem\n   * @returns\n   */\n  protected renderFileUploadTemplate(fileItem: MgtFileUploadItem) {\n    const completed = classMap({\n      'file-upload-table': true,\n      upload: fileItem.completed\n    });\n    return html`\n    <div class='file-upload-cell'>\n      <div class='file-upload-table file-upload-name'>\n        <div class='file-upload-cell'>\n          <div\n            title=\"${fileItem.file.name}\"\n            class='file-upload-filename'>\n            ${fileItem.file.name}\n          </div>\n        </div>\n      </div>\n      <div class='file-upload-table'>\n        <div class='file-upload-cell'>\n          <div class=\"${completed}\">\n            <fluent-progress class=\"file-upload-bar\" value=\"${fileItem.percent}\"></fluent-progress>\n            <div class='file-upload-cell percent-indicator'>\n              <span>${fileItem.percent}%</span>\n              <span\n                class=\"file-upload-cancel\"\n                @click=${() => this.deleteFileUploadSession(fileItem)}>\n                ${getSvg(SvgIcon.Cancel)}\n              </span>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    `;\n  }\n\n  /**\n   * Handle the \"Upload Files\" button click event to open dialog and select files.\n   *\n   * @param event\n   * @returns\n   */\n  protected onFileUploadChange = (event: UIEvent) => {\n    const inputElement = event.target as HTMLInputElement;\n    if (!event || inputElement.files.length < 1) {\n      return;\n    } else {\n      void this.readUploadedFiles(inputElement.files, () => (inputElement.value = null));\n    }\n  };\n\n  /**\n   * Handle the click event on upload file button that open select files dialog to upload.\n   *\n   */\n  protected onFileUploadClick = () => {\n    const uploadInput: HTMLElement = this.renderRoot.querySelector('#file-upload-input');\n    uploadInput.click();\n  };\n\n  /**\n   * Function delete existing file upload sessions\n   *\n   * @param fileItem\n   */\n  protected async deleteFileUploadSession(fileItem: MgtFileUploadItem) {\n    try {\n      if (fileItem.uploadUrl !== undefined) {\n        // Responses that confirm cancelation of session.\n        // 404 means (The upload session was not found/The resource could not be found/)\n        // 409 means The resource has changed since the caller last read it; usually an eTag mismatch\n        await deleteSessionFile(this.fileUploadList.graph, fileItem.uploadUrl);\n        fileItem.uploadUrl = undefined;\n        fileItem.completed = true;\n        this.setUploadFail(fileItem, strings.cancelUploadFile);\n      } else {\n        fileItem.uploadUrl = undefined;\n        fileItem.completed = true;\n        this.setUploadFail(fileItem, strings.cancelUploadFile);\n      }\n    } catch {\n      fileItem.uploadUrl = undefined;\n      fileItem.completed = true;\n      this.setUploadFail(fileItem, strings.cancelUploadFile);\n    }\n  }\n\n  /**\n   * Stop listeners from onDragOver event.\n   *\n   * @param event\n   */\n  protected handleonDragOver = (event: DragEvent) => {\n    event.preventDefault();\n    event.stopPropagation();\n    if (event.dataTransfer.items && event.dataTransfer.items.length > 0) {\n      event.dataTransfer.dropEffect = event.dataTransfer.dropEffect = this._dropEffect;\n    }\n  };\n\n  /**\n   * Stop listeners from onDragEnter event, enable drag and drop view.\n   *\n   * @param event\n   */\n  protected handleonDragEnter = (event: DragEvent) => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    this._dragCounter++;\n    if (event.dataTransfer.items && event.dataTransfer.items.length > 0) {\n      event.dataTransfer.dropEffect = this._dropEffect;\n      const dragFileBorder: HTMLElement = this.renderRoot.querySelector('#file-upload-border');\n      dragFileBorder.classList.add('visible');\n    }\n  };\n\n  /**\n   * Stop listeners from ondragenter event, disable drag and drop view.\n   *\n   * @param event\n   */\n  protected handleonDragLeave = (event: DragEvent) => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    this._dragCounter--;\n    if (this._dragCounter === 0) {\n      const dragFileBorder: HTMLElement = this.renderRoot.querySelector('#file-upload-border');\n      dragFileBorder.classList.remove('visible');\n    }\n  };\n\n  /**\n   * Stop listeners from onDrop event and process files.\n   *\n   * @param event\n   */\n  protected handleonDrop = (event: DragEvent) => {\n    event.preventDefault();\n    event.stopPropagation();\n    const done = (): void => {\n      event.dataTransfer.clearData();\n    };\n    const dragFileBorder: HTMLElement = this.renderRoot.querySelector('#file-upload-border');\n    dragFileBorder.classList.remove('visible');\n    if (event.dataTransfer?.items) {\n      void this.readUploadedFiles(event.dataTransfer.items, done);\n    }\n    this._dragCounter = 0;\n  };\n\n  private async readUploadedFiles(uploaded: DataTransferItemList | FileList, onCompleteCallback: () => void) {\n    const files = await this.getFilesFromUploadArea(uploaded);\n    await this.getSelectedFiles(files);\n    onCompleteCallback();\n  }\n\n  /**\n   * Get Files and initalize MgtFileUploadItem object life cycle to be uploaded\n   *\n   * @param inputFiles\n   */\n  protected async getSelectedFiles(files: File[]) {\n    let fileItems: MgtFileUploadItem[] = [];\n    const fileItemsCompleted: MgtFileUploadItem[] = [];\n    this._applyAll = false;\n    this._applyAllConflictBehavior = null;\n    this._maximumFileSize = false;\n    this._excludedFileType = false;\n\n    // Collect ongoing upload files\n    this.filesToUpload.forEach(fileItem => {\n      if (!fileItem.completed) {\n        fileItems.push(fileItem);\n      } else {\n        fileItemsCompleted.push(fileItem);\n      }\n    });\n\n    for (const file of files as FileWithPath[]) {\n      const fullPath = file.fullPath === '' ? '/' + file.name : file.fullPath;\n      if (fileItems.filter(item => item.fullPath === fullPath).length === 0) {\n        // Initialize variable for File validation\n        let acceptFile = true;\n\n        // Exclude file based on max file size allowed\n        if (this.fileUploadList.maxFileSize !== undefined && acceptFile) {\n          if (file.size > this.fileUploadList.maxFileSize * 1024) {\n            acceptFile = false;\n            if (this._maximumFileSize === false) {\n              const maximumFileSize: (number | true | string)[] = await this.getFileUploadStatus(\n                file,\n                fullPath,\n                'MaxFileSize',\n                this.fileUploadList\n              );\n              if (maximumFileSize !== null) {\n                if (maximumFileSize[0] === 1) {\n                  this._maximumFileSize = true;\n                }\n              }\n            }\n          }\n        }\n\n        // Exclude file based on File extensions\n        if (this.fileUploadList.excludedFileExtensions !== undefined) {\n          if (this.fileUploadList.excludedFileExtensions.length > 0 && acceptFile) {\n            if (\n              this.fileUploadList.excludedFileExtensions.filter(fileExtension => {\n                return file.name.toLowerCase().indexOf(fileExtension.toLowerCase()) > -1;\n              }).length > 0\n            ) {\n              acceptFile = false;\n              if (this._excludedFileType === false) {\n                const excludedFileType: (number | true | string)[] = await this.getFileUploadStatus(\n                  file,\n                  fullPath,\n                  'ExcludedFileType',\n                  this.fileUploadList\n                );\n                if (excludedFileType !== null) {\n                  if (excludedFileType[0] === 1) {\n                    this._excludedFileType = true;\n                  }\n                }\n              }\n            }\n          }\n        }\n\n        // Collect accepted files\n        if (acceptFile) {\n          const conflictBehavior: (number | true | MgtFileUploadConflictBehavior)[] = await this.getFileUploadStatus(\n            file,\n            fullPath,\n            'Upload',\n            this.fileUploadList\n          );\n          let completed = false;\n          if (conflictBehavior !== null) {\n            if (conflictBehavior[0] === -1) {\n              completed = true;\n            } else {\n              this._applyAll = Boolean(conflictBehavior[0]);\n              this._applyAllConflictBehavior = conflictBehavior[1] ? 1 : 0;\n            }\n          }\n\n          // Initialize MgtFileUploadItem Life cycle\n          fileItems.push({\n            file,\n            driveItem: {\n              name: file.name\n            },\n            fullPath,\n            conflictBehavior: calculateConflictBehavior(conflictBehavior),\n            iconStatus: null,\n            percent: 1,\n            view: 'image',\n            completed,\n            maxSize: this._maxChunkSize,\n            minSize: 0\n          });\n        }\n      }\n    }\n    fileItems = fileItems.sort((firstFile, secondFile) => {\n      return firstFile.fullPath\n        .substring(0, firstFile.fullPath.lastIndexOf('/'))\n        .localeCompare(secondFile.fullPath.substring(0, secondFile.fullPath.lastIndexOf('/')));\n    });\n    // remove completed file report image to be reuploaded.\n    fileItems.forEach(fileItem => {\n      if (fileItemsCompleted.filter(item => item.fullPath === fileItem.fullPath).length !== 0) {\n        const index = fileItemsCompleted.findIndex(item => item.fullPath === fileItem.fullPath);\n        fileItemsCompleted.splice(index, 1);\n      }\n    });\n    fileItems.push(...fileItemsCompleted);\n    this.filesToUpload = fileItems;\n    // Send multiple Files to upload\n    const promises = this.filesToUpload.map(fileItem => this.sendFileItemGraph(fileItem));\n    await Promise.all(promises);\n  }\n\n  /**\n   * Call modal dialog to replace or keep file.\n   *\n   * @param file\n   * @returns\n   */\n  protected async getFileUploadStatus(\n    file: File,\n    fullPath: string,\n    DialogStatus: string,\n    fileUploadList: MgtFileUploadConfig\n  ): Promise<(number | true | MgtFileUploadConflictBehavior)[]> {\n    const fileUploadDialog: HTMLElement = this.renderRoot.querySelector('#file-upload-dialog');\n\n    switch (DialogStatus) {\n      case 'Upload': {\n        const driveItem = await getGraphfile(this.fileUploadList.graph, `${this.getGrapQuery(fullPath)}?$select=id`);\n        if (driveItem !== null) {\n          if (this._applyAll === true) {\n            return [this._applyAll, this._applyAllConflictBehavior];\n          }\n          fileUploadDialog.classList.add('visible');\n          this._dialogTitle = strings.fileReplaceTitle;\n          this._dialogContent = strings.fileReplace.replace('{FileName}', file.name);\n          this._dialogCheckBox = strings.checkApplyAll;\n          this._dialogPrimaryButton = strings.buttonReplace;\n          this._dialogSecondaryButton = strings.buttonKeep;\n          await super.requestStateUpdate(true);\n\n          return new Promise<(number | MgtFileUploadConflictBehavior)[]>(resolve => {\n            const fileUploadDialogClose: HTMLElement = this.renderRoot.querySelector('.file-upload-dialog-close');\n            const fileUploadDialogOk: HTMLElement = this.renderRoot.querySelector('.file-upload-dialog-ok');\n            const fileUploadDialogCancel: HTMLElement = this.renderRoot.querySelector('.file-upload-dialog-cancel');\n            const fileUploadDialogCheck: HTMLInputElement = this.renderRoot.querySelector('#file-upload-dialog-check');\n            fileUploadDialogCheck.checked = false;\n            fileUploadDialogCheck.classList.remove('hide');\n\n            // Replace File\n            const onOkDialogClick = () => {\n              fileUploadDialog.classList.remove('visible');\n              resolve([fileUploadDialogCheck.checked ? 1 : 0, 'replace']);\n            };\n\n            // Rename File\n            const onCancelDialogClick = () => {\n              fileUploadDialog.classList.remove('visible');\n              resolve([fileUploadDialogCheck.checked ? 1 : 0, 'rename']);\n            };\n\n            // Cancel File\n            const onCloseDialogClick = () => {\n              fileUploadDialog.classList.remove('visible');\n              resolve([-1]);\n            };\n\n            // Remove and include event listener to validate options.\n            fileUploadDialogOk.removeEventListener('click', onOkDialogClick);\n            fileUploadDialogCancel.removeEventListener('click', onCancelDialogClick);\n            fileUploadDialogClose.removeEventListener('click', onCloseDialogClick);\n            fileUploadDialogOk.addEventListener('click', onOkDialogClick);\n            fileUploadDialogCancel.addEventListener('click', onCancelDialogClick);\n            fileUploadDialogClose.addEventListener('click', onCloseDialogClick);\n          });\n        } else {\n          return null;\n        }\n        break;\n      }\n      case 'ExcludedFileType':\n        fileUploadDialog.classList.add('visible');\n        this._dialogTitle = strings.fileTypeTitle;\n        this._dialogContent =\n          strings.fileType.replace('{FileName}', file.name) +\n          ' (' +\n          fileUploadList.excludedFileExtensions.join(',') +\n          ')';\n        this._dialogCheckBox = strings.checkAgain;\n        this._dialogPrimaryButton = strings.buttonOk;\n        this._dialogSecondaryButton = strings.buttonCancel;\n        await super.requestStateUpdate(true);\n\n        return new Promise<number[]>(resolve => {\n          const fileUploadDialogOk: HTMLElement = this.renderRoot.querySelector('.file-upload-dialog-ok');\n          const fileUploadDialogCancel: HTMLElement = this.renderRoot.querySelector('.file-upload-dialog-cancel');\n          const fileUploadDialogClose: HTMLElement = this.renderRoot.querySelector('.file-upload-dialog-close');\n          const fileUploadDialogCheck: HTMLInputElement = this.renderRoot.querySelector('#file-upload-dialog-check');\n          fileUploadDialogCheck.checked = false;\n          fileUploadDialogCheck.classList.remove('hide');\n\n          const onOkDialogClick = () => {\n            fileUploadDialog.classList.remove('visible');\n            // Confirm info\n            resolve([fileUploadDialogCheck.checked ? 1 : 0]);\n          };\n\n          const onCancelDialogClick = () => {\n            fileUploadDialog.classList.remove('visible');\n            // Cancel all\n            resolve([0]);\n          };\n\n          // Remove and include event listener to validate options.\n          fileUploadDialogOk.removeEventListener('click', onOkDialogClick);\n          fileUploadDialogCancel.removeEventListener('click', onCancelDialogClick);\n          fileUploadDialogClose.removeEventListener('click', onCancelDialogClick);\n          fileUploadDialogOk.addEventListener('click', onOkDialogClick);\n          fileUploadDialogCancel.addEventListener('click', onCancelDialogClick);\n          fileUploadDialogClose.addEventListener('click', onCancelDialogClick);\n        });\n      case 'MaxFileSize':\n        fileUploadDialog.classList.add('visible');\n        this._dialogTitle = strings.maximumFileSizeTitle;\n        this._dialogContent =\n          strings.maximumFileSize\n            .replace('{FileSize}', formatBytes(fileUploadList.maxFileSize * 1024))\n            .replace('{FileName}', file.name) +\n          formatBytes(file.size) +\n          '.';\n        this._dialogCheckBox = strings.checkAgain;\n        this._dialogPrimaryButton = strings.buttonOk;\n        this._dialogSecondaryButton = strings.buttonCancel;\n        await super.requestStateUpdate(true);\n\n        return new Promise<number[]>(resolve => {\n          const fileUploadDialogOk: HTMLElement = this.renderRoot.querySelector('.file-upload-dialog-ok');\n          const fileUploadDialogCancel: HTMLElement = this.renderRoot.querySelector('.file-upload-dialog-cancel');\n          const fileUploadDialogClose: HTMLElement = this.renderRoot.querySelector('.file-upload-dialog-close');\n          const fileUploadDialogCheck: HTMLInputElement = this.renderRoot.querySelector('#file-upload-dialog-check');\n          fileUploadDialogCheck.checked = false;\n          fileUploadDialogCheck.classList.remove('hide');\n\n          const onOkDialogClick = () => {\n            fileUploadDialog.classList.remove('visible');\n            // Confirm info\n            resolve([fileUploadDialogCheck.checked ? 1 : 0]);\n          };\n\n          const onCancelDialogClick = () => {\n            fileUploadDialog.classList.remove('visible');\n            // Cancel all\n            resolve([0]);\n          };\n          // Remove and include event listener to validate options.\n          fileUploadDialogOk.removeEventListener('click', onOkDialogClick);\n          fileUploadDialogCancel.removeEventListener('click', onCancelDialogClick);\n          fileUploadDialogClose.removeEventListener('click', onCancelDialogClick);\n          fileUploadDialogOk.addEventListener('click', onOkDialogClick);\n          fileUploadDialogCancel.addEventListener('click', onCancelDialogClick);\n          fileUploadDialogClose.addEventListener('click', onCancelDialogClick);\n        });\n\n      default:\n        break;\n    }\n  }\n\n  /**\n   * Get GraphQuery based on pre defined parameters.\n   *\n   * @param fileItem\n   * @returns\n   */\n  protected getGrapQuery(fullPath: string) {\n    let itemPath = '';\n    if (this.fileUploadList.itemPath) {\n      if (this.fileUploadList.itemPath.length > 0) {\n        itemPath = this.fileUploadList.itemPath.startsWith('/')\n          ? this.fileUploadList.itemPath\n          : '/' + this.fileUploadList.itemPath;\n      }\n    }\n\n    // {userId} {itemId}\n    if (this.fileUploadList.userId && this.fileUploadList.itemId) {\n      return `/users/${this.fileUploadList.userId}/drive/items/${this.fileUploadList.itemId}:${fullPath}`;\n    }\n    // {userId} {itemPath}\n    if (this.fileUploadList.userId && this.fileUploadList.itemPath) {\n      return `/users/${this.fileUploadList.userId}/drive/root:${itemPath}${fullPath}`;\n    }\n    // {groupId} {itemId}\n    if (this.fileUploadList.groupId && this.fileUploadList.itemId) {\n      return `/groups/${this.fileUploadList.groupId}/drive/items/${this.fileUploadList.itemId}:${fullPath}`;\n    }\n    // {groupId} {itemPath}\n    if (this.fileUploadList.groupId && this.fileUploadList.itemPath) {\n      return `/groups/${this.fileUploadList.groupId}/drive/root:${itemPath}${fullPath}`;\n    }\n    // {driveId} {itemId}\n    if (this.fileUploadList.driveId && this.fileUploadList.itemId) {\n      return `/drives/${this.fileUploadList.driveId}/items/${this.fileUploadList.itemId}:${fullPath}`;\n    }\n    // {driveId} {itemPath}\n    if (this.fileUploadList.driveId && this.fileUploadList.itemPath) {\n      return `/drives/${this.fileUploadList.driveId}/root:${itemPath}${fullPath}`;\n    }\n    // {siteId} {itemId}\n    if (this.fileUploadList.siteId && this.fileUploadList.itemId) {\n      return `/sites/${this.fileUploadList.siteId}/drive/items/${this.fileUploadList.itemId}:${fullPath}`;\n    }\n    // {siteId} {itemPath}\n    if (this.fileUploadList.siteId && this.fileUploadList.itemPath) {\n      return `/sites/${this.fileUploadList.siteId}/drive/root:${itemPath}${fullPath}`;\n    }\n    // default OneDrive {itemId}\n    if (this.fileUploadList.itemId) {\n      return `/me/drive/items/${this.fileUploadList.itemId}:${fullPath}`;\n    }\n    // default OneDrive {itemPath}\n    if (this.fileUploadList.itemPath) {\n      return `/me/drive/root:${itemPath}${fullPath}`;\n    }\n    // default OneDrive root\n    return `/me/drive/root:${fullPath}`;\n  }\n\n  /**\n   * Send file using Upload using Graph based on length\n   *\n   * @param fileUpload\n   * @returns\n   */\n  protected async sendFileItemGraph(fileItem: MgtFileUploadItem) {\n    const graph: IGraph = this.fileUploadList.graph;\n    let graphQuery = '';\n    if (fileItem.file.size < this._maxChunkSize) {\n      try {\n        if (!fileItem.completed) {\n          if (fileItem.conflictBehavior === null || fileItem.conflictBehavior === 'replace') {\n            graphQuery = `${this.getGrapQuery(fileItem.fullPath)}:/content`;\n          }\n          if (fileItem.conflictBehavior === 'rename') {\n            graphQuery = `${this.getGrapQuery(fileItem.fullPath)}:/content?@microsoft.graph.conflictBehavior=rename`;\n          }\n          fileItem.driveItem = await sendFileContent(graph, graphQuery, fileItem.file);\n          if (fileItem.driveItem !== null) {\n            this.setUploadSuccess(fileItem);\n          } else {\n            fileItem.driveItem = {\n              name: fileItem.file.name\n            };\n            this.setUploadFail(fileItem, strings.failUploadFile);\n          }\n        }\n      } catch (error) {\n        this.setUploadFail(fileItem, strings.failUploadFile);\n      }\n    } else {\n      if (!fileItem.completed) {\n        if (fileItem.uploadUrl === undefined) {\n          const response = await getUploadSession(\n            graph,\n            `${this.getGrapQuery(fileItem.fullPath)}:/createUploadSession`,\n            fileItem.conflictBehavior\n          );\n          try {\n            if (response !== null) {\n              // uploadSession url used to send chunks of file\n              fileItem.uploadUrl = response.uploadUrl;\n              const driveItem = await this.sendSessionUrlGraph(graph, fileItem);\n              if (driveItem !== null) {\n                fileItem.driveItem = driveItem;\n                this.setUploadSuccess(fileItem);\n              } else {\n                this.setUploadFail(fileItem, strings.failUploadFile);\n              }\n            } else {\n              this.setUploadFail(fileItem, strings.failUploadFile);\n            }\n            // eslint-disable-next-line no-empty\n          } catch {}\n        }\n      }\n    }\n  }\n\n  /**\n   * Manage slices of File to upload file by chunks using Graph and Session Url\n   *\n   * @param Graph\n   * @param fileItem\n   * @returns\n   */\n  protected async sendSessionUrlGraph(graph: IGraph, fileItem: MgtFileUploadItem) {\n    while (fileItem.file.size > fileItem.minSize) {\n      if (fileItem.mimeStreamString === undefined) {\n        fileItem.mimeStreamString = (await this.readFileContent(fileItem.file)) as ArrayBuffer;\n      }\n      // Graph client API uses Buffer package to manage ArrayBuffer, change to Blob avoids external package dependency\n      const fileSlice: Blob = new Blob([fileItem.mimeStreamString.slice(fileItem.minSize, fileItem.maxSize)]);\n      fileItem.percent = Math.round((fileItem.maxSize / fileItem.file.size) * 100);\n      await super.requestStateUpdate(true);\n\n      if (fileItem.uploadUrl !== undefined) {\n        const response = await sendFileChunk(\n          graph,\n          fileItem.uploadUrl,\n          `${fileItem.maxSize - fileItem.minSize}`,\n          `bytes ${fileItem.minSize}-${fileItem.maxSize - 1}/${fileItem.file.size}`,\n          fileSlice\n        );\n        if (response === null) {\n          return null;\n        } else if (isUploadSession(response)) {\n          // Define next Chunk\n          fileItem.minSize = parseInt(response.nextExpectedRanges[0].split('-')[0], 10);\n          fileItem.maxSize = fileItem.minSize + this._maxChunkSize;\n          if (fileItem.maxSize > fileItem.file.size) {\n            fileItem.maxSize = fileItem.file.size;\n          }\n        } else if (response.id !== undefined) {\n          return response;\n        }\n      } else {\n        return null;\n      }\n    }\n  }\n\n  /**\n   * Change the state of Mgt-File icon upload to Success\n   *\n   * @param fileUpload\n   */\n  protected setUploadSuccess(fileUpload: MgtFileUploadItem) {\n    fileUpload.percent = 100;\n    void super.requestStateUpdate(true);\n    setTimeout(() => {\n      fileUpload.iconStatus = getSvg(SvgIcon.Success);\n      fileUpload.view = 'twolines';\n      fileUpload.fieldUploadResponse = 'lastModifiedDateTime';\n      fileUpload.completed = true;\n      void super.requestStateUpdate(true);\n      void clearFilesCache();\n    }, 500);\n  }\n\n  /**\n   * Change the state of Mgt-File icon upload to Fail\n   *\n   * @param fileUpload\n   */\n  protected setUploadFail(fileUpload: MgtFileUploadItem, errorMessage: string) {\n    setTimeout(() => {\n      fileUpload.iconStatus = getSvg(SvgIcon.Fail);\n      fileUpload.view = 'twolines';\n      fileUpload.driveItem.description = errorMessage;\n      fileUpload.fieldUploadResponse = 'description';\n      fileUpload.completed = true;\n      void super.requestStateUpdate(true);\n    }, 500);\n  }\n\n  /**\n   * Retrieve File content as ArrayBuffer\n   *\n   * @param file\n   * @returns\n   */\n  protected readFileContent(file: File): Promise<string | ArrayBuffer> {\n    return new Promise<string | ArrayBuffer>((resolve, reject) => {\n      const myReader: FileReader = new FileReader();\n\n      myReader.onloadend = () => {\n        resolve(myReader.result);\n      };\n\n      myReader.onerror = e => {\n        reject(e);\n      };\n\n      myReader.readAsArrayBuffer(file);\n    });\n  }\n\n  /**\n   * Collect Files from Upload Area based on maxUploadFile\n   *\n   * @param uploadFilesItems\n   * @returns\n   */\n  protected async getFilesFromUploadArea(filesItems: DataTransferItemList | FileList): Promise<File[]> {\n    const folders: FileSystemDirectoryEntry[] = [];\n    let entry: FileSystemEntry;\n    const collectFilesItems: File[] = [];\n\n    for (const uploadFileItem of filesItems) {\n      if (isDataTransferItem(uploadFileItem)) {\n        if (isFutureDataTransferItem(uploadFileItem)) {\n          entry = uploadFileItem.getAsEntry();\n          if (isFileSystemDirectoryEntry(entry)) {\n            folders.push(entry);\n          } else {\n            const file = uploadFileItem.getAsFile();\n            if (file) {\n              this.writeFilePath(file, '');\n              collectFilesItems.push(file);\n            }\n          }\n        } else if (uploadFileItem.webkitGetAsEntry) {\n          entry = uploadFileItem.webkitGetAsEntry();\n          if (isFileSystemDirectoryEntry(entry)) {\n            folders.push(entry);\n          } else {\n            const file = uploadFileItem.getAsFile();\n            if (file) {\n              this.writeFilePath(file, '');\n              collectFilesItems.push(file);\n            }\n          }\n        } else {\n          const file = uploadFileItem.getAsFile();\n          if (file) {\n            this.writeFilePath(file, '');\n            collectFilesItems.push(file);\n          }\n        }\n      } else {\n        this.writeFilePath(uploadFileItem, '');\n        collectFilesItems.push(uploadFileItem);\n      }\n    }\n\n    // Collect Files from folder\n    if (folders.length > 0) {\n      const folderFiles = await this.getFolderFiles(folders);\n      collectFilesItems.push(...folderFiles);\n    }\n    return collectFilesItems;\n  }\n\n  /**\n   * Retrieve files from folder and subfolders to array.\n   *\n   * @param folders\n   * @returns\n   */\n  protected getFolderFiles(folders: FileSystemDirectoryEntry[]) {\n    return new Promise<File[]>(resolve => {\n      let reading = 0;\n      const contents: File[] = [];\n      folders.forEach(entry => {\n        readEntry(entry, '');\n      });\n\n      const readEntry = (entry: FileEntry, path: string) => {\n        if (isFileSystemDirectoryEntry(entry)) {\n          readReaderContent(entry.createReader());\n        } else if (isFileSystemFileEntry(entry)) {\n          reading++;\n          entry.file(file => {\n            reading--;\n            // Include Folder path where File is located\n            this.writeFilePath(file, path);\n            contents.push(file);\n\n            if (reading === 0) {\n              resolve(contents);\n            }\n          });\n        }\n      };\n\n      const readReaderContent = (reader: FileSystemDirectoryReader) => {\n        reading++;\n\n        reader.readEntries(entries => {\n          reading--;\n          for (const entry of entries) {\n            readEntry(entry, entry.fullPath);\n          }\n\n          if (reading === 0) {\n            resolve(contents);\n          }\n        });\n      };\n    });\n  }\n  private writeFilePath(file: File | FileSystemEntry, path: string) {\n    (file as unknown as FileEntry).fullPath = path;\n  }\n}\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport {\n  GraphPageIterator,\n  Providers,\n  ProviderState,\n  mgtHtml,\n  MgtTemplatedTaskComponent\n} from '@microsoft/mgt-element';\nimport { DriveItem } from '@microsoft/microsoft-graph-types';\nimport { html, TemplateResult } from 'lit';\nimport { property, state } from 'lit/decorators.js';\nimport { repeat } from 'lit/directives/repeat.js';\nimport {\n  clearFilesCache,\n  fetchNextAndCacheForFilesPageIterator,\n  getDriveFilesByIdIterator,\n  getDriveFilesByPathIterator,\n  getFilesByIdIterator,\n  getFilesByListQueryIterator,\n  getFilesByPathIterator,\n  getFilesByQueries,\n  getFilesIterator,\n  getGroupFilesByIdIterator,\n  getGroupFilesByPathIterator,\n  getMyInsightsFiles,\n  getSiteFilesByIdIterator,\n  getSiteFilesByPathIterator,\n  getUserFilesByIdIterator,\n  getUserFilesByPathIterator,\n  getUserInsightsFiles\n} from '../../graph/graph.files';\nimport './mgt-file-upload/mgt-file-upload';\nimport { getSvg, SvgIcon } from '../../utils/SvgHelper';\nimport { OfficeGraphInsightString, ViewType, viewTypeConverter } from '../../graph/types';\nimport { styles } from './mgt-file-list-css';\nimport { strings } from './strings';\nimport { MgtFile, registerMgtFileComponent } from '../mgt-file/mgt-file';\nimport { MgtFileUploadConfig, registerMgtFileUploadComponent } from './mgt-file-upload/mgt-file-upload';\n\nimport { fluentProgressRing } from '@fluentui/web-components';\nimport { registerFluentComponents } from '../../utils/FluentComponents';\nimport { CardSection } from '../BasePersonCardSection';\nimport { registerComponent } from '@microsoft/mgt-element';\n\nexport const registerMgtFileListComponent = () => {\n  registerFluentComponents(fluentProgressRing);\n\n  registerMgtFileComponent();\n  registerMgtFileUploadComponent();\n  registerComponent('file-list', MgtFileList);\n};\n\n/**\n * The File List component displays a list of multiple folders and files by\n * using the file/folder name, an icon, and other properties specified by the developer.\n * This component uses the mgt-file component.\n *\n * @export\n * @class MgtFileList\n *\n * @fires {CustomEvent<MicrosoftGraph.DriveItem>} itemClick - Fired when a user clicks on a file.\n * it returns the file (DriveItem) details.\n *\n * NOTE: This component also allows customizing the tokens from mgt-file and mgt-file-upload components.\n * @cssprop --file-list-background-color - {Color} the background color of the component.\n * @cssprop --file-list-box-shadow - {String} the box-shadow syle of the component. Default value is --elevation-shadow-card-rest.\n * @cssprop --file-list-border-radius - {Length} the file list box border radius. Default value is 8px.\n * @cssprop --file-list-border - {String} the file list border style. Default value is none.\n * @cssprop --file-list-padding -{String} the file list padding.  Default value is 0px.\n * @cssprop --file-list-margin -{String} the file list margin. Default value is 0px.\n * @cssprop --show-more-button-background-color - {Color} the \"show more\" button background color.\n * @cssprop --show-more-button-background-color--hover - {Color} the \"show more\" button background color on hover.\n * @cssprop --show-more-button-font-size - {String} the \"show more\" text font size. Default value is 12px.\n * @cssprop --show-more-button-padding - {String} the \"show more\" button padding. Default value is 0px.\n * @cssprop --show-more-button-border-bottom-right-radius - {String} the \"show more\" button bottom right border radius. Default value is 8px.\n * @cssprop --show-more-button-border-bottom-left-radius - {String} the \"show more\" button bottom left border radius. Default value is 8px;\n * @cssprop --progress-ring-size -{String} Progress ring height and width. Default value is 24px.\n */\nexport class MgtFileList extends MgtTemplatedTaskComponent implements CardSection {\n  @state() private _isCompact = false;\n  /**\n   * Array of styles to apply to the element. The styles should be defined\n   * using the `css` tag function.\n   */\n  static get styles() {\n    return styles;\n  }\n\n  protected get strings(): Record<string, string> {\n    return strings;\n  }\n\n  /**\n   * allows developer to provide query for a file list\n   *\n   * @type {string}\n   * @memberof MgtFileList\n   */\n  @property({\n    attribute: 'file-list-query'\n  })\n  public fileListQuery: string;\n\n  /**\n   * The name for display in the overview section.\n   *\n   * @readonly\n   * @type {string}\n   * @memberof MgtFileList\n   */\n  public get displayName(): string {\n    return this.strings.filesSectionTitle;\n  }\n\n  /**\n   * The title for the card when rendered as a card full.\n   *\n   * @readonly\n   * @type {string}\n   * @memberof MgtFileList\n   */\n  public get cardTitle(): string {\n    return this.strings.filesSectionTitle;\n  }\n\n  /**\n   * Render the icon for display in the navigation ribbon.\n   *\n   * @returns {TemplateResult}\n   * @memberof MgtFileList\n   */\n  public renderIcon(): TemplateResult {\n    return getSvg(SvgIcon.Files);\n  }\n\n  /**\n   * allows developer to provide an array of file queries\n   *\n   * @type {string[]}\n   * @memberof MgtFileList\n   */\n  @property({\n    attribute: 'file-queries',\n    converter: (value, _type) => {\n      if (value) {\n        return value.split(',').map(v => v.trim());\n      } else {\n        return null;\n      }\n    }\n  })\n  public fileQueries: string[] | null = null;\n\n  /**\n   * allows developer to provide an array of files\n   *\n   * @type {MicrosoftGraph.DriveItem[]}\n   * @memberof MgtFileList\n   */\n  @property({ type: Object })\n  public files: DriveItem[] | null = null;\n\n  /**\n   * allows developer to provide site id for a file\n   *\n   * @type {string}\n   * @memberof MgtFileList\n   */\n  @property({\n    attribute: 'site-id'\n  })\n  public siteId: string;\n\n  /**\n   * allows developer to provide drive id for a file\n   *\n   * @type {string}\n   * @memberof MgtFileList\n   */\n  @property({\n    attribute: 'drive-id'\n  })\n  public driveId: string;\n\n  /**\n   * allows developer to provide group id for a file\n   *\n   * @type {string}\n   * @memberof MgtFileList\n   */\n  @property({\n    attribute: 'group-id'\n  })\n  public groupId: string;\n\n  /**\n   * allows developer to provide item id for a file\n   *\n   * @type {string}\n   * @memberof MgtFileList\n   */\n  @property({\n    attribute: 'item-id'\n  })\n  public itemId: string;\n\n  /**\n   * allows developer to provide item path for a file\n   *\n   * @type {string}\n   * @memberof MgtFileList\n   */\n  @property({\n    attribute: 'item-path'\n  })\n  public itemPath: string;\n\n  /**\n   * allows developer to provide user id for a file\n   *\n   * @type {string}\n   * @memberof MgtFile\n   */\n  @property({\n    attribute: 'user-id'\n  })\n  public userId: string;\n\n  /**\n   * allows developer to provide insight type for a file\n   * can be trending, used, or shared\n   *\n   * @type {OfficeGraphInsightString}\n   * @memberof MgtFileList\n   */\n  @property({\n    attribute: 'insight-type'\n  })\n  public insightType: OfficeGraphInsightString;\n\n  /**\n   * Sets what data to be rendered (file icon only, oneline, twolines threelines).\n   * Default is 'threelines'.\n   *\n   * @type {ViewType}\n   * @memberof MgtFileList\n   */\n  @property({\n    attribute: 'item-view',\n    converter: value => viewTypeConverter(value, 'threelines')\n  })\n  public itemView: ViewType = 'threelines';\n\n  /**\n   * allows developer to provide file type to filter the list\n   * can be docx\n   *\n   * @type {string[]}\n   * @memberof MgtFileList\n   */\n  @property({\n    attribute: 'file-extensions',\n    converter: (value, _type) => {\n      return value.split(',').map(v => v.trim());\n    }\n  })\n  public fileExtensions: string[] = [];\n\n  /**\n   * A number value to indicate the number of more files to load when show more button is clicked\n   *\n   * @type {number}\n   * @memberof MgtFileList\n   */\n  @property({\n    attribute: 'page-size',\n    type: Number\n  })\n  public pageSize = 10;\n\n  @property({\n    attribute: 'disable-open-on-click',\n    type: Boolean\n  })\n  public disableOpenOnClick = false;\n  /**\n   * A boolean value indication if 'show-more' button should be disabled\n   *\n   * @type {boolean}\n   * @memberof MgtFileList\n   */\n  @property({\n    attribute: 'hide-more-files-button',\n    type: Boolean\n  })\n  public hideMoreFilesButton = false;\n\n  /**\n   * A number value indication for file size upload (KB)\n   *\n   * @type {number}\n   * @memberof MgtFileList\n   */\n  @property({\n    attribute: 'max-file-size',\n    type: Number\n  })\n  public maxFileSize: number;\n\n  /**\n   * A boolean value indication if file upload extension should be enable or disabled\n   *\n   * @type {boolean}\n   * @memberof MgtFileList\n   */\n  @property({\n    attribute: 'enable-file-upload',\n    type: Boolean\n  })\n  public enableFileUpload = false;\n\n  /**\n   * A number value to indicate the max number allowed of files to upload.\n   *\n   * @type {number}\n   * @memberof MgtFileList\n   */\n  @property({\n    attribute: 'max-upload-file',\n    type: Number\n  })\n  public maxUploadFile = 10;\n\n  /**\n   * A Array of file extensions to be excluded from file upload.\n   *\n   * @type {string[]}\n   * @memberof MgtFileList\n   */\n  @property({\n    attribute: 'excluded-file-extensions',\n    converter: (value, _type) => {\n      return value.split(',').map(v => v.trim());\n    }\n  })\n  public excludedFileExtensions: string[] = [];\n\n  /**\n   * Get the scopes required for file list\n   *\n   * @static\n   * @return {*}  {string[]}\n   * @memberof MgtFileList\n   */\n  public static get requiredScopes(): string[] {\n    return [...new Set([...MgtFile.requiredScopes])];\n  }\n\n  private _preloadedFiles: DriveItem[] = [];\n  private pageIterator: GraphPageIterator<DriveItem>;\n  // tracking user arrow key input of selection for accessibility purpose\n  private _focusedItemIndex = -1;\n\n  @state() private _isLoadingMore: boolean;\n\n  constructor() {\n    super();\n  }\n\n  /**\n   * Reset state\n   *\n   * @memberof MgtFileList\n   */\n  protected clearState(): void {\n    super.clearState();\n    this.files = null;\n  }\n\n  /**\n   * Set the section to compact view mode\n   *\n   * @returns\n   * @memberof BasePersonCardSection\n   */\n  public asCompactView() {\n    this._isCompact = true;\n    return this;\n  }\n\n  /**\n   * Set the section to full view mode\n   *\n   * @returns\n   * @memberof BasePersonCardSection\n   */\n  public asFullView() {\n    this._isCompact = false;\n    return this;\n  }\n\n  protected args(): unknown[] {\n    return [\n      this.providerState,\n      this.fileListQuery,\n      this.fileQueries,\n      this.siteId,\n      this.driveId,\n      this.groupId,\n      this.itemId,\n      this.itemPath,\n      this.userId,\n      this.insightType,\n      this.fileExtensions,\n      this.pageSize,\n      this.maxFileSize\n    ];\n  }\n\n  protected renderLoading = () => {\n    if (!this.files) {\n      return this.renderTemplate('loading', null) || html``;\n    }\n    return this.renderContent();\n  };\n\n  /**\n   * Render the file list\n   *\n   * @return {*}\n   * @memberof MgtFileList\n   */\n  protected renderContent = () => {\n    if (!this.files || this.files.length === 0) {\n      return this.renderNoData();\n    }\n    return this._isCompact ? this.renderCompactView() : this.renderFullView();\n  };\n\n  /**\n   * Render the compact view\n   *\n   * @returns {TemplateResult}\n   * @memberof MgtFileList\n   */\n  public renderCompactView(): TemplateResult {\n    const files = this.files.slice(0, 3);\n\n    return this.renderFiles(files);\n  }\n\n  /**\n   * Render the full view\n   *\n   * @returns {TemplateResult}\n   * @memberof MgtFileList\n   */\n  public renderFullView(): TemplateResult {\n    return this.renderTemplate('default', { files: this.files }) || this.renderFiles(this.files);\n  }\n\n  /**\n   * Render the state when no data is available\n   *\n   * @protected\n   * @returns {TemplateResult}\n   * @memberof MgtFileList\n   */\n  protected renderNoData(): TemplateResult {\n    return (\n      this.renderTemplate('no-data', null) ||\n      (this.enableFileUpload === true && Providers.globalProvider !== undefined\n        ? html`\n            <div class=\"file-list-wrapper\" dir=${this.direction}>\n              ${this.renderFileUpload()}\n            </div>`\n        : html``)\n    );\n  }\n\n  /**\n   * Render the list of files.\n   *\n   * @protected\n   * @param {*} files\n   * @returns {TemplateResult}\n   * @memberof mgtFileList\n   */\n  protected renderFiles(files: DriveItem[]): TemplateResult {\n    return html`\n      <div id=\"file-list-wrapper\" class=\"file-list-wrapper\" dir=${this.direction}>\n        ${this.enableFileUpload ? this.renderFileUpload() : null}\n        <ul\n          id=\"file-list\"\n          class=\"file-list\"\n        >\n          <li\n            tabindex=\"0\"\n            class=\"file-item\"\n            @keydown=\"${this.onFileListKeyDown}\"\n            @focus=\"${this.onFocusFirstItem}\"\n            @click=${(e: UIEvent) => this.handleItemSelect(files[0], e)}>\n            ${this.renderFile(files[0])}\n          </li>\n          ${repeat(\n            files.slice(1),\n            f => f.id,\n            f => html`\n              <li\n                class=\"file-item\"\n                @keydown=\"${this.onFileListKeyDown}\"\n                @click=${(e: UIEvent) => this.handleItemSelect(f, e)}>\n                ${this.renderFile(f)}\n              </li>\n            `\n          )}\n        </ul>\n        ${\n          !this.hideMoreFilesButton &&\n          this.pageIterator &&\n          (this.pageIterator.hasNext || this._preloadedFiles.length) &&\n          !this._isCompact\n            ? this.renderMoreFileButton()\n            : null\n        }\n      </div>\n    `;\n  }\n\n  /**\n   * Render an individual file.\n   *\n   * @protected\n   * @returns {TemplateResult}\n   * @memberof mgtFileList\n   */\n  protected renderFile(file: DriveItem): TemplateResult {\n    const view = this.itemView;\n    return (\n      this.renderTemplate('file', { file }, file.id) ||\n      mgtHtml`\n        <mgt-file class=\"mgt-file-item\" .fileDetails=${file} .view=${view}></mgt-file>\n      `\n    );\n  }\n\n  /**\n   * Render the button when clicked will show more files.\n   *\n   * @protected\n   * @returns {TemplateResult}\n   * @memberof MgtFileList\n   */\n  protected renderMoreFileButton(): TemplateResult {\n    if (this._isLoadingMore) {\n      return html`\n        <fluent-progress-ring role=\"progressbar\" viewBox=\"0 0 8 8\" class=\"progress-ring\"></fluent-progress-ring>\n      `;\n    } else {\n      return html`\n        <fluent-button\n          appearance=\"stealth\"\n          id=\"show-more\"\n          class=\"show-more\"\n          @click=${() => this.renderNextPage()}\n        >\n          <span class=\"show-more-text\">${this.strings.showMoreSubtitle}</span>\n        </fluent-button>`;\n    }\n  }\n\n  /**\n   * Render MgtFileUpload sub component\n   *\n   * @returns\n   */\n  protected renderFileUpload(): TemplateResult {\n    const fileUploadConfig: MgtFileUploadConfig = {\n      graph: Providers.globalProvider.graph.forComponent(this),\n      driveId: this.driveId,\n      excludedFileExtensions: this.excludedFileExtensions,\n      groupId: this.groupId,\n      itemId: this.itemId,\n      itemPath: this.itemPath,\n      userId: this.userId,\n      siteId: this.siteId,\n      maxFileSize: this.maxFileSize,\n      maxUploadFile: this.maxUploadFile\n    };\n    return mgtHtml`\n        <mgt-file-upload .fileUploadList=${fileUploadConfig} ></mgt-file-upload>\n      `;\n  }\n\n  /**\n   * Handles setting the focusedItemIndex to 0 when you focus on the first item\n   * in the file list.\n   *\n   * @returns void\n   */\n  private readonly onFocusFirstItem = () => (this._focusedItemIndex = 0);\n\n  /**\n   * Handle accessibility keyboard keydown events (arrow up, arrow down, enter, tab) on file list\n   *\n   * @param event\n   */\n  private readonly onFileListKeyDown = (event: KeyboardEvent): void => {\n    const fileList = this.renderRoot.querySelector('.file-list');\n    let focusedItem: HTMLElement;\n\n    if (!fileList?.children.length) {\n      return;\n    }\n\n    if (event.code === 'ArrowUp' || event.code === 'ArrowDown') {\n      if (event.code === 'ArrowUp') {\n        if (this._focusedItemIndex === -1) {\n          this._focusedItemIndex = fileList.children.length;\n        }\n        this._focusedItemIndex = (this._focusedItemIndex - 1 + fileList.children.length) % fileList.children.length;\n      }\n      if (event.code === 'ArrowDown') {\n        this._focusedItemIndex = (this._focusedItemIndex + 1) % fileList.children.length;\n      }\n\n      focusedItem = fileList.children[this._focusedItemIndex] as HTMLElement;\n      this.updateItemBackgroundColor(fileList, focusedItem, 'focused');\n    }\n\n    if (event.code === 'Enter' || event.code === 'Space') {\n      focusedItem = fileList.children[this._focusedItemIndex] as HTMLElement;\n\n      const file = focusedItem.children[0] as MgtFile;\n      event.preventDefault();\n      this.fireCustomEvent('itemClick', file.fileDetails);\n      this.handleFileClick(file.fileDetails);\n\n      this.updateItemBackgroundColor(fileList, focusedItem, 'selected');\n    }\n\n    if (event.code === 'Tab') {\n      focusedItem = fileList.children[this._focusedItemIndex] as HTMLElement;\n    }\n  };\n\n  /**\n   * load state into the component.\n   *\n   * @protected\n   * @returns\n   * @memberof MgtFileList\n   */\n  protected async loadState() {\n    const provider = Providers.globalProvider;\n    if (!provider || provider.state === ProviderState.Loading) {\n      return;\n    }\n\n    if (provider.state === ProviderState.SignedOut) {\n      this.files = null;\n      return;\n    }\n    const graph = provider.graph.forComponent(this);\n    let files: DriveItem[];\n    let pageIterator: GraphPageIterator<DriveItem>;\n\n    const getFromMyDrive = !this.driveId && !this.siteId && !this.groupId && !this.userId;\n\n    // combinations of these attributes must be provided in order for the component to know which endpoint to call to request files\n    // not supplying enough for these combinations will get a null file result\n    if (\n      (this.driveId && !this.itemId && !this.itemPath) ||\n      (this.groupId && !this.itemId && !this.itemPath) ||\n      (this.siteId && !this.itemId && !this.itemPath) ||\n      (this.userId && !this.insightType && !this.itemId && !this.itemPath)\n    ) {\n      this.files = null;\n    }\n\n    if (!this.files) {\n      if (this.fileListQuery) {\n        pageIterator = await getFilesByListQueryIterator(graph, this.fileListQuery, this.pageSize);\n      } else if (this.fileQueries) {\n        files = await getFilesByQueries(graph, this.fileQueries);\n      } else if (getFromMyDrive) {\n        if (this.itemId) {\n          pageIterator = await getFilesByIdIterator(graph, this.itemId, this.pageSize);\n        } else if (this.itemPath) {\n          pageIterator = await getFilesByPathIterator(graph, this.itemPath, this.pageSize);\n        } else if (this.insightType) {\n          files = await getMyInsightsFiles(graph, this.insightType);\n        } else {\n          pageIterator = await getFilesIterator(graph, this.pageSize);\n        }\n      } else if (this.driveId) {\n        if (this.itemId) {\n          pageIterator = await getDriveFilesByIdIterator(graph, this.driveId, this.itemId, this.pageSize);\n        } else if (this.itemPath) {\n          pageIterator = await getDriveFilesByPathIterator(graph, this.driveId, this.itemPath, this.pageSize);\n        }\n      } else if (this.groupId) {\n        if (this.itemId) {\n          pageIterator = await getGroupFilesByIdIterator(graph, this.groupId, this.itemId, this.pageSize);\n        } else if (this.itemPath) {\n          pageIterator = await getGroupFilesByPathIterator(graph, this.groupId, this.itemPath, this.pageSize);\n        }\n      } else if (this.siteId) {\n        if (this.itemId) {\n          pageIterator = await getSiteFilesByIdIterator(graph, this.siteId, this.itemId, this.pageSize);\n        } else if (this.itemPath) {\n          pageIterator = await getSiteFilesByPathIterator(graph, this.siteId, this.itemPath, this.pageSize);\n        }\n      } else if (this.userId) {\n        if (this.itemId) {\n          pageIterator = await getUserFilesByIdIterator(graph, this.userId, this.itemId, this.pageSize);\n        } else if (this.itemPath) {\n          pageIterator = await getUserFilesByPathIterator(graph, this.userId, this.itemPath, this.pageSize);\n        } else if (this.insightType) {\n          files = await getUserInsightsFiles(graph, this.userId, this.insightType);\n        }\n      }\n\n      if (pageIterator) {\n        this.pageIterator = pageIterator;\n        this._preloadedFiles = [...this.pageIterator.value];\n\n        // handle when cached file length is greater than page size\n        if (this._preloadedFiles.length >= this.pageSize) {\n          files = this._preloadedFiles.splice(0, this.pageSize);\n        } else {\n          files = this._preloadedFiles.splice(0, this._preloadedFiles.length);\n        }\n      }\n\n      // filter files when extensions are provided\n      let filteredByFileExtension: DriveItem[];\n      if (this.fileExtensions?.length > 0) {\n        // retrive all pages before filtering\n        if (this.pageIterator?.value) {\n          while (this.pageIterator.hasNext) {\n            await fetchNextAndCacheForFilesPageIterator(this.pageIterator);\n          }\n          files = this.pageIterator.value;\n          this._preloadedFiles = [];\n        }\n        filteredByFileExtension = files.filter(file => {\n          for (const e of this.fileExtensions) {\n            if (e === this.getFileExtension(file.name)) {\n              return file;\n            }\n          }\n        });\n      }\n\n      if (filteredByFileExtension?.length >= 0) {\n        this.files = filteredByFileExtension;\n        if (this.pageSize) {\n          files = this.files.splice(0, this.pageSize);\n          this.files = files;\n        }\n      } else {\n        this.files = files;\n      }\n    }\n  }\n\n  /**\n   * Handle the click event on an item.\n   *\n   * @protected\n   * @memberof MgtFileList\n   */\n  protected handleItemSelect(item: DriveItem, event: UIEvent): void {\n    this.handleFileClick(item);\n    this.fireCustomEvent('itemClick', item);\n\n    // handle accessibility updates when item clicked\n    if (event) {\n      const fileList = this.renderRoot.querySelector('.file-list');\n\n      // get index of the focused item\n      const nodes = Array.from(fileList.children);\n      const li = (event.target as HTMLElement).closest('li');\n      const index = nodes.indexOf(li);\n      this._focusedItemIndex = index;\n      const clickedItem = fileList.children[this._focusedItemIndex] as HTMLElement;\n      this.updateItemBackgroundColor(fileList, clickedItem, 'selected');\n    }\n  }\n\n  /**\n   * Handle the click event on button to show next page.\n   *\n   * @protected\n   * @memberof MgtFileList\n   */\n  protected async renderNextPage() {\n    // render next page from cache if exists, or else use iterator\n    if (this._preloadedFiles.length > 0) {\n      this.files = [\n        ...this.files,\n        ...this._preloadedFiles.splice(0, Math.min(this.pageSize, this._preloadedFiles.length))\n      ];\n    } else {\n      if (this.pageIterator.hasNext) {\n        this._isLoadingMore = true;\n        const root = this.renderRoot.querySelector('#file-list-wrapper');\n        if (root?.animate) {\n          // play back\n          root.animate(\n            [\n              {\n                height: 'auto',\n                transformOrigin: 'top left'\n              },\n              {\n                height: 'auto',\n                transformOrigin: 'top left'\n              }\n            ],\n            {\n              duration: 1000,\n              easing: 'ease-in-out',\n              fill: 'both'\n            }\n          );\n        }\n        await fetchNextAndCacheForFilesPageIterator(this.pageIterator);\n        this._isLoadingMore = false;\n        this.files = this.pageIterator.value;\n      }\n    }\n\n    this.requestUpdate();\n  }\n\n  private handleFileClick(file: DriveItem) {\n    if (file?.webUrl && !this.disableOpenOnClick) {\n      window.open(file.webUrl, '_blank', 'noreferrer');\n    }\n  }\n\n  /**\n   * Get file extension string from file name\n   *\n   * @param name file name\n   * @returns {string} file extension\n   */\n  private getFileExtension(name: string) {\n    const re = /(?:\\.([^.]+))?$/;\n    const fileExtension = re.exec(name)[1] || '';\n\n    return fileExtension;\n  }\n\n  /**\n   * Handle remove and add css class on accessibility keyboard select and focus\n   *\n   * @param fileList HTML element\n   * @param focusedItem HTML element\n   * @param className background class to be applied\n   */\n  private updateItemBackgroundColor(fileList: Element, focusedItem: HTMLElement, className: string) {\n    // reset background color and remove tabindex\n    for (const node of fileList.children) {\n      node.classList.remove(className);\n      node.removeAttribute('tabindex');\n    }\n\n    // set focused item background color\n    if (focusedItem) {\n      focusedItem.classList.add(className);\n      focusedItem.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'start' });\n      focusedItem.setAttribute('tabindex', '0');\n      focusedItem.focus();\n    }\n\n    // remove selected classes\n    for (const node of fileList.children) {\n      node.classList.remove('selected');\n    }\n  }\n\n  /**\n   * Handle reload of File List and condition to clear cache\n   *\n   * @param clearCache boolean, if true clear cache\n   */\n  public reload(clearCache = false) {\n    if (clearCache) {\n      // clear cache File List\n      void clearFilesCache();\n    }\n    // explicitly run the task to reload data\n    void this._task.run();\n  }\n}\n","// THIS FILE IS AUTO GENERATED\n// ANY CHANGES WILL BE LOST DURING BUILD\n// MODIFY THE .SCSS FILE INSTEAD\n\nimport { css, CSSResult } from 'lit';\n/**\n * exports lit-element css\n * @export styles\n */\nexport const styles: CSSResult[] = [\n  css`\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, \"Segoe UI\", \"Segoe UI Web (West European)\", \"Segoe UI\", -apple-system, \"BlinkMacSystemFont\", \"Roboto\", \"Helvetica Neue\", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:\"\\\\\\e70d\"}.ms-icon-chevron-up::before{content:\"\\\\\\e70e\"}.ms-icon-contact::before{content:\"\\\\\\e77b\"}.ms-icon-add-friend::before{content:\"\\\\\\e8fa\"}.ms-icon-outlook-logo-inverser::before{content:\"\\\\\\eb6d\"}:host{font-size:var(--default-font-size);font-weight:var(--default-font-weight,400);border:var(--file-border,1px solid transparent);border-radius:var(--file-border-radius,4px);background-color:var(--file-background-color)}:host .item{display:flex;flex-flow:row nowrap;align-items:center;background-color:var(--file-background-color);padding:var(--file-padding,0);margin:var(--file-margin,0)}:host .item:hover{background-color:var(--file-background-color-hover,var(--neutral-fill-hover));border-radius:var(--file-border-radius,4px);cursor:pointer;--secondary-text-color:var(--secondary-text-hover-color)}:host .item:focus,:host .item:focus-visible{background-color:var(--file-background-color-focus,var(--neutral-fill-hover));border-radius:var(--file-border-radius,4px)}:host .item__file-type-icon{height:var(--file-type-icon-height,28px);display:flex;align-items:center;justify-content:center}:host .item__file-type-icon img{height:var(--file-type-icon-height,28px)}:host .item__details{padding-inline-start:var(--file-padding-inline-start,14px)}:host .item__details .line1{font-size:var(--default-font-size);font-weight:var(--file-line1-font-weight,var(--default-font-weight,400));text-transform:var(--file-line1-text-transform,initial);line-height:20px;color:var(--file-line1-color,var(--neutral-foreground-rest))}:host .item__details .line2{color:var(--file-line2-color,var(--secondary-text-color));font-size:var(--file-line2-font-size,var(--last-modified-font-size,12px));font-weight:var(--file-line2-font-weight,var(--default-font-weight,400));text-transform:var(--file-line2-text-transform,initial);line-height:16px}:host .item__details .line3{color:var(--file-line3-color,var(--secondary-text-color));font-size:var(--file-line3-font-size,var(--size-font-size,12px));font-weight:var(--file-line3-font-weight,var(--default-font-weight,400));text-transform:var(--file-line3-text-transform,initial);line-height:16px}[dir=rtl] .item{direction:rtl}[dir=rtl] .item__details{direction:rtl}\n`];","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nconst fileTypeMap: Record<string, string> = {\n  PowerPoint: 'pptx',\n  Word: 'docx',\n  Excel: 'xlsx',\n  Pdf: 'pdf',\n  OneNote: 'onetoc',\n  OneNotePage: 'one',\n  InfoPath: 'xsn',\n  Visio: 'vstx',\n  Publisher: 'pub',\n  Project: 'mpp',\n  Access: 'accdb',\n  Mail: 'email',\n  Csv: 'csv',\n  Archive: 'archive',\n  Xps: 'vector',\n  Audio: 'audio',\n  Video: 'video',\n  Image: 'photo',\n  Web: 'html',\n  Text: 'txt',\n  Xml: 'xml',\n  Story: 'genericfile',\n  ExternalContent: 'genericfile',\n  Folder: 'folder',\n  Spsite: 'spo',\n  Other: 'genericfile'\n};\n\nconst baseUri = 'https://spoprod-a.akamaihd.net/files/fabric-cdn-prod_20201008.001/assets/item-types';\n\n/**\n * Available icon sizes\n */\nexport type IconSize = 16 | 20 | 24 | 32 | 40 | 48 | 64 | 96;\n\n/**\n * Helper to provide fluent icon image urls\n *\n * @param type\n * @param size\n * @param extension\n * @returns\n */\nexport const getFileTypeIconUri = (type: string, size: IconSize, extension: 'png' | 'svg') => {\n  const fileType: string = fileTypeMap[type] || 'genericfile';\n  return `${baseUri}/${size.toString()}/${fileType}.${extension}`;\n};\n\n/**\n * Helper to provide fluent icon image urls with the correct size\n *\n * @param type\n * @param size\n * @param extension\n * @returns\n */\nexport const getFileTypeIconUriByExtension = (type: string, size: IconSize, extension: 'png' | 'svg') => {\n  const found = Object.keys(fileTypeMap).find(key => fileTypeMap[key] === type);\n  if (found) {\n    return `${baseUri}/${size.toString()}/${type}.${extension}`;\n  } else if (type === 'jpg' || type === 'png') {\n    type = 'photo';\n    return `${baseUri}/${size.toString()}/${type}.${extension}`;\n  } else {\n    return null;\n  }\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nexport const strings = {\n  modifiedSubtitle: 'Modified',\n  sizeSubtitle: 'Size'\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { DriveItem } from '@microsoft/microsoft-graph-types';\nimport { html, TemplateResult } from 'lit';\nimport { property } from 'lit/decorators.js';\nimport { styles } from './mgt-file-css';\nimport { MgtTemplatedTaskComponent, Providers, ProviderState } from '@microsoft/mgt-element';\nimport {\n  getDriveItemById,\n  getDriveItemByPath,\n  getDriveItemByQuery,\n  getGroupDriveItemById,\n  getGroupDriveItemByPath,\n  getListDriveItemById,\n  getMyDriveItemById,\n  getMyDriveItemByPath,\n  getMyInsightsDriveItemById,\n  getSiteDriveItemById,\n  getSiteDriveItemByPath,\n  getUserDriveItemById,\n  getUserDriveItemByPath,\n  getUserInsightsDriveItemById\n} from '../../graph/graph.files';\nimport { formatBytes, getRelativeDisplayDate } from '../../utils/Utils';\nimport { OfficeGraphInsightString, ViewType, viewTypeConverter } from '../../graph/types';\nimport { getFileTypeIconUriByExtension } from '../../styles/fluent-icons';\nimport { getSvg, SvgIcon } from '../../utils/SvgHelper';\nimport { strings } from './strings';\nimport { registerComponent } from '@microsoft/mgt-element';\n\nexport const registerMgtFileComponent = () => registerComponent('file', MgtFile);\n\n/**\n * The File component is used to represent an individual file/folder from OneDrive or SharePoint by displaying information such as the file/folder name, an icon indicating the file type, and other properties such as the author, last modified date, or other details selected by the developer.\n *\n * @export\n * @class MgtFile\n * @extends {MgtTemplatedComponent}\n *\n * @cssprop --file-type-icon-height - {Length} file type icon height. Default value is 28px.\n * @cssprop --file-border - {String} file item border style. Default value is \"1px solid transparent\".\n * @cssprop --file-border-radius - {String} the border radius of the file component. Default value is 4px.\n * @cssprop --file-box-shadow - {String} the box-shadow of the component. Default value is none.\n * @cssprop --file-background-color - {Color} the background-color of the component.\n * @cssprop --file-background-color-focus - {Color} the background-color of the component on focus.\n * @cssprop --file-background-color-hover - {Color} the background-color of the component on hover.\n * @cssprop --file-padding - {String} the padding around the file component. Default value is 0px.\n * @cssprop --file-padding-inline-start - {Length} the padding between file icon and file details. Default value is 14px.\n * @cssprop --file-margin - {String} the margin around the file component. Default value is 0px.\n * @cssprop --file-line1-font-size - {Length} the first line text font size. Default value is 12px.\n * @cssprop --file-line1-font-weight - {Length} the first line text font weight. Default value is 400.\n * @cssprop --file-line1-color - {Color} the first line text color.\n * @cssprop --file-line1-text-transform - {String} the first line text text transform. Default value is initial.\n * @cssprop --file-line2-font-size - {Length} the second line text font size. Default value is 12px.\n * @cssprop --file-line2-font-weight - {Length} the second line text font weight. Default value is 400.\n * @cssprop --file-line2-color - {Color} the second line text color.\n * @cssprop --file-line2-text-transform - {String} the second line text text transform. Default value is initial.\n * @cssprop --file-line3-font-size - {Length} the third line text font size. Default value is 12px.\n * @cssprop --file-line3-font-weight - {Length} the third line text font weight. Default value is 400.\n * @cssprop --file-line3-color - {Color} the third line text color.\n * @cssprop --file-line3-text-transform - {String} the third line text text transform. Default value is 400.\n */\nexport class MgtFile extends MgtTemplatedTaskComponent {\n  /**\n   * Array of styles to apply to the element. The styles should be defined\n   * using the `css` tag function.\n   */\n  static get styles() {\n    return styles;\n  }\n  protected get strings() {\n    return strings;\n  }\n\n  /**\n   * allows developer to provide query for a file\n   *\n   * @type {string}\n   * @memberof MgtFile\n   */\n  @property({\n    attribute: 'file-query'\n  })\n  public fileQuery: string;\n\n  /**\n   * allows developer to provide site id for a file\n   *\n   * @type {string}\n   * @memberof MgtFile\n   */\n  @property({\n    attribute: 'site-id'\n  })\n  public siteId: string;\n\n  /**\n   * allows developer to provide drive id for a file\n   *\n   * @type {string}\n   * @memberof MgtFile\n   */\n  @property({\n    attribute: 'drive-id'\n  })\n  public driveId: string;\n\n  /**\n   * allows developer to provide group id for a file\n   *\n   * @type {string}\n   * @memberof MgtFile\n   */\n  @property({\n    attribute: 'group-id'\n  })\n  public groupId: string;\n\n  /**\n   * allows developer to provide list id for a file\n   *\n   * @type {string}\n   * @memberof MgtFile\n   */\n  @property({\n    attribute: 'list-id'\n  })\n  public listId: string;\n\n  /**\n   * allows developer to provide user id for a file\n   *\n   * @type {string}\n   * @memberof MgtFile\n   */\n  @property({\n    attribute: 'user-id'\n  })\n  public userId: string;\n  /**\n   * allows developer to provide item id for a file\n   *\n   * @type {string}\n   * @memberof MgtFile\n   */\n  @property({\n    attribute: 'item-id'\n  })\n  public itemId: string;\n\n  /**\n   * allows developer to provide item path for a file\n   *\n   * @type {string}\n   * @memberof MgtFile\n   */\n  @property({\n    attribute: 'item-path'\n  })\n  public itemPath: string;\n\n  /**\n   * allows developer to provide insight type for a file\n   * can be trending, used, or shared\n   *\n   * @type {OfficeGraphInsightString}\n   * @memberof MgtFile\n   */\n  @property({\n    attribute: 'insight-type'\n  })\n  public insightType: OfficeGraphInsightString;\n\n  /**\n   * allows developer to provide insight id for a file\n   *\n   * @type {string}\n   * @memberof MgtFile\n   */\n  @property({\n    attribute: 'insight-id'\n  })\n  public insightId: string;\n\n  /**\n   * allows developer to provide DriveItem object\n   *\n   * @type {MicrosoftGraph.DriveItem}\n   * @memberof MgtFile\n   */\n  @property({\n    type: Object\n  })\n  public fileDetails: DriveItem;\n\n  /**\n   * allows developer to provide file type icon url\n   *\n   * @type {string}\n   * @memberof MgtFile\n   */\n  @property({\n    attribute: 'file-icon'\n  })\n  public fileIcon: string;\n\n  /**\n   * object containing Graph details on item\n   *\n   * @type {MicrosoftGraph.DriveItem}\n   * @memberof MgtFile\n   */\n  @property({ type: Object })\n  public driveItem: DriveItem;\n\n  /**\n   * Sets the property of the file to use for the first line of text.\n   * Default is file name\n   *\n   * @type {string}\n   * @memberof MgtFile\n   */\n  @property({ attribute: 'line1-property' }) public line1Property: string;\n\n  /**\n   * Sets the property of the file to use for the second line of text.\n   * Default is last modified date time\n   *\n   * @type {string}\n   * @memberof MgtFile\n   */\n  @property({ attribute: 'line2-property' }) public line2Property: string;\n\n  /**\n   * Sets the property of the file to use for the second line of text.\n   * Default is file size\n   *\n   * @type {string}\n   * @memberof MgtFile\n   */\n  @property({ attribute: 'line3-property' }) public line3Property: string;\n\n  /**\n   * Sets what data will be rendered.\n   * Valid options are 'image', 'oneline', 'twolines', 'threelines', or 'fourlines'\n   * Default is 'threelines'.\n   *\n   * @type {ViewType}\n   * @memberof MgtFile\n   */\n  @property({\n    attribute: 'view',\n    converter: value => viewTypeConverter(value, 'threelines')\n  })\n  public view: ViewType;\n\n  /**\n   * Get the scopes required for file\n   *\n   * @static\n   * @return {*}  {string[]}\n   * @memberof MgtFile\n   */\n  public static get requiredScopes(): string[] {\n    return [...new Set(['files.read', 'files.read.all', 'sites.read.all'])];\n  }\n\n  protected args(): unknown[] {\n    return [\n      this.providerState,\n      this.fileQuery,\n      this.siteId,\n      this.itemId,\n      this.driveId,\n      this.itemPath,\n      this.listId,\n      this.groupId,\n      this.userId,\n      this.insightType,\n      this.insightId,\n      this.fileDetails,\n      this.fileIcon\n    ];\n  }\n\n  constructor() {\n    super();\n    this.line1Property = 'name';\n    this.line2Property = 'lastModifiedDateTime';\n    this.line3Property = 'size';\n    this.view = 'threelines';\n  }\n\n  public renderContent = () => {\n    if (!this.driveItem) {\n      return this.renderNoData();\n    }\n\n    const file = this.driveItem;\n    let fileTemplate: TemplateResult;\n\n    fileTemplate = this.renderTemplate('default', { file });\n    if (!fileTemplate) {\n      const fileDetailsTemplate: TemplateResult = this.renderDetails(file);\n      const fileTypeIconTemplate: TemplateResult = this.renderFileTypeIcon();\n\n      fileTemplate = html`\n        <div class=\"item\">\n          ${fileTypeIconTemplate} ${fileDetailsTemplate}\n        </div>`;\n    }\n\n    return fileTemplate;\n  };\n\n  /**\n   * Render the state when no data is available\n   *\n   * @protected\n   * @returns {TemplateResult}\n   * @memberof MgtFile\n   */\n  protected renderNoData(): TemplateResult {\n    return this.renderTemplate('no-data', null) || html``;\n  }\n\n  /**\n   * Render the file type icon\n   *\n   * @protected\n   * @param {string} [iconSrc]\n   * @memberof MgtFile\n   */\n  protected renderFileTypeIcon(): TemplateResult {\n    if (!this.fileIcon && !this.driveItem.name) {\n      return html``;\n    }\n\n    let fileIconSrc;\n\n    if (this.fileIcon) {\n      fileIconSrc = this.fileIcon;\n    } else {\n      // get file type extension from file name\n      const re = /(?:\\.([^.]+))?$/;\n      const fileType =\n        this.driveItem.package === undefined && this.driveItem.folder === undefined\n          ? re.exec(this.driveItem.name)[1]\n            ? re.exec(this.driveItem.name)[1].toLowerCase()\n            : this.driveItem.size\n            ? 'null'\n            : 'folder'\n          : this.driveItem.package !== undefined\n          ? this.driveItem.package.type === 'oneNote'\n            ? 'onetoc'\n            : 'folder'\n          : 'folder';\n      fileIconSrc = getFileTypeIconUriByExtension(fileType, 48, 'svg');\n    }\n\n    return html`\n      <div class=\"item__file-type-icon\">\n        ${\n          fileIconSrc\n            ? html`\n              <img src=${fileIconSrc} alt=\"File icon\" />\n            `\n            : html`\n              ${getSvg(SvgIcon.File)}\n            `\n        }\n      </div>\n    `;\n  }\n\n  /**\n   * Render the file details\n   *\n   * @protected\n   * @param {MicrosoftGraph.DriveItem} [driveItem]\n   * @memberof MgtFile\n   */\n  protected renderDetails(driveItem: DriveItem): TemplateResult {\n    if (!driveItem || this.view === 'image') {\n      return html``;\n    }\n\n    const details: TemplateResult[] = [];\n\n    if (this.view > 'image') {\n      const text = this.getTextFromProperty(driveItem, this.line1Property);\n      if (text) {\n        details.push(html`\n          <div class=\"line1\" aria-label=\"${text}\">${text}</div>\n        `);\n      }\n    }\n\n    if (this.view > 'oneline') {\n      const text = this.getTextFromProperty(driveItem, this.line2Property);\n      if (text) {\n        details.push(html`\n          <div class=\"line2\" aria-label=\"${text}\">${text}</div>\n        `);\n      }\n    }\n\n    if (this.view > 'twolines') {\n      const text = this.getTextFromProperty(driveItem, this.line3Property);\n      if (text) {\n        details.push(html`\n          <div class=\"line3\" aria-label=\"${text}\">${text}</div>\n        `);\n      }\n    }\n\n    return html`\n      <div class=\"item__details\">\n        ${details}\n      </div>\n    `;\n  }\n\n  /**\n   * load state into the component.\n   *\n   * @protected\n   * @returns\n   * @memberof MgtFile\n   */\n  protected async loadState() {\n    if (this.fileDetails) {\n      this.driveItem = this.fileDetails;\n      return;\n    }\n\n    const provider = Providers.globalProvider;\n    if (!provider || provider.state === ProviderState.Loading) {\n      return;\n    }\n\n    if (provider.state === ProviderState.SignedOut) {\n      this.driveItem = null;\n      return;\n    }\n\n    const graph = provider.graph.forComponent(this);\n    let driveItem: DriveItem;\n\n    // evaluate to true when only item-id or item-path is provided\n    const getFromMyDrive = !this.driveId && !this.siteId && !this.groupId && !this.listId && !this.userId;\n\n    if (\n      // return null when a combination of provided properties are required\n      (this.driveId && !this.itemId && !this.itemPath) ||\n      (this.siteId && !this.itemId && !this.itemPath) ||\n      (this.groupId && !this.itemId && !this.itemPath) ||\n      (this.listId && !this.siteId && !this.itemId) ||\n      (this.insightType && !this.insightId) ||\n      (this.userId && !this.itemId && !this.itemPath && !this.insightType && !this.insightId)\n    ) {\n      driveItem = null;\n    } else if (this.fileQuery) {\n      driveItem = await getDriveItemByQuery(graph, this.fileQuery);\n    } else if (this.itemId && getFromMyDrive) {\n      driveItem = await getMyDriveItemById(graph, this.itemId);\n    } else if (this.itemPath && getFromMyDrive) {\n      driveItem = await getMyDriveItemByPath(graph, this.itemPath);\n    } else if (this.userId) {\n      if (this.itemId) {\n        driveItem = await getUserDriveItemById(graph, this.userId, this.itemId);\n      } else if (this.itemPath) {\n        driveItem = await getUserDriveItemByPath(graph, this.userId, this.itemPath);\n      } else if (this.insightType && this.insightId) {\n        driveItem = await getUserInsightsDriveItemById(graph, this.userId, this.insightType, this.insightId);\n      }\n    } else if (this.driveId) {\n      if (this.itemId) {\n        driveItem = await getDriveItemById(graph, this.driveId, this.itemId);\n      } else if (this.itemPath) {\n        driveItem = await getDriveItemByPath(graph, this.driveId, this.itemPath);\n      }\n    } else if (this.siteId && !this.listId) {\n      if (this.itemId) {\n        driveItem = await getSiteDriveItemById(graph, this.siteId, this.itemId);\n      } else if (this.itemPath) {\n        driveItem = await getSiteDriveItemByPath(graph, this.siteId, this.itemPath);\n      }\n    } else if (this.listId) {\n      driveItem = await getListDriveItemById(graph, this.siteId, this.listId, this.itemId);\n    } else if (this.groupId) {\n      if (this.itemId) {\n        driveItem = await getGroupDriveItemById(graph, this.groupId, this.itemId);\n      } else if (this.itemPath) {\n        driveItem = await getGroupDriveItemByPath(graph, this.groupId, this.itemPath);\n      }\n    } else if (this.insightType && !this.userId) {\n      driveItem = await getMyInsightsDriveItemById(graph, this.insightType, this.insightId);\n    }\n\n    this.driveItem = driveItem;\n  }\n\n  private getTextFromProperty(driveItem: DriveItem, properties: string): string {\n    if (!properties || properties.length === 0) {\n      return null;\n    }\n\n    const propertyList = properties.trim().split(',');\n    let text: string;\n    let i = 0;\n\n    while (!text && i < propertyList.length) {\n      const current = propertyList[i].trim();\n      switch (current) {\n        case 'size': {\n          // convert size to kb, mb, gb\n          let size = '0';\n          if (driveItem.size) {\n            size = formatBytes(driveItem.size);\n          }\n          text = `${this.strings.sizeSubtitle}: ${size}`;\n          break;\n        }\n        case 'lastModifiedDateTime': {\n          // convert date time\n          let relativeDateString: string;\n          let lastModifiedString: string;\n          if (driveItem.lastModifiedDateTime) {\n            const lastModifiedDateTime = new Date(driveItem.lastModifiedDateTime);\n            relativeDateString = getRelativeDisplayDate(lastModifiedDateTime);\n            lastModifiedString = `${this.strings.modifiedSubtitle} ${relativeDateString}`;\n          } else {\n            lastModifiedString = '';\n          }\n          text = lastModifiedString;\n          break;\n        }\n        default:\n          text = driveItem[current] as string;\n      }\n      i++;\n    }\n\n    return text;\n  }\n}\n","// THIS FILE IS AUTO GENERATED\n// ANY CHANGES WILL BE LOST DURING BUILD\n// MODIFY THE .SCSS FILE INSTEAD\n\nimport { css, CSSResult } from 'lit';\n/**\n * exports lit-element css\n * @export styles\n */\nexport const styles: CSSResult[] = [\n  css`\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, \"Segoe UI\", \"Segoe UI Web (West European)\", \"Segoe UI\", -apple-system, \"BlinkMacSystemFont\", \"Roboto\", \"Helvetica Neue\", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:\"\\\\\\e70d\"}.ms-icon-chevron-up::before{content:\"\\\\\\e70e\"}.ms-icon-contact::before{content:\"\\\\\\e77b\"}.ms-icon-add-friend::before{content:\"\\\\\\e8fa\"}.ms-icon-outlook-logo-inverser::before{content:\"\\\\\\eb6d\"}:host{font-size:var(--default-font-size)}:host .flyout [slot=anchor]{display:flex;cursor:pointer;align-items:var(--person-alignment,normal)}:host .flyout [slot=anchor].vertical{flex-direction:column;justify-content:center;align-items:center;margin-inline-start:0}:host .person-root{display:flex;flex-direction:row;align-items:center;background-color:var(--person-background-color,transparent);border-radius:var(--person-border-radius,4px)}:host .person-root.small .avatar-wrapper{min-width:var(--person-avatar-size,24px);width:var(--person-avatar-size,24px);height:var(--person-avatar-size,24px)}:host .person-root.small .contact-icon,:host .person-root.small .initials{font-size:calc(var(--person-avatar-size,24px) * .4)}:host .person-root.small .presence-wrapper svg{width:calc(var(--person-avatar-size,24px) * .28);height:calc(var(--person-avatar-size,24px) * .28)}:host .person-root.noline .avatar-wrapper,:host .person-root.oneline .avatar-wrapper{min-width:var(--person-avatar-size,24px);width:var(--person-avatar-size,24px);height:var(--person-avatar-size,24px)}:host .person-root.noline .avatar-wrapper .contact-icon,:host .person-root.noline .avatar-wrapper .initials,:host .person-root.oneline .avatar-wrapper .contact-icon,:host .person-root.oneline .avatar-wrapper .initials{font-size:calc(var(--person-avatar-size,24px) * .4)}:host .person-root.noline .avatar-wrapper .presence-wrapper svg,:host .person-root.oneline .avatar-wrapper .presence-wrapper svg{width:calc(var(--person-avatar-size,24px) * .28);height:calc(var(--person-avatar-size,24px) * .28)}:host .person-root.noline .presence-basic,:host .person-root.oneline .presence-basic{border-width:1px;position:relative;bottom:calc(var(--person-avatar-size,24px) * .12 - 4px)}:host .person-root.twolines .avatar-wrapper{min-width:var(--person-avatar-size,40px);width:var(--person-avatar-size,40px);height:var(--person-avatar-size,40px)}:host .person-root.twolines .avatar-wrapper .contact-icon,:host .person-root.twolines .avatar-wrapper .initials{font-size:calc(var(--person-avatar-size,40px) * .4)}:host .person-root.twolines .avatar-wrapper .presence-wrapper svg{width:calc(var(--person-avatar-size,40px) * .28);height:calc(var(--person-avatar-size,40px) * .28)}:host .person-root.large .avatar-wrapper,:host .person-root.threelines .avatar-wrapper{min-width:var(--person-avatar-size,56px);width:var(--person-avatar-size,56px);height:var(--person-avatar-size,56px)}:host .person-root.large .avatar-wrapper .contact-icon,:host .person-root.large .avatar-wrapper .initials,:host .person-root.threelines .avatar-wrapper .contact-icon,:host .person-root.threelines .avatar-wrapper .initials{font-size:calc(var(--person-avatar-size,56px) * .4)}:host .person-root.large .avatar-wrapper .presence-wrapper svg,:host .person-root.threelines .avatar-wrapper .presence-wrapper svg{width:calc(var(--person-avatar-size,56px) * .28);height:calc(var(--person-avatar-size,56px) * .28)}:host .person-root.fourlines .avatar-wrapper,:host .person-root.vertical .avatar-wrapper{min-width:var(--person-avatar-size,72px);width:var(--person-avatar-size,72px);height:var(--person-avatar-size,72px)}:host .person-root.fourlines .avatar-wrapper .contact-icon,:host .person-root.fourlines .avatar-wrapper .initials,:host .person-root.vertical .avatar-wrapper .contact-icon,:host .person-root.vertical .avatar-wrapper .initials{font-size:calc(var(--person-avatar-size,72px) * .4)}:host .person-root.fourlines .avatar-wrapper .presence-wrapper svg,:host .person-root.vertical .avatar-wrapper .presence-wrapper svg{width:calc(var(--person-avatar-size,72px) * .28);height:calc(var(--person-avatar-size,72px) * .28)}:host .person-root.vertical{flex-direction:column;justify-content:center;align-items:center}:host .person-root .avatar-wrapper{min-width:var(--person-avatar-size,24px);width:var(--person-avatar-size,24px);height:var(--person-avatar-size,24px);position:relative;box-sizing:border-box}:host .person-root .avatar-wrapper .contact-icon,:host .person-root .avatar-wrapper .initials,:host .person-root .avatar-wrapper img{height:100%;width:100%;border:var(--person-avatar-border,none);border-radius:var(--person-avatar-border-radius,50%);margin-block-start:var(--person-avatar-top-spacing,0);object-fit:cover;object-position:center top}:host .person-root .avatar-wrapper .contact-icon,:host .person-root .avatar-wrapper .initials{display:flex;justify-content:center;align-items:center;font-size:calc(var(--person-avatar-size,24px) * .4);font-weight:400;background:var(--person-initials-background-color,var(--neutral-fill-secondary-rest));color:var(--person-initials-text-color,var(--neutral-fill-strong-hover))}:host .person-root .avatar-wrapper .presence-wrapper{bottom:var(--person-presence-wrapper-bottom,0);right:0;position:absolute;border-radius:50%;background-color:var(--neutral-layer-1);border:1px solid var(--neutral-layer-1)}:host .person-root .avatar-wrapper .presence-wrapper svg{display:flex;width:calc(var(--person-avatar-size,24px) * .28);height:calc(var(--person-avatar-size,24px) * .28)}:host .person-root .details-wrapper{display:flex;flex-direction:column;align-items:flex-start;justify-content:center;min-width:var(--person-details-wrapper-width,168px);margin-inline-start:var(--person-details-left-spacing,12px);margin-block-end:var(--person-details-bottom-spacing,0)}:host .person-root .details-wrapper.vertical{display:inline-flex;flex-direction:column;justify-content:center;align-items:center;margin-inline-start:0}:host .person-root .details-wrapper .line1{font-size:var(--person-line1-font-size,ms-font-size-14);font-weight:var(--person-line1-font-weight,600);color:var(--person-line1-text-color,var(--neutral-foreground-rest));text-transform:var(--person-line1-text-transform,inherit);line-height:var(--person-line1-text-line-height,20px)}:host .person-root .details-wrapper .line2{font-size:var(--person-line2-font-size,var(--email-font-size,ms-font-size-12));font-weight:var(--person-line2-font-weight,400);color:var(--person-line2-text-color,var(--secondary-text-color));text-transform:var(--person-line2-text-transform,inherit);line-height:var(--person-line2-text-line-height,16px)}:host .person-root .details-wrapper .line3{font-size:var(--person-line3-font-size,var(--email-font-size,ms-font-size-12));font-weight:var(--person-line3-font-weight,400);color:var(--person-line3-text-color,var(--secondary-text-color));text-transform:var(--person-line3-text-transform,inherit);line-height:var(--person-line3-text-line-height,16px)}:host .person-root .details-wrapper .line4{font-size:var(--person-line4-font-size,var(--email-font-size,ms-font-size-12));font-weight:var(--person-line4-font-weight,400);color:var(--person-line4-text-color,var(--secondary-text-color));text-transform:var(--person-line4-text-transform,inherit);line-height:var(--person-line4-text-line-height,16px)}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg,:host svg>path{fill:#fff;fill-rule:nonzero;clip-rule:nonzero}}[dir=rtl] .presence-wrapper{right:unset!important;left:0}\n`];","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nconst avatarTypes = ['photo', 'initials'] as const;\n\nexport type AvatarType = (typeof avatarTypes)[number];\nexport const isAvatarType = (value: unknown): value is AvatarType =>\n  typeof value === 'string' && avatarTypes.includes(value as AvatarType);\nexport const avatarTypeConverter = (value: string, defaultValue: AvatarType = 'photo'): AvatarType =>\n  isAvatarType(value) ? value : defaultValue;\n\n/**\n * Configuration object for the Person component\n *\n * @export\n * @interface MgtPersonConfig\n */\nexport interface MgtPersonConfig {\n  /**\n   * Sets or gets whether the person component can use Contacts APIs to\n   * find contacts and their images\n   *\n   * @type {boolean}\n   */\n  useContactApis: boolean;\n}\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nconst activityMap = {\n  Available: 'Available',\n  Away: 'Away',\n  BeRightBack: 'Be right back',\n  Busy: 'Busy',\n  DoNotDisturb: 'Do not disturb',\n  InACall: 'In a call',\n  InAConferenceCall: 'In a conference call',\n  Inactive: 'Inactive',\n  InAMeeting: 'In a meeting',\n  Offline: 'Offline',\n  OffWork: 'Off work',\n  OutOfOffice: 'Out of office',\n  PresenceUnknown: 'Presence unknown',\n  Presenting: 'Presenting',\n  UrgentInterruptionsOnly: 'Urgent interruptions only'\n};\n\nexport const strings = {\n  ...activityMap,\n  photoFor: 'Photo for',\n  emailAddress: 'Email address'\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { ProviderState, Providers, log, error } from '@microsoft/mgt-element';\nimport { getUsersPresenceByPeople } from '../graph/graph.presence';\nimport { Presence } from '@microsoft/microsoft-graph-types';\n\n/**\n * Holds the presence options.\n *\n * @export\n * @interface PresenceConfig\n */\nexport interface PresenceConfig {\n  /**\n   * The maximum time limit before the presence is polled again.\n   *\n   * @type {number}\n   * @memberof PresenceConfig\n   */\n  refresh: number;\n\n  /**\n   * The maximum time limit after a component is registered for it to be queried.\n   *\n   * @type {number}\n   * @memberof PresenceConfig\n   */\n  initial: number;\n}\n\nexport interface PresenceAwareComponent {\n  get presenceId(): string | undefined;\n  onPresenceChange(presence: Presence): void;\n}\n\n/**\n * Class in charge of managing presence across all users and components.\n *\n * @export\n * @class PresenceService\n */\nexport class PresenceService {\n  private static readonly components = new Set<PresenceAwareComponent>();\n  private static initPromise: Promise<void> | null = null;\n  private static registerPromise: (value: unknown) => void;\n  private static isStopped = false;\n\n  private static readonly presenceConfig: PresenceConfig = {\n    initial: 1000,\n    refresh: 30000\n  };\n\n  /**\n   * Returns the presenceConfig object.\n   *\n   * @readonly\n   * @static\n   * @type {PresenceConfig}\n   * @memberof PresenceService\n   */\n  public static get config(): PresenceConfig {\n    return this.presenceConfig;\n  }\n\n  /**\n   * Registers a component with the presence service so that it can receive updates.\n   *\n   * @static\n   * @param {MgtPerson} component\n   * @memberof PresenceService\n   */\n  public static register(component: PresenceAwareComponent) {\n    if (this.initPromise === null || this.initPromise === undefined) {\n      this.initPromise = this.init();\n    }\n\n    // after init, add component\n    this.initPromise.then(\n      () => {\n        setTimeout(() => {\n          if (this.registerPromise) {\n            this.registerPromise(null);\n          }\n        }, this.config.initial);\n        this.components.add(component);\n      },\n      e => error('the PresenceService could not be initialized; presence will not be updated', e)\n    );\n  }\n\n  /**\n   * Unregisters a component with the presence service so that it no longer receives updates.\n   * There is no error if the component was not registered.\n   *\n   * @static\n   * @param {MgtPerson} component\n   * @memberof PresenceService\n   */\n  public static unregister(component: PresenceAwareComponent) {\n    this.components.delete(component);\n  }\n\n  /*\n   * Stops the presence service.\n   *\n   * @static\n   * @memberof PresenceService\n   */\n  public static stop() {\n    this.isStopped = true;\n  }\n\n  /**\n   * Starts a timer for notifying the components of presence updates.\n   *\n   * @private\n   * @static\n   * @memberof PresenceService\n   */\n  private static async init(): Promise<void> {\n    const loop = async () => {\n      while (!this.isStopped) {\n        // wait for next interval\n        const registerPromise = new Promise(resolve => (this.registerPromise = resolve));\n        const timeoutPromise = new Promise(resolve => setTimeout(resolve, this.config.refresh));\n        await Promise.race([registerPromise, timeoutPromise]);\n\n        // get a valid graph provider\n        const provider = Providers.globalProvider;\n        if (!provider || provider.state === ProviderState.Loading || provider.state === ProviderState.SignedOut) {\n          continue;\n        }\n\n        // log attempt\n        log(`updating presence for ${this.components.size} components.`);\n        const presenceByUserId = new Map<string, Presence | undefined>();\n\n        // get full list of users\n        for (const component of this.components) {\n          const id = component.presenceId;\n          if (id && !presenceByUserId.has(id)) {\n            presenceByUserId.set(id, undefined);\n          }\n        }\n\n        // get updated presence for all users\n        const listOfIds: string[] = [];\n        try {\n          const presences = await getUsersPresenceByPeople(\n            provider.graph,\n            Array.from(presenceByUserId.keys()).map(userId => ({ id: userId })),\n            true // bypassCacheRead\n          );\n          if (presences) {\n            for (const presence of Object.values(presences)) {\n              if (presence.id) {\n                presenceByUserId.set(presence.id, presence);\n                listOfIds.push(`${presence.id}=${presence.availability}/${presence.activity}`);\n              }\n            }\n          }\n        } catch (e) {\n          error(`could not update presence`, e);\n          continue;\n        }\n\n        // log results\n        log(`updated presence for ${listOfIds.length} users.`, listOfIds);\n\n        // update components\n        for (const component of this.components) {\n          const id = component.presenceId;\n          if (id) {\n            const presence = presenceByUserId.get(id);\n            if (presence) {\n              component.onPresenceChange(presence);\n            }\n          }\n        }\n      }\n    };\n\n    void loop(); // start loop without waiting for end\n    return Promise.resolve();\n  }\n}\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport {\n  MgtTemplatedTaskComponent,\n  ProviderState,\n  Providers,\n  customElementHelper,\n  mgtHtml\n} from '@microsoft/mgt-element';\nimport { Presence } from '@microsoft/microsoft-graph-types';\nimport { html, TemplateResult, nothing } from 'lit';\nimport { property, state } from 'lit/decorators.js';\nimport { classMap } from 'lit/directives/class-map.js';\nimport { findPeople, getEmailFromGraphEntity } from '../../graph/graph.people';\nimport { getGroupImage, getPersonImage } from '../../graph/graph.photos';\nimport { getUserPresence } from '../../graph/graph.presence';\nimport { findUsers, getMe, getUser } from '../../graph/graph.user';\nimport { getUserWithPhoto } from '../../graph/graph.userWithPhoto';\nimport { AvatarSize, IDynamicPerson, ViewType, viewTypeConverter } from '../../graph/types';\nimport '../../styles/style-helper';\nimport { SvgIcon, getSvg } from '../../utils/SvgHelper';\nimport '../sub-components/mgt-flyout/mgt-flyout';\nimport { MgtFlyout, registerMgtFlyoutComponent } from '../sub-components/mgt-flyout/mgt-flyout';\nimport { type PersonCardInteraction, personCardConverter } from './../PersonCardInteraction';\nimport { styles } from './mgt-person-css';\nimport { MgtPersonConfig, AvatarType, avatarTypeConverter } from './mgt-person-types';\nimport { strings } from './strings';\nimport { isUser, isContact } from '../../graph/entityType';\nimport { ifDefined } from 'lit/directives/if-defined.js';\nimport { buildComponentName, registerComponent } from '@microsoft/mgt-element';\nimport { IExpandable, IHistoryClearer } from '../mgt-person-card/types';\nimport { PresenceService, PresenceAwareComponent } from '../../utils/PresenceService';\n\n/**\n * Person properties part of original set provided by graph by default\n */\nexport const defaultPersonProperties = [\n  'businessPhones',\n  'displayName',\n  'givenName',\n  'jobTitle',\n  'department',\n  'mail',\n  'mobilePhone',\n  'officeLocation',\n  'preferredLanguage',\n  'surname',\n  'userPrincipalName',\n  'id',\n  'userType'\n];\n\nexport const registerMgtPersonComponent = () => {\n  // register self first to avoid infinte loop due to circular ref between person and person card\n  registerComponent('person', MgtPerson);\n\n  registerMgtFlyoutComponent();\n};\n\n/**\n * The person component is used to display a person or contact by using their photo, name, and/or email address.\n *\n * @export\n * @class MgtPerson\n * @extends {MgtTemplatedComponent}\n *\n * @fires {CustomEvent<IDynamicPerson>} line1clicked - Fired when line1 is clicked\n * @fires {CustomEvent<IDynamicPerson>} line2clicked - Fired when line2 is clicked\n * @fires {CustomEvent<IDynamicPerson>} line3clicked - Fired when line3 is clicked\n * @fires {CustomEvent<IDynamicPerson>} line4clicked - Fired when line4 is clicked\n *\n * @cssprop --person-background-color - {Color} the color of the person component background.\n * @cssprop --person-background-border-radius - {Length} the border radius of the person component. Default is 4px.\n *\n * @cssprop --person-avatar-size - {Length} the width and height of the avatar. Default is 24px.\n * @cssprop --person-avatar-border - {String} the border around an avatar. Default is none.\n * @cssprop --person-avatar-border-radius - {String} the radius around the border of an avatar. Default is 50%.\n *\n * @cssprop --person-initials-text-color - {Color} the color of initials in an avatar.\n * @cssprop --person-initials-background-color - {Color} the color of the background in an avatar with initials.\n *\n * @cssprop --person-details-spacing - {Length} the space between the avatar and the person details. Default is 12px.\n *\n * @cssprop --person-line1-font-size - {String} the font-size of the line 1 text. Default is 14px.\n * @cssprop --person-line1-font-weight - {Length} the font weight of the line 1 text. Default is 600.\n * @cssprop --person-line1-text-color - {Color} the color of the line 1 text.\n * @cssprop --person-line1-text-transform - {String} the tex transform of the line 1 text. Default is inherit.\n * @cssprop --person-line1-text-line-height - {Length} the line height of the line 1 text. Default is 20px.\n *\n * @cssprop --person-line2-font-size - {Length} the font-size of the line 2 text. Default is 12px.\n * @cssprop --person-line2-font-weight - {Length} the font weight of the line 2 text. Default is 400.\n * @cssprop --person-line2-text-color - {Color} the color of the line 2 text.\n * @cssprop --person-line2-text-transform - {String} the tex transform of the line 2 text. Default is inherit.\n * @cssprop --person-line2-text-line-height - {Length} the line height of the line 2 text. Default is 16px.\n *\n * @cssprop --person-line3-font-size - {Length} the font-size of the line 3 text. Default is 12px.\n * @cssprop --person-line3-font-weight - {Length} the font weight of the line 3 text. Default is 400.\n * @cssprop --person-line3-text-color - {Color} the color of the line 3 text.\n * @cssprop --person-line3-text-transform - {String} the tex transform of the line 3 text. Default is inherit.\n * @cssprop --person-line3-text-line-height - {Length} the line height of the line 3 text. Default is 16px.\n *\n * @cssprop --person-line4-font-size - {Length} the font-size of the line 4 text. Default is 12px.\n * @cssprop --person-line4-font-weight - {Length} the font weight of the line 4 text. Default is 400.\n * @cssprop --person-line4-text-color - {Color} the color of the line 4 text.\n * @cssprop --person-line4-text-transform - {String} the tex transform of the line 4 text. Default is inherit.\n * @cssprop --person-line4-text-line-height - {Length} the line height of the line 4 text. Default is 16px.\n *\n * @cssprop --person-details-wrapper-width - {Length} the minimum width of the details section. Default is 168px.\n */\nexport class MgtPerson extends MgtTemplatedTaskComponent implements PresenceAwareComponent {\n  /**\n   * Array of styles to apply to the element. The styles should be defined\n   * using the `css` tag function.\n   */\n  static get styles() {\n    return styles;\n  }\n\n  /**\n   * Strings to use for localization\n   *\n   * @readonly\n   * @protected\n   * @memberof MgtPerson\n   */\n  protected get strings() {\n    return strings;\n  }\n\n  /**\n   * Global Configuration object for all\n   * person components\n   *\n   * @static\n   * @type {MgtPersonConfig}\n   * @memberof MgtPerson\n   */\n  public static config: MgtPersonConfig = {\n    useContactApis: true\n  };\n\n  /**\n   * allows developer to define name of person for component\n   *\n   * @type {string}\n   */\n  public get personQuery(): string {\n    return this._personQuery;\n  }\n  @property({\n    attribute: 'person-query'\n  })\n  public set personQuery(value: string) {\n    if (value === this._personQuery) {\n      return;\n    }\n\n    this._personQuery = value;\n    this._personDetails = null;\n    this.personDetailsInternal = null;\n  }\n\n  /**\n   * Fallback when no user is found\n   *\n   * @type {IDynamicPerson}\n   */\n  public get fallbackDetails(): IDynamicPerson {\n    return this._fallbackDetails;\n  }\n  @property({\n    attribute: 'fallback-details',\n    type: Object\n  })\n  public set fallbackDetails(value: IDynamicPerson) {\n    if (value === this._fallbackDetails) {\n      return;\n    }\n\n    this._fallbackDetails = value;\n\n    if (this.personDetailsInternal) {\n      return;\n    }\n  }\n\n  /**\n   * user-id property allows developer to use id value to determine person\n   *\n   * @type {string}\n   */\n  public get userId(): string {\n    return this._userId;\n  }\n  @property({\n    attribute: 'user-id'\n  })\n  public set userId(value: string) {\n    if (value === this._userId) {\n      return;\n    }\n\n    this._userId = value;\n    this.personDetailsInternal = null;\n    this._personDetails = null;\n  }\n\n  /**\n   * usage property allows you to specify where the component is being used to add\n   * customized personalization for it. Currently only supports \"people\" and \"people-picker\" as used in\n   * the people component.\n   *\n   * @type {string}\n   */\n  public get usage(): string {\n    return this._usage;\n  }\n  @property({\n    attribute: 'usage'\n  })\n  public set usage(value: string) {\n    if (value === this._usage) {\n      return;\n    }\n\n    this._usage = value;\n  }\n\n  /**\n   * determines if person component renders presence\n   *\n   * @type {boolean}\n   */\n  @property({\n    attribute: 'show-presence',\n    type: Boolean\n  })\n  public showPresence: boolean;\n\n  /**\n   * determines if person component refreshes presence\n   *\n   * @type {boolean}\n   */\n  @property({\n    attribute: 'disable-presence-refresh',\n    type: Boolean\n  })\n  public disablePresenceRefresh;\n\n  /**\n   * determines person component avatar size and apply presence badge accordingly.\n   * Valid options are 'small', 'large', and 'auto'\n   * Default is \"auto\". When you set the view more than oneline, it will default to \"auto\".\n   *\n   * @type {AvatarSize}\n   */\n  @property({\n    attribute: 'avatar-size',\n    type: String\n  })\n  public avatarSize: AvatarSize;\n\n  /**\n   * object containing Graph details on person\n   * a copy of person-details attribute\n   *\n   * @type {IDynamicPerson}\n   */\n  private get personDetailsInternal(): IDynamicPerson {\n    return this._personDetailsInternal;\n  }\n\n  @state()\n  private set personDetailsInternal(value: IDynamicPerson) {\n    if (this._personDetailsInternal === value) {\n      return;\n    }\n\n    this._personDetailsInternal = value;\n    this._fetchedImage = null;\n    this._fetchedPresence = null;\n  }\n\n  /**\n   * object containing Graph details on person\n   *\n   * @type {IDynamicPerson}\n   */\n  public get personDetails(): IDynamicPerson {\n    return this._personDetails;\n  }\n\n  @property({\n    attribute: 'person-details',\n    type: Object\n  })\n  public set personDetails(value: IDynamicPerson) {\n    if (this._personDetails === value) {\n      return;\n    }\n\n    this._personDetails = value;\n    this._fetchedImage = null;\n    this._fetchedPresence = null;\n  }\n\n  /**\n   * Set the image of the person\n   *\n   * @type {string}\n   * @memberof MgtPersonCard\n   */\n  public get personImage(): string {\n    return this._personImage || this._fetchedImage;\n  }\n  @property({\n    attribute: 'person-image',\n    type: String\n  })\n  public set personImage(value: string) {\n    if (value === this._personImage) {\n      return;\n    }\n\n    this._isInvalidImageSrc = !value;\n    this._personImage = value;\n  }\n\n  /**\n   * Sets whether the person image should be fetched\n   * from the Microsoft Graph based on the personDetailsInternal\n   * provided by the user\n   *\n   * @type {boolean}\n   * @memberof MgtPerson\n   */\n  @property({\n    attribute: 'fetch-image',\n    type: Boolean\n  })\n  public fetchImage: boolean;\n\n  /**\n   * Sets whether to disable the person image fetch\n   * from the Microsoft Graph\n   *\n   * @type {boolean}\n   * @memberof MgtPerson\n   */\n  @property({\n    attribute: 'disable-image-fetch',\n    type: Boolean\n  })\n  public disableImageFetch: boolean;\n\n  /**\n   * Sets the vertical layout of\n   * the Person Card\n   *\n   * @type {boolean}\n   * @memberof MgtPerson\n   */\n  @property({\n    attribute: 'vertical-layout',\n    type: Boolean\n  })\n  public verticalLayout: boolean;\n\n  /**\n   * Determines and sets person avatar view\n   * Valid options are 'photo' or 'initials'\n   *\n   * @type {AvatarType}\n   * @memberof MgtPerson\n   */\n  @property({\n    attribute: 'avatar-type',\n    converter: (value): AvatarType => avatarTypeConverter(value, 'photo')\n  })\n  public avatarType: AvatarType = 'photo';\n\n  /**\n   * Gets or sets presence of person\n   *\n   * @type {MicrosoftGraph.Presence}\n   * @memberof MgtPerson\n   */\n  public get personPresence(): Presence {\n    return this._personPresence || this._fetchedPresence;\n  }\n  @property({\n    attribute: 'person-presence',\n    type: Object\n  })\n  public set personPresence(value: Presence) {\n    if (value === this._personPresence) {\n      return;\n    }\n    this._personPresence = value;\n  }\n\n  /**\n   * Sets how the person-card is invoked\n   * Valid options are: 'none', 'hover', or 'click'\n   * Set to 'none' to not show the card\n   *\n   * @type {PersonCardInteraction}\n   * @memberof MgtPerson\n   */\n  @property({\n    attribute: 'person-card',\n    converter: value => personCardConverter(value)\n  })\n  public personCardInteraction: PersonCardInteraction = 'none';\n\n  /**\n   * Get the scopes required for person\n   *\n   * @static\n   * @return {*}  {string[]}\n   * @memberof MgtPerson\n   */\n  public static get requiredScopes(): string[] {\n    const scopes = ['user.readbasic.all', 'user.read', 'people.read', 'presence.read.all', 'presence.read'];\n\n    if (MgtPerson.config.useContactApis) {\n      scopes.push('contacts.read');\n    }\n\n    return scopes;\n  }\n\n  /**\n   * Gets the flyout element\n   *\n   * @protected\n   * @type {MgtFlyout}\n   * @memberof MgtPerson\n   */\n  protected get flyout(): MgtFlyout {\n    return this.renderRoot.querySelector('.flyout');\n  }\n\n  /**\n   * Sets the property of the personDetailsInternal to use for the first line of text.\n   * Default is displayName.\n   *\n   * @type {string}\n   * @memberof MgtPerson\n   */\n  @property({ attribute: 'line1-property' }) public line1Property: string;\n\n  /**\n   * Sets the property of the personDetailsInternal to use for the second line of text.\n   * Default is mail.\n   *\n   * @type {string}\n   * @memberof MgtPerson\n   */\n  @property({ attribute: 'line2-property' }) public line2Property: string;\n\n  /**\n   * Sets the property of the personDetailsInternal to use for the third line of text.\n   * Default is mail.\n   *\n   * @type {string}\n   * @memberof MgtPerson\n   */\n  @property({ attribute: 'line3-property' }) public line3Property: string;\n\n  /**\n   * Sets the property of the personDetailsInternal to use for the fourth line of text.\n   * Default is mail.\n   *\n   * @type {string}\n   * @memberof MgtPerson\n   */\n  @property({ attribute: 'line4-property' }) public line4Property: string;\n\n  /**\n   * Sets what data to be rendered.\n   * Valid options are 'image', 'oneline', 'twolines', 'threelines', or 'fourlines'\n   * Default is 'image'.\n   *\n   * @type {ViewType}\n   * @memberof MgtPerson\n   */\n  @property({\n    converter: value => viewTypeConverter(value, 'image')\n  })\n  public view: ViewType = 'image';\n\n  @state() private _fetchedImage: string;\n  @state() private _fetchedPresence: Presence;\n  @state() private _isInvalidImageSrc: boolean;\n  @state() private _personCardShouldRender: boolean;\n  @state() private _hasLoadedPersonCard = false;\n\n  private _personDetailsInternal: IDynamicPerson;\n  private _personDetails: IDynamicPerson;\n  private _fallbackDetails: IDynamicPerson;\n  private _personImage: string;\n  private _personPresence: Presence;\n  private _personQuery: string;\n  private _userId: string;\n  private _usage: string;\n\n  private _mouseLeaveTimeout = -1;\n  private _mouseEnterTimeout = -1;\n\n  constructor() {\n    super();\n\n    // defaults\n    this.personCardInteraction = 'none';\n    this.line1Property = 'displayName';\n    this.line2Property = 'jobTitle';\n    this.line3Property = 'department';\n    this.line4Property = 'email';\n    this.view = 'image';\n    this.avatarSize = 'auto';\n    this.disableImageFetch = false;\n    this._isInvalidImageSrc = false;\n    this.avatarType = 'photo';\n    this.verticalLayout = false;\n  }\n\n  /**\n   * Unregisters from presence service if necessary. Note, it does not cause an error\n   * if the component was not registered.\n   *\n   * @memberof MgtAgenda\n   */\n  public disconnectedCallback() {\n    if (this.showPresence && !this.disablePresenceRefresh) {\n      PresenceService.unregister(this);\n    }\n    super.disconnectedCallback();\n  }\n\n  protected readonly renderContent = () => {\n    // Prep data\n    const person = this.personDetails || this.personDetailsInternal || this.fallbackDetails;\n    const image = this.getImage();\n    const presence = this.personPresence || this._fetchedPresence;\n\n    if (!person && !image) {\n      return this.renderNoData();\n    }\n    if (!person?.personImage && image) {\n      person.personImage = image;\n    }\n\n    // Default template\n    let personTemplate = this.renderTemplate('default', { person, personImage: image, personPresence: presence });\n\n    if (!personTemplate) {\n      const detailsTemplate: TemplateResult = this.renderDetails(person, presence);\n      const imageWithPresenceTemplate: TemplateResult = this.renderAvatar(person, image, presence);\n\n      personTemplate = html`\n        ${imageWithPresenceTemplate}\n        ${detailsTemplate}\n      `;\n    }\n\n    const showPersonCard = this.personCardInteraction !== 'none';\n    if (showPersonCard) {\n      personTemplate = this.renderFlyout(personTemplate, person, image, presence);\n    }\n\n    const rootClasses = classMap({\n      'person-root': true,\n      small: !this.isThreeLines() && !this.isFourLines() && !this.isLargeAvatar(),\n      large: this.avatarSize !== 'auto' && this.isLargeAvatar(),\n      noline: this.isNoLine(),\n      oneline: this.isOneLine(),\n      twolines: this.isTwoLines(),\n      threelines: this.isThreeLines(),\n      fourlines: this.isFourLines(),\n      vertical: this.isVertical()\n    });\n\n    return html`\n      <div\n        class=\"${rootClasses}\"\n        dir=${this.direction}\n        @click=${this.handleMouseClick}\n        @mouseenter=${this.handleMouseEnter}\n        @mouseleave=${this.handleMouseLeave}\n        @keydown=${this.handleKeyDown}\n        tabindex=\"${ifDefined(this.personCardInteraction !== 'none' ? '0' : undefined)}\"\n      >\n        ${personTemplate}\n      </div>\n    `;\n  };\n\n  /**\n   * Render the loading state\n   *\n   * @protected\n   * @returns {TemplateResult}\n   * @memberof MgtPerson\n   */\n  protected renderLoading = (): TemplateResult => {\n    const loadingTemplate = this.renderTemplate('loading', null);\n    if (loadingTemplate) {\n      return loadingTemplate;\n    }\n\n    const avatarClasses = {\n      'avatar-icon': true,\n      vertical: this.isVertical(),\n      small: !this.isLargeAvatar(),\n      threeLines: this.isThreeLines(),\n      fourLines: this.isFourLines()\n    };\n\n    return html`\n      <i class=${classMap(avatarClasses)} icon='loading'>${this.renderLoadingIcon()}</i>\n    `;\n  };\n\n  /**\n   * Clears state of the component\n   *\n   * @protected\n   * @memberof MgtPerson\n   */\n  protected clearState(): void {\n    this._personImage = '';\n    this._personDetailsInternal = null;\n    this._fetchedImage = null;\n    this._fetchedPresence = null;\n  }\n\n  /**\n   * Render the state when no data is available\n   *\n   * @protected\n   * @returns {TemplateResult}\n   * @memberof MgtPerson\n   */\n  protected renderNoData(): TemplateResult {\n    const noDataTemplate = this.renderTemplate('no-data', null);\n    if (noDataTemplate) {\n      return noDataTemplate;\n    }\n\n    const avatarClasses = {\n      'avatar-icon': true,\n      vertical: this.isVertical(),\n      small: !this.isLargeAvatar(),\n      noline: this.isNoLine(),\n      oneline: this.isOneLine(),\n      twolines: this.isTwoLines(),\n      threelines: this.isThreeLines(),\n      fourlines: this.isFourLines()\n    };\n\n    return html`\n      <i class=${classMap(avatarClasses)} icon='no-data'>${this.renderPersonIcon()}</i>\n    `;\n  }\n\n  /**\n   * Render a loading icon.\n   *\n   * @protected\n   * @returns\n   * @memberof MgtPerson\n   */\n  protected renderLoadingIcon() {\n    return getSvg(SvgIcon.Loading);\n  }\n\n  /**\n   * Render a person icon.\n   *\n   * @protected\n   * @returns\n   * @memberof MgtPerson\n   */\n  protected renderPersonIcon() {\n    return getSvg(SvgIcon.Person);\n  }\n\n  /**\n   * Render the image part of the person template.\n   * If the image is unavailable, the person's initials will be used instead.\n   *\n   * @protected\n   * @param {string} [imageSrc]\n   * @param {IDynamicPerson} [personDetailsInternal]\n   * @returns\n   * @memberof MgtPerson\n   */\n  protected renderImage(personDetailsInternal: IDynamicPerson, imageSrc: string) {\n    const altText = `${this.strings.photoFor} ${personDetailsInternal.displayName}`;\n    const hasImage = imageSrc && !this._isInvalidImageSrc && this.avatarType === 'photo';\n    const imageOnly = this.avatarType === 'photo' && this.view === 'image';\n    const titleText =\n      (personDetailsInternal?.displayName ||\n        `${this.strings.emailAddress} ${getEmailFromGraphEntity(personDetailsInternal)}`) ??\n      undefined;\n    const imageTemplate = html`<img\n      title=\"${ifDefined(imageOnly ? titleText : undefined)}\"\n      alt=${altText}\n      src=${imageSrc}\n      @error=${() => (this._isInvalidImageSrc = true)} />`;\n\n    const initials = personDetailsInternal ? this.getInitials(personDetailsInternal) : '';\n    const hasInitials = initials?.length;\n    const textClasses = classMap({\n      initials: hasInitials && !hasImage,\n      'contact-icon': !hasInitials\n    });\n    const contactIconTemplate = html`<i>${this.renderPersonIcon()}</i>`;\n    // consider the image to presentational if the view is anything other than image.\n    // this reduces the redundant announcement of the user's name.\n    const textTemplate = html`\n      <span \n        title=\"${ifDefined(this.view === 'image' ? titleText : undefined)}\"\n        role=\"${ifDefined(this.view === 'image' ? undefined : 'presentation')}\"\n        class=\"${textClasses}\"\n      >\n        ${hasInitials ? initials : contactIconTemplate}\n      </span>\n`;\n    if (hasImage) {\n      this.fireCustomEvent('person-image-rendered');\n    } else {\n      this.fireCustomEvent('person-icon-rendered');\n    }\n\n    return hasImage ? imageTemplate : textTemplate;\n  }\n\n  /**\n   * Render presence for the person.\n   *\n   * @param presence\n   * @memberof MgtPerson\n   * @returns\n   */\n  protected renderPresence(presence: Presence): TemplateResult {\n    if (!this.showPresence || !presence) {\n      return html``;\n    }\n    let presenceIcon: TemplateResult;\n\n    const { activity, availability } = presence;\n    switch (availability) {\n      case 'Available':\n      case 'AvailableIdle':\n        switch (activity) {\n          case 'OutOfOffice':\n            presenceIcon = getSvg(SvgIcon.PresenceOofAvailable);\n            break;\n          // OutOfOffice and Uknowns\n          case 'Available':\n          default:\n            presenceIcon = getSvg(SvgIcon.PresenceAvailable);\n            break;\n        }\n        break;\n      case 'Busy':\n      case 'BusyIdle':\n        switch (activity) {\n          case 'OutOfOffice':\n          case 'OnACall':\n            presenceIcon = getSvg(SvgIcon.PresenceOofBusy);\n            break;\n          // Busy,InACall,InAConferenceCall,InAMeeting, Unknown\n          case 'Busy':\n          case 'InACall':\n          case 'InAMeeting':\n          case 'InAConferenceCall':\n          default:\n            presenceIcon = getSvg(SvgIcon.PresenceBusy);\n            break;\n        }\n        break;\n      case 'DoNotDisturb':\n        switch (activity) {\n          case 'OutOfOffice':\n            presenceIcon = getSvg(SvgIcon.PresenceOofDnd);\n            break;\n          case 'Presenting':\n          case 'Focusing':\n          case 'UrgentInterruptionsOnly':\n          default:\n            presenceIcon = getSvg(SvgIcon.PresenceDnd);\n            break;\n        }\n        break;\n\n      case 'Away':\n        switch (activity) {\n          case 'OutOfOffice':\n            presenceIcon = getSvg(SvgIcon.PresenceOofAway);\n            break;\n          case 'AwayLastSeenTime':\n          default:\n            presenceIcon = getSvg(SvgIcon.PresenceAway);\n            break;\n        }\n        break;\n      case 'BeRightBack':\n        switch (activity) {\n          default:\n            presenceIcon = getSvg(SvgIcon.PresenceAway);\n            break;\n        }\n        break;\n      case 'Offline':\n        switch (activity) {\n          case 'Offline':\n            presenceIcon = getSvg(SvgIcon.PresenceOffline);\n            break;\n          case 'OutOfOffice':\n          case 'OffWork':\n            presenceIcon = getSvg(SvgIcon.PresenceOofAway);\n            break;\n          default:\n            presenceIcon = getSvg(SvgIcon.PresenceStatusUnknown);\n            break;\n        }\n        break;\n      default:\n        presenceIcon = getSvg(SvgIcon.PresenceStatusUnknown);\n        break;\n    }\n\n    const presenceWrapperClasses = classMap({\n      'presence-wrapper': true,\n      noline: this.isNoLine(),\n      oneline: this.isOneLine()\n    });\n\n    const formattedActivity = (this.strings[activity] as string) ?? nothing;\n\n    return html`\n      <span\n        class=\"${presenceWrapperClasses}\"\n        title=\"${formattedActivity}\"\n        aria-label=\"${formattedActivity}\"\n        role=\"img\">\n          ${presenceIcon}\n      </span>\n    `;\n  }\n\n  /**\n   * Render image with presence for the person.\n   *\n   * @protected\n   * @param\n   * @memberof MgtPersonCard\n   */\n  protected renderAvatar(personDetailsInternal: IDynamicPerson, image: string, presence: Presence): TemplateResult {\n    const imageTemplate: TemplateResult = this.renderImage(personDetailsInternal, image);\n    const presenceTemplate: TemplateResult = this.renderPresence(presence);\n\n    return html`\n      <div class=\"avatar-wrapper\">\n        ${imageTemplate}\n        ${presenceTemplate}\n      </div>\n    `;\n  }\n\n  private handleLine1Clicked() {\n    this.fireCustomEvent('line1clicked', this.personDetailsInternal);\n  }\n\n  private handleLine2Clicked() {\n    this.fireCustomEvent('line2clicked', this.personDetailsInternal);\n  }\n\n  private handleLine3Clicked() {\n    this.fireCustomEvent('line3clicked', this.personDetailsInternal);\n  }\n\n  private handleLine4Clicked() {\n    this.fireCustomEvent('line4clicked', this.personDetailsInternal);\n  }\n\n  /**\n   * Render the details part of the person template.\n   *\n   * @param personProps\n   * @param presence\n   * @memberof MgtPerson\n   * @returns\n   */\n  protected renderDetails(personProps: IDynamicPerson, presence?: Presence): TemplateResult {\n    if (!personProps || this.view === 'image') {\n      return html``;\n    }\n\n    const person: IDynamicPerson & { presenceActivity?: string; presenceAvailability?: string } = personProps;\n    if (presence) {\n      person.presenceActivity = presence?.activity;\n      person.presenceAvailability = presence?.availability;\n    }\n\n    const details: TemplateResult[] = [];\n\n    // we already returned on image, so we must have a first line\n    const line1text = this.getTextFromProperty(person, this.line1Property);\n    if (this.hasTemplate('line1')) {\n      // Render the line1 template\n      const template = this.renderTemplate('line1', { person });\n      details.push(html`\n           <div class=\"line1\" part=\"detail-line\" @click=${() =>\n             this.handleLine1Clicked()} role=\"presentation\" aria-label=\"${line1text}\">${template}</div>\n         `);\n    } else {\n      // Render the line1 property value\n      if (line1text) {\n        details.push(html`\n             <div class=\"line1\" part=\"detail-line\" @click=${() =>\n               this.handleLine1Clicked()} role=\"presentation\" aria-label=\"${line1text}\">${line1text}</div>\n           `);\n      }\n    }\n\n    // if we have more than one line we add the second line\n    if (this.view !== 'oneline') {\n      const text = this.getTextFromProperty(person, this.line2Property);\n      if (this.hasTemplate('line2')) {\n        // Render the line2 template\n        const template = this.renderTemplate('line2', { person });\n        details.push(html`\n           <div class=\"line2\" part=\"detail-line\" @click=${() =>\n             this.handleLine2Clicked()} role=\"presentation\" aria-label=\"${text}\">${template}</div>\n         `);\n      } else {\n        // Render the line2 property value\n        if (text) {\n          details.push(html`\n             <div class=\"line2\" part=\"detail-line\" @click=${() =>\n               this.handleLine2Clicked()} role=\"presentation\" aria-label=\"${text}\">${text}</div>\n           `);\n        }\n      }\n    }\n\n    // if we have a third or fourth line we add the third line\n    if (this.view === 'threelines' || this.view === 'fourlines') {\n      const text = this.getTextFromProperty(person, this.line3Property);\n      if (this.hasTemplate('line3')) {\n        // Render the line3 template\n        const template = this.renderTemplate('line3', { person });\n        details.push(html`\n           <div class=\"line3\" part=\"detail-line\" @click=${() =>\n             this.handleLine3Clicked()} role=\"presentation\" aria-label=\"${text}\">${template}</div>\n         `);\n      } else {\n        // Render the line3 property value\n        if (text) {\n          details.push(html`\n             <div class=\"line3\" part=\"detail-line\" @click=${() =>\n               this.handleLine3Clicked()} role=\"presentation\" aria-label=\"${text}\">${text}</div>\n           `);\n        }\n      }\n    }\n\n    // add the fourth line if necessary\n    if (this.view === 'fourlines') {\n      const text = this.getTextFromProperty(person, this.line4Property);\n      if (this.hasTemplate('line4')) {\n        // Render the line4 template\n        const template = this.renderTemplate('line4', { person });\n        details.push(html`\n          <div class=\"line4\" part=\"detail-line\" @click=${() =>\n            this.handleLine4Clicked()} role=\"presentation\" aria-label=\"${text}\">${template}</div>\n        `);\n      } else {\n        // Render the line4 property value\n        if (text) {\n          details.push(html`\n            <div class=\"line4\" part=\"detail-line\" @click=${() =>\n              this.handleLine4Clicked()} role=\"presentation\" aria-label=\"${text}\">${text}</div>\n          `);\n        }\n      }\n    }\n\n    const detailsClasses = classMap({\n      'details-wrapper': true,\n      vertical: this.isVertical()\n    });\n\n    return html`\n      <div class=\"${detailsClasses}\">\n        ${details}\n      </div>\n    `;\n  }\n\n  /**\n   * Render the details flyout.\n   *\n   * @protected\n   * @returns {TemplateResult}\n   * @memberof MgtPerson\n   */\n  protected renderFlyout(\n    anchor: TemplateResult,\n    personDetails: IDynamicPerson,\n    image: string,\n    presence: Presence\n  ): TemplateResult {\n    const flyoutContent =\n      this._personCardShouldRender && this._hasLoadedPersonCard\n        ? html`\n           <div slot=\"flyout\" data-testid=\"flyout-slot\">\n             ${this.renderFlyoutContent(personDetails, image, presence)}\n           </div>`\n        : html``;\n\n    const slotClasses = classMap({\n      small: !this.isThreeLines() && !this.isFourLines() && !this.isLargeAvatar(),\n      large: this.avatarSize !== 'auto' && this.isLargeAvatar(),\n      noline: this.isNoLine(),\n      oneline: this.isOneLine(),\n      twolines: this.isTwoLines(),\n      threelines: this.isThreeLines(),\n      fourlines: this.isFourLines(),\n      vertical: this.isVertical()\n    });\n\n    return mgtHtml`\n      <mgt-flyout light-dismiss class=\"flyout\" .avoidHidingAnchor=${false}>\n        <div slot=\"anchor\" class=\"${slotClasses}\">${anchor}</div>\n        ${flyoutContent}\n      </mgt-flyout>`;\n  }\n\n  /**\n   * Render the flyout menu content.\n   *\n   * @protected\n   * @returns {TemplateResult}\n   * @memberof MgtPerson\n   */\n  protected renderFlyoutContent(personDetails: IDynamicPerson, image: string, presence: Presence): TemplateResult {\n    this.fireCustomEvent('flyout-content-rendered');\n    return (\n      this.renderTemplate('person-card', { person: personDetails, personImage: image }) ||\n      mgtHtml`\n        <mgt-person-card\n          class=\"mgt-person-card\"\n          lock-tab-navigation\n          .personDetails=${personDetails}\n          .personImage=${image}\n          .personPresence=${presence}\n          .showPresence=${this.showPresence}>\n        </mgt-person-card>`\n    );\n  }\n\n  protected args() {\n    return [\n      this.providerState,\n      this.verticalLayout,\n      this.view,\n      this.fallbackDetails,\n      this.line1Property,\n      this.line2Property,\n      this.line3Property,\n      this.line4Property,\n      this.fetchImage,\n      this.avatarType,\n      this.userId,\n      this.personQuery,\n      this.disableImageFetch,\n      this.showPresence,\n      this.personDetails\n    ];\n  }\n\n  /**\n   * load state into the component.\n   *\n   * @protected\n   * @returns\n   * @memberof MgtPerson\n   */\n  protected async loadState() {\n    const provider = Providers.globalProvider;\n    if (!provider || provider.state === ProviderState.Loading) {\n      return;\n    }\n\n    if (provider && provider.state === ProviderState.SignedOut) {\n      this.personDetailsInternal = null;\n      return;\n    }\n\n    const graph = provider.graph.forComponent(this);\n\n    if ((this.verticalLayout && this.view !== 'fourlines') || this.fallbackDetails) {\n      this.line2Property = 'email';\n    }\n\n    // Prepare person props\n    let personProps = [\n      ...defaultPersonProperties,\n      this.line1Property,\n      this.line2Property,\n      this.line3Property,\n      this.line4Property\n    ];\n    personProps = personProps.filter(email => email !== 'email');\n\n    let details = this.personDetailsInternal || this.personDetails;\n    if (details) {\n      if (\n        !details.personImage &&\n        this.fetchImage &&\n        this.avatarType === 'photo' &&\n        !this.personImage &&\n        !this._fetchedImage\n      ) {\n        let image: string;\n        if ('groupTypes' in details) {\n          image = await getGroupImage(graph, details);\n        } else {\n          image = await getPersonImage(graph, details, MgtPerson.config.useContactApis);\n        }\n        if (image) {\n          details.personImage = image;\n          this._fetchedImage = image;\n        }\n      }\n    } else if (this.userId || this.personQuery === 'me') {\n      // Use userId or 'me' query to get the person and image\n      let person: IDynamicPerson;\n      if (this.avatarType === 'photo' && !this.disableImageFetch) {\n        person = await getUserWithPhoto(graph, this.userId, personProps);\n      } else {\n        if (this.personQuery === 'me') {\n          person = await getMe(graph, personProps);\n        } else {\n          person = await getUser(graph, this.userId, personProps);\n        }\n      }\n      this.personDetailsInternal = person;\n      this.personDetails = person;\n      this._fetchedImage = this.getImage();\n    } else if (this.personQuery) {\n      // Use the personQuery to find our person.\n      let people = await findPeople(graph, this.personQuery, 1);\n\n      if (!people || people.length === 0) {\n        people = (await findUsers(graph, this.personQuery, 1)) || [];\n      }\n\n      if (people?.length) {\n        this.personDetailsInternal = people[0];\n        this.personDetails = people[0];\n        if (this.avatarType === 'photo' && !this.disableImageFetch) {\n          const image = await getPersonImage(graph, people[0], MgtPerson.config.useContactApis);\n\n          if (image) {\n            this.personDetailsInternal.personImage = image;\n            this.personDetails.personImage = image;\n            this._fetchedImage = image;\n          }\n        }\n      }\n    }\n\n    details = this.personDetailsInternal || this.personDetails || this.fallbackDetails;\n\n    const defaultPresence: Presence = {\n      activity: 'Offline',\n      availability: 'Offline',\n      id: null\n    };\n\n    if (this.showPresence && !this.disablePresenceRefresh) {\n      this._fetchedPresence = defaultPresence;\n      PresenceService.register(this);\n    } else if (this.showPresence && !this.personPresence && !this._fetchedPresence) {\n      try {\n        if (details) {\n          // setting userId to 'me' ensures only the presence.read permission is required\n          const userId = this.personQuery !== 'me' ? details?.id : null;\n          this._fetchedPresence = await getUserPresence(graph, userId);\n        } else {\n          this._fetchedPresence = defaultPresence;\n        }\n      } catch (_) {\n        // set up a default Presence in case beta api changes or getting error code\n        this._fetchedPresence = defaultPresence;\n      }\n    }\n  }\n\n  /**\n   * Gets the user initials\n   *\n   * @protected\n   * @returns {string}\n   * @memberof MgtPerson\n   */\n  protected getInitials(person?: IDynamicPerson): string {\n    if (!person) {\n      person = this.personDetailsInternal;\n    }\n\n    if (isContact(person)) {\n      return person.initials;\n    }\n\n    let initials = '';\n    if (isUser(person)) {\n      initials += person.givenName?.[0]?.toUpperCase() ?? '';\n      initials += person.surname?.[0]?.toUpperCase() ?? '';\n    }\n\n    if (!initials && person.displayName) {\n      const name = person.displayName.split(/\\s+/);\n      for (let i = 0; i < 2 && i < name.length; i++) {\n        if (name[i][0] && this.isLetter(name[i][0])) {\n          initials += name[i][0].toUpperCase();\n        }\n      }\n    }\n\n    return initials;\n  }\n\n  private getImage(): string {\n    if (this.personImage) {\n      return this.personImage;\n    }\n\n    if (this._fetchedImage) {\n      return this._fetchedImage;\n    }\n\n    const person = this.personDetailsInternal || this.personDetails;\n    return person?.personImage ? person.personImage : null;\n  }\n\n  private isLetter(char: string) {\n    try {\n      return char.match(new RegExp('\\\\p{L}', 'u'));\n    } catch (e) {\n      return char.toLowerCase() !== char.toUpperCase();\n    }\n  }\n\n  private getTextFromProperty(personDetailsInternal: IDynamicPerson, prop: string): string {\n    if (!prop || prop.length === 0) {\n      return null;\n    }\n\n    const properties = prop.trim().split(',');\n    let text: string;\n    let i = 0;\n\n    while (!text && i < properties.length) {\n      const currentProp = properties[i].trim();\n      switch (currentProp) {\n        case 'mail':\n        case 'email':\n          text = getEmailFromGraphEntity(personDetailsInternal);\n          break;\n        default:\n          text = personDetailsInternal[currentProp] as string;\n      }\n      i++;\n    }\n\n    return text;\n  }\n\n  private isLargeAvatar() {\n    return (\n      this.avatarSize === 'large' || (this.avatarSize === 'auto' && this.view !== 'image' && this.view !== 'oneline')\n    );\n  }\n\n  private isNoLine() {\n    return this.view === 'image';\n  }\n\n  private isOneLine() {\n    return this.view === 'oneline';\n  }\n\n  private isTwoLines() {\n    return this.view === 'twolines';\n  }\n\n  private isThreeLines() {\n    return this.view === 'threelines';\n  }\n\n  private isFourLines() {\n    return this.view === 'fourlines';\n  }\n\n  private isVertical() {\n    return this.verticalLayout;\n  }\n\n  private readonly handleMouseClick = (e: MouseEvent) => {\n    const element = e.target as HTMLElement;\n    // todo: fix for disambiguation\n    if (\n      this.personCardInteraction === 'click' &&\n      element.tagName !== `${customElementHelper.prefix}-PERSON-CARD`.toUpperCase()\n    ) {\n      this.showPersonCard();\n    }\n  };\n\n  private readonly handleKeyDown = (e: KeyboardEvent) => {\n    // enter activates person-card\n    if (e) {\n      if (e.key === 'Enter') {\n        this.showPersonCard();\n      }\n    }\n  };\n\n  private readonly handleMouseEnter = () => {\n    clearTimeout(this._mouseEnterTimeout);\n    clearTimeout(this._mouseLeaveTimeout);\n    if (this.personCardInteraction !== 'hover') {\n      return;\n    }\n    this._mouseEnterTimeout = window.setTimeout(this.showPersonCard, 500);\n  };\n\n  private readonly handleMouseLeave = () => {\n    clearTimeout(this._mouseEnterTimeout);\n    clearTimeout(this._mouseLeaveTimeout);\n    this._mouseLeaveTimeout = window.setTimeout(this.hidePersonCard, 500);\n  };\n\n  /**\n   * hides the person card\n   *\n   * @memberof MgtPerson\n   */\n  public hidePersonCard = () => {\n    const flyout = this.flyout;\n    if (flyout) {\n      flyout.close();\n    }\n    const personCard =\n      this.querySelector<Element & IExpandable & IHistoryClearer>('.mgt-person-card') ||\n      this.renderRoot.querySelector('.mgt-person-card');\n    if (personCard) {\n      personCard.isExpanded = false;\n      personCard.clearHistory();\n    }\n  };\n\n  private readonly loadPersonCardResources = async () => {\n    // if there could be a person-card then we should load those resources using a dynamic import\n    if (this.personCardInteraction !== 'none' && !this._hasLoadedPersonCard) {\n      const { registerMgtPersonCardComponent } = await import('../mgt-person-card/mgt-person-card');\n\n      // only register person card if it hasn't been registered yet\n      if (!customElements.get(buildComponentName('person-card'))) registerMgtPersonCardComponent();\n\n      this._hasLoadedPersonCard = true;\n    }\n  };\n\n  public showPersonCard = () => {\n    if (!this._personCardShouldRender) {\n      this._personCardShouldRender = true;\n      void this.loadPersonCardResources();\n    }\n\n    const flyout = this.flyout;\n    if (flyout) {\n      flyout.open();\n    }\n  };\n\n  /**\n   * gets the id of the person that presence updates are needed for\n   *\n   * @memberof MgtPerson\n   * @implements {PresenceAwareComponent}\n   * @returns {string | undefined}\n   **/\n  public get presenceId(): string | undefined {\n    return this.personDetailsInternal?.id || this.personDetails?.id || this.fallbackDetails?.id;\n  }\n\n  /**\n   * fires when the presence for the user is changed\n   *\n   * @memberof MgtPerson\n   * @implements {PresenceAwareComponent}\n   * @param {Presence} [presence]\n   **/\n  public onPresenceChange(presence: Presence): void {\n    this.personPresence = presence;\n  }\n}\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * An object containing width, height, top and left properties (aka segment's bounding rects)\n *\n * @interface IWindowSegment\n */\nexport interface IWindowSegment {\n  top: number;\n  left: number;\n  width: number;\n  height: number;\n}\n\n/**\n * An interface that defines the Window Segments Enumeration API.\n *\n * @interface SegmentAwareWindow\n */\nexport interface ISegmentAwareWindow extends Window {\n  /**\n   * Returns an array of screen segments.\n   *\n   * @returns {*}\n   * @memberof SegmentAwareWindow\n   */\n  getWindowSegments(): IWindowSegment[];\n}\n\n/**\n * Responds whether or not the Window object supports the Window Segments Enumeration API.\n *\n * @export\n * @returns {boolean}\n */\nexport const isWindowSegmentAware = (): boolean => {\n  return (window as unknown as ISegmentAwareWindow).getWindowSegments !== undefined;\n};\n\n/**\n * Returns an ISegmentAwareWindow instance of the Window object, or null if the API is not supported.\n *\n * @export\n * @returns {ISegmentAwareWindow}\n */\nexport const getSegmentAwareWindow = (): ISegmentAwareWindow => {\n  return isWindowSegmentAware() ? (window as unknown as ISegmentAwareWindow) : null;\n};\n","// THIS FILE IS AUTO GENERATED\n// ANY CHANGES WILL BE LOST DURING BUILD\n// MODIFY THE .SCSS FILE INSTEAD\n\nimport { css, CSSResult } from 'lit';\n/**\n * exports lit-element css\n * @export styles\n */\nexport const styles: CSSResult[] = [\n  css`\n.root .scout-top{position:fixed;top:0;left:0}.root .scout-bottom{position:fixed;bottom:0;right:0}.root .flyout{display:none;position:fixed;z-index:9999999;opacity:0;box-shadow:var(--mgt-flyout-box-shadow,var(--elevation-shadow-card-rest));border-radius:8px}.root .flyout.small{overflow:hidden auto}.root.visible .flyout{display:inline-block;animation-name:fade-in;animation-duration:.3s;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;transition:top .3s ease,bottom .3s ease,left .3s ease;z-index:9999999}.root.visible .flyout.small{overflow:hidden auto}@keyframes fade-in{from{opacity:0;margin-top:-10px;margin-bottom:-10px}to{opacity:1;margin-top:0;margin-bottom:0}}\n`];","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { html, PropertyValues, TemplateResult } from 'lit';\nimport { property } from 'lit/decorators.js';\nimport { classMap } from 'lit/directives/class-map.js';\nimport { getSegmentAwareWindow, isWindowSegmentAware, IWindowSegment } from '../../../utils/WindowSegmentHelpers';\nimport { styles } from './mgt-flyout-css';\nimport { MgtBaseTaskComponent } from '@microsoft/mgt-element/';\nimport { registerComponent } from '@microsoft/mgt-element';\n\nexport const registerMgtFlyoutComponent = () => registerComponent('flyout', MgtFlyout);\n\n/**\n * A component to create flyout anchored to an element\n *\n * @export\n * @class MgtFlyout\n * @extends {LitElement}\n */\nexport class MgtFlyout extends MgtBaseTaskComponent {\n  /**\n   * Array of styles to apply to the element. The styles should be defined\n   * using the `css` tag function.\n   */\n  static get styles() {\n    return styles;\n  }\n\n  /**\n   * Gets or sets whether the flyout is light dismissible.\n   *\n   * @type {boolean}\n   * @memberof MgtFlyout\n   */\n  @property({\n    attribute: 'light-dismiss',\n    type: Boolean\n  })\n  public isLightDismiss: boolean;\n\n  /**\n   * Gets or sets whether the flyout should avoid rendering the flyout\n   * on top of the anchor\n   *\n   * @type {boolean}\n   * @memberof MgtFlyout\n   */\n  @property({\n    attribute: null,\n    type: Boolean\n  })\n  public avoidHidingAnchor: boolean;\n\n  /**\n   * Gets or sets whether the flyout is visible\n   *\n   * @type {string}\n   * @memberof MgtFlyout\n   */\n  @property({\n    attribute: 'isOpen',\n    type: Boolean\n  })\n  public get isOpen(): boolean {\n    return this._isOpen;\n  }\n  public set isOpen(value: boolean) {\n    const oldValue = this._isOpen;\n    if (oldValue === value) {\n      return;\n    }\n\n    this._isOpen = value;\n\n    window.requestAnimationFrame(() => {\n      this.setupWindowEvents(this.isOpen);\n      const flyout = this._flyout;\n      if (!this.isOpen && flyout) {\n        // reset style for next update\n        flyout.style.width = null;\n        flyout.style.setProperty('--mgt-flyout-set-width', null);\n        flyout.style.setProperty('--mgt-flyout-set-height', null);\n        flyout.style.maxHeight = null;\n        flyout.style.top = null;\n        flyout.style.left = null;\n        flyout.style.bottom = null;\n      }\n    });\n\n    this.requestUpdate('isOpen', oldValue);\n    this.dispatchEvent(new Event(value ? 'opened' : 'closed'));\n  }\n\n  // Minimum distance to render from window edge\n  private get _edgePadding() {\n    return 24;\n  }\n\n  // if the flyout is opened once, this will keep the flyout in the dom\n  private _renderedOnce = false;\n\n  private get _flyout(): HTMLElement {\n    return this.renderRoot.querySelector('.flyout');\n  }\n\n  private get _anchor(): HTMLElement {\n    return this.renderRoot.querySelector('.anchor');\n  }\n\n  private get _topScout(): HTMLElement {\n    return this.renderRoot.querySelector('.scout-top');\n  }\n\n  private get _bottomScout(): HTMLElement {\n    return this.renderRoot.querySelector('.scout-bottom');\n  }\n\n  private _isOpen = false;\n  private _smallView = false;\n  private _windowHeight: number;\n\n  constructor() {\n    super();\n\n    this.avoidHidingAnchor = true;\n\n    // handling when person-card is expanded and size changes\n    this.addEventListener('expanded', () => {\n      window.requestAnimationFrame(() => {\n        this.updateFlyout();\n      });\n    });\n  }\n\n  /**\n   * Show the flyout.\n   */\n  public open(): void {\n    this.isOpen = true;\n  }\n\n  /**\n   * Close the flyout.\n   */\n  public close(): void {\n    this.isOpen = false;\n  }\n\n  /**\n   * Invoked each time the custom element is disconnected from the document's DOM\n   *\n   * @memberof MgtFlyout\n   */\n  public disconnectedCallback() {\n    this.setupWindowEvents(false);\n    super.disconnectedCallback();\n  }\n\n  /**\n   * Invoked whenever the element is updated. Implement to perform\n   * post-updating tasks via DOM APIs, for example, focusing an element.\n   *\n   * Setting properties inside this method will trigger the element to update\n   * again after this update cycle completes.\n   *\n   * @param changedProperties Map of changed properties with old values\n   */\n  protected updated(changedProps: PropertyValues) {\n    super.updated(changedProps);\n\n    window.requestAnimationFrame(() => {\n      this.updateFlyout();\n    });\n  }\n\n  /**\n   * Invoked on each update to perform rendering tasks. This method must return\n   * a lit-html TemplateResult. Setting properties inside this method will *not*\n   * trigger the element to update.\n   */\n  protected render() {\n    const flyoutClasses = {\n      root: true,\n      visible: this.isOpen\n    };\n\n    const anchorTemplate = this.renderAnchor();\n    let flyoutTemplate = null;\n    this._windowHeight =\n      window.innerHeight && document.documentElement.clientHeight\n        ? Math.min(window.innerHeight, document.documentElement.clientHeight)\n        : window.innerHeight || document.documentElement.clientHeight;\n\n    if (this._windowHeight < 250) {\n      this._smallView = true;\n    }\n\n    if (this.isOpen || this._renderedOnce) {\n      this._renderedOnce = true;\n      const smallFlyoutClasses = classMap({\n        flyout: true,\n        small: this._smallView\n      });\n      flyoutTemplate = html`\n        <div class=${smallFlyoutClasses} @wheel=${this.handleFlyoutWheel}>\n          ${this.renderFlyout()}\n        </div>\n      `;\n    }\n\n    return html`\n      <div class=${classMap(flyoutClasses)}>\n        <div class=\"anchor\">\n          ${anchorTemplate}\n        </div>\n        <div class=\"scout-top\"></div>\n        <div class=\"scout-bottom\"></div>\n        ${flyoutTemplate}\n      </div>\n    `;\n  }\n\n  /**\n   * Renders the anchor content.\n   *\n   * @protected\n   * @returns\n   * @memberof MgtFlyout\n   */\n  protected renderAnchor(): TemplateResult {\n    return html`\n      <slot name=\"anchor\"></slot>\n    `;\n  }\n\n  /**\n   * Renders the flyout.\n   */\n  protected renderFlyout(): TemplateResult {\n    return html`\n      <slot name=\"flyout\"></slot>\n    `;\n  }\n\n  /**\n   * Updates the position of the flyout.\n   * Makes a second recursive call to ensure the flyout is positioned correctly.\n   * This is needed as the width of the flyout is not settled until after the first render.\n   *\n   * @private\n   * @param {boolean} [firstPass=true]\n   * @return {*}\n   * @memberof MgtFlyout\n   */\n  private updateFlyout(firstPass = true) {\n    if (!this.isOpen) {\n      return;\n    }\n\n    const anchor = this._anchor;\n    const flyout = this._flyout;\n\n    if (flyout && anchor) {\n      const windowWidth =\n        window.innerWidth && document.documentElement.clientWidth\n          ? Math.min(window.innerWidth, document.documentElement.clientWidth)\n          : window.innerWidth || document.documentElement.clientWidth;\n\n      this._windowHeight =\n        window.innerHeight && document.documentElement.clientHeight\n          ? Math.min(window.innerHeight, document.documentElement.clientHeight)\n          : window.innerHeight || document.documentElement.clientHeight;\n\n      let left = 0;\n      let bottom: number;\n      let top = 0;\n      let height: number;\n      let width: number;\n\n      const flyoutRect = flyout.getBoundingClientRect();\n      const anchorRect = anchor.getBoundingClientRect();\n      const topScoutRect = this._topScout.getBoundingClientRect();\n      const bottomScoutRect = this._bottomScout.getBoundingClientRect();\n\n      const windowRect: IWindowSegment = {\n        height: this._windowHeight,\n        left: 0,\n        top: 0,\n        width: windowWidth\n      };\n\n      if (isWindowSegmentAware()) {\n        const segmentAwareWindow = getSegmentAwareWindow();\n        const screenSegments = segmentAwareWindow.getWindowSegments();\n\n        let anchorSegment: IWindowSegment;\n\n        const anchorCenterX = anchorRect.left + anchorRect.width / 2;\n        const anchorCenterY = anchorRect.top + anchorRect.height / 2;\n\n        for (const segment of screenSegments) {\n          if (anchorCenterX >= segment.left && anchorCenterY >= segment.top) {\n            anchorSegment = segment;\n            break;\n          }\n        }\n\n        if (anchorSegment) {\n          windowRect.left = anchorSegment.left;\n          windowRect.top = anchorSegment.top;\n          windowRect.width = anchorSegment.width;\n          windowRect.height = anchorSegment.height;\n        }\n      }\n\n      if (flyoutRect.width + 2 * this._edgePadding > windowRect.width) {\n        if (flyoutRect.width > windowRect.width) {\n          // flyout is wider than the window\n          width = windowRect.width;\n          left = 0;\n        } else {\n          // center in between\n          left = (windowRect.width - flyoutRect.width) / 2;\n        }\n      } else if (anchorRect.left + flyoutRect.width + this._edgePadding > windowRect.width) {\n        // it will render off screen to the right, move to the left\n        left = anchorRect.left - (anchorRect.left + flyoutRect.width + this._edgePadding - windowRect.width);\n      } else if (anchorRect.left < this._edgePadding) {\n        // it will render off screen to the left, move to the right\n        left = this._edgePadding;\n      } else {\n        left = anchorRect.left;\n      }\n\n      const anchorRectBottomToWindowBottom = windowRect.height - (anchorRect.top + anchorRect.height);\n      const anchorRectTopToWindowTop = anchorRect.top;\n\n      if (this.avoidHidingAnchor) {\n        if (anchorRectBottomToWindowBottom <= flyoutRect.height) {\n          if (anchorRectTopToWindowTop < flyoutRect.height) {\n            if (anchorRectTopToWindowTop > anchorRectBottomToWindowBottom) {\n              // more room top than bottom - render above\n              bottom = windowRect.height - anchorRect.top;\n              height = anchorRectTopToWindowTop;\n            } else {\n              // more room bottom than top\n              top = anchorRect.bottom;\n              height = anchorRectBottomToWindowBottom;\n            }\n          } else {\n            // render above anchor\n            bottom = windowRect.height - anchorRect.top;\n            height = anchorRectTopToWindowTop;\n          }\n        } else {\n          top = anchorRect.bottom;\n          height = anchorRectBottomToWindowBottom;\n        }\n      } else {\n        if (flyoutRect.height + 2 * this._edgePadding > windowRect.height) {\n          // flyout wants to be higher than the window hight, and we don't need to avoid hiding the anchor\n          // make the flyout height the height of the window\n          if (flyoutRect.height >= windowRect.height) {\n            height = windowRect.height;\n            top = 0;\n          } else {\n            top = (windowRect.height - flyoutRect.height) / 2;\n          }\n        } else {\n          if (anchorRect.top + anchorRect.height + flyoutRect.height + this._edgePadding > windowRect.height) {\n            // it will render offscreen bellow, move it up a bit\n            top = windowRect.height - flyoutRect.height - this._edgePadding;\n          } else {\n            top = Math.max(anchorRect.top + anchorRect.height, this._edgePadding);\n          }\n        }\n      }\n\n      // check the scout is positioned where it is supposed to be\n      // if it's not, then we are no longer fixed position and should assume\n      // absolute positioning\n      // this is a workaround when a transform is applied to a parent\n      // https://stackoverflow.com/questions/42660332/css-transform-parent-and-fixed-child\n      if (topScoutRect.top !== 0 || topScoutRect.left !== 0) {\n        left -= topScoutRect.left;\n\n        if (typeof bottom !== 'undefined') {\n          bottom += bottomScoutRect.top - this._windowHeight;\n        } else {\n          top -= topScoutRect.top;\n        }\n      }\n\n      if (this.direction === 'rtl') {\n        if (left > 100 && this.offsetLeft > 100) {\n          // potentially anchored to right side (for non people-picker flyout)\n          flyout.style.left = `${windowRect.width - left + flyoutRect.left - flyoutRect.width - 30}px`;\n        }\n      } else {\n        flyout.style.left = `${left + windowRect.left}px`;\n      }\n\n      if (typeof bottom !== 'undefined') {\n        flyout.style.top = 'unset';\n        flyout.style.bottom = `${bottom}px`;\n      } else {\n        flyout.style.bottom = 'unset';\n        flyout.style.top = `${top + windowRect.top}px`;\n      }\n\n      if (width) {\n        // if we had to set the width, recalculate since the height could have changed\n        flyout.style.width = `${width}px`;\n        flyout.style.setProperty('--mgt-flyout-set-width', `${width}px`);\n        window.requestAnimationFrame(() => this.updateFlyout());\n      }\n\n      // don't use the calculated height on the first pass as the contents of the flyout may not have rendered yet\n      // this gives them a change to contribute height and not get forced to a smaller than intended height\n      if (height && !firstPass) {\n        flyout.style.maxHeight = `${height}px`;\n        flyout.style.setProperty('--mgt-flyout-set-height', `${height}px`);\n      } else {\n        flyout.style.maxHeight = null;\n        flyout.style.setProperty('--mgt-flyout-set-height', 'unset');\n      }\n      if (firstPass) {\n        window.requestAnimationFrame(() => this.updateFlyout(false));\n      }\n    }\n  }\n\n  private setupWindowEvents(isOpen: boolean) {\n    if (isOpen && this.isLightDismiss) {\n      window.addEventListener('wheel', this.handleWindowEvent);\n      window.addEventListener('pointerdown', this.handleWindowEvent);\n      window.addEventListener('resize', this.handleResize);\n      window.addEventListener('keyup', this.handleKeyUp);\n    } else {\n      window.removeEventListener('wheel', this.handleWindowEvent);\n      window.removeEventListener('pointerdown', this.handleWindowEvent);\n      window.removeEventListener('resize', this.handleResize);\n      window.removeEventListener('keyup', this.handleKeyUp);\n    }\n  }\n\n  private readonly handleWindowEvent = (e: Event) => {\n    const flyout = this._flyout;\n\n    if (flyout) {\n      // IE\n      if (!e.composedPath) {\n        let currentElem = e.target as HTMLElement;\n        while (currentElem) {\n          currentElem = currentElem.parentElement;\n          if (currentElem === flyout || (e.type === 'pointerdown' && currentElem === this)) {\n            return;\n          }\n        }\n      } else {\n        const path = e.composedPath();\n        if (path.includes(flyout) || (e.type === 'pointerdown' && path.includes(this))) {\n          return;\n        }\n      }\n    }\n\n    this.close();\n  };\n\n  private readonly handleResize = () => {\n    this.close();\n  };\n\n  private readonly handleKeyUp = (e: KeyboardEvent) => {\n    if (e.key === 'Escape') {\n      this.close();\n    }\n  };\n\n  private readonly handleFlyoutWheel = (e: Event) => {\n    e.preventDefault();\n  };\n}\n","// THIS FILE IS AUTO GENERATED\n// ANY CHANGES WILL BE LOST DURING BUILD\n// MODIFY THE .SCSS FILE INSTEAD\n\nimport { css, CSSResult } from 'lit';\n/**\n * exports lit-element css\n * @export styles\n */\nexport const styles: CSSResult[] = [\n  css`\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, \"Segoe UI\", \"Segoe UI Web (West European)\", \"Segoe UI\", -apple-system, \"BlinkMacSystemFont\", \"Roboto\", \"Helvetica Neue\", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:\"\\\\\\e70d\"}.ms-icon-chevron-up::before{content:\"\\\\\\e70e\"}.ms-icon-contact::before{content:\"\\\\\\e77b\"}.ms-icon-add-friend::before{content:\"\\\\\\e8fa\"}.ms-icon-outlook-logo-inverser::before{content:\"\\\\\\eb6d\"}\n`];","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { html } from 'lit';\nimport { MgtBaseTaskComponent } from '@microsoft/mgt-element';\nimport { styles } from './mgt-spinner-css';\nimport { registerComponent } from '@microsoft/mgt-element';\n\nexport const registerMgtSpinnerComponent = () => registerComponent('spinner', MgtSpinner);\n\n/**\n * Custom Component used to handle loading state in components.\n *\n * @export MgtSpinner\n * @class MgtSpinner\n * @extends {MgtBaseComponent}\n */\nexport class MgtSpinner extends MgtBaseTaskComponent {\n  /**\n   * Array of styles to apply to the element. The styles should be defined\n   * user the `css` tag function.\n   */\n  public static get styles() {\n    return styles;\n  }\n\n  /**\n   * Render the loading spinner\n   *\n   * @returns\n   * @memberof MgtSpinner\n   */\n  public render() {\n    return html`<fluent-progress-ring title=\"spinner\"></fluent-progress-ring>`;\n  }\n}\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { CacheSchema } from '@microsoft/mgt-element';\nexport type CacheNames =\n  | 'presence'\n  | 'users'\n  | 'photos'\n  | 'people'\n  | 'groups'\n  | 'files'\n  | 'get'\n  | 'fileLists'\n  | 'search'\n  | 'conversation';\n\n/**\n * All schemas and stores for caching component calls\n */\nexport const schemas: Record<CacheNames, CacheSchema> = {\n  conversation: {\n    name: 'conversation',\n    stores: {\n      chats: 'chats',\n      subscriptions: 'subscriptions',\n      lastRead: 'lastRead'\n    },\n    version: 3,\n    indexes: {\n      subscriptions: [{ name: 'lastAccessDateTime', field: 'lastAccessDateTime' }]\n    }\n  },\n  presence: {\n    name: 'presence',\n    stores: {\n      presence: 'presence'\n    },\n    version: 2\n  },\n  users: {\n    name: 'users',\n    stores: {\n      users: 'users',\n      usersQuery: 'usersQuery',\n      userFilters: 'userFilters'\n    },\n    version: 3\n  },\n  photos: {\n    name: 'photos',\n    stores: {\n      contacts: 'contacts',\n      users: 'users',\n      groups: 'groups',\n      teams: 'teams'\n    },\n    version: 2\n  },\n  people: {\n    name: 'people',\n    stores: {\n      contacts: 'contacts',\n      groupPeople: 'groupPeople',\n      peopleQuery: 'peopleQuery'\n    },\n    version: 3\n  },\n  groups: {\n    name: 'groups',\n    stores: {\n      groups: 'groups',\n      groupsQuery: 'groupsQuery'\n    },\n    version: 5\n  },\n  get: {\n    name: 'responses',\n    stores: {\n      responses: 'responses'\n    },\n    version: 2\n  },\n  search: {\n    name: 'search',\n    stores: {\n      responses: 'responses'\n    },\n    version: 2\n  },\n  files: {\n    name: 'files',\n    stores: {\n      driveFiles: 'driveFiles',\n      groupFiles: 'groupFiles',\n      siteFiles: 'siteFiles',\n      userFiles: 'userFiles',\n      insightFiles: 'insightFiles',\n      fileQueries: 'fileQueries'\n    },\n    version: 2\n  },\n  fileLists: {\n    name: 'file-lists',\n    stores: {\n      fileLists: 'fileLists',\n      insightfileLists: 'insightfileLists'\n    },\n    version: 2\n  }\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { IDynamicPerson, IContact, IGroup, IUser } from './types';\n\nexport const isGroup = (obj: IDynamicPerson): obj is IGroup => {\n  return 'groupTypes' in obj;\n};\n\nexport const isUser = (obj: IDynamicPerson): obj is IUser => {\n  return 'personType' in obj || 'userType' in obj;\n};\n\nexport const isContact = (obj: IDynamicPerson): obj is IContact => {\n  return 'initials' in obj;\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport {\n  CacheItem,\n  CacheService,\n  CacheStore,\n  CollectionResponse,\n  GraphPageIterator,\n  IGraph,\n  prepScopes\n} from '@microsoft/mgt-element';\nimport { DriveItem, SharedInsight, Trending, UploadSession, UsedInsight } from '@microsoft/microsoft-graph-types';\nimport { schemas } from './cacheStores';\nimport { GraphRequest, ResponseType } from '@microsoft/microsoft-graph-client';\nimport { blobToBase64 } from '../utils/Utils';\nimport { MgtFileUploadConflictBehavior } from '../components/mgt-file-list/mgt-file-upload/mgt-file-upload';\n\n/**\n * Simple type guard to check if a response is an UploadSession\n *\n * @param session\n * @returns\n */\nexport const isUploadSession = (session: unknown): session is UploadSession => {\n  return Array.isArray((session as UploadSession).nextExpectedRanges);\n};\n\ntype Insight = SharedInsight | UsedInsight | Trending;\n\n/**\n * Object to be stored in cache\n */\ninterface CacheFile extends CacheItem {\n  /**\n   * stringified json representing a file\n   */\n  file?: string;\n}\n\n/**\n * Object to be stored in cache\n */\ninterface CacheFileList extends CacheItem {\n  /**\n   * stringified json representing a list of files\n   */\n  files?: string[];\n  /**\n   * nextLink string to get next page\n   */\n  nextLink?: string;\n}\n\n/**\n * document thumbnail object stored in cache\n */\nexport interface CacheThumbnail extends CacheItem {\n  /**\n   * tag associated with thumbnail\n   */\n  eTag?: string;\n  /**\n   * document thumbnail\n   */\n  thumbnail?: string;\n}\n\n/**\n * Clear Cache of FileList\n */\nexport const clearFilesCache = async (): Promise<void> => {\n  const cache: CacheStore<CacheFileList> = CacheService.getCache<CacheFileList>(\n    schemas.fileLists,\n    schemas.fileLists.stores.fileLists\n  );\n  await cache.clearStore();\n};\n\n/**\n * Defines the time it takes for objects in the cache to expire\n */\nexport const getFileInvalidationTime = (): number =>\n  CacheService.config.files.invalidationPeriod || CacheService.config.defaultInvalidationPeriod;\n\n/**\n * Whether or not the cache is enabled\n */\nexport const getIsFilesCacheEnabled = (): boolean =>\n  CacheService.config.files.isEnabled && CacheService.config.isEnabled;\n\n/**\n * Defines the time it takes for objects in the cache to expire\n */\nexport const getFileListInvalidationTime = (): number =>\n  CacheService.config.fileLists.invalidationPeriod || CacheService.config.defaultInvalidationPeriod;\n\n/**\n * Whether or not the cache is enabled\n */\nexport const getIsFileListsCacheEnabled = (): boolean =>\n  CacheService.config.fileLists.isEnabled && CacheService.config.isEnabled;\n\nconst validDriveItemScopes = [\n  'Files.Read',\n  'Files.ReadWrite',\n  'Files.Read.All',\n  'Files.ReadWrite.All',\n  'Group.Read.All',\n  'Group.ReadWrite.All',\n  'Sites.Read.All',\n  'Sites.ReadWrite.All'\n];\nexport const validInsightScopes = ['Sites.Read.All', 'Sites.ReadWrite.All'];\nconst validFileUploadScopes = ['Files.ReadWrite', 'Files.ReadWrite.All', 'Sites.ReadWrite.All'];\n/**\n * Load a DriveItem give and arbitrary query\n *\n * @param graph\n * @param resource\n * @returns\n */\nexport const getDriveItemByQuery = async (\n  graph: IGraph,\n  resource: string,\n  storeName: string = schemas.files.stores.fileQueries,\n  scopes = validDriveItemScopes\n): Promise<DriveItem> => {\n  // get from cache\n  const cache: CacheStore<CacheFile> = CacheService.getCache<CacheFile>(schemas.files, storeName);\n  const cachedFile = await getFileFromCache(cache, resource);\n  if (cachedFile) {\n    return cachedFile;\n  }\n\n  let response: DriveItem;\n  try {\n    response = (await graph.api(resource).middlewareOptions(prepScopes(scopes)).get()) as DriveItem;\n\n    if (getIsFilesCacheEnabled()) {\n      await cache.putValue(resource, { file: JSON.stringify(response) });\n    }\n    // eslint-disable-next-line no-empty\n  } catch {}\n\n  return response || null;\n};\n\n// GET /drives/{drive-id}/items/{item-id}\nexport const getDriveItemById = async (graph: IGraph, driveId: string, itemId: string): Promise<DriveItem> => {\n  const endpoint = `/drives/${driveId}/items/${itemId}`;\n  return getDriveItemByQuery(graph, endpoint, schemas.files.stores.driveFiles);\n};\n\n// GET /drives/{drive-id}/root:/{item-path}\nexport const getDriveItemByPath = async (graph: IGraph, driveId: string, itemPath: string): Promise<DriveItem> => {\n  const endpoint = `/drives/${driveId}/root:/${itemPath}`;\n  return getDriveItemByQuery(graph, endpoint, schemas.files.stores.driveFiles);\n};\n\n// GET /groups/{group-id}/drive/items/{item-id}\nexport const getGroupDriveItemById = async (graph: IGraph, groupId: string, itemId: string): Promise<DriveItem> => {\n  const endpoint = `/groups/${groupId}/drive/items/${itemId}`;\n  return getDriveItemByQuery(graph, endpoint, schemas.files.stores.groupFiles);\n};\n\n// GET /groups/{group-id}/drive/root:/{item-path}\nexport const getGroupDriveItemByPath = async (graph: IGraph, groupId: string, itemPath: string): Promise<DriveItem> => {\n  const endpoint = `/groups/${groupId}/drive/root:/${itemPath}`;\n  return getDriveItemByQuery(graph, endpoint, schemas.files.stores.groupFiles);\n};\n\n// GET /me/drive/items/{item-id}\nexport const getMyDriveItemById = async (graph: IGraph, itemId: string): Promise<DriveItem> => {\n  const endpoint = `/me/drive/items/${itemId}`;\n  return getDriveItemByQuery(graph, endpoint, schemas.files.stores.userFiles);\n};\n\n// GET /me/drive/root:/{item-path}\nexport const getMyDriveItemByPath = async (graph: IGraph, itemPath: string): Promise<DriveItem> => {\n  const endpoint = `/me/drive/root:/${itemPath}`;\n  return getDriveItemByQuery(graph, endpoint, schemas.files.stores.userFiles);\n};\n\n// GET /sites/{site-id}/drive/items/{item-id}\nexport const getSiteDriveItemById = async (graph: IGraph, siteId: string, itemId: string): Promise<DriveItem> => {\n  const endpoint = `/sites/${siteId}/drive/items/${itemId}`;\n  return getDriveItemByQuery(graph, endpoint, schemas.files.stores.siteFiles);\n};\n\n// GET /sites/{site-id}/drive/root:/{item-path}\nexport const getSiteDriveItemByPath = async (graph: IGraph, siteId: string, itemPath: string): Promise<DriveItem> => {\n  const endpoint = `/sites/${siteId}/drive/root:/${itemPath}`;\n  return getDriveItemByQuery(graph, endpoint, schemas.files.stores.siteFiles);\n};\n\n// GET /sites/{site-id}/lists/{list-id}/items/{item-id}/driveItem\nexport const getListDriveItemById = async (\n  graph: IGraph,\n  siteId: string,\n  listId: string,\n  itemId: string\n): Promise<DriveItem> => {\n  const endpoint = `/sites/${siteId}/lists/${listId}/items/${itemId}/driveItem`;\n  return getDriveItemByQuery(graph, endpoint, schemas.files.stores.siteFiles);\n};\n\n// GET /users/{user-id}/drive/items/{item-id}\nexport const getUserDriveItemById = async (graph: IGraph, userId: string, itemId: string): Promise<DriveItem> => {\n  const endpoint = `/users/${userId}/drive/items/${itemId}`;\n  return getDriveItemByQuery(graph, endpoint, schemas.files.stores.userFiles);\n};\n\n// GET /users/{user-id}/drive/root:/{item-path}\nexport const getUserDriveItemByPath = async (graph: IGraph, userId: string, itemPath: string): Promise<DriveItem> => {\n  const endpoint = `/users/${userId}/drive/root:/${itemPath}`;\n  return getDriveItemByQuery(graph, endpoint, schemas.files.stores.userFiles);\n};\n\n// GET /me/insights/trending/{id}/resource\n// GET /me/insights/used/{id}/resource\n// GET /me/insights/shared/{id}/resource\nexport const getMyInsightsDriveItemById = async (\n  graph: IGraph,\n  insightType: string,\n  id: string\n): Promise<DriveItem> => {\n  const endpoint = `/me/insights/${insightType}/${id}/resource`;\n  return getDriveItemByQuery(graph, endpoint, schemas.files.stores.insightFiles, validInsightScopes);\n};\n\n// GET /users/{id or userPrincipalName}/insights/{trending or used or shared}/{id}/resource\nexport const getUserInsightsDriveItemById = async (\n  graph: IGraph,\n  userId: string,\n  insightType: string,\n  id: string\n): Promise<DriveItem> => {\n  const endpoint = `/users/${userId}/insights/${insightType}/${id}/resource`;\n  return getDriveItemByQuery(graph, endpoint, schemas.files.stores.insightFiles, validInsightScopes);\n};\n\nconst getIterator = async (\n  graph: IGraph,\n  endpoint: string,\n  storeName: string,\n  top?: number\n): Promise<GraphPageIterator<DriveItem>> => {\n  let filesPageIterator: GraphPageIterator<DriveItem>;\n\n  // get iterator from cached values\n  const cache: CacheStore<CacheFileList> = CacheService.getCache<CacheFileList>(schemas.fileLists, storeName);\n  const fileList = await getFileListFromCache(cache, storeName, `${endpoint}:${top}`);\n  if (fileList) {\n    filesPageIterator = getFilesPageIteratorFromCache(graph, fileList.files, fileList.nextLink);\n\n    return filesPageIterator;\n  }\n\n  // get iterator from graph request\n  let request: GraphRequest;\n  try {\n    request = graph.api(endpoint).middlewareOptions(prepScopes(validDriveItemScopes));\n    if (top) {\n      request.top(top);\n    }\n    filesPageIterator = await getFilesPageIteratorFromRequest(graph, request);\n\n    if (getIsFileListsCacheEnabled()) {\n      const nextLink = filesPageIterator.nextLink;\n      await cache.putValue(endpoint, {\n        files: filesPageIterator.value.map(v => JSON.stringify(v)),\n        nextLink\n      });\n    }\n    // eslint-disable-next-line no-empty\n  } catch {}\n  return filesPageIterator || null;\n};\n\n// GET /me/drive/root/children\nexport const getFilesIterator = async (graph: IGraph, top?: number): Promise<GraphPageIterator<DriveItem>> => {\n  const endpoint = '/me/drive/root/children';\n  const cacheStore = schemas.fileLists.stores.fileLists;\n  return getIterator(graph, endpoint, cacheStore, top);\n};\n\n// GET /drives/{drive-id}/items/{item-id}/children\nexport const getDriveFilesByIdIterator = async (\n  graph: IGraph,\n  driveId: string,\n  itemId: string,\n  top?: number\n): Promise<GraphPageIterator<DriveItem>> => {\n  const endpoint = `/drives/${driveId}/items/${itemId}/children`;\n  const cacheStore = schemas.fileLists.stores.fileLists;\n  return getIterator(graph, endpoint, cacheStore, top);\n};\n\n// GET /drives/{drive-id}/root:/{item-path}:/children\nexport const getDriveFilesByPathIterator = async (\n  graph: IGraph,\n  driveId: string,\n  itemPath: string,\n  top?: number\n): Promise<GraphPageIterator<DriveItem>> => {\n  const endpoint = `/drives/${driveId}/root:/${itemPath}:/children`;\n  const cacheStore = schemas.fileLists.stores.fileLists;\n  return getIterator(graph, endpoint, cacheStore, top);\n};\n\n// GET /groups/{group-id}/drive/items/{item-id}/children\nexport const getGroupFilesByIdIterator = async (\n  graph: IGraph,\n  groupId: string,\n  itemId: string,\n  top?: number\n): Promise<GraphPageIterator<DriveItem>> => {\n  const endpoint = `/groups/${groupId}/drive/items/${itemId}/children`;\n  const cacheStore = schemas.fileLists.stores.fileLists;\n  return getIterator(graph, endpoint, cacheStore, top);\n};\n\n// GET /groups/{group-id}/drive/root:/{item-path}:/children\nexport const getGroupFilesByPathIterator = async (\n  graph: IGraph,\n  groupId: string,\n  itemPath: string,\n  top?: number\n): Promise<GraphPageIterator<DriveItem>> => {\n  const endpoint = `/groups/${groupId}/drive/root:/${itemPath}:/children`;\n  const cacheStore = schemas.fileLists.stores.fileLists;\n  return getIterator(graph, endpoint, cacheStore, top);\n};\n\n// GET /me/drive/items/{item-id}/children\nexport const getFilesByIdIterator = async (\n  graph: IGraph,\n  itemId: string,\n  top?: number\n): Promise<GraphPageIterator<DriveItem>> => {\n  const endpoint = `/me/drive/items/${itemId}/children`;\n  const cacheStore = schemas.fileLists.stores.fileLists;\n  return getIterator(graph, endpoint, cacheStore, top);\n};\n\n// GET /me/drive/root:/{item-path}:/children\nexport const getFilesByPathIterator = async (\n  graph: IGraph,\n  itemPath: string,\n  top?: number\n): Promise<GraphPageIterator<DriveItem>> => {\n  const endpoint = `/me/drive/root:/${itemPath}:/children`;\n  const cacheStore = schemas.fileLists.stores.fileLists;\n  return getIterator(graph, endpoint, cacheStore, top);\n};\n\n// GET /sites/{site-id}/drive/items/{item-id}/children\nexport const getSiteFilesByIdIterator = async (\n  graph: IGraph,\n  siteId: string,\n  itemId: string,\n  top?: number\n): Promise<GraphPageIterator<DriveItem>> => {\n  const endpoint = `/sites/${siteId}/drive/items/${itemId}/children`;\n  const cacheStore = schemas.fileLists.stores.fileLists;\n  return getIterator(graph, endpoint, cacheStore, top);\n};\n\n// GET /sites/{site-id}/drive/root:/{item-path}:/children\nexport const getSiteFilesByPathIterator = async (\n  graph: IGraph,\n  siteId: string,\n  itemPath: string,\n  top?: number\n): Promise<GraphPageIterator<DriveItem>> => {\n  const endpoint = `/sites/${siteId}/drive/root:/${itemPath}:/children`;\n  const cacheStore = schemas.fileLists.stores.fileLists;\n  return getIterator(graph, endpoint, cacheStore, top);\n};\n\n// GET /users/{user-id}/drive/items/{item-id}/children\nexport const getUserFilesByIdIterator = async (\n  graph: IGraph,\n  userId: string,\n  itemId: string,\n  top?: number\n): Promise<GraphPageIterator<DriveItem>> => {\n  const endpoint = `/users/${userId}/drive/items/${itemId}/children`;\n  const cacheStore = schemas.fileLists.stores.fileLists;\n  return getIterator(graph, endpoint, cacheStore, top);\n};\n\n// GET /users/{user-id}/drive/root:/{item-path}:/children\nexport const getUserFilesByPathIterator = async (\n  graph: IGraph,\n  userId: string,\n  itemPath: string,\n  top?: number\n): Promise<GraphPageIterator<DriveItem>> => {\n  const endpoint = `/users/${userId}/drive/root:/${itemPath}:/children`;\n  const cacheStore = schemas.fileLists.stores.fileLists;\n  return getIterator(graph, endpoint, cacheStore, top);\n};\n\nexport const getFilesByListQueryIterator = async (\n  graph: IGraph,\n  listQuery: string,\n  top?: number\n): Promise<GraphPageIterator<DriveItem>> => {\n  const cacheStore = schemas.fileLists.stores.fileLists;\n  return getIterator(graph, listQuery, cacheStore, top);\n};\n\n// GET /me/insights/{trending\t| used | shared}\nexport const getMyInsightsFiles = async (graph: IGraph, insightType: string): Promise<DriveItem[]> => {\n  const endpoint = `/me/insights/${insightType}`;\n  const cacheStore = schemas.fileLists.stores.insightfileLists;\n\n  // get files from cached values\n  const cache: CacheStore<CacheFileList> = CacheService.getCache<CacheFileList>(schemas.fileLists, cacheStore);\n  const fileList = await getFileListFromCache(cache, cacheStore, endpoint);\n  if (fileList) {\n    // fileList.files is string[] so JSON.parse to get proper objects\n    return fileList.files.map((file: string) => JSON.parse(file) as DriveItem);\n  }\n\n  // get files from graph request\n  let insightResponse: CollectionResponse<Insight>;\n  try {\n    insightResponse = (await graph\n      .api(endpoint)\n      .filter(\"resourceReference/type eq 'microsoft.graph.driveItem'\")\n      .middlewareOptions(prepScopes(validInsightScopes))\n      .get()) as CollectionResponse<Insight>;\n    // eslint-disable-next-line no-empty\n  } catch {}\n\n  const result = await getDriveItemsByInsights(graph, insightResponse, validInsightScopes);\n  if (getIsFileListsCacheEnabled()) {\n    await cache.putValue(endpoint, { files: result.map(file => JSON.stringify(file)) });\n  }\n\n  return result || null;\n};\n\n// GET /users/{id | userPrincipalName}/insights/{trending\t| used | shared}\nexport const getUserInsightsFiles = async (\n  graph: IGraph,\n  userId: string,\n  insightType: string\n): Promise<DriveItem[]> => {\n  let endpoint: string;\n  let filter: string;\n\n  if (insightType === 'shared') {\n    endpoint = '/me/insights/shared';\n    filter = `((lastshared/sharedby/id eq '${userId}') and (resourceReference/type eq 'microsoft.graph.driveItem'))`;\n  } else {\n    endpoint = `/users/${userId}/insights/${insightType}`;\n    filter = \"resourceReference/type eq 'microsoft.graph.driveItem'\";\n  }\n\n  const key = `${endpoint}?$filter=${filter}`;\n\n  // get files from cached values\n  const cacheStore = schemas.fileLists.stores.insightfileLists;\n  const cache: CacheStore<CacheFileList> = CacheService.getCache<CacheFileList>(schemas.fileLists, cacheStore);\n  const fileList = await getFileListFromCache(cache, cacheStore, key);\n  if (fileList) {\n    return fileList.files.map((file: string) => JSON.parse(file) as DriveItem);\n  }\n\n  // get files from graph request\n  let insightResponse: CollectionResponse<Insight>;\n\n  try {\n    insightResponse = (await graph\n      .api(endpoint)\n      .filter(filter)\n      .middlewareOptions(prepScopes(validInsightScopes))\n      .get()) as CollectionResponse<Insight>;\n    // eslint-disable-next-line no-empty\n  } catch {}\n\n  const result = await getDriveItemsByInsights(graph, insightResponse, validInsightScopes);\n  if (getIsFileListsCacheEnabled()) {\n    await cache.putValue(endpoint, { files: result.map(file => JSON.stringify(file)) });\n  }\n\n  return result || null;\n};\n\nexport const getFilesByQueries = async (graph: IGraph, fileQueries: string[]): Promise<DriveItem[]> => {\n  if (!fileQueries || fileQueries.length === 0) {\n    return [];\n  }\n\n  const batch = graph.createBatch();\n  const files: DriveItem[] = [];\n  let cache: CacheStore<CacheFile>;\n  let cachedFile: CacheFile;\n  if (getIsFilesCacheEnabled()) {\n    cache = CacheService.getCache<CacheFile>(schemas.files, schemas.files.stores.fileQueries);\n  }\n\n  for (const fileQuery of fileQueries) {\n    if (getIsFilesCacheEnabled()) {\n      cachedFile = await cache.getValue(fileQuery); // todo\n    }\n\n    if (getIsFilesCacheEnabled() && cachedFile && getFileInvalidationTime() > Date.now() - cachedFile.timeCached) {\n      files.push(JSON.parse(cachedFile.file) as DriveItem);\n    } else if (fileQuery !== '') {\n      batch.get(fileQuery, fileQuery, validDriveItemScopes);\n    }\n  }\n\n  try {\n    const responses = await batch.executeAll();\n\n    for (const fileQuery of fileQueries) {\n      const response = responses.get(fileQuery);\n      if (response?.content) {\n        files.push(response.content as DriveItem);\n        if (getIsFilesCacheEnabled()) {\n          await cache.putValue(fileQuery, { file: JSON.stringify(response.content) });\n        }\n      }\n    }\n\n    return files;\n  } catch (_) {\n    try {\n      return Promise.all(\n        fileQueries\n          .filter(fileQuery => fileQuery && fileQuery !== '')\n          .map(async fileQuery => {\n            const file = await getDriveItemByQuery(graph, fileQuery);\n            if (file) {\n              if (getIsFilesCacheEnabled()) {\n                await cache.putValue(fileQuery, { file: JSON.stringify(file) });\n              }\n              return file;\n            }\n          })\n      );\n    } catch (e) {\n      return [];\n    }\n  }\n};\n\nconst getDriveItemsByInsights = async (\n  graph: IGraph,\n  insightResponse: CollectionResponse<Insight>,\n  scopes: string[]\n): Promise<DriveItem[]> => {\n  if (!insightResponse) {\n    return [];\n  }\n\n  const insightItems = insightResponse.value;\n  const batch = graph.createBatch();\n  const driveItems: DriveItem[] = [];\n  for (const item of insightItems) {\n    const driveItemId = item.resourceReference.id;\n    if (driveItemId !== '') {\n      batch.get(driveItemId, driveItemId, scopes);\n    }\n  }\n\n  try {\n    const driveItemResponses = await batch.executeAll();\n\n    for (const item of insightItems) {\n      const driveItemResponse = driveItemResponses.get(item.resourceReference.id);\n      if (driveItemResponse?.content) {\n        driveItems.push(driveItemResponse.content as DriveItem);\n      }\n    }\n    return driveItems;\n  } catch (_) {\n    try {\n      // we're filtering the insights calls that feed this to ensure that only\n      // drive items are returned, but we still need to check for nulls\n      return Promise.all(\n        insightItems\n          .filter(insightItem => Boolean(insightItem.resourceReference.id))\n          .map(\n            async insightItem =>\n              (await graph\n                .api(insightItem.resourceReference.id)\n                .middlewareOptions(prepScopes(scopes))\n                .get()) as DriveItem\n          )\n      );\n    } catch (e) {\n      return [];\n    }\n  }\n};\n\nconst getFilesPageIteratorFromRequest = async (graph: IGraph, request: GraphRequest) => {\n  return GraphPageIterator.create<DriveItem>(graph, request);\n};\n\nconst getFilesPageIteratorFromCache = (graph: IGraph, value: string[], nextLink: string) => {\n  return GraphPageIterator.createFromValue<DriveItem>(\n    graph,\n    value.map(v => JSON.parse(v) as DriveItem),\n    nextLink\n  );\n};\n\n/**\n * Load a file from the cache\n *\n * @param {CacheStore<CacheFile>} cache\n * @param {string} key\n * @return {*}\n */\nconst getFileFromCache = async <TResult = DriveItem>(cache: CacheStore<CacheFile>, key: string): Promise<TResult> => {\n  if (getIsFilesCacheEnabled()) {\n    const file = await cache.getValue(key);\n\n    if (file && getFileInvalidationTime() > Date.now() - file.timeCached) {\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n      return JSON.parse(file.file) as TResult;\n    }\n  }\n\n  return null;\n};\n\nexport const getFileListFromCache = async (cache: CacheStore<CacheFileList>, store: string, key: string) => {\n  if (!cache) {\n    cache = CacheService.getCache<CacheFileList>(schemas.fileLists, store);\n  }\n\n  if (getIsFileListsCacheEnabled()) {\n    const fileList = await cache.getValue(key);\n\n    if (fileList && getFileListInvalidationTime() > Date.now() - fileList.timeCached) {\n      return fileList;\n    }\n  }\n\n  return null;\n};\n\n// refresh filesPageIterator to its next iteration and save current page to cache\nexport const fetchNextAndCacheForFilesPageIterator = async (filesPageIterator: GraphPageIterator<DriveItem>) => {\n  const nextLink = filesPageIterator.nextLink;\n\n  if (filesPageIterator.hasNext) {\n    await filesPageIterator.next();\n  }\n  if (getIsFileListsCacheEnabled()) {\n    const cache: CacheStore<CacheFileList> = CacheService.getCache<CacheFileList>(\n      schemas.fileLists,\n      schemas.fileLists.stores.fileLists\n    );\n\n    // match only the endpoint (after version number and before OData query params) e.g. /me/drive/root/children\n    const reg = /(graph.microsoft.com\\/(v1.0|beta))(.*?)(?=\\?)/gi;\n    const matches = reg.exec(nextLink);\n    const key = matches[3];\n\n    await cache.putValue(key, { files: filesPageIterator.value.map(v => JSON.stringify(v)), nextLink });\n  }\n};\n\n/**\n * retrieves the specified document thumbnail\n *\n * @param {string} resource\n * @param {string[]} scopes\n * @returns {Promise<string>}\n */\nexport const getDocumentThumbnail = async (\n  graph: IGraph,\n  resource: string,\n  scopes: string[]\n): Promise<CacheThumbnail> => {\n  try {\n    const response = (await graph\n      .api(resource)\n      .responseType(ResponseType.RAW)\n      .middlewareOptions(prepScopes(scopes))\n      .get()) as Response;\n\n    if (response.status === 404) {\n      // 404 means the resource does not have a thumbnail\n      // we still want to cache that state\n      // so we return an object that can be cached\n      return { eTag: null, thumbnail: null };\n    } else if (!response.ok) {\n      return null;\n    }\n\n    const eTag = response.headers.get('eTag');\n    const blob = await blobToBase64(await response.blob());\n    return { eTag, thumbnail: blob };\n  } catch (e) {\n    return null;\n  }\n};\n\n/**\n * retrieve file properties based on Graph query\n *\n * @param graph\n * @param resource\n * @returns\n */\nexport const getGraphfile = async (graph: IGraph, resource: string): Promise<DriveItem> => {\n  // get from graph request\n  try {\n    const response = (await graph.api(resource).middlewareOptions(prepScopes(validDriveItemScopes)).get()) as DriveItem;\n    return response || null;\n    // eslint-disable-next-line no-empty\n  } catch {}\n\n  return null;\n};\n\n/**\n * retrieve UploadSession Url for large file and send by chuncks\n *\n * @param graph\n * @param resource\n * @returns\n */\nexport const getUploadSession = async (\n  graph: IGraph,\n  resource: string,\n  conflictBehavior: MgtFileUploadConflictBehavior\n): Promise<UploadSession> => {\n  try {\n    // get from graph request\n    const sessionOptions = {\n      item: {\n        '@microsoft.graph.conflictBehavior': conflictBehavior ? conflictBehavior : 'rename'\n      }\n    };\n    let response: UploadSession;\n    try {\n      response = (await graph\n        .api(resource)\n        .middlewareOptions(prepScopes(validFileUploadScopes))\n        .post(JSON.stringify(sessionOptions))) as UploadSession;\n      // eslint-disable-next-line no-empty\n    } catch {}\n\n    return response || null;\n  } catch (e) {\n    return null;\n  }\n};\n\n/**\n * send file chunck to OneDrive, SharePoint Site\n *\n * @param graph\n * @param resource\n * @param file\n * @returns\n */\nexport const sendFileChunk = async (\n  graph: IGraph,\n  resource: string,\n  contentLength: string,\n  contentRange: string,\n  file: Blob\n): Promise<UploadSession | DriveItem> => {\n  try {\n    // get from graph request\n    const header = {\n      'Content-Length': contentLength,\n      'Content-Range': contentRange\n    };\n    let response: UploadSession | DriveItem;\n    try {\n      response = (await graph.client\n        .api(resource)\n        .middlewareOptions(prepScopes(validFileUploadScopes))\n        .headers(header)\n        .put(file)) as UploadSession | DriveItem;\n      // eslint-disable-next-line no-empty\n    } catch {}\n\n    return response || null;\n  } catch (e) {\n    return null;\n  }\n};\n\n/**\n * send file to OneDrive, SharePoint Site\n *\n * @param graph\n * @param resource\n * @param file\n * @returns\n */\nexport const sendFileContent = async (graph: IGraph, resource: string, file: File): Promise<DriveItem> => {\n  try {\n    // get from graph request\n    let response: DriveItem;\n    try {\n      response = (await graph.client\n        .api(resource)\n        .middlewareOptions(prepScopes(validFileUploadScopes))\n        .put(file)) as DriveItem;\n      // eslint-disable-next-line no-empty\n    } catch {}\n\n    return response || null;\n  } catch (e) {\n    return null;\n  }\n};\n\n/**\n * delete upload session\n *\n * @param graph\n * @param resource\n * @returns\n */\nexport const deleteSessionFile = async (graph: IGraph, resource: string): Promise<void> => {\n  try {\n    await graph.client.api(resource).middlewareOptions(prepScopes(validFileUploadScopes)).delete();\n  } catch {\n    // TODO: re-examine the error handling here\n    // DELETE returns a 204 on success so void makes sense to return on the happy path\n    // but we should probably throw on error\n    return null;\n  }\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { IGraph, prepScopes, CacheItem, CacheService, CacheStore, CacheSchema } from '@microsoft/mgt-element';\nimport { Contact, Person, User } from '@microsoft/microsoft-graph-types';\nimport { CollectionResponse } from '@microsoft/mgt-element';\nimport { extractEmailAddress } from '../utils/Utils';\nimport { schemas } from './cacheStores';\nimport { IDynamicPerson } from './types';\n\nconst personTypes = ['any', 'person', 'group'] as const;\n/**\n * Person Type enum\n *\n * @export\n * @enum {string}\n */\nexport type PersonType = (typeof personTypes)[number];\nexport const isPersonType = (value: unknown): value is PersonType =>\n  typeof value === 'string' && personTypes.includes(value as PersonType);\nexport const personTypeConverter = (value: string, defaultValue: PersonType = 'any'): PersonType =>\n  isPersonType(value) ? value : defaultValue;\n\nconst userTypes = ['any', 'user', 'contact'] as const;\n/**\n * User Type enum\n *\n * @export\n * @enum {string}\n */\nexport type UserType = (typeof userTypes)[number];\n\nexport const isUserType = (value: unknown): value is UserType => {\n  return typeof value === 'string' && userTypes.includes(value as UserType);\n};\n\nexport const userTypeConverter = (value: string, defaultValue: UserType = 'any'): UserType =>\n  isUserType(value) ? value : defaultValue;\n\n/**\n * Object to be stored in cache representing individual people\n */\ninterface CachePerson extends CacheItem {\n  /**\n   * json representing a person stored as string\n   */\n  person?: string;\n}\n\n/**\n * Stores results of queries (multiple people returned)\n */\ninterface CachePeopleQuery extends CacheItem {\n  /**\n   * max number of results the query asks for\n   */\n  maxResults?: number;\n  /**\n   * list of people returned by query (might be less than max results!)\n   */\n  results?: string[];\n}\n\n/**\n * Defines the expiration time\n */\nconst getPeopleInvalidationTime = (): number => {\n  return CacheService.config.people.invalidationPeriod || CacheService.config.defaultInvalidationPeriod;\n};\n\n/**\n * Whether the people store is enabled\n */\nconst getIsPeopleCacheEnabled = (): boolean => CacheService.config.people.isEnabled && CacheService.config.isEnabled;\n\nconst validPeopleQueryScopes = ['People.Read', 'People.Read.All'];\nconst validContactQueryScopes = ['Contacts.Read', 'Contacts.ReadWrite'];\n\n/**\n * async promise, returns all Graph people who are most relevant contacts to the signed in user.\n *\n * @param {IGraph} graph\n * @param {string} query\n * @param {number} [top=10] - number of people to return\n * @param {UserType} [personType='any'] - the type of person to search for\n * @returns {(Promise<Person[]>)}\n */\nexport const findPeople = async (\n  graph: IGraph,\n  query: string,\n  top = 10,\n  userType: UserType = 'any',\n  filters = ''\n): Promise<Person[]> => {\n  const cacheKey = `${query}:${top}:${userType}`;\n  let cache: CacheStore<CachePeopleQuery>;\n  if (getIsPeopleCacheEnabled()) {\n    const people: CacheSchema = schemas.people;\n    const peopleQuery: string = schemas.people.stores.peopleQuery;\n    cache = CacheService.getCache<CachePeopleQuery>(people, peopleQuery);\n    const result: CachePeopleQuery = getIsPeopleCacheEnabled() ? await cache.getValue(cacheKey) : null;\n    if (result && getPeopleInvalidationTime() > Date.now() - result.timeCached) {\n      return result.results.map(peopleStr => JSON.parse(peopleStr) as Person);\n    }\n  }\n\n  let filter = \"personType/class eq 'Person'\";\n\n  if (userType !== 'any') {\n    if (userType === 'user') {\n      filter += \"and personType/subclass eq 'OrganizationUser'\";\n    } else {\n      filter += \"and (personType/subclass eq 'ImplicitContact' or personType/subclass eq 'PersonalContact')\";\n    }\n  }\n\n  if (filters !== '') {\n    // Adding the default people filters to the search filters\n    filter += ` and  ${filters}`;\n  }\n  let graphResult: CollectionResponse<Person>;\n  try {\n    let graphRequest = graph\n      .api('/me/people')\n      .search('\"' + query + '\"')\n      .top(top)\n      .filter(filter)\n      .middlewareOptions(prepScopes(validPeopleQueryScopes));\n\n    if (userType !== 'contact') {\n      // for any type other than Contact, user a wider search\n      graphRequest = graphRequest.header('X-PeopleQuery-QuerySources', 'Mailbox,Directory');\n    }\n\n    graphResult = (await graphRequest.get()) as CollectionResponse<Person>;\n\n    if (getIsPeopleCacheEnabled() && graphResult) {\n      const item: CachePeopleQuery = { maxResults: top, results: null };\n      item.results = graphResult.value.map(personStr => JSON.stringify(personStr));\n      await cache.putValue(cacheKey, item);\n    }\n  } catch (error) {\n    // intentionally empty\n  }\n  return graphResult?.value;\n};\n\n/**\n * async promise to the Graph for People, by default, it will request the most frequent contacts for the signed in user.\n *\n * @returns {(Promise<Person[]>)}\n * @memberof Graph\n */\nexport const getPeople = async (\n  graph: IGraph,\n  userType: UserType = 'any',\n  peopleFilters = '',\n  top = 10\n): Promise<Person[]> => {\n  let cache: CacheStore<CachePeopleQuery>;\n  const cacheKey = `${peopleFilters ? peopleFilters : `*:${userType}`}:${top}`;\n\n  if (getIsPeopleCacheEnabled()) {\n    cache = CacheService.getCache<CachePeopleQuery>(schemas.people, schemas.people.stores.peopleQuery);\n    const cacheRes = await cache.getValue(cacheKey);\n\n    if (cacheRes && getPeopleInvalidationTime() > Date.now() - cacheRes.timeCached) {\n      return cacheRes.results.map(ppl => JSON.parse(ppl) as Person);\n    }\n  }\n\n  const uri = '/me/people';\n  let filter = \"personType/class eq 'Person'\";\n  if (userType !== 'any') {\n    if (userType === 'user') {\n      filter += \"and personType/subclass eq 'OrganizationUser'\";\n    } else {\n      filter += \"and (personType/subclass eq 'ImplicitContact' or personType/subclass eq 'PersonalContact')\";\n    }\n  }\n\n  if (peopleFilters) {\n    filter += ` and ${peopleFilters}`;\n  }\n\n  let people: CollectionResponse<Person>;\n  try {\n    let graphRequest = graph.api(uri).middlewareOptions(prepScopes(validPeopleQueryScopes)).top(top).filter(filter);\n\n    if (userType !== 'contact') {\n      // for any type other than Contact, user a wider search\n      graphRequest = graphRequest.header('X-PeopleQuery-QuerySources', 'Mailbox,Directory');\n    }\n\n    people = (await graphRequest.get()) as CollectionResponse<Person>;\n    if (getIsPeopleCacheEnabled() && people) {\n      await cache.putValue(cacheKey, { maxResults: 10, results: people.value.map(ppl => JSON.stringify(ppl)) });\n    }\n  } catch (_) {\n    // no-op\n  }\n  return people ? people.value : null;\n};\n\n/**\n * Attempts to extract the email from the IDynamicPerson properties.\n *\n * @param {IDynamicperson} entity\n */\nexport const getEmailFromGraphEntity = (entity: IDynamicPerson): string => {\n  const person = entity as Person;\n  const user = entity as User;\n  const contact = entity as Contact;\n\n  if (user.mail) {\n    return extractEmailAddress(user.mail);\n  } else if (person.scoredEmailAddresses?.length) {\n    return extractEmailAddress(person.scoredEmailAddresses[0].address);\n  } else if (contact.emailAddresses?.length) {\n    return extractEmailAddress(contact.emailAddresses[0].address);\n  }\n  return null;\n};\n\n/**\n * async promise, returns a Graph contact associated with the email provided\n *\n * @param {string} email\n * @returns {(Promise<Contact[]>)}\n * @memberof Graph\n */\nexport const findContactsByEmail = async (graph: IGraph, email: string): Promise<Contact[]> => {\n  let cache: CacheStore<CachePerson>;\n  if (getIsPeopleCacheEnabled()) {\n    cache = CacheService.getCache<CachePerson>(schemas.people, schemas.people.stores.contacts);\n    const contact = await cache.getValue(email);\n\n    if (contact && getPeopleInvalidationTime() > Date.now() - contact.timeCached) {\n      return JSON.parse(contact.person) as Contact[];\n    }\n  }\n\n  const encodedEmail = `${email.replace(/#/g, '%2523')}`;\n\n  const result = (await graph\n    .api('/me/contacts')\n    .filter(`emailAddresses/any(a:a/address eq '${encodedEmail}')`)\n    .middlewareOptions(prepScopes(validContactQueryScopes))\n    .get()) as CollectionResponse<Contact>;\n\n  if (getIsPeopleCacheEnabled() && result) {\n    await cache.putValue(email, { person: JSON.stringify(result.value) });\n  }\n\n  return result ? result.value : null;\n};\n\n/**\n * async promise, returns Graph people matching the Graph query specified\n * in the resource param\n *\n * @param {IGraph} graph - the graph instance to use for making requests\n * @param {string} version - the graph version url segment to use when making requests\n * @param {string} resource - the resource segment of the graph url to be requested\n * @param {string[]} scopes - an array of scopes that are required to make the underlying graph request,\n *  if any scope provided is not currently consented then the user will be prompted for consent prior to\n *  making the graph request to load data.\n * @returns {(Promise<Person[]>)}\n * @memberof Graph\n */\nexport const getPeopleFromResource = async (\n  graph: IGraph,\n  version: string,\n  resource: string,\n  scopes: string[]\n): Promise<Person[]> => {\n  let cache: CacheStore<CachePeopleQuery>;\n  const key = `${version}${resource}`;\n  if (getIsPeopleCacheEnabled()) {\n    cache = CacheService.getCache<CachePeopleQuery>(schemas.people, schemas.people.stores.peopleQuery);\n    const result: CachePeopleQuery = await cache.getValue(key);\n    if (result && getPeopleInvalidationTime() > Date.now() - result.timeCached) {\n      return result.results.map(peopleStr => JSON.parse(peopleStr) as Person);\n    }\n  }\n\n  let request = graph.api(resource).version(version);\n\n  if (scopes?.length) {\n    request = request.middlewareOptions(prepScopes(scopes));\n  }\n\n  let response = (await request.get()) as CollectionResponse<Person>;\n  // get more pages if there are available\n  if (response && Array.isArray(response.value) && response['@odata.nextLink']) {\n    let page = response;\n\n    while (page?.['@odata.nextLink']) {\n      const nextLink = page['@odata.nextLink'] as string;\n      const nextResource = nextLink.split(version)[1];\n      page = (await graph.api(nextResource).version(version).get()) as CollectionResponse<Person>;\n      if (page?.value?.length) {\n        page.value = response.value.concat(page.value);\n        response = page;\n      }\n    }\n  }\n\n  if (getIsPeopleCacheEnabled() && response) {\n    const item = { results: null };\n    if (Array.isArray(response.value)) {\n      item.results = response.value.map(personStr => JSON.stringify(personStr));\n    } else {\n      item.results = [JSON.stringify(response)];\n    }\n    await cache.putValue(key, item);\n  }\n\n  return response?.value;\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { IGraph, prepScopes, CacheItem, CacheService, CacheStore } from '@microsoft/mgt-element';\nimport { ResponseType } from '@microsoft/microsoft-graph-client';\nimport * as MicrosoftGraph from '@microsoft/microsoft-graph-types';\nimport { Person, ProfilePhoto } from '@microsoft/microsoft-graph-types';\n\nimport { blobToBase64 } from '../utils/Utils';\nimport { schemas } from './cacheStores';\nimport { findContactsByEmail, getEmailFromGraphEntity } from './graph.people';\nimport { findUsers } from './graph.user';\nimport { IDynamicPerson } from './types';\n\n/**\n * photo object stored in cache\n */\nexport interface CachePhoto extends CacheItem {\n  /**\n   * user tag associated with photo\n   */\n  eTag?: string;\n  /**\n   * user/contact photo\n   */\n  photo?: string;\n}\n\n/**\n * Defines expiration time\n */\nexport const getPhotoInvalidationTime = () =>\n  CacheService.config.photos.invalidationPeriod || CacheService.config.defaultInvalidationPeriod;\n\n/**\n * Whether photo store is enabled\n */\nexport const getIsPhotosCacheEnabled = () => CacheService.config.photos.isEnabled && CacheService.config.isEnabled;\n\n/**\n * Ordered list of scopes able to load user photos for any user, least privilege comes first\n */\nexport const anyUserValidPhotoScopes = ['User.ReadBasic.All', 'User.Read.All', 'User.ReadWrite.All'];\n\n/**\n * Ordered list of scopes able to load user photo for the current user, least privilege comes first\n */\nexport const currentUserValidPhotoScopes = ['User.Read', 'User.ReadWrite', ...anyUserValidPhotoScopes];\n\n/**\n * retrieves a photo for the specified resource.\n *\n * @param {string} resource\n * @param {string[]} scopes\n * @returns {Promise<string>}\n */\nexport const getPhotoForResource = async (graph: IGraph, resource: string, scopes: string[]): Promise<CachePhoto> => {\n  try {\n    const response = (await graph\n      .api(`${resource}/photo/$value`)\n      .responseType(ResponseType.RAW)\n      .middlewareOptions(prepScopes(scopes))\n      .get()) as Response;\n\n    if (response.status === 404) {\n      // 404 means the resource does not have a photo\n      // we still want to cache that state\n      // so we return an object that can be cached\n      return { eTag: null, photo: null };\n    } else if (!response.ok) {\n      return null;\n    }\n\n    const eTag = response['@odata.mediaEtag'] as string;\n    const blob = await blobToBase64(await response.blob());\n    return { eTag, photo: blob };\n  } catch (e) {\n    return null;\n  }\n};\n\n/**\n * async promise, returns Graph photos associated with contacts of the logged in user\n *\n * @param contactId\n * @returns {Promise<string>}\n * @memberof Graph\n */\nexport const getContactPhoto = async (graph: IGraph, contactId: string): Promise<string> => {\n  let cache: CacheStore<CachePhoto>;\n  let photoDetails: CachePhoto;\n  if (getIsPhotosCacheEnabled()) {\n    cache = CacheService.getCache<CachePhoto>(schemas.photos, schemas.photos.stores.contacts);\n    photoDetails = await cache.getValue(contactId);\n    if (photoDetails && getPhotoInvalidationTime() > Date.now() - photoDetails.timeCached) {\n      return photoDetails.photo;\n    }\n  }\n  const validContactPhotoScopes = ['Contacts.Read', 'Contacts.ReadWrite'];\n\n  photoDetails = await getPhotoForResource(graph, `me/contacts/${contactId}`, validContactPhotoScopes);\n  if (getIsPhotosCacheEnabled() && photoDetails) {\n    await cache.putValue(contactId, photoDetails);\n  }\n  return photoDetails ? photoDetails.photo : null;\n};\n\n/**\n * async promise, returns Graph photo associated with provided userId\n *\n * @param userId\n * @returns {Promise<string>}\n * @memberof Graph\n */\nexport const getUserPhoto = async (graph: IGraph, userId: string): Promise<string> => {\n  let cache: CacheStore<CachePhoto>;\n  let photoDetails: CachePhoto;\n\n  if (getIsPhotosCacheEnabled()) {\n    cache = CacheService.getCache<CachePhoto>(schemas.photos, schemas.photos.stores.users);\n    photoDetails = await cache.getValue(userId);\n    if (photoDetails && getPhotoInvalidationTime() > Date.now() - photoDetails.timeCached) {\n      return photoDetails.photo;\n    } else if (photoDetails) {\n      // there is a photo in the cache, but it's stale. implicit assumption that the app has permissions\n      // necessary to fetch photo metadata otherwise there couldn't be data in the cache\n      try {\n        const response = (await graph.api(`users/${userId}/photo`).get()) as ProfilePhoto;\n        if (\n          response &&\n          (response['@odata.mediaEtag'] !== photoDetails.eTag ||\n            (response['@odata.mediaEtag'] === null && photoDetails.eTag === null))\n        ) {\n          // set photoDetails to null so that photo gets pulled from the graph later\n          photoDetails = null;\n        }\n      } catch {\n        return null;\n      }\n    }\n  }\n  // if there is a photo in the cache, we got here because it was stale\n  photoDetails = photoDetails || (await getPhotoForResource(graph, `users/${userId}`, anyUserValidPhotoScopes));\n  if (getIsPhotosCacheEnabled() && photoDetails) {\n    await cache.putValue(userId, photoDetails);\n  }\n  return photoDetails ? photoDetails.photo : null;\n};\n\n/**\n * async promise, returns Graph photo associated with the logged in user\n *\n * @returns {Promise<string>}\n * @memberof Graph\n */\nexport const myPhoto = async (graph: IGraph): Promise<string> => {\n  let cache: CacheStore<CachePhoto>;\n  let photoDetails: CachePhoto;\n  if (getIsPhotosCacheEnabled()) {\n    cache = CacheService.getCache<CachePhoto>(schemas.photos, schemas.photos.stores.users);\n    photoDetails = await cache.getValue('me');\n    if (photoDetails && getPhotoInvalidationTime() > Date.now() - photoDetails.timeCached) {\n      return photoDetails.photo;\n    }\n  }\n\n  try {\n    const response = (await graph.api('me/photo').get()) as ProfilePhoto;\n    if (\n      response &&\n      (response['@odata.mediaEtag'] !== photoDetails.eTag ||\n        (response['@odata.mediaEtag'] === null && photoDetails.eTag === null))\n    ) {\n      photoDetails = null;\n    }\n  } catch {\n    return null;\n  }\n  photoDetails = photoDetails || (await getPhotoForResource(graph, 'me', currentUserValidPhotoScopes));\n  if (getIsPhotosCacheEnabled()) {\n    await cache.putValue('me', photoDetails || {});\n  }\n\n  return photoDetails ? photoDetails.photo : null;\n};\n\n/**\n * async promise, loads image of user\n *\n * @export\n */\nexport const getPersonImage = async (graph: IGraph, person: IDynamicPerson, useContactsApis = true) => {\n  // handle if person but not user\n  if ('personType' in person && (person as Person).personType.subclass !== 'OrganizationUser') {\n    if ((person as Person).personType.subclass === 'PersonalContact' && useContactsApis) {\n      // if person is a contact, look for them and their photo in contact api\n      const contactMail = getEmailFromGraphEntity(person);\n      const contact = await findContactsByEmail(graph, contactMail);\n      if (contact?.length && contact[0].id) {\n        return await getContactPhoto(graph, contact[0].id);\n      }\n    }\n\n    return null;\n  }\n\n  // handle if user\n  if ((person as MicrosoftGraph.Person).userPrincipalName || person.id) {\n    // try to find a user by userPrincipalName\n    const id = (person as MicrosoftGraph.Person).userPrincipalName || person.id;\n    return await getUserPhoto(graph, id);\n  }\n\n  // else assume id is for user and try to get photo\n  if (person.id) {\n    const image = await getUserPhoto(graph, person.id);\n    if (image) {\n      return image;\n    }\n  }\n\n  // let's try to find a person by the email\n  const email = getEmailFromGraphEntity(person);\n\n  if (email) {\n    // try to find user\n    const users = await findUsers(graph, email, 1);\n    if (users?.length) {\n      return await getUserPhoto(graph, users[0].id);\n    }\n\n    // if no user, try to find a contact\n    if (useContactsApis) {\n      const contacts = await findContactsByEmail(graph, email);\n      if (contacts?.length) {\n        return await getContactPhoto(graph, contacts[0].id);\n      }\n    }\n  }\n\n  return null;\n};\n\n/**\n * Load the image for a group\n *\n * @param graph\n * @param group\n * @param useContactsApis\n * @returns\n */\nexport const getGroupImage = async (graph: IGraph, group: IDynamicPerson) => {\n  let photoDetails: CachePhoto;\n  let cache: CacheStore<CachePhoto>;\n\n  const groupId = group.id;\n\n  if (getIsPhotosCacheEnabled()) {\n    cache = CacheService.getCache<CachePhoto>(schemas.photos, schemas.photos.stores.groups);\n    photoDetails = await cache.getValue(groupId);\n    if (photoDetails && getPhotoInvalidationTime() > Date.now() - photoDetails.timeCached) {\n      return photoDetails.photo;\n    } else if (photoDetails) {\n      // there is a photo in the cache, but it's stale\n      try {\n        const response = (await graph.api(`groups/${groupId}/photo`).get()) as ProfilePhoto;\n        if (\n          response &&\n          (response['@odata.mediaEtag'] !== photoDetails.eTag ||\n            (response['@odata.mediaEtag'] === null && photoDetails.eTag === null))\n        ) {\n          // set photoDetails to null so that photo gets pulled from the graph later\n          photoDetails = null;\n        }\n      } catch {\n        return null;\n      }\n    }\n  }\n\n  const validGroupPhotoScopes = ['Group.Read.All', 'Group.ReadWrite.All'];\n  // if there is a photo in the cache, we got here because it was stale\n  photoDetails = photoDetails || (await getPhotoForResource(graph, `groups/${groupId}`, validGroupPhotoScopes));\n  if (getIsPhotosCacheEnabled() && photoDetails) {\n    await cache.putValue(groupId, photoDetails);\n  }\n  return photoDetails ? photoDetails.photo : null;\n};\n\n/**\n * checks if user has a photo in the cache\n *\n * @param userId\n * @returns {CachePhoto}\n * @memberof Graph\n */\nexport const getPhotoFromCache = async (userId: string, storeName: string): Promise<CachePhoto> => {\n  const cache = CacheService.getCache<CachePhoto>(schemas.photos, storeName);\n  const item = await cache.getValue(userId);\n  return item;\n};\n\n/**\n * checks if user has a photo in the cache\n *\n * @param userId\n * @returns {void}\n * @memberof Graph\n */\nexport const storePhotoInCache = async (userId: string, storeName: string, value: CachePhoto): Promise<void> => {\n  const cache = CacheService.getCache<CachePhoto>(schemas.photos, storeName);\n  await cache.putValue(userId, value);\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { IGraph, prepScopes, CacheItem, CacheService, CacheStore, CollectionResponse } from '@microsoft/mgt-element';\nimport { Person, Presence } from '@microsoft/microsoft-graph-types';\nimport { schemas } from './cacheStores';\nimport { IDynamicPerson } from './types';\n\n/**\n * Object to be stored in cache representing individual people\n */\ninterface CachePresence extends CacheItem {\n  /**\n   * json representing a person stored as string\n   */\n  presence?: string;\n}\n\n/**\n * Defines the expiration time\n */\nconst getPresenceInvalidationTime = (): number =>\n  CacheService.config.presence.invalidationPeriod || CacheService.config.defaultInvalidationPeriod;\n\n/**\n * Whether the groups store is enabled\n */\nconst getIsPresenceCacheEnabled = (): boolean =>\n  CacheService.config.presence.isEnabled && CacheService.config.isEnabled;\n\n/**\n * async promise, allows developer to get user presence\n *\n * @returns {Promise<Presence>}\n * @param {IGraph} graph\n * @param {string} userId - id for the user or null for current signed in user\n * @memberof BetaGraph\n */\nexport const getUserPresence = async (graph: IGraph, userId?: string): Promise<Presence> => {\n  let cache: CacheStore<CachePresence>;\n\n  if (getIsPresenceCacheEnabled()) {\n    cache = CacheService.getCache(schemas.presence, schemas.presence.stores.presence);\n    const presence = await cache.getValue(userId || 'me');\n    if (presence && getPresenceInvalidationTime() > Date.now() - presence.timeCached) {\n      return JSON.parse(presence.presence) as Presence;\n    }\n  }\n\n  const validScopes = userId ? ['presence.read.all'] : ['presence.read', 'presence.read.all'];\n  const resource = userId ? `/users/${userId}/presence` : '/me/presence';\n\n  const result = (await graph.api(resource).middlewareOptions(prepScopes(validScopes)).get()) as Presence;\n  if (getIsPresenceCacheEnabled()) {\n    await cache.putValue(userId || 'me', { presence: JSON.stringify(result) });\n  }\n\n  return result;\n};\n\n/**\n * Async promise, allows developer to get person presense by providing array of IDynamicPerson.\n * BypassCacheRead forces all presence to be queried from the graph but will still update the cache.\n *\n * @returns {}\n * @memberof BetaGraph\n */\nexport const getUsersPresenceByPeople = async (graph: IGraph, people?: IDynamicPerson[], bypassCacheRead = false) => {\n  if (!people || people.length === 0) {\n    return {};\n  }\n\n  const peoplePresence: Record<string, Presence> = {};\n  const peoplePresenceToQuery: string[] = [];\n  const validScopes = ['presence.read.all'];\n  let cache: CacheStore<CachePresence>;\n\n  if (getIsPresenceCacheEnabled()) {\n    cache = CacheService.getCache(schemas.presence, schemas.presence.stores.presence);\n  }\n\n  for (const person of people) {\n    if (person?.id) {\n      const id = person.id;\n      peoplePresence[id] = null;\n      let presence: CachePresence;\n      if (!bypassCacheRead && getIsPresenceCacheEnabled()) {\n        presence = await cache.getValue(id);\n      }\n      if (\n        !bypassCacheRead &&\n        getIsPresenceCacheEnabled() &&\n        presence &&\n        getPresenceInvalidationTime() > Date.now() - presence.timeCached\n      ) {\n        peoplePresence[id] = JSON.parse(presence.presence) as Presence;\n      } else {\n        peoplePresenceToQuery.push(id);\n      }\n    }\n  }\n\n  try {\n    if (peoplePresenceToQuery.length > 0) {\n      const presenceResult = (await graph\n        .api('/communications/getPresencesByUserId')\n        .middlewareOptions(prepScopes(validScopes))\n        .post({\n          ids: peoplePresenceToQuery\n        })) as CollectionResponse<Presence>;\n\n      for (const r of presenceResult.value) {\n        peoplePresence[r.id] = r;\n        if (getIsPresenceCacheEnabled()) {\n          await cache.putValue(r.id, { presence: JSON.stringify(r) });\n        }\n      }\n    }\n\n    return peoplePresence;\n  } catch (_) {\n    try {\n      /**\n       * individual calls to getUserPresence as fallback\n       * must filter out the contacts, which will either 404 or have PresenceUnknown response\n       * caching will be handled by getUserPresence\n       */\n      const response = await Promise.all(\n        people\n          .filter(\n            person =>\n              person?.id &&\n              !peoplePresence[person.id] &&\n              'personType' in person &&\n              (person as Person).personType.subclass === 'OrganizationUser'\n          )\n          .map(person => getUserPresence(graph, person.id))\n      );\n\n      for (const r of response) {\n        peoplePresence[r.id] = r;\n      }\n      return peoplePresence;\n    } catch (e) {\n      return null;\n    }\n  }\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { CacheItem, CacheService, CacheStore, CollectionResponse, IGraph, prepScopes } from '@microsoft/mgt-element';\nimport { User } from '@microsoft/microsoft-graph-types';\n\nimport { GraphRequest } from '@microsoft/microsoft-graph-client';\nimport { schemas } from './cacheStores';\nimport { findPeople, PersonType } from './graph.people';\nimport { IDynamicPerson } from './types';\n\n/**\n * Object to be stored in cache\n */\nexport interface CacheUser extends CacheItem {\n  /**\n   * stringified json representing a user\n   */\n  user?: string;\n}\n\n/**\n * Object to be stored in cache\n */\nexport interface CacheUserQuery extends CacheItem {\n  /**\n   * max number of results the query asks for\n   */\n  maxResults?: number;\n  /**\n   * list of users returned by query\n   */\n  results?: string[];\n}\n\n/**\n * Defines the time it takes for objects in the cache to expire\n */\nexport const getUserInvalidationTime = (): number =>\n  CacheService.config.users.invalidationPeriod || CacheService.config.defaultInvalidationPeriod;\n\n/**\n * Whether or not the cache is enabled\n */\nexport const getIsUsersCacheEnabled = (): boolean =>\n  CacheService.config.users.isEnabled && CacheService.config.isEnabled;\n\nexport const getUsers = async (graph: IGraph, userFilters = '', top = 10): Promise<User[]> => {\n  const allValidScopes = [\n    'User.ReadBasic.All',\n    'User.Read.All',\n    'Directory.Read.All',\n    'User.ReadWrite.All',\n    'Directory.ReadWrite.All'\n  ];\n  const apiString = '/users';\n  let cache: CacheStore<CacheUserQuery>;\n  const cacheKey = `${userFilters === '' ? '*' : userFilters}:${top}`;\n  const cacheItem = { maxResults: top, results: null };\n\n  if (getIsUsersCacheEnabled()) {\n    cache = CacheService.getCache<CacheUserQuery>(schemas.users, schemas.users.stores.userFilters);\n    const cacheRes = await cache.getValue(cacheKey);\n    if (cacheRes && getUserInvalidationTime() > Date.now() - cacheRes.timeCached) {\n      return cacheRes.results.map(userStr => JSON.parse(userStr) as User);\n    }\n  }\n  const graphClient: GraphRequest = graph.api(apiString).top(top);\n\n  if (userFilters) {\n    graphClient.filter(userFilters).header('ConsistencyLevel', 'eventual').count(true);\n  }\n\n  try {\n    const response = (await graphClient\n      .middlewareOptions(prepScopes(allValidScopes))\n      .get()) as CollectionResponse<User>;\n    if (getIsUsersCacheEnabled() && response) {\n      cacheItem.results = response.value.map(userStr => JSON.stringify(userStr));\n      await cache.putValue(userFilters, cacheItem);\n    }\n    return response.value;\n    // eslint-disable-next-line no-empty\n  } catch (error) {}\n};\n\nconst allValidMeScopes = ['User.Read', 'User.ReadWrite'];\n/**\n * async promise, returns Graph User data relating to the user logged in\n *\n * @returns {(Promise<User>)}\n * @memberof Graph\n */\nexport const getMe = async (graph: IGraph, requestedProps?: string[]): Promise<User> => {\n  // for the /me call we'll only use the single User.Read and User.ReadWrite permissions\n  // as they are explicitly scoped to the current user\n  let cache: CacheStore<CacheUser>;\n  if (getIsUsersCacheEnabled()) {\n    cache = CacheService.getCache<CacheUser>(schemas.users, schemas.users.stores.users);\n    const me = await cache.getValue('me');\n\n    if (me && getUserInvalidationTime() > Date.now() - me.timeCached) {\n      const cachedData = JSON.parse(me.user) as User;\n      const uniqueProps = requestedProps\n        ? requestedProps.filter(prop => !Object.keys(cachedData).includes(prop))\n        : null;\n\n      // if requestedProps doesn't contain any unique props other than \"@odata.context\"\n      if (!uniqueProps || uniqueProps.length <= 1) {\n        return cachedData;\n      }\n    }\n  }\n\n  let apiString = 'me';\n  if (requestedProps) {\n    apiString = apiString + '?$select=' + requestedProps.toString();\n  }\n  const response = (await graph.api(apiString).middlewareOptions(prepScopes(allValidMeScopes)).get()) as User;\n  if (getIsUsersCacheEnabled()) {\n    await cache.putValue('me', { user: JSON.stringify(response) });\n  }\n  return response;\n};\n\nexport const validUserByIdScopes = [\n  'User.ReadBasic.All',\n  'User.Read.All',\n  'Directory.Read.All',\n  'User.ReadWrite.All',\n  'Directory.ReadWrite.All'\n];\n/**\n * async promise, returns all Graph users associated with the userPrincipleName provided\n *\n * @param {string} userPrincipleName\n * @returns {(Promise<User>)}\n * @memberof Graph\n */\nexport const getUser = async (graph: IGraph, userPrincipleName: string, requestedProps?: string[]): Promise<User> => {\n  let cache: CacheStore<CacheUser>;\n\n  if (getIsUsersCacheEnabled()) {\n    cache = CacheService.getCache<CacheUser>(schemas.users, schemas.users.stores.users);\n    // check cache\n    const user = await cache.getValue(userPrincipleName);\n\n    // is it stored and is timestamp good?\n    if (user && getUserInvalidationTime() > Date.now() - user.timeCached) {\n      const cachedData = user.user ? (JSON.parse(user.user) as User) : null;\n      const uniqueProps =\n        requestedProps && cachedData ? requestedProps.filter(prop => !Object.keys(cachedData).includes(prop)) : null;\n\n      // return without any worries\n      if (!uniqueProps || uniqueProps.length <= 1) {\n        return cachedData;\n      }\n    }\n  }\n\n  let apiString = `/users/${userPrincipleName}`;\n  if (requestedProps) {\n    apiString = apiString + '?$select=' + requestedProps.toString();\n  }\n\n  // else we must grab it\n  let response: User;\n  try {\n    response = (await graph.api(apiString).middlewareOptions(prepScopes(validUserByIdScopes)).get()) as User;\n    // eslint-disable-next-line no-empty\n  } catch (_) {}\n\n  if (getIsUsersCacheEnabled()) {\n    await cache.putValue(userPrincipleName, { user: JSON.stringify(response) });\n  }\n  return response;\n};\n\n/**\n * Returns a Promise of Graph Users array associated with the user ids array\n *\n * @export\n * @param {IGraph} graph\n * @param {string[]} userIds, an array of string ids\n * @returns {Promise<User[]>}\n */\nexport const getUsersForUserIds = async (\n  graph: IGraph,\n  userIds: string[],\n  searchInput = '',\n  userFilters = '',\n  fallbackDetails?: IDynamicPerson[]\n): Promise<User[]> => {\n  if (!userIds || userIds.length === 0) {\n    return [];\n  }\n  const batch = graph.createBatch<User>();\n  const peopleDict: Record<string, User | Promise<User>> = {};\n  const peopleSearchMatches = {};\n  const notInCache = [];\n  searchInput = searchInput.toLowerCase();\n  let cache: CacheStore<CacheUser>;\n\n  if (getIsUsersCacheEnabled()) {\n    cache = CacheService.getCache<CacheUser>(schemas.users, schemas.users.stores.users);\n  }\n\n  for (const id of userIds) {\n    peopleDict[id] = null;\n    let apiUrl = `/users/${id}`;\n    let user: User;\n    let cacheUser: CacheUser;\n    if (getIsUsersCacheEnabled()) {\n      cacheUser = await cache.getValue(id);\n    }\n    if (cacheUser?.user && getUserInvalidationTime() > Date.now() - cacheUser.timeCached) {\n      user = JSON.parse(cacheUser?.user) as User;\n\n      if (searchInput) {\n        if (user) {\n          const displayName = user.displayName;\n          const searchMatches = displayName?.toLowerCase().includes(searchInput);\n          if (searchMatches) {\n            peopleSearchMatches[id] = user;\n          }\n        }\n      } else {\n        if (user) {\n          peopleDict[id] = user;\n        } else {\n          batch.get(id, apiUrl, validUserByIdScopes);\n          notInCache.push(id);\n        }\n      }\n    } else if (id !== '') {\n      if (id === 'me') {\n        peopleDict[id] = await getMe(graph);\n      } else {\n        apiUrl = `/users/${id}`;\n        if (userFilters) {\n          apiUrl += `${apiUrl}?$filter=${userFilters}&$count=true`;\n        }\n        batch.get(id, apiUrl, validUserByIdScopes, userFilters ? { ConsistencyLevel: 'eventual' } : {});\n        notInCache.push(id);\n      }\n    }\n  }\n  try {\n    if (batch.hasRequests) {\n      const responses = await batch.executeAll();\n      // iterate over userIds to ensure the order of ids\n      for (const id of userIds) {\n        const response = responses.get(id);\n        if (response?.content) {\n          const user = response.content;\n          if (searchInput) {\n            const displayName = user?.displayName.toLowerCase() || '';\n            if (displayName.includes(searchInput)) {\n              peopleSearchMatches[id] = user;\n            }\n          } else {\n            peopleDict[id] = user;\n          }\n\n          if (getIsUsersCacheEnabled()) {\n            await cache.putValue(id, { user: JSON.stringify(user) });\n          }\n        } else {\n          const fallback = fallbackDetails.find(detail => Object.values(detail).includes(id));\n          if (fallback) {\n            peopleDict[id] = fallback as User;\n          }\n        }\n      }\n    }\n    if (searchInput && Object.keys(peopleSearchMatches).length) {\n      return Promise.all(Object.values(peopleSearchMatches));\n    }\n    return Promise.all(Object.values(peopleDict));\n  } catch (_) {\n    // fallback to making the request one by one\n    try {\n      // call getUser for all the users that weren't cached\n      userIds\n        .filter(id => notInCache.includes(id))\n        .forEach(id => {\n          peopleDict[id] = getUser(graph, id);\n        });\n      if (getIsUsersCacheEnabled()) {\n        // store all users that weren't retrieved from the cache, into the cache\n        await Promise.all(\n          userIds\n            .filter(id => notInCache.includes(id))\n            .map(async id => await cache.putValue(id, { user: JSON.stringify(await peopleDict[id]) }))\n        );\n      }\n      return Promise.all(Object.values(peopleDict));\n    } catch (e) {\n      return [];\n    }\n  }\n};\n\n/**\n * Returns a Promise of Graph Users array associated with the people queries array\n *\n * @export\n * @param {IGraph} graph\n * @param {string[]} peopleQueries, an array of string ids\n * @returns {Promise<User[]>}\n */\nexport const getUsersForPeopleQueries = async (\n  graph: IGraph,\n  peopleQueries: string[],\n  fallbackDetails?: IDynamicPerson[]\n): Promise<User[]> => {\n  const allValidPeopleScopes = ['People.Read', 'People.Read.All'];\n  if (!peopleQueries || peopleQueries.length === 0) {\n    return [];\n  }\n\n  const batch = graph.createBatch<CollectionResponse<User>>();\n  const people: User[] = [];\n  let cacheRes: CacheUserQuery;\n  let cache: CacheStore<CacheUserQuery>;\n  if (getIsUsersCacheEnabled()) {\n    cache = CacheService.getCache<CacheUserQuery>(schemas.users, schemas.users.stores.usersQuery);\n  }\n\n  for (const personQuery of peopleQueries) {\n    if (getIsUsersCacheEnabled()) {\n      cacheRes = await cache.getValue(personQuery);\n    }\n\n    if (\n      getIsUsersCacheEnabled() &&\n      cacheRes?.results[0] &&\n      getUserInvalidationTime() > Date.now() - cacheRes.timeCached\n    ) {\n      const person = JSON.parse(cacheRes.results[0]) as User;\n      people.push(person);\n    } else {\n      batch.get(personQuery, `/me/people?$search=\"${personQuery}\"`, allValidPeopleScopes, {\n        'X-PeopleQuery-QuerySources': 'Mailbox,Directory'\n      });\n    }\n  }\n\n  if (batch.hasRequests) {\n    try {\n      const responses = await batch.executeAll();\n\n      for (const personQuery of peopleQueries) {\n        const response = responses.get(personQuery);\n        if (response?.content?.value && response.content.value.length > 0) {\n          people.push(response.content.value[0]);\n          if (getIsUsersCacheEnabled()) {\n            await cache.putValue(personQuery, { maxResults: 1, results: [JSON.stringify(response.content.value[0])] });\n          }\n        } else {\n          const fallback = fallbackDetails.find(detail => Object.values(detail).includes(personQuery));\n          if (fallback) {\n            people.push(fallback as User);\n          }\n        }\n      }\n\n      return people;\n    } catch (_) {\n      try {\n        return Promise.all(\n          peopleQueries\n            .filter(personQuery => personQuery && personQuery !== '')\n            .map(async personQuery => {\n              const personArray = await findPeople(graph, personQuery, 1);\n              if (personArray?.length) {\n                if (getIsUsersCacheEnabled()) {\n                  await cache.putValue(personQuery, { maxResults: 1, results: [JSON.stringify(personArray[0])] });\n                }\n                return personArray[0];\n              }\n            })\n        );\n      } catch (e) {\n        return [];\n      }\n    }\n  }\n  return people;\n};\n\n/**\n * Search Microsoft Graph for Users in the organization\n *\n * @export\n * @param {IGraph} graph\n * @param {string} query - the string to search for\n * @param {number} [top=10] - maximum number of results to return\n * @returns {Promise<User[]>}\n */\nexport const findUsers = async (graph: IGraph, query: string, top = 10, userFilters = ''): Promise<User[]> => {\n  const scopes = validUserByIdScopes;\n  const item = { maxResults: top, results: null };\n  const cacheKey = `${query}:${top}:${userFilters}`;\n  let cache: CacheStore<CacheUserQuery>;\n\n  if (getIsUsersCacheEnabled()) {\n    cache = CacheService.getCache<CacheUserQuery>(schemas.users, schemas.users.stores.usersQuery);\n    const result: CacheUserQuery = await cache.getValue(cacheKey);\n\n    if (result && getUserInvalidationTime() > Date.now() - result.timeCached) {\n      return result.results.map(userStr => JSON.parse(userStr) as User);\n    }\n  }\n\n  const encodedQuery = `${query.replace(/#/g, '%2523')}`;\n  const graphBuilder = graph.api('users').search(`\"displayName:${encodedQuery}\" OR \"mail:${encodedQuery}\"`);\n  let graphResult: CollectionResponse<User>;\n\n  if (userFilters !== '') {\n    graphBuilder.filter(userFilters).header('ConsistencyLevel', 'eventual').count(true);\n  }\n  try {\n    graphResult = (await graphBuilder.top(top).middlewareOptions(prepScopes(scopes)).get()) as CollectionResponse<User>;\n    // eslint-disable-next-line no-empty\n  } catch {}\n\n  if (getIsUsersCacheEnabled() && graphResult) {\n    item.results = graphResult.value.map(userStr => JSON.stringify(userStr));\n    await cache.putValue(query, item);\n  }\n  return graphResult ? graphResult.value : null;\n};\n\n/**\n * async promise, returns all matching Graph users who are member of the specified group\n *\n * @param {string} query\n * @param {string} groupId - the group to query\n * @param {number} [top=10] - number of people to return\n * @param {PersonType} [personType='person'] - the type of person to search for\n * @param {boolean} [transitive=false] - whether the return should contain a flat list of all nested members\n * @returns {(Promise<User[]>)}\n */\nexport const findGroupMembers = async (\n  graph: IGraph,\n  query: string,\n  groupId: string,\n  top = 10,\n  personType: PersonType = 'person',\n  transitive = false,\n  userFilters = '',\n  peopleFilters = ''\n): Promise<User[]> => {\n  const allValidScopes = [\n    'GroupMember.Read.All',\n    'Group.Read.All',\n    'Directory.Read.All',\n    'GroupMember.ReadWrite.All',\n    'Group.ReadWrite.All'\n  ];\n  const item = { maxResults: top, results: null };\n\n  let cache: CacheStore<CacheUserQuery>;\n  const key = `${groupId || '*'}:${query || '*'}:${top}:${personType}:${transitive}:${userFilters}`;\n\n  if (getIsUsersCacheEnabled()) {\n    cache = CacheService.getCache<CacheUserQuery>(schemas.users, schemas.users.stores.usersQuery);\n    const result: CacheUserQuery = await cache.getValue(key);\n\n    if (result && getUserInvalidationTime() > Date.now() - result.timeCached) {\n      return result.results.map(userStr => JSON.parse(userStr) as User);\n    }\n  }\n\n  let filter = '';\n  if (query) {\n    filter = `startswith(displayName,'${query}') or startswith(givenName,'${query}') or startswith(surname,'${query}') or startswith(mail,'${query}') or startswith(userPrincipalName,'${query}')`;\n  }\n\n  let apiUrl = `/groups/${groupId}/${transitive ? 'transitiveMembers' : 'members'}`;\n  if (personType === 'person') {\n    apiUrl += '/microsoft.graph.user';\n  } else if (personType === 'group') {\n    apiUrl += '/microsoft.graph.group';\n    if (query) {\n      filter = `startswith(displayName,'${query}') or startswith(mail,'${query}')`;\n    }\n  }\n\n  if (userFilters) {\n    filter += query ? ` and ${userFilters}` : userFilters;\n  }\n\n  if (peopleFilters) {\n    filter += query ? ` and ${peopleFilters}` : peopleFilters;\n  }\n\n  const graphClient: GraphRequest = graph.api(apiUrl).top(top).filter(filter);\n\n  if (userFilters) {\n    graphClient.header('ConsistencyLevel', 'eventual').count(true);\n  }\n\n  const graphResult = (await graphClient\n    .middlewareOptions(prepScopes(allValidScopes))\n    .get()) as CollectionResponse<User>;\n\n  if (getIsUsersCacheEnabled() && graphResult) {\n    item.results = graphResult.value.map(userStr => JSON.stringify(userStr));\n    await cache.putValue(key, item);\n  }\n\n  return graphResult ? graphResult.value : null;\n};\n\nexport const findUsersFromGroupIds = async (\n  graph: IGraph,\n  query: string,\n  groupIds: string[],\n  top = 10,\n  personType: PersonType = 'person',\n  transitive = false,\n  groupFilters = ''\n): Promise<User[]> => {\n  const users: User[] = [];\n  for (const groupId of groupIds) {\n    try {\n      const groupUsers = await findGroupMembers(graph, query, groupId, top, personType, transitive, groupFilters);\n      users.push(...groupUsers);\n    } catch (_) {\n      continue;\n    }\n  }\n  return users;\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { CacheService, IGraph, prepScopes } from '@microsoft/mgt-element';\n\nimport {\n  CachePhoto,\n  anyUserValidPhotoScopes,\n  currentUserValidPhotoScopes,\n  getIsPhotosCacheEnabled,\n  getPhotoForResource,\n  getPhotoFromCache,\n  getPhotoInvalidationTime,\n  storePhotoInCache\n} from './graph.photos';\nimport { CacheUser, getIsUsersCacheEnabled, getUserInvalidationTime } from './graph.user';\nimport { IDynamicPerson } from './types';\nimport { schemas } from './cacheStores';\nimport { Photo } from '@microsoft/microsoft-graph-types';\nimport { isGraphError } from './isGraphError';\n\n/**\n * async promise, returns IDynamicPerson\n *\n * @param {string} userId\n * @returns {(Promise<IDynamicPerson>)}\n * @memberof Graph\n */\nexport const getUserWithPhoto = async (\n  graph: IGraph,\n  userId?: string,\n  requestedProps?: string[]\n): Promise<IDynamicPerson> => {\n  const anyUserValidScopes = [\n    'User.ReadBasic.All',\n    'User.Read.All',\n    'Directory.Read.All',\n    'User.ReadWrite.All',\n    'Directory.ReadWrite.All'\n  ];\n\n  const currentUserValidScopes = ['User.Read', 'User.ReadWrite', ...anyUserValidScopes];\n\n  const requiredUserScopes = userId ? anyUserValidScopes : currentUserValidScopes;\n  const requiredPhotoScopes = userId ? anyUserValidPhotoScopes : currentUserValidPhotoScopes;\n\n  let photo: string;\n  let user: IDynamicPerson = null;\n\n  let cachedPhoto: CachePhoto;\n  let cachedUser: CacheUser;\n\n  const resource = userId ? `users/${userId}` : 'me';\n  const fullResource = resource + (requestedProps ? `?$select=${requestedProps.toString()}` : '');\n\n  // attempt to get user and photo from cache if enabled\n  if (getIsUsersCacheEnabled()) {\n    const cache = CacheService.getCache<CacheUser>(schemas.users, schemas.users.stores.users);\n    cachedUser = await cache.getValue(userId || 'me');\n    if (cachedUser && getUserInvalidationTime() > Date.now() - cachedUser.timeCached) {\n      user = cachedUser.user ? (JSON.parse(cachedUser.user) as IDynamicPerson) : null;\n      if (user !== null && requestedProps) {\n        const uniqueProps = requestedProps.filter(prop => !Object.keys(user).includes(prop));\n        if (uniqueProps.length >= 1) {\n          user = null;\n          cachedUser = null;\n        }\n      }\n    } else {\n      cachedUser = null;\n    }\n  }\n  if (getIsPhotosCacheEnabled()) {\n    cachedPhoto = await getPhotoFromCache(userId || 'me', schemas.photos.stores.users);\n    if (cachedPhoto && getPhotoInvalidationTime() > Date.now() - cachedPhoto.timeCached) {\n      photo = cachedPhoto.photo;\n    } else if (cachedPhoto) {\n      try {\n        const response: Photo = (await graph.api(`${resource}/photo`).get()) as Photo;\n        if (response?.['@odata.mediaEtag'] && response['@odata.mediaEtag'] === cachedPhoto.eTag) {\n          // put current image into the cache to update the timestamp since etag is the same\n          await storePhotoInCache(userId || 'me', schemas.photos.stores.users, cachedPhoto);\n          photo = cachedPhoto.photo;\n        } else {\n          cachedPhoto = null;\n        }\n      } catch (e: unknown) {\n        if (isGraphError(e)) {\n          // if 404 received (photo not found) but user already in cache, update timeCache value to prevent repeated 404 error / graph calls on each page refresh\n          if (e.code === 'ErrorItemNotFound' || e.code === 'ImageNotFound') {\n            await storePhotoInCache(userId || 'me', schemas.photos.stores.users, { eTag: null, photo: null });\n          }\n        }\n      }\n    }\n  }\n\n  // if both are not in the cache, batch get them\n  if (!cachedPhoto && !cachedUser) {\n    let eTag: string;\n\n    // batch calls\n    const batch = graph.createBatch();\n    if (userId) {\n      batch.get(\n        'user',\n        `/users/${userId}${requestedProps ? '?$select=' + requestedProps.toString() : ''}`,\n        requiredUserScopes\n      );\n      batch.get('photo', `users/${userId}/photo/$value`, requiredPhotoScopes);\n    } else {\n      batch.get('user', 'me', requiredUserScopes);\n      batch.get('photo', 'me/photo/$value', requiredPhotoScopes);\n    }\n    const response = await batch.executeAll();\n\n    const photoResponse = response.get('photo');\n    if (photoResponse) {\n      // eslint-disable-next-line @typescript-eslint/dot-notation\n      eTag = photoResponse.headers['ETag'];\n      photo = photoResponse.content as string;\n    }\n\n    const userResponse = response.get('user');\n    if (userResponse) {\n      user = userResponse.content as IDynamicPerson;\n    }\n\n    // store user & photo in their respective cache\n    if (getIsUsersCacheEnabled()) {\n      const cache = CacheService.getCache<CacheUser>(schemas.users, schemas.users.stores.users);\n      await cache.putValue(userId || 'me', { user: JSON.stringify(user) });\n    }\n    if (getIsPhotosCacheEnabled()) {\n      await storePhotoInCache(userId || 'me', schemas.photos.stores.users, { eTag, photo });\n    }\n  } else if (!cachedPhoto) {\n    try {\n      // if only photo or user is not cached, get it individually\n      const response = await getPhotoForResource(graph, resource, requiredPhotoScopes);\n      if (response) {\n        if (getIsPhotosCacheEnabled()) {\n          await storePhotoInCache(userId || 'me', schemas.photos.stores.users, {\n            eTag: response.eTag,\n            photo: response.photo\n          });\n        }\n        photo = response.photo;\n      }\n    } catch (_) {\n      // intentionally left empty...\n    }\n  } else if (!cachedUser) {\n    // get user from graph\n    try {\n      const response: IDynamicPerson = (await graph\n        .api(fullResource)\n        .middlewareOptions(prepScopes(requiredUserScopes))\n        .get()) as IDynamicPerson;\n\n      if (response) {\n        if (getIsUsersCacheEnabled()) {\n          const cache = CacheService.getCache<CacheUser>(schemas.users, schemas.users.stores.users);\n          await cache.putValue(userId || 'me', { user: JSON.stringify(response) });\n        }\n        user = response;\n      }\n    } catch (_) {\n      // intentionally left empty...\n    }\n  }\n\n  if (user) {\n    user.personImage = photo;\n  }\n  return user;\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { GraphError } from '@microsoft/microsoft-graph-client';\n\nexport const isGraphError = (e: unknown): e is GraphError => {\n  const test = e as GraphError;\n  return (\n    test.statusCode &&\n    'code' in test &&\n    'body' in test &&\n    test.date &&\n    'message' in test &&\n    'name' in test &&\n    'requestId' in test\n  );\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport * as MicrosoftGraph from '@microsoft/microsoft-graph-types';\n\n/**\n * IDynamicPerson describes the person object we use throughout mgt-person,\n * which can be one of three similar Graph types.\n *\n * In addition, this custom type also defines the optional `personImage` property,\n * which is used to pass the image around to other components as part of the person object.\n */\nexport type IUser = MicrosoftGraph.User | MicrosoftGraph.Person;\nexport type IContact = MicrosoftGraph.Contact;\nexport type IGroup = MicrosoftGraph.Group;\n\nexport type IDynamicPerson = (IUser | IContact | IGroup) & {\n  /**\n   * personDetails.personImage is a toolkit injected property to pass image between components\n   * an optimization to avoid fetching the image when unnecessary.\n   *\n   * @type {string}\n   */\n  personImage?: string;\n};\n\n/**\n * avatarSize describes the enum strings that can be passed in to determine\n * size of avatar.\n */\nexport type AvatarSize = 'small' | 'large' | 'auto';\n\n/**\n * Insight string types used to retrieve OneDrive files\n */\nexport type OfficeGraphInsightString = 'trending' | 'used' | 'shared';\n\nconst viewTypes = ['image', 'oneline', 'twolines', 'threelines', 'fourlines'] as const;\n/**\n * Enumeration to define what parts of the person component render\n *\n * @export\n * @enum {string}\n */\nexport type ViewType = (typeof viewTypes)[number];\n\nexport const isViewType = (value: unknown): value is ViewType => {\n  return typeof value === 'string' && viewTypes.includes(value as ViewType);\n};\n\nexport const viewTypeConverter = (value: string, defaultValue: ViewType = 'twolines'): ViewType => {\n  if (isViewType(value)) {\n    return value;\n  }\n  return defaultValue;\n};\n\n/**\n * Postion describes the position of the dropdown\n */\nexport type Position = 'above' | 'below';\n","// THIS FILE IS AUTO GENERATED\n// ANY CHANGES WILL BE LOST DURING BUILD\n// MODIFY THE .SCSS FILE INSTEAD\n\nimport { css, CSSResult } from 'lit';\n/**\n * exports lit-element css\n * @export styles\n */\nexport const styles: CSSResult[] = [\n  css`\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, \"Segoe UI\", \"Segoe UI Web (West European)\", \"Segoe UI\", -apple-system, \"BlinkMacSystemFont\", \"Roboto\", \"Helvetica Neue\", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:\"\\\\\\e70d\"}.ms-icon-chevron-up::before{content:\"\\\\\\e70e\"}.ms-icon-contact::before{content:\"\\\\\\e77b\"}.ms-icon-add-friend::before{content:\"\\\\\\e8fa\"}.ms-icon-outlook-logo-inverser::before{content:\"\\\\\\eb6d\"}:host{--card-height:auto;--card-width:99%;background-color:var(--agenda-background-color,transparent)}:host .header{margin:var(--agenda-header-margin,18px 0 12px 10px);font-size:var(--agenda-header-font-size,24px);font-style:normal;font-weight:400;line-height:32px;color:var(--agenda-header-color,var(--neutral-foreground-rest));opacity:.9}:host .agenda,:host .group{display:flex;flex-direction:column;row-gap:var(--agenda-event-row-gap,14px)}:host .agenda>.group:first-child>.header,:host .group>.group:first-child>.header{margin-top:0}:host .agenda .event,:host .group .event{background:var(--agenda-event-background-color,var(--fill-color));border:var(--agenda-event-border,solid 2px transparent);box-shadow:var(--agenda-event-box-shadow,var(--elevation-shadow-card-rest));padding:var(--agenda-event-padding,12px);position:relative;display:flex;flex:1 1 auto;content-visibility:visible;contain:none}:host .agenda .event-container,:host .group .event-container{border-radius:calc(var(--layer-corner-radius) * 1px);padding:1px}:host .agenda .event.narrow,:host .group .event.narrow{display:flex;flex-direction:column;inset:0}:host .agenda .event-time-container,:host .group .event-time-container{font-style:normal;font-weight:600;font-size:12px;color:var(--agenda-event-time-color,var(--neutral-foreground-rest));width:112px;height:16px}:host .agenda .event-time-container.narrow,:host .group .event-time-container.narrow{margin-bottom:1px;width:100%}:host .agenda .event-time,:host .group .event-time{font-size:var(--agenda-event-time-font-size,12px);color:var(--agenda-event-time-color,var(--neutral-foreground-rest));font-weight:600}:host .agenda .event-details-container,:host .group .event-details-container{display:flex;flex-direction:column;position:relative;bottom:8px;top:0;padding-inline-start:32px}:host .agenda .event-details-container.narrow,:host .group .event-details-container.narrow{position:inherit;left:6px;display:flex;flex-direction:column;padding-inline-start:0}:host .agenda .event-subject,:host .group .event-subject{font-style:normal;font-weight:400;font-size:var(--agenda-event-subject-font-size,20px);line-height:28px;color:var(--agenda-event-subject-color,var(--neutral-foreground-rest));mix-blend-mode:normal;position:inherit;bottom:8px}:host .agenda .event-location-container,:host .group .event-location-container{display:inline-flex;flex-direction:row}:host .agenda .event-location-container .event-location,:host .group .event-location-container .event-location{padding-inline-start:3px;font-style:normal;font-weight:400;font-size:var(--agenda-event-location-font-size,12px);line-height:16px;color:var(--agenda-event-location-color,var(--neutral-foreground-rest))}:host .agenda .event-location-container .event-location-loading,:host .group .event-location-container .event-location-loading{width:90px;height:10px;margin:2px 0 0 4px}:host .agenda .event-location-container .event-location-icon,:host .group .event-location-container .event-location-icon{display:inline-flex}:host .agenda .event-location-container .event-location-icon svg,:host .group .event-location-container .event-location-icon svg{position:relative;top:2px;width:12px;height:12px}:host .agenda .event-location-container .event-location-icon svg path,:host .group .event-location-container .event-location-icon svg path{stroke:var(--agenda-event-location-color,var(--neutral-foreground-rest))}:host .agenda .event-location-container .event-location-icon-loading,:host .group .event-location-container .event-location-icon-loading{width:14px;height:14px}:host .agenda .event-location-container .event-attendee-loading,:host .group .event-location-container .event-attendee-loading{width:20px;height:20px;border-radius:10px;margin:0 2px 0 0}:host .agenda .event-attendees,:host .group .event-attendees{--list-margin:8px 0 0 0;--person-avatar-size:20px}fluent-card.event.event-loading{--card-height:90px}:host .event-attendees{--color:$agenda-event-attendees-color}:host fluent-tooltip{width:auto;contain:inline-size}[dir=rtl] :host{direction:rtl}[dir=rtl] .event-time-container{direction:ltr;display:flex;justify-content:flex-end}@media (forced-colors:active) and (prefers-color-scheme:dark){:host .agenda .event-location-container .event-location-icon svg path{stroke:#fff!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host .agenda .event-location-container .event-location-icon svg path{stroke:#000!important}}\n`];","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { GraphPageIterator, IGraph, prepScopes } from '@microsoft/mgt-element';\nimport * as MicrosoftGraph from '@microsoft/microsoft-graph-types';\n\n/**\n *\n * @param {IGraph} graph\n * @param {string} query the graph resource and query string to be requested\n * @param {string[]} additionalScopes an array of scope to be requested before making the request\n * Should be calculated by the calling code using `IProvider.needsAdditionalScopes()`\n * @returns {Promise<GraphPageIterator<MicrosoftGraph.Event>>} a page iterator to allow\n * the calling code to request more data if present and needed\n */\nexport const getEventsQueryPageIterator = async (\n  graph: IGraph,\n  query: string,\n  additionalScopes: string[]\n): Promise<GraphPageIterator<MicrosoftGraph.Event>> => {\n  const request = graph.api(query).middlewareOptions(prepScopes(additionalScopes)).orderby('start/dateTime');\n\n  return GraphPageIterator.create<MicrosoftGraph.Event>(graph, request);\n};\n\n/**\n * returns Calender events iterator associated with either the logged in user or a specific groupId\n *\n * @param {IGraph} graph\n * @param {Date} startDateTime\n * @param {Date} endDateTime\n * @param {string} [groupId]\n * @returns {Promise<GraphPageIterator<MicrosoftGraph.Event>>}\n * @memberof Graph\n */\nexport const getEventsPageIterator = async (\n  graph: IGraph,\n  startDateTime: Date,\n  endDateTime: Date,\n  groupId?: string\n): Promise<GraphPageIterator<MicrosoftGraph.Event>> => {\n  const sdt = `startdatetime=${startDateTime.toISOString()}`;\n  const edt = `enddatetime=${endDateTime.toISOString()}`;\n\n  const uri: string = groupId\n    ? `groups/${groupId}/calendar/calendarview?${sdt}&${edt}`\n    : `me/calendarview?${sdt}&${edt}`;\n  const allValidScopes = groupId\n    ? ['Group.Read.All', 'Group.ReadWrite.All']\n    : ['Calendars.ReadBasic', 'Calendars.Read', 'Calendars.ReadWrite'];\n\n  return getEventsQueryPageIterator(graph, uri, allValidScopes);\n};\n","// THIS FILE IS AUTO GENERATED\n// ANY CHANGES WILL BE LOST DURING BUILD\n// MODIFY THE .SCSS FILE INSTEAD\n\nimport { css, CSSResult } from 'lit';\n/**\n * exports lit-element css\n * @export styles\n */\nexport const styles: CSSResult[] = [\n  css`\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, \"Segoe UI\", \"Segoe UI Web (West European)\", \"Segoe UI\", -apple-system, \"BlinkMacSystemFont\", \"Roboto\", \"Helvetica Neue\", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:\"\\\\\\e70d\"}.ms-icon-chevron-up::before{content:\"\\\\\\e70e\"}.ms-icon-contact::before{content:\"\\\\\\e77b\"}.ms-icon-add-friend::before{content:\"\\\\\\e8fa\"}.ms-icon-outlook-logo-inverser::before{content:\"\\\\\\eb6d\"}:host .people-list{list-style:none;margin:var(--people-list-margin,8px 4px 8px 8px);padding:unset;display:flex;align-items:center;gap:var(--people-avatar-gap,4px)}:host .people-list .people-person{--person-avatar-size:var(--people-person-avatar-size, 24px)}:host .overflow span{vertical-align:middle;color:var(--people-overflow-font-color,currentColor);font-size:var(--people-overflow-font-size,12px);font-weight:var(--people-overflow-font-weight,400)}\n`];","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport * as MicrosoftGraph from '@microsoft/microsoft-graph-types';\nimport { html, TemplateResult } from 'lit';\nimport { property, state } from 'lit/decorators.js';\nimport { repeat } from 'lit/directives/repeat.js';\nimport { getPeople, getPeopleFromResource } from '../../graph/graph.people';\nimport { getUsersPresenceByPeople } from '../../graph/graph.presence';\nimport { findGroupMembers, getUsersForPeopleQueries, getUsersForUserIds } from '../../graph/graph.user';\nimport { IDynamicPerson } from '../../graph/types';\nimport { Providers, ProviderState, MgtTemplatedTaskComponent, mgtHtml } from '@microsoft/mgt-element';\nimport '../../styles/style-helper';\nimport { type PersonCardInteraction, personCardConverter } from './../PersonCardInteraction';\n\nimport { styles } from './mgt-people-css';\nimport { MgtPerson, registerMgtPersonComponent } from '../mgt-person/mgt-person';\nimport { registerComponent } from '@microsoft/mgt-element';\n\n/**\n * web component to display a group of people or contacts by using their photos or initials.\n *\n * @export\n * @class MgtPeople\n * @extends {MgtTemplatedTaskComponent}\n *\n * @cssprop --people-list-margin- {String} the margin around the list of people. Default is 8px 4px 8px 8px.\n * @cssprop --people-avatar-gap - {String} the gap between the people in the list. Default is 4px.\n * @cssprop --people-overflow-font-color - {Color} the color of the overflow text.\n * @cssprop --people-overflow-font-size - {String} the text color of the overflow text. Default is 12px.\n * @cssprop --people-overflow-font-weight - {String} the font weight of the overflow text. Default is 400.\n * @cssprop --people-person-avatar-size - {Length} the size of the avatar. Default is 24px.\n */\n\nexport const registerMgtPeopleComponent = () => {\n  registerMgtPersonComponent();\n  registerComponent('people', MgtPeople);\n};\n\nexport class MgtPeople extends MgtTemplatedTaskComponent {\n  /**\n   * Array of styles to apply to the element. The styles should be defined\n   * using the `css` tag function.\n   */\n  static get styles() {\n    return styles;\n  }\n\n  /**\n   * determines if agenda events come from specific group\n   *\n   * @type {string}\n   */\n  @property({\n    attribute: 'group-id',\n    type: String\n  })\n  public groupId: string;\n\n  /**\n   * user id array\n   *\n   * @memberof MgtPeople\n   */\n  @property({\n    attribute: 'user-ids',\n    converter: (value, _type) => {\n      return value.split(',').map(v => v.trim());\n    }\n  })\n  public userIds: string[];\n\n  /**\n   * containing array of people used in the component.\n   *\n   * @type {IDynamicPerson[]}\n   */\n  @property({\n    attribute: 'people',\n    type: Object\n  })\n  public people: IDynamicPerson[];\n\n  /**\n   * allows developer to define queries of people for component\n   *\n   * @type {string[]}\n   */\n\n  @property({\n    attribute: 'people-queries',\n    converter: (value, _type) => {\n      return value.split(',').map(v => v.trim());\n    }\n  })\n  public peopleQueries: string[];\n\n  /**\n   * developer determined max people shown in component\n   *\n   * @type {number}\n   */\n  @property({\n    attribute: 'show-max',\n    type: Number\n  })\n  public showMax: number;\n\n  /**\n   * determines if person component renders presence\n   *\n   * @type {boolean}\n   */\n  @property({\n    attribute: 'show-presence',\n    type: Boolean\n  })\n  public showPresence: boolean;\n\n  /**\n   * Sets how the person-card is invoked\n   * Valid options are: 'none', 'hover', or 'click'\n   * Set to 'none' to not show the card\n   *\n   * @type {PersonCardInteraction}\n   * @memberof MgtPerson\n   */\n  @property({\n    attribute: 'person-card',\n    converter: (value, _type) => personCardConverter(value, 'hover')\n  })\n  public personCardInteraction: PersonCardInteraction = 'hover';\n\n  /**\n   * The resource to get\n   *\n   * @type {string}\n   * @memberof MgtPeople\n   */\n  @property({\n    attribute: 'resource',\n    type: String\n  })\n  public resource: string;\n\n  /**\n   * Api version to use for request\n   *\n   * @type {string}\n   * @memberof MgtPeople\n   */\n  @property({\n    attribute: 'version',\n    type: String\n  })\n  public version = 'v1.0';\n\n  /**\n   * The scopes to request\n   *\n   * @type {string[]}\n   * @memberof MgtPeople\n   */\n  @property({\n    attribute: 'scopes',\n    converter: value => {\n      return value ? value.toLowerCase().split(',') : null;\n    },\n    reflect: true\n  })\n  public scopes: string[] = [];\n\n  /**\n   * Fallback when no user is found\n   *\n   * @type {IDynamicPerson[]}\n   */\n  @property({\n    attribute: 'fallback-details',\n    type: Array\n  })\n  public fallbackDetails: IDynamicPerson[];\n\n  /**\n   * Get the scopes required for people\n   *\n   * @static\n   * @return {*}  {string[]}\n   * @memberof MgtPeople\n   */\n  public static get requiredScopes(): string[] {\n    return [\n      ...new Set([\n        'user.read.all',\n        'people.read',\n        'user.readbasic.all',\n        'presence.read.all',\n        'contacts.read',\n        ...MgtPerson.requiredScopes\n      ])\n    ];\n  }\n\n  private _peoplePresence: Record<string, MicrosoftGraph.Presence> = {};\n  @state() private _arrowKeyLocation = -1;\n\n  constructor() {\n    super();\n    this.showMax = 3;\n  }\n\n  /**\n   * Clears the state of the component\n   *\n   * @protected\n   * @memberof MgtPeople\n   */\n  protected clearState(): void {\n    this.people = null;\n  }\n\n  protected args(): unknown[] {\n    return [\n      this.providerState,\n      this.groupId,\n      this.userIds,\n      this.peopleQueries,\n      this.showMax,\n      this.resource,\n      this.version,\n      this.fallbackDetails\n    ];\n  }\n\n  /**\n   * Invoked on each update to perform rendering tasks. This method must return\n   * a lit-html TemplateResult. Setting properties inside this method will *not*\n   * trigger the element to update.\n   */\n  protected renderContent = () => {\n    if (!this.people || this.people.length === 0) {\n      return this.renderNoData();\n    }\n\n    return this.renderTemplate('default', { people: this.people, max: this.showMax }) || this.renderPeople();\n  };\n\n  /**\n   * Render the loading state.\n   *\n   * @protected\n   * @returns\n   * @memberof MgtPeople\n   */\n  protected renderLoading = () => {\n    return this.renderTemplate('loading', null) || html``;\n  };\n\n  /**\n   * Render the list of people.\n   *\n   * @protected\n   * @param {*} people\n   * @returns {TemplateResult}\n   * @memberof MgtPeople\n   */\n  protected renderPeople(): TemplateResult {\n    const maxPeople = this.people.slice(0, this.showMax).filter(pple => pple);\n    return html`\n      <ul\n        tabindex=\"0\"\n        class=\"people-list\"\n        aria-label=\"people\"\n        @keydown=${this.handleKeyDown}>\n        ${repeat(\n          maxPeople,\n          p => (p.id ? p.id : p.displayName),\n          p => html`\n            <li tabindex=\"-1\" class=\"people-person\">\n              ${this.renderPerson(p)}\n            </li>\n          `\n        )}\n        ${this.people.length > this.showMax ? this.renderOverflow() : null}\n      </ul>\n    `;\n  }\n\n  /**\n   * Render the overflow content to represent any extra people, beyond the max.\n   *\n   * @protected\n   * @returns {TemplateResult}\n   * @memberof MgtPeople\n   */\n  protected renderOverflow(): TemplateResult {\n    const extra = this.people.length - this.showMax;\n    return (\n      this.renderTemplate('overflow', {\n        extra,\n        max: this.showMax,\n        people: this.people\n      }) ||\n      html`\n        <li tabindex=\"-1\" aria-label=\"and ${extra} more attendees\" class=\"overflow\"><span>+${extra}</span></li>\n      `\n    );\n  }\n\n  /**\n   * Handles the keypresses on a keyboard for the listed people.\n   *\n   * @param event is a KeyboardEvent.\n   */\n  protected handleKeyDown = (event: KeyboardEvent) => {\n    const peopleContainer: HTMLElement = this.shadowRoot.querySelector('.people-list');\n    let person: HTMLElement;\n    const peopleElements: HTMLCollection = peopleContainer?.children;\n    // Default all tabindex values in li nodes to -1\n    for (const element of peopleElements) {\n      const el: HTMLElement = element as HTMLElement;\n      el.setAttribute('tabindex', '-1');\n      el.blur();\n    }\n\n    const childElementCount = peopleContainer.childElementCount;\n    const keyName = event.key;\n    if (keyName === 'ArrowRight') {\n      this._arrowKeyLocation = (this._arrowKeyLocation + 1 + childElementCount) % childElementCount;\n    } else if (keyName === 'ArrowLeft') {\n      this._arrowKeyLocation = (this._arrowKeyLocation - 1 + childElementCount) % childElementCount;\n    } else if (keyName === 'Tab' || keyName === 'Escape') {\n      this._arrowKeyLocation = -1;\n      peopleContainer.blur();\n    } else if (['Enter', 'space', ' '].includes(keyName)) {\n      if (this.personCardInteraction !== 'none') {\n        const personEl = peopleElements[this._arrowKeyLocation] as HTMLElement;\n        const mgtPerson = personEl.querySelector<MgtPerson>('mgt-person');\n        if (mgtPerson) {\n          mgtPerson.showPersonCard();\n        }\n      }\n    }\n\n    if (this._arrowKeyLocation > -1) {\n      person = peopleElements[this._arrowKeyLocation] as HTMLElement;\n      person.setAttribute('tabindex', '1');\n      person.focus();\n    }\n  };\n\n  /**\n   * Render an individual person.\n   *\n   * @protected\n   * @returns {TemplateResult}\n   * @memberof MgtPeople\n   */\n  protected renderPerson(person: MicrosoftGraph.User | MicrosoftGraph.Person | MicrosoftGraph.Contact): TemplateResult {\n    let personPresence: MicrosoftGraph.Presence = {\n      // set up default presence\n      activity: 'Offline',\n      availability: 'Offline',\n      id: null\n    };\n    if (this.showPresence && this._peoplePresence) {\n      personPresence = this._peoplePresence[person.id];\n    }\n    const avatarSize = 'small';\n    return (\n      this.renderTemplate('person', { person }, person.id) ||\n      // set image to @ to flag the mgt-person component to\n      // query the image from the graph\n      mgtHtml`\n        <mgt-person\n          class=\"people-person\"\n          .personDetails=${person}\n          .fetchImage=${true}\n          .avatarSize=${avatarSize}\n          .personCardInteraction=${this.personCardInteraction}\n          .showPresence=${this.showPresence}\n          .personPresence=${personPresence}\n          .usage=${'people'}\n        ></mgt-person>\n      `\n    );\n  }\n\n  /**\n   * render the no data state.\n   *\n   * @protected\n   * @returns {TemplateResult}\n   * @memberof MgtPeople\n   */\n  protected renderNoData(): TemplateResult {\n    return this.renderTemplate('no-data', null) || html``;\n  }\n\n  /**\n   * load state into the component.\n   *\n   * @protected\n   * @returns\n   * @memberof MgtPeople\n   */\n  protected async loadState() {\n    if (!this.people) {\n      const provider = Providers.globalProvider;\n\n      if (provider && provider.state === ProviderState.SignedIn) {\n        const graph = provider.graph.forComponent(this);\n\n        // populate people\n        if (this.groupId) {\n          this.people = await findGroupMembers(graph, null, this.groupId, this.showMax, 'person');\n        } else if (this.userIds) {\n          this.people = await getUsersForUserIds(graph, this.userIds, '', '', this.fallbackDetails);\n        } else if (this.peopleQueries) {\n          this.people = await getUsersForPeopleQueries(graph, this.peopleQueries, this.fallbackDetails);\n        } else if (this.resource) {\n          this.people = await getPeopleFromResource(graph, this.version, this.resource, this.scopes);\n        } else {\n          this.people = await getPeople(graph);\n        }\n\n        // populate presence for people\n        if (this.showPresence) {\n          this._peoplePresence = await getUsersPresenceByPeople(graph, this.people);\n        } else {\n          this._peoplePresence = null;\n        }\n      }\n    }\n  }\n}\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport * as MicrosoftGraph from '@microsoft/microsoft-graph-types';\nimport { html, TemplateResult } from 'lit';\nimport { property } from 'lit/decorators.js';\nimport { Providers, ProviderState, mgtHtml, MgtTemplatedTaskComponent } from '@microsoft/mgt-element';\nimport '../../styles/style-helper';\nimport '../mgt-person/mgt-person';\nimport { styles } from './mgt-agenda-css';\nimport { getEventsPageIterator, getEventsQueryPageIterator } from './mgt-agenda.graph';\nimport { SvgIcon, getSvg } from '../../utils/SvgHelper';\nimport { MgtPeople, registerMgtPeopleComponent } from '../mgt-people/mgt-people';\nimport { registerFluentComponents } from '../../utils/FluentComponents';\nimport { fluentCard } from '@fluentui/web-components';\nimport { classMap } from 'lit/directives/class-map.js';\nimport { registerComponent } from '@microsoft/mgt-element';\n\n/**\n * Web Component which represents events in a user or group calendar.\n *\n * @export\n * @class MgtAgenda\n * @extends {MgtTemplatedComponent}\n *\n * @fires {CustomEvent<MicrosoftGraph.Event>} eventClick - Fired when user click an event\n *\n * @cssprop --event-box-shadow - {String} Event box shadow color and size\n * @cssprop --event-row-gap - {String} The size of the gap between two event elements\n * @cssprop --event-padding - {String} Event padding\n * @cssprop --event-background-color - {Color} Event background color\n * @cssprop --event-border - {String} Event border style\n * @cssprop --agenda-header-margin - {String} Agenda header margin size\n * @cssprop --agenda-header-font-size - {Length} Agenda header font size\n * @cssprop --agenda-header-color - {Color} Agenda header color\n * @cssprop --event-time-font-size - {Length} Event time font size\n * @cssprop --event-time-color - {Color} Event time color\n * @cssprop --event-subject-font-size - {Length} Event subject font size\n * @cssprop --event-subject-color - {Color} Event subject color\n * @cssprop --event-location-font-size - {Length} Event location font size\n * @cssprop --event-location-color - {Color} Event location color\n * @cssprop --event-attendees-color - {Color} Event attendees color\n */\n\nexport const registerMgtAgendaComponent = () => {\n  registerFluentComponents(fluentCard);\n  // register dependent components\n  registerMgtPeopleComponent();\n  // register self\n  registerComponent('agenda', MgtAgenda);\n};\n\nexport class MgtAgenda extends MgtTemplatedTaskComponent {\n  /**\n   * Array of styles to apply to the element. The styles should be defined\n   * using the `css` tag function.\n   */\n  static get styles() {\n    return styles;\n  }\n\n  /**\n   * stores current date for initial calender selection in events.\n   *\n   * @type {string}\n   */\n  @property({\n    attribute: 'date',\n    type: String\n  })\n  public date: string;\n\n  /**\n   * determines if agenda events come from specific group\n   *\n   * @type {string}\n   */\n  @property({\n    attribute: 'group-id',\n    type: String\n  })\n  public groupId: string;\n\n  /**\n   * sets number of days until end date, 3 is the default\n   *\n   * @type {number}\n   */\n  @property({\n    attribute: 'days',\n    type: Number\n  })\n  public days = 3;\n\n  /**\n   * allows developer to specify a different graph query that retrieves events\n   *\n   * @type {string}\n   */\n  @property({\n    attribute: 'event-query',\n    type: String\n  })\n  public eventQuery: string;\n\n  /**\n   * array containing events from user agenda.\n   *\n   * @type {MicrosoftGraph.Event[]}\n   */\n  @property({\n    attribute: 'events',\n    type: Array,\n    hasChanged: (newVal: [], oldVal: []) => {\n      return newVal !== oldVal;\n    }\n  })\n  public events: MicrosoftGraph.Event[];\n\n  /**\n   * allows developer to define max number of events shown\n   *\n   * @type {number}\n   */\n  @property({\n    attribute: 'show-max',\n    type: Number\n  })\n  public showMax: number;\n\n  /**\n   * allows developer to define agenda to group events by day.\n   *\n   * @type {boolean}\n   */\n  @property({\n    attribute: 'group-by-day',\n    type: Boolean\n  })\n  public groupByDay: boolean;\n\n  /**\n   * allows developer to specify preferred timezone that should be used for\n   * rendering events retrieved from Graph, eg. `America/Los_Angeles`.\n   * By default events are rendered using the current timezone of the\n   * device being used.\n   *\n   * @type {string}\n   */\n  @property({\n    attribute: 'preferred-timezone',\n    type: String\n  })\n  public preferredTimezone: string;\n\n  /**\n   * Get the scopes required for agenda\n   *\n   * @static\n   * @return {*}  {string[]}\n   * @memberof MgtAgenda\n   */\n  public static get requiredScopes(): string[] {\n    return [...new Set(['calendars.read', ...MgtPeople.requiredScopes])];\n  }\n\n  /**\n   * determines width available for agenda component.\n   *\n   * @type {boolean}\n   */\n  @property({ attribute: false }) private _isNarrow: boolean;\n\n  /**\n   * Determines width available if resize is necessary, adds onResize event listener to window\n   *\n   * @memberof MgtAgenda\n   */\n  public connectedCallback() {\n    this._isNarrow = this.offsetWidth < 600;\n    super.connectedCallback();\n    window.addEventListener('resize', this.onResize);\n  }\n\n  /**\n   * Removes onResize event listener from window\n   *\n   * @memberof MgtAgenda\n   */\n  public disconnectedCallback() {\n    window.removeEventListener('resize', this.onResize);\n    super.disconnectedCallback();\n  }\n\n  /**\n   * Invoked on each update to perform rendering tasks. This method must return a lit-html TemplateResult.\n   * Setting properties inside this method will not trigger the element to update\n   *\n   * @returns\n   * @memberof MgtAgenda\n   */\n  public renderContent = (): TemplateResult => {\n    // No data\n    if (!this.events || this.events.length === 0) {\n      return this.renderNoData();\n    }\n\n    // Prep data\n    const events = this.showMax && this.showMax > 0 ? this.events.slice(0, this.showMax) : this.events;\n\n    // Default template\n    const renderedTemplate = this.renderTemplate('default', { events });\n    if (renderedTemplate) {\n      return renderedTemplate;\n    }\n\n    const agendaClasses = {\n      agenda: true,\n      grouped: this.groupByDay\n    };\n\n    // Render list\n    return html`\n      <div dir=${this.direction} class=\"${classMap(agendaClasses)}\">\n        ${this.groupByDay ? this.renderGroups(events) : this.renderEvents(events)}\n      </div>\n    `;\n  };\n\n  /**\n   * Reloads the component with its current settings and potential new data\n   *\n   * @memberof MgtAgenda\n   */\n  public async reload() {\n    this.events = await this.loadEvents();\n  }\n\n  /**\n   * Render the loading state\n   *\n   * @protected\n   * @returns\n   * @memberof MgtAgenda\n   */\n  protected renderLoading = (): TemplateResult => {\n    return (\n      this.renderTemplate('loading', null) ||\n      html`\n        <fluent-card class=\"event event-loading\">\n          <div class=\"event-time-container\">\n            <div class=\"event-time-loading loading-element\"></div>\n          </div>\n          <div class=\"event-details-container\">\n            <div class=\"event-subject-loading loading-element\"></div>\n            <div class=\"event-location-container\">\n              <div class=\"event-location-icon-loading loading-element\"></div>\n              <div class=\"event-location-loading loading-element\"></div>\n            </div>\n            <div class=\"event-location-container\">\n              <div class=\"event-attendee-loading loading-element\"></div>\n              <div class=\"event-attendee-loading loading-element\"></div>\n              <div class=\"event-attendee-loading loading-element\"></div>\n            </div>\n          </div>\n        </fluent-card>`\n    );\n  };\n\n  /**\n   * Clears state of the component\n   *\n   * @protected\n   * @memberof MgtAgenda\n   */\n  protected clearState(): void {\n    this.events = null;\n  }\n\n  /**\n   * Render the no-data state.\n   *\n   * @protected\n   * @returns {TemplateResult}\n   * @memberof MgtAgenda\n   */\n  protected renderNoData(): TemplateResult {\n    return this.renderTemplate('no-data', null) || html``;\n  }\n\n  /**\n   * Render an individual Event.\n   *\n   * @protected\n   * @param {MicrosoftGraph.Event} event\n   * @returns\n   * @memberof MgtAgenda\n   */\n  protected renderEvent(event: MicrosoftGraph.Event): TemplateResult {\n    // Update narrow state\n    this._isNarrow = this.offsetWidth < 600;\n\n    const eventClasses = {\n      narrow: this._isNarrow\n    };\n\n    return html`\n      <fluent-card class=\"${classMap({ event: true, ...eventClasses })}\">\n        <div class=\"${classMap({ 'event-time-container': true, ...eventClasses })}\">\n          <div class=\"event-time\" aria-label=\"${this.getEventTimeString(event)}\">${this.getEventTimeString(event)}</div>\n        </div>\n        <div class=\"${classMap({ 'event-details-container': true, ...eventClasses })}\">\n          ${this.renderTitle(event)} ${this.renderLocation(event)} ${this.renderAttendees(event)}\n        </div>\n        <div class=\"event-other-container\">${this.renderOther(event)}</div>\n      </fluent-card>\n    `;\n  }\n\n  /**\n   * Render the header for a group.\n   * Only relevant for grouped Events.\n   *\n   * @protected\n   * @param {Date} date\n   * @returns\n   * @memberof MgtAgenda\n   */\n  protected renderHeader(header: string): TemplateResult {\n    return (\n      this.renderTemplate('header', { header }, 'header-' + header) ||\n      html`\n        <div class=\"header\" aria-label=\"${header}\">${header}</div>\n      `\n    );\n  }\n\n  /**\n   * Render the title field of an Event\n   *\n   * @protected\n   * @param {MicrosoftGraph.Event} event\n   * @returns\n   * @memberof MgtAgenda\n   */\n  protected renderTitle(event: MicrosoftGraph.Event): TemplateResult {\n    return html`\n      <div\n        aria-label=${event.subject}\n        class=\"${classMap({\n          'event-subject': true,\n          narrow: this._isNarrow\n        })}\"\n      >\n        ${event.subject}\n      </div>`;\n  }\n\n  /**\n   * Render the location field of an Event\n   *\n   * @protected\n   * @param {MicrosoftGraph.Event} event\n   * @returns\n   * @memberof MgtAgenda\n   */\n  protected renderLocation(event: MicrosoftGraph.Event): TemplateResult {\n    if (!event.location.displayName) {\n      return null;\n    }\n\n    return html`\n      <div class=\"event-location-container\">\n        <div class=\"event-location-icon\">${getSvg(SvgIcon.OfficeLocation)}</div>\n        <div class=\"event-location\" aria-label=\"${event.location.displayName}\">${event.location.displayName}</div>\n      </div>\n    `;\n  }\n\n  /**\n   * Render the attendees field of an Event\n   *\n   * @protected\n   * @param {MicrosoftGraph.Event} event\n   * @returns\n   * @memberof MgtAgenda\n   */\n  protected renderAttendees(event: MicrosoftGraph.Event): TemplateResult {\n    if (!event.attendees.length) {\n      return null;\n    }\n    return mgtHtml`\n      <mgt-people\n        show-max=\"5\"\n        show-presence\n        class=\"event-attendees\"\n        .peopleQueries=${event.attendees.map(attendee => {\n          return attendee.emailAddress.address;\n        })}\n      ></mgt-people>\n    `;\n  }\n\n  /**\n   * Render the event other field of an Event\n   *\n   * @protected\n   * @param {MicrosoftGraph.Event} event\n   * @returns\n   * @memberof MgtAgenda\n   */\n  protected renderOther(event: MicrosoftGraph.Event): TemplateResult {\n    return this.hasTemplate('event-other')\n      ? html`\n          ${this.renderTemplate('event-other', { event }, event.id + '-other')}\n        `\n      : null;\n  }\n\n  /**\n   * Render the events in groups, each with a header.\n   *\n   * @protected\n   * @param {MicrosoftGraph.Event[]} events\n   * @returns {TemplateResult}\n   * @memberof MgtAgenda\n   */\n  protected renderGroups(events: MicrosoftGraph.Event[]): TemplateResult {\n    // Render list, grouped by day\n    const grouped: Record<string, MicrosoftGraph.Event[]> = {};\n\n    events.forEach(event => {\n      let dateString = event?.start?.dateTime;\n      if (event.end.timeZone === 'UTC') {\n        dateString += 'Z';\n      }\n\n      const header = this.getDateHeaderFromDateTimeString(dateString);\n      grouped[header] = grouped[header] || [];\n      grouped[header].push(event);\n    });\n\n    return html`\n      ${Object.keys(grouped).map(\n        header =>\n          html`\n            <div class=\"group\">${this.renderHeader(header)} ${this.renderEvents(grouped[header])}</div>\n          `\n      )}\n    `;\n  }\n\n  /**\n   * Render a list of events.\n   *\n   * @protected\n   * @param {MicrosoftGraph.Event[]} events\n   * @returns {TemplateResult}\n   * @memberof MgtAgenda\n   */\n  protected renderEvents(events: MicrosoftGraph.Event[]): TemplateResult {\n    return html`\n        ${events.map(\n          event =>\n            html`\n              <div\n                class=\"event-container\"\n                tabindex=\"0\"\n                @focus=${() => this.eventClicked(event)}>\n                ${this.renderTemplate('event', { event }, event.id) || this.renderEvent(event)}\n              </div>`\n        )}`;\n  }\n\n  protected args() {\n    return [this.providerState, this.preferredTimezone, this.eventQuery, this.date, this.groupId, this.days];\n  }\n\n  /**\n   * Load state into the component\n   *\n   * @protected\n   * @returns\n   * @memberof MgtAgenda\n   */\n  protected async loadState() {\n    if (this.events) {\n      return;\n    }\n\n    const events = await this.loadEvents();\n    if (events?.length > 0) {\n      this.events = events;\n    }\n  }\n\n  private readonly onResize = () => {\n    this._isNarrow = this.offsetWidth < 600;\n  };\n\n  private eventClicked(event: MicrosoftGraph.Event) {\n    this.fireCustomEvent('eventClick', event);\n  }\n\n  private getEventTimeString(event: MicrosoftGraph.Event) {\n    if (event.isAllDay) {\n      return 'ALL DAY';\n    }\n\n    // #937 When not specifying a preferred time zone using the\n    // preferred-timezone attribute, MGT treats the dates retrieved from\n    // Microsoft Graph as local time, rather than UTC.\n    let startString = event.start.dateTime;\n    if (event.start.timeZone === 'UTC') {\n      startString += 'Z';\n    }\n    let endString = event.end.dateTime;\n    if (event.end.timeZone === 'UTC') {\n      endString += 'Z';\n    }\n\n    const start = this.prettyPrintTimeFromDateTime(new Date(startString));\n    const end = this.prettyPrintTimeFromDateTime(new Date(endString));\n\n    return `${start} - ${end}`;\n  }\n\n  private async loadEvents(): Promise<MicrosoftGraph.Event[]> {\n    const p = Providers.globalProvider;\n    let events: MicrosoftGraph.Event[] = [];\n\n    if (p?.state === ProviderState.SignedIn) {\n      const graph = p.graph.forComponent(this);\n\n      if (this.eventQuery) {\n        try {\n          const tokens = this.eventQuery.split('|');\n          let scope: string;\n          let query: string;\n          if (tokens.length > 1) {\n            query = tokens[0].trim();\n            scope = tokens[1].trim();\n          } else {\n            query = this.eventQuery;\n          }\n          const iterator = await getEventsQueryPageIterator(graph, query, scope ? [scope] : []);\n          if (iterator?.value) {\n            events = iterator.value;\n\n            while (iterator.hasNext) {\n              await iterator.next();\n              events = iterator.value;\n            }\n          }\n          // eslint-disable-next-line no-empty\n        } catch (e) {}\n      } else {\n        const start = this.date ? new Date(this.date) : new Date();\n        const end = new Date(start.getTime());\n        end.setDate(start.getDate() + this.days);\n\n        try {\n          const iterator = await getEventsPageIterator(graph, start, end, this.groupId);\n          if (iterator?.value) {\n            events = iterator.value;\n\n            while (iterator.hasNext) {\n              await iterator.next();\n              events = iterator.value;\n            }\n          }\n        } catch (error) {\n          // noop - possible error with graph\n        }\n      }\n    }\n\n    return events;\n  }\n\n  private prettyPrintTimeFromDateTime(date: Date) {\n    return date.toLocaleTimeString(navigator.language, {\n      timeStyle: 'short',\n      timeZone: this.preferredTimezone\n    });\n  }\n\n  private getDateHeaderFromDateTimeString(dateTimeString: string) {\n    const date = new Date(dateTimeString);\n    return date.toLocaleDateString(navigator.language, {\n      dateStyle: 'full',\n      timeZone: this.preferredTimezone\n    });\n  }\n}\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nexport const strings = {\n  comboboxPlaceholder: 'Select an item'\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { html, TemplateResult } from 'lit';\nimport { property } from 'lit/decorators.js';\nimport {\n  CacheService,\n  CacheStore,\n  equals,\n  MgtTemplatedTaskComponent,\n  prepScopes,\n  Providers,\n  ProviderState,\n  CollectionResponse,\n  IGraph\n} from '@microsoft/mgt-element';\n\nimport { getPhotoForResource } from '../../graph/graph.photos';\nimport { getDocumentThumbnail } from '../../graph/graph.files';\nimport { schemas } from '../../graph/cacheStores';\nimport { CacheResponse } from '../CacheResponse';\nimport { Entity } from '@microsoft/microsoft-graph-types';\nimport { GraphRequest } from '@microsoft/microsoft-graph-client';\nimport { registerComponent } from '@microsoft/mgt-element';\n\n/**\n * Simple holder type for an image\n */\ninterface ImageValue {\n  image: string;\n}\n\n/**\n * A type guard to check if a value is a collection response\n *\n * @param value {*} the value to check\n * @returns {boolean} true if the value is a collection response\n */\nexport const isCollectionResponse = (value: unknown): value is CollectionResponse<unknown> =>\n  Array.isArray((value as CollectionResponse<unknown>)?.value);\n\nconst responseTypes = ['json', 'image'] as const;\n/**\n * Enumeration to define what types of query are available\n *\n * @export\n * @enum {string}\n */\nexport type ResponseType = (typeof responseTypes)[number];\nconst isResponseType = (value: unknown): value is ResponseType =>\n  typeof value === 'string' && responseTypes.includes(value as ResponseType);\nconst responseTypeConverter = (value: string, defaultValue: ResponseType = 'json'): ResponseType =>\n  isResponseType(value) ? value : defaultValue;\n\n/**\n * Defines the expiration time\n */\nconst getResponseInvalidationTime = (currentInvalidationPeriod: number): number =>\n  currentInvalidationPeriod ||\n  CacheService.config.response.invalidationPeriod ||\n  CacheService.config.defaultInvalidationPeriod;\n\n/**\n * Whether the response store is enabled\n */\nconst getIsResponseCacheEnabled = (): boolean =>\n  CacheService.config.response.isEnabled && CacheService.config.isEnabled;\n\n/**\n * Holder type emitted with the dataChange event\n */\nexport interface DataChangedDetail {\n  response?: CollectionResponse<Entity>;\n  error?: object;\n}\n\nexport const registerMgtGetComponent = () => registerComponent('get', MgtGet);\n\n/**\n * Custom element for making Microsoft Graph get queries\n *\n * @fires {CustomEvent<DataChangedDetail>} dataChange - Fired when data changes bubbles, composed, and is not cancelable.\n *\n * @export\n * @class mgt-get\n * @extends {MgtTemplatedComponent}\n */\nexport class MgtGet extends MgtTemplatedTaskComponent {\n  /**\n   * The resource to get\n   *\n   * @type {string}\n   * @memberof MgtGet\n   */\n  @property({\n    attribute: 'resource',\n    reflect: true,\n    type: String\n  })\n  public resource: string;\n\n  /**\n   * The scopes to request\n   *\n   * @type {string[]}\n   * @memberof MgtGet\n   */\n  @property({\n    attribute: 'scopes',\n    converter: (value, _type) => {\n      return value ? value.toLowerCase().split(',') : null;\n    },\n    reflect: true\n  })\n  public scopes: string[] = [];\n\n  /**\n   * Api version to use for request\n   *\n   * @type {string}\n   * @memberof MgtGet\n   */\n  @property({\n    attribute: 'version',\n    reflect: true,\n    type: String\n  })\n  public version = 'v1.0';\n\n  /**\n   * Type of response\n   * Default = json\n   * Supported values = json, image\n   *\n   * @type {ResponseType}\n   * @memberof MgtGet\n   */\n  @property({\n    attribute: 'type',\n    reflect: true,\n    type: String,\n    converter: value => responseTypeConverter(value, 'json')\n  })\n  public type: ResponseType = 'json';\n\n  /**\n   * Maximum number of pages to get for the resource\n   * default = 3\n   * if <= 0, all pages will be fetched\n   *\n   * @type {number}\n   * @memberof MgtGet\n   */\n  @property({\n    attribute: 'max-pages',\n    reflect: true,\n    type: Number\n  })\n  public maxPages = 3;\n\n  /**\n   * Number of milliseconds to poll the delta API and\n   * update the response. Set to positive value to enable\n   *\n   * @type {number}\n   * @memberof MgtGet\n   */\n  @property({\n    attribute: 'polling-rate',\n    reflect: true,\n    type: Number\n  })\n  public pollingRate = 0;\n\n  /**\n   * Enables cache on the response from the specified resource\n   * default = false\n   *\n   * @type {boolean}\n   * @memberof MgtGet\n   */\n  @property({\n    attribute: 'cache-enabled',\n    reflect: true,\n    type: Boolean\n  })\n  public cacheEnabled = false;\n\n  /**\n   * Invalidation period of the cache for the responses in milliseconds\n   *\n   * @type {number}\n   * @memberof MgtGet\n   */\n  @property({\n    attribute: 'cache-invalidation-period',\n    type: Number\n  })\n  public cacheInvalidationPeriod = 0;\n\n  /**\n   * Gets or sets the response of the request\n   *\n   * @type any\n   * @memberof MgtGet\n   */\n  @property({ attribute: false }) public response: CollectionResponse<Entity> | Entity | ImageValue;\n\n  /**\n   *\n   * Gets or sets the error (if any) of the request\n   *\n   * @type any\n   * @memberof MgtGet\n   */\n  @property({ attribute: false }) public error: object;\n\n  private isPolling = false;\n  private isRefreshing = false;\n\n  /**\n   * Refresh the data\n   *\n   * @param {boolean} [hardRefresh=false]\n   * if false (default), the component will only update if the data changed\n   * if true, the data will be first cleared and reloaded completely\n   * @memberof MgtGet\n   */\n  public refresh(hardRefresh = false) {\n    this.isRefreshing = true;\n    if (hardRefresh) {\n      this.clearState();\n    }\n    void this._task.run();\n  }\n\n  /**\n   * Clears state of the component\n   *\n   * @protected\n   * @memberof MgtGet\n   */\n  protected clearState(): void {\n    this.response = null;\n  }\n\n  protected args(): unknown[] {\n    return [\n      this.providerState,\n      this.resource,\n      this.scopes,\n      this.version,\n      this.pollingRate,\n      this.type,\n      this.maxPages,\n      this.cacheEnabled,\n      this.cacheInvalidationPeriod\n    ];\n  }\n\n  protected renderLoading = () => {\n    const loading = this.renderTemplate('loading', null);\n    return isCollectionResponse(this.response)\n      ? this.renderValueContentWithDefaultTemplate(\n          html`${this.response.value.map(v => this.renderTemplate('value', v, v.id))} ${loading} `\n        )\n      : loading;\n  };\n\n  /**\n   * Invoked on each update to perform rendering tasks. This method must return\n   * a lit-html TemplateResult. Setting properties inside this method will *not*\n   * trigger the element to update.\n   */\n  protected renderContent = () => {\n    if (this.hasTemplate('value') && isCollectionResponse(this.response)) {\n      const valueContent: TemplateResult = isCollectionResponse(this.response)\n        ? html`\n          ${this.response.value.map(v => this.renderTemplate('value', v, v.id))}\n        `\n        : this.renderTemplate('value', this.response);\n\n      return this.renderValueContentWithDefaultTemplate(valueContent);\n    } else if (this.response) {\n      return this.renderTemplate('default', this.response) || html``;\n    } else if (this.hasTemplate('no-data')) {\n      return this.renderTemplate('no-data', null);\n    } else {\n      return html``;\n    }\n  };\n\n  private renderValueContentWithDefaultTemplate(valueContent: TemplateResult) {\n    if (this.hasTemplate('default')) {\n      const defaultContent = this.renderTemplate('default', this.response);\n\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access, @typescript-eslint/dot-notation\n      if ((this.templates['value']?.templateOrder ?? 999) > this.templates['default'].templateOrder) {\n        return html`\n          ${defaultContent}${valueContent}\n        `;\n      } else {\n        return html`\n          ${valueContent}${defaultContent}\n        `;\n      }\n    } else {\n      return valueContent;\n    }\n  }\n\n  /**\n   * load state into the component.\n   *\n   * @protected\n   * @returns\n   * @memberof MgtGet\n   */\n  protected async loadState() {\n    const provider = Providers.globalProvider;\n\n    this.error = null;\n\n    if (!provider || provider.state !== ProviderState.SignedIn) {\n      return;\n    }\n\n    if (this.resource) {\n      try {\n        let cache: CacheStore<CacheResponse>;\n        const key = `${this.version}${this.resource}`;\n        let response: Entity | CollectionResponse<Entity> | ImageValue = null;\n\n        if (this.shouldRetrieveCache()) {\n          cache = CacheService.getCache<CacheResponse>(schemas.get, schemas.get.stores.responses);\n          const result: CacheResponse = getIsResponseCacheEnabled() ? await cache.getValue(key) : null;\n          if (result && getResponseInvalidationTime(this.cacheInvalidationPeriod) > Date.now() - result.timeCached) {\n            response = JSON.parse(result.response) as CollectionResponse<Entity>;\n          }\n        }\n\n        if (!response) {\n          let uri = this.resource;\n          let isDeltaLink = false;\n\n          // if we had a response earlier with a delta link, use it instead\n          if (this.response?.['@odata.deltaLink']) {\n            uri = this.response['@odata.deltaLink'] as string;\n            isDeltaLink = true;\n          } else {\n            // TODO: Check this against the base url for the cloud in use.\n            isDeltaLink = new URL(uri, 'https://graph.microsoft.com').pathname.endsWith('delta');\n          }\n\n          const graph: IGraph = provider.graph.forComponent(this);\n          let request: GraphRequest = graph.api(uri).version(this.version);\n\n          if (this.scopes?.length) {\n            request = request.middlewareOptions(prepScopes(this.scopes));\n          }\n\n          if (this.type === 'json') {\n            response = (await request.get()) as CollectionResponse<Entity> | Entity;\n\n            if (isDeltaLink && isCollectionResponse(this.response) && isCollectionResponse(response)) {\n              const responseValues: Entity[] = response.value;\n              response.value = this.response.value.concat(responseValues);\n            }\n\n            if (!this.isPolling && !equals(this.response, response)) {\n              this.response = response;\n            }\n\n            // get more pages if there are available\n            if (isCollectionResponse(response) && response['@odata.nextLink']) {\n              let pageCount = 1;\n              let page = response;\n\n              while (\n                (pageCount < this.maxPages || this.maxPages <= 0 || (isDeltaLink && this.pollingRate)) &&\n                page?.['@odata.nextLink']\n              ) {\n                pageCount++;\n                const nextResource = (page['@odata.nextLink'] as string).split(this.version)[1];\n                page = (await graph.api(nextResource).version(this.version).get()) as CollectionResponse<Entity>;\n                if (page?.value?.length) {\n                  page.value = response.value.concat(page.value);\n                  response = page;\n                  if (!this.isPolling) {\n                    this.response = response;\n                  }\n                }\n              }\n            }\n          } else {\n            if (this.resource.indexOf('/photo/$value') === -1 && this.resource.indexOf('/thumbnails/') === -1) {\n              throw new Error('Only /photo/$value and /thumbnails/ endpoints support the image type');\n            }\n\n            let image: string;\n            if (this.resource.indexOf('/photo/$value') > -1) {\n              // Sanitizing the resource to ensure getPhotoForResource gets the right format\n              const sanitizedResource = this.resource.replace('/photo/$value', '');\n              const photoResponse = await getPhotoForResource(graph, sanitizedResource, this.scopes);\n              if (photoResponse) {\n                image = photoResponse.photo;\n              }\n            } else if (this.resource.indexOf('/thumbnails/') > -1) {\n              const imageResponse = await getDocumentThumbnail(graph, this.resource, this.scopes);\n              if (imageResponse) {\n                image = imageResponse.thumbnail;\n              }\n            }\n\n            if (image) {\n              response = {\n                image\n              };\n            }\n          }\n\n          if (this.shouldUpdateCache() && response) {\n            cache = CacheService.getCache<CacheResponse>(schemas.get, schemas.get.stores.responses);\n            await cache.putValue(key, { response: JSON.stringify(response) });\n          }\n        }\n\n        if (!equals(this.response, response)) {\n          this.response = response;\n        }\n      } catch (e: unknown) {\n        this.error = e as object;\n      }\n\n      if (this.response) {\n        this.error = null;\n\n        if (this.pollingRate) {\n          setTimeout(() => {\n            this.isPolling = true;\n            void this.loadState().finally(() => {\n              this.isPolling = false;\n            });\n          }, this.pollingRate);\n        }\n      }\n    } else {\n      this.response = null;\n    }\n    this.isRefreshing = false;\n    this.fireCustomEvent('dataChange', { response: this.response, error: this.error }, true, false, true);\n  }\n\n  private shouldRetrieveCache(): boolean {\n    return getIsResponseCacheEnabled() && this.cacheEnabled && !(this.isRefreshing || this.isPolling);\n  }\n\n  private shouldUpdateCache(): boolean {\n    return getIsResponseCacheEnabled() && this.cacheEnabled;\n  }\n}\n","// THIS FILE IS AUTO GENERATED\n// ANY CHANGES WILL BE LOST DURING BUILD\n// MODIFY THE .SCSS FILE INSTEAD\n\nimport { css, CSSResult } from 'lit';\n/**\n * exports lit-element css\n * @export styles\n */\nexport const styles: CSSResult[] = [\n  css`\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, \"Segoe UI\", \"Segoe UI Web (West European)\", \"Segoe UI\", -apple-system, \"BlinkMacSystemFont\", \"Roboto\", \"Helvetica Neue\", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:\"\\\\\\e70d\"}.ms-icon-chevron-up::before{content:\"\\\\\\e70e\"}.ms-icon-contact::before{content:\"\\\\\\e77b\"}.ms-icon-add-friend::before{content:\"\\\\\\e8fa\"}.ms-icon-outlook-logo-inverser::before{content:\"\\\\\\eb6d\"}:host{--max-height:var(--picker-max-height, 380px);font-family:var(--default-font-family)}:host .picker{background-color:var(--picker-background-color,transparent)}:host fluent-combobox::part(selected-value)::placeholder{color:var(--picker-text-color,var(--input-filled-placeholder-rest))}:host fluent-combobox::part(selected-value):hover::placeholder{color:var(--picker-text-color-hover,var(--secondary-text-hover-color))}[dir=rtl] .picker{direction:rtl}\n`];","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { html, PropertyValueMap, TemplateResult } from 'lit';\nimport { property, state } from 'lit/decorators.js';\nimport { ifDefined } from 'lit/directives/if-defined.js';\nimport { MgtTemplatedTaskComponent, mgtHtml, error } from '@microsoft/mgt-element';\nimport { strings } from './strings';\nimport { fluentCombobox, fluentOption } from '@fluentui/web-components';\nimport { registerFluentComponents } from '../../utils/FluentComponents';\nimport '../../styles/style-helper';\nimport { Entity } from '@microsoft/microsoft-graph-types';\nimport { DataChangedDetail, registerMgtGetComponent } from '../mgt-get/mgt-get';\nimport { styles } from './mgt-picker-css';\nimport { registerComponent } from '@microsoft/mgt-element';\n\nexport const registerMgtPickerComponent = () => {\n  registerFluentComponents(fluentCombobox, fluentOption);\n\n  registerMgtGetComponent();\n  registerComponent('picker', MgtPicker);\n};\n\n/**\n * Web component that allows a single entity pick from a generic endpoint from Graph. Is a thin wrapper over mgt-get.\n * Does not load any state itself, only received state from mgt-get via events.\n *\n * @fires {CustomEvent<any>} selectionChanged - Fired when an option is clicked/selected\n * @export\n * @class MgtPicker\n * @extends {MgtTemplatedTaskComponent}\n *\n * @cssprop --picker-background-color - {Color} Picker component background color\n * @cssprop --picker-list-max-height - {String} max height for options list. Default value is 380px.\n */\nexport class MgtPicker extends MgtTemplatedTaskComponent {\n  protected get strings() {\n    return strings;\n  }\n\n  public static get styles() {\n    return styles;\n  }\n\n  /**\n   * The resource to get\n   *\n   * @type {string}\n   * @memberof MgtPicker\n   */\n  @property({\n    attribute: 'resource',\n    type: String\n  })\n  public resource: string;\n\n  /**\n   * Api version to use for request\n   *\n   * @type {string}\n   * @memberof MgtPicker\n   */\n  @property({\n    attribute: 'version',\n    type: String\n  })\n  public version = 'v1.0';\n\n  /**\n   * Maximum number of pages to get for the resource\n   * default = 3\n   * if <= 0, all pages will be fetched\n   *\n   * @type {number}\n   * @memberof MgtPicker\n   */\n  @property({\n    attribute: 'max-pages',\n    type: Number\n  })\n  public maxPages = 3;\n\n  /**\n   * A placeholder for the picker\n   *\n   * @type {string}\n   * @memberof MgtPicker\n   */\n  @property({\n    attribute: 'placeholder',\n    type: String\n  })\n  public placeholder: string;\n\n  /**\n   * Key to be rendered in the picker\n   *\n   * @type {string}\n   * @memberof MgtPicker\n   */\n  @property({\n    attribute: 'key-name',\n    type: String\n  })\n  public keyName: string;\n\n  /**\n   * Entity to be rendered in the picker\n   *\n   * @type {string}\n   * @memberof MgtPicker\n   */\n  @property({\n    attribute: 'entity-type',\n    type: String\n  })\n  public entityType: string;\n\n  /**\n   * The scopes to request\n   *\n   * @type {string[]}\n   * @memberof MgtPicker\n   */\n  @property({\n    attribute: 'scopes',\n    converter: value => {\n      return value ? value.toLowerCase().split(',') : null;\n    }\n  })\n  public scopes: string[] = [];\n\n  /**\n   * Enables cache on the response from the specified resource\n   * default = false\n   *\n   * @type {boolean}\n   * @memberof MgtPicker\n   */\n  @property({\n    attribute: 'cache-enabled',\n    type: Boolean\n  })\n  public cacheEnabled = false;\n\n  /**\n   * Invalidation period of the cache for the responses in milliseconds\n   *\n   * @type {number}\n   * @memberof MgtPicker\n   */\n  @property({\n    attribute: 'cache-invalidation-period',\n    type: Number\n  })\n  public cacheInvalidationPeriod = 0;\n\n  /**\n   * Sets the currently selected value for the picker\n   * Must be present as an option in the supplied data returned from the the underlying graph query\n   *\n   * @type {string}\n   * @memberof MgtPicker\n   */\n  @property({\n    attribute: 'selected-value',\n    type: String\n  })\n  public selectedValue: string;\n\n  @state() private response: Entity[];\n\n  constructor() {\n    super();\n    this.placeholder = this.strings.comboboxPlaceholder;\n    this.entityType = null;\n    this.keyName = null;\n  }\n\n  /**\n   * Refresh the data\n   *\n   * @param {boolean} [hardRefresh=false]\n   * if false (default), the component will only update if the data changed\n   * if true, the data will be first cleared and reloaded completely\n   * @memberof MgtPicker\n   */\n  public refresh(hardRefresh = false) {\n    if (hardRefresh) {\n      this.clearState();\n    }\n    void this._task.run();\n  }\n\n  /**\n   * Clears the state of the component\n   *\n   * @protected\n   * @memberof MgtPicker\n   */\n  protected clearState(): void {\n    this.response = null;\n    this.error = null;\n  }\n\n  public renderLoading = (): TemplateResult => {\n    if (!this.response) {\n      return this.renderTemplate('loading', null);\n    }\n    return this.renderContent();\n  };\n\n  /**\n   * Invoked on each update to perform rendering the picker. This method must return\n   * a lit-html TemplateResult. Setting properties inside this method will *not*\n   * trigger the element to update.\n   */\n  public renderContent = () => {\n    const errorData = this.error ? (this.error as Error) : null;\n    if (errorData && this.hasTemplate('error')) {\n      return this.renderTemplate('error', { errorData }, 'error');\n    } else if (this.hasTemplate('no-data')) {\n      return this.renderTemplate('no-data', null);\n    }\n\n    return this.response?.length > 0 ? this.renderPicker() : this.renderGet();\n  };\n\n  /**\n   * Render picker.\n   *\n   * @protected\n   * @returns {TemplateResult}\n   * @memberof MgtPicker\n   */\n  protected renderPicker(): TemplateResult {\n    return mgtHtml`\n      <fluent-combobox\n        @keydown=${this.handleComboboxKeydown}\n        current-value=${ifDefined(this.selectedValue)}\n        part=\"picker\"\n        class=\"picker\"\n        id=\"combobox\"\n        autocomplete=\"list\"\n        placeholder=${this.placeholder}>\n          ${this.response.map(\n            item => html`\n            <fluent-option value=${item.id} @click=${(e: MouseEvent) =>\n              this.handleClick(e, item)}> ${this.getNestedPropertyValue(item, this.keyName)} </fluent-option>`\n          )}\n      </fluent-combobox>\n     `;\n  }\n\n  private getNestedPropertyValue(item: Entity, keyName: string) {\n    const keys = keyName.split('.');\n    let value: Entity | object | string = item;\n\n    for (const key of keys) {\n      value = value[key] as object | string;\n\n      if (value === undefined) {\n        console.warn(`mgt-picker: Key '${key}' is undefined.`);\n        return '';\n      }\n    }\n\n    return value;\n  }\n\n  /**\n   * Renders mgt-get which does a GET request to the resource.\n   *\n   * @protected\n   * @returns {TemplateResult}\n   * @memberof MgtPicker\n   */\n  protected renderGet(): TemplateResult {\n    return mgtHtml`\n      <mgt-get\n        class=\"mgt-get\"\n        resource=${this.resource}\n        version=${this.version}\n        .scopes=${this.scopes}\n        max-pages=${this.maxPages}\n        ?cache-enabled=${this.cacheEnabled}\n        ?cache-invalidation-period=${this.cacheInvalidationPeriod}>\n      </mgt-get>`;\n  }\n\n  /**\n   * When the component is first updated wire up the event listeners.\n   * @param changedProperties a map of changed properties with old values\n   */\n  protected firstUpdated(changedProperties: PropertyValueMap<unknown> | Map<PropertyKey, unknown>): void {\n    super.firstUpdated(changedProperties);\n    const parent = this.renderRoot;\n    if (parent) {\n      parent.addEventListener('dataChange', (e: CustomEvent<DataChangedDetail>): void => this.handleDataChange(e));\n    } else {\n      error('mgt-picker component requires a renderRoot. Something has gone horribly wrong.');\n    }\n  }\n\n  private handleDataChange(e: CustomEvent<DataChangedDetail>): void {\n    const response = e.detail.response.value;\n    const err = e.detail.error ? e.detail.error : null;\n    this.response = response;\n    this.error = err;\n  }\n\n  private handleClick(_e: MouseEvent, item: Entity) {\n    this.fireCustomEvent('selectionChanged', item, true, false, true);\n  }\n\n  /**\n   * Handles getting the fluent option item in the dropdown and fires a custom\n   * event with it when you press Enter or Backspace keys.\n   *\n   * @param {KeyboardEvent} e\n   */\n  private readonly handleComboboxKeydown = (e: KeyboardEvent) => {\n    let value: string;\n    let item: Entity;\n    const keyName: string = e.key;\n    const comboBox: HTMLElement = e.target as HTMLElement;\n    const fluentOptionEl = comboBox.querySelector('.selected');\n    if (fluentOptionEl) {\n      value = fluentOptionEl.getAttribute('value');\n    }\n\n    if ('Enter' === keyName) {\n      if (value) {\n        item = this.response.filter(res => res.id === value).pop();\n        this.fireCustomEvent('selectionChanged', item, true, false, true);\n      }\n    }\n  };\n}\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nexport const strings = {\n  termsetIdRequired: 'The termsetId property or termset-id attribute is required',\n  noTermsFound: 'No terms found',\n  comboboxPlaceholder: 'Select a term',\n  loadingMessage: 'Loading...'\n};\n","// THIS FILE IS AUTO GENERATED\n// ANY CHANGES WILL BE LOST DURING BUILD\n// MODIFY THE .SCSS FILE INSTEAD\n\nimport { css, CSSResult } from 'lit';\n/**\n * exports lit-element css\n * @export styles\n */\nexport const styles: CSSResult[] = [\n  css`\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, \"Segoe UI\", \"Segoe UI Web (West European)\", \"Segoe UI\", -apple-system, \"BlinkMacSystemFont\", \"Roboto\", \"Helvetica Neue\", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:\"\\\\\\e70d\"}.ms-icon-chevron-up::before{content:\"\\\\\\e70e\"}.ms-icon-contact::before{content:\"\\\\\\e77b\"}.ms-icon-add-friend::before{content:\"\\\\\\e8fa\"}.ms-icon-outlook-logo-inverser::before{content:\"\\\\\\eb6d\"}:host{--max-height:var(--taxonomy-picker-list-max-height, 380px)}:host .picker{background-color:var(--taxonomy-picker-background-color,transparent)}:host fluent-combobox::part(selected-value)::placeholder{color:var(--taxonomy-picker-placeholder-color,var(--input-filled-placeholder-rest))}:host fluent-combobox::part(selected-value):hover::placeholder{color:var(--taxonomy-picker-placeholder-color-hover,var(--secondary-text-hover-color))}[dir=rtl] .picker{direction:rtl}\n`];","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport type * as MicrosoftGraph from '@microsoft/microsoft-graph-types';\nimport { Position } from '../../graph/types';\nimport { html, PropertyValueMap, TemplateResult } from 'lit';\nimport { property, state } from 'lit/decorators.js';\nimport { MgtTemplatedTaskComponent, mgtHtml } from '@microsoft/mgt-element';\nimport { strings } from './strings';\nimport { fluentCombobox, fluentOption } from '@fluentui/web-components';\nimport { registerFluentComponents } from '../../utils/FluentComponents';\nimport '../../styles/style-helper';\nimport { styles } from './mgt-taxonomy-picker-css';\nimport { DataChangedDetail, registerMgtGetComponent } from '../mgt-get/mgt-get';\nimport { registerComponent } from '@microsoft/mgt-element';\nimport { registerMgtSpinnerComponent } from '../sub-components/mgt-spinner/mgt-spinner';\n\nexport const registerMgtTaxonomyPickerComponent = () => {\n  registerFluentComponents(fluentCombobox, fluentOption);\n\n  registerMgtSpinnerComponent();\n  registerMgtGetComponent();\n  registerComponent('taxonomy-picker', MgtTaxonomyPicker);\n};\n\n/**\n * Web component that can query the Microsoft Graph API for Taxonomy\n * and render a dropdown control with terms,\n * allowing selection of a single term based on\n * the specified term set id or a combination of the specified term set id and the specified term id.\n * Uses mgt-get.\n *\n * @fires {CustomEvent<MicrosoftGraph.TermStore.Term>} selectionChanged - Fired when an option is clicked/selected\n * @export\n * @class MgtTaxonomyPicker\n * @extends {MgtTemplatedTaskComponent}\n *\n * @cssprop --taxonomy-picker-background-color - {Color} Picker component background color\n * @cssprop --taxonomy-picker-list-max-height - {String} max height for options list. Default value is 380px.\n * @cssprop --taxonomy-picker-placeholder-color - {Color} Text color for the placeholder in the picker\n * @cssprop --taxonomy-picker-placeholder-hover-color - {Color} Text color for the placeholder in the picker on hover\n */\nexport class MgtTaxonomyPicker extends MgtTemplatedTaskComponent {\n  /**\n   * The strings to be used for localizing the component.\n   *\n   * @readonly\n   * @protected\n   * @memberof MgtTaxonomyPicker\n   */\n  protected get strings() {\n    return strings;\n  }\n\n  public static get styles() {\n    return styles;\n  }\n\n  /**\n   * The termsetId of the term set whose children to get.\n   *\n   * @type {string}\n   * @memberof MgtTaxonomyPicker\n   */\n  @property({\n    attribute: 'term-set-id',\n    type: String\n  })\n  public termsetId: string;\n\n  /**\n   * The termId of the term whose children to get. This term must be a child of the term set specified by termsetId.\n   *\n   * @type {string}\n   * @memberof MgtTaxonomyPicker\n   */\n  @property({\n    attribute: 'term-id',\n    type: String\n  })\n  public termId: string;\n\n  /**\n   * The id of the site where the termset is located. If not specified, the termset is assumed to be at the tenant level.\n   *\n   * @type {string}\n   * @memberof MgtTaxonomyPicker\n   */\n  @property({\n    attribute: 'site-id',\n    type: String\n  })\n  public siteId: string;\n\n  /**\n   * The locale based on which the term names should be returned.\n   *\n   * @type {string}\n   * @memberof MgtTaxonomyPicker\n   */\n  @property({\n    attribute: 'locale',\n    type: String\n  })\n  public locale: string;\n\n  /**\n   * Api version to use for request.\n   * Default is beta.\n   *\n   * @type {string}\n   * @memberof MgtTaxonomyPicker\n   */\n  @property({\n    attribute: 'version',\n    type: String\n  })\n  public version = 'beta';\n\n  /**\n   * A placeholder for the picker.\n   *\n   * @type {string}\n   * @memberof MgtTaxonomyPicker\n   */\n  @property({\n    attribute: 'placeholder',\n    type: String\n  })\n  public placeholder: string;\n\n  /**\n   * The position of the dropdown. Can be 'above' or 'below'.\n   *\n   * @type {string}\n   * @memberof MgtTaxonomyPicker\n   */\n  @property({\n    attribute: 'position',\n    type: String,\n    converter: (value: Position): Position => {\n      if (value === 'above') {\n        return 'above';\n      }\n      return 'below';\n    }\n  })\n  public position: Position = 'below';\n\n  /**\n   * The default selected term id.\n   *\n   * @type {string}\n   * @memberof MgtTaxonomyPicker\n   */\n  @property({\n    attribute: 'default-selected-term-id',\n    type: String\n  })\n  public defaultSelectedTermId: string;\n\n  /**\n   * The selected term.\n   *\n   * @type {MicrosoftGraph.TermStore.Term}\n   * @memberof MgtTaxonomyPicker\n   */\n  @property({\n    attribute: 'selected-term',\n    type: Object\n  })\n  public selectedTerm: MicrosoftGraph.TermStore.Term | null = null;\n\n  /**\n   * Determines whether component should be disabled or not\n   *\n   * @type {boolean}\n   * @memberof MgtPeoplePicker\n   */\n  @property({\n    attribute: 'disabled',\n    type: Boolean\n  })\n  public disabled: boolean;\n\n  /**\n   * Enables cache on the response from the specified resource.\n   * Default is false.\n   *\n   * @type {boolean}\n   * @memberof MgtTaxonomyPicker\n   */\n  @property({\n    attribute: 'cache-enabled',\n    type: Boolean\n  })\n  public cacheEnabled = false;\n\n  /**\n   * Invalidation period of the cache for the responses in milliseconds.\n   *\n   * @type {number}\n   * @memberof MgtTaxonomyPicker\n   */\n  @property({\n    attribute: 'cache-invalidation-period',\n    type: Number\n  })\n  public cacheInvalidationPeriod = 0;\n\n  @state() private terms: MicrosoftGraph.TermStore.Term[];\n  @state() private noTerms: boolean;\n  // @state() private error: object;\n\n  constructor() {\n    super();\n    this.placeholder = this.strings.comboboxPlaceholder;\n    this.noTerms = false;\n  }\n\n  /**\n   * Refresh the data\n   *\n   * @param {boolean} [hardRefresh=false]\n   * if false (default), the component will only update if the data changed\n   * if true, the data will be first cleared and reloaded completely\n   * @memberof MgtTaxonomyPicker\n   */\n  public refresh(hardRefresh = false) {\n    if (hardRefresh) {\n      this.clearState();\n    }\n  }\n\n  /**\n   * Clears the state of the component\n   *\n   * @protected\n   * @memberof MgtTaxonomyPicker\n   */\n  protected clearState(): void {\n    this.terms = null;\n    this.error = null;\n    this.noTerms = false;\n  }\n  /**\n   * Renders loading spinner while terms are fetched from the Graph\n   *\n   * @protected\n   * @returns\n   * @memberof MgtTaxonomyPicker\n   */\n  protected renderLoading = () => {\n    if (!this.terms) {\n      return (\n        this.renderTemplate('loading', null, 'loading') ||\n        mgtHtml`\n        <div class=\"message-parent\">\n          <mgt-spinner></mgt-spinner>\n          <div label=\"loading-text\" aria-label=\"loading\">\n            ${this.strings.loadingMessage}\n          </div>\n        </div>\n      `\n      );\n    }\n    return this.renderContent();\n  };\n\n  /**\n   * Invoked on each update to perform rendering the picker. This method must return\n   * a lit-html TemplateResult. Setting properties inside this method will *not*\n   * trigger the element to update.\n   */\n  public renderContent = () => {\n    // if error state, render error template\n    if (this.error) {\n      return this.renderError();\n    }\n\n    // if no terms are found, render no-data template\n    if (this.noTerms) {\n      return this.renderNoData();\n    }\n\n    // if terms are found, render picker else render get\n    return this.terms?.length > 0 ? this.renderTaxonomyPicker() : this.renderGet();\n  };\n\n  /**\n   * Render the no-data state.\n   *\n   * @protected\n   * @returns {TemplateResult}\n   * @memberof MgtTaxonomyPicker\n   */\n  protected renderError = (): TemplateResult =>\n    this.renderTemplate('error', null, 'error') || html`<span>${this.error}</span>`;\n  /**\n   * Render the no-data state.\n   *\n   * @protected\n   * @returns {TemplateResult}\n   * @memberof MgtTaxonomyPicker\n   */\n  protected renderNoData(): TemplateResult {\n    return this.renderTemplate('no-data', null) || html`<span>${this.strings.noTermsFound}</span>`;\n  }\n\n  /**\n   * Render picker.\n   *\n   * @protected\n   * @returns {TemplateResult}\n   * @memberof MgtTaxonomyPicker\n   */\n  protected renderTaxonomyPicker(): TemplateResult {\n    return mgtHtml`\n      <fluent-combobox class=\"taxonomy-picker\" autocomplete=\"both\" placeholder=${this.placeholder} position=${\n        this.position\n      } ?disabled=${this.disabled}>\n        ${this.terms.map(term => this.renderTaxonomyPickerItem(term))}\n      </fluent-combobox>\n     `;\n  }\n\n  /**\n   * Render picker item.\n   *\n   * @protected\n   * @returns {TemplateResult}\n   * @memberof MgtTaxonomyPicker\n   */\n  protected renderTaxonomyPickerItem(term: MicrosoftGraph.TermStore.Term): TemplateResult {\n    const selected: boolean = this.defaultSelectedTermId && this.defaultSelectedTermId === term.id;\n\n    return html`\n        <fluent-option value=${term.id} ?selected=${selected} @click=${(e: MouseEvent) => this.handleClick(e, term)}> ${\n          this.renderTemplate('term', { term }, term.id) || term.labels[0].name\n        } </fluent-option>\n        `;\n  }\n\n  /**\n   * Render picker.\n   *\n   * @protected\n   * @returns {TemplateResult}\n   * @memberof MgtTaxonomyPicker\n   */\n  protected renderGet(): TemplateResult {\n    // if termsetId is not specified, return error message\n    if (!this.termsetId) {\n      return html`<span>${this.strings.termsetIdRequired}</span>`;\n    }\n\n    let resource = `/termStore/sets/${this.termsetId}/children`;\n\n    // if both termsetId and termId are specified, then set resource to /termStore/sets/{termsetId}/terms/{termId}/children\n    if (this.termId) {\n      resource = `/termStore/sets/${this.termsetId}/terms/${this.termId}/children`;\n    }\n\n    // if siteId is specified, then prefix /sites/{siteId}/ to the resource\n    if (this.siteId) {\n      resource = `/sites/${this.siteId}${resource}`;\n    }\n\n    // Add properties to select to the resource\n    resource += '?$select=id,labels,descriptions,properties';\n\n    return mgtHtml`\n      <mgt-get\n        class=\"mgt-get\"\n        resource=${resource}\n        version=${this.version}\n        scopes=\"TermStore.Read.All, TermStore.ReadWrite.All\"\n        ?cache-enabled=${this.cacheEnabled}\n        ?cache-invalidation-period=${this.cacheInvalidationPeriod}>\n      </mgt-get>`;\n  }\n\n  protected firstUpdated(changedProperties: PropertyValueMap<unknown> | Map<PropertyKey, unknown>): void {\n    super.firstUpdated(changedProperties);\n    const parent = this.renderRoot;\n    parent.addEventListener('dataChange', (e: CustomEvent<DataChangedDetail>): void => this.handleDataChange(e));\n  }\n\n  private handleDataChange(e: CustomEvent<DataChangedDetail>): void {\n    const error = e.detail.error ? e.detail.error : null;\n\n    if (error) {\n      this.error = error;\n      return;\n    }\n\n    // if locale is specified, then convert it to lower case\n    if (this.locale) {\n      this.locale = this.locale.toLowerCase();\n    }\n\n    const response = e.detail.response.value;\n\n    // if response is not null and has values, if locale is specified, then\n    // get the label in response that has languageTag equal to locale and make it the first label and append the rest of the labels\n\n    const terms = response.map((item: MicrosoftGraph.TermStore.Term) => {\n      const labels = item.labels;\n      if (labels && labels.length > 0) {\n        if (this.locale) {\n          const label = labels.find(l => l.languageTag.toLowerCase() === this.locale);\n          if (label) {\n            item.labels = [label, ...labels.filter(l => l.languageTag.toLowerCase() !== this.locale)];\n          }\n        }\n      }\n      return item;\n    });\n\n    this.terms = terms;\n\n    //  if there are no terms then set noTerms to true\n    if (terms.length === 0) {\n      this.noTerms = true;\n    }\n  }\n\n  private handleClick(e: MouseEvent, item: MicrosoftGraph.TermStore.Term) {\n    this.selectedTerm = item;\n    this.fireCustomEvent('selectionChanged', item);\n  }\n}\n","// THIS FILE IS AUTO GENERATED\n// ANY CHANGES WILL BE LOST DURING BUILD\n// MODIFY THE .SCSS FILE INSTEAD\n\nimport { css, CSSResult } from 'lit';\n/**\n * exports lit-element css\n * @export styles\n */\nexport const styles: CSSResult[] = [\n  css`\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, \"Segoe UI\", \"Segoe UI Web (West European)\", \"Segoe UI\", -apple-system, \"BlinkMacSystemFont\", \"Roboto\", \"Helvetica Neue\", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:\"\\\\\\e70d\"}.ms-icon-chevron-up::before{content:\"\\\\\\e70e\"}.ms-icon-contact::before{content:\"\\\\\\e77b\"}.ms-icon-add-friend::before{content:\"\\\\\\e8fa\"}.ms-icon-outlook-logo-inverser::before{content:\"\\\\\\eb6d\"}:host .signed-in-person{--person-background-color:$signed-in-background-color;padding:var(--login-button-padding,10px 16px)}:host .account{padding:0;margin:7px 0}:host .account,:host .person,:host .signed-in-person{--person-avatar-size:var(--login-person-avatar-size, 40px)}:host fluent-button.signed-in{height:auto;min-width:auto}:host fluent-button.signed-in::part(control){width:100%;height:100%;padding:var(--login-button-padding,0);background:var(--login-signed-in-background,transparent);word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host fluent-button.signed-in::part(control):focus-within,:host fluent-button.signed-in::part(control):hover{background:var(--login-signed-in-hover-background,var(--neutral-fill-stealth-hover));--secondary-text-color:var(--secondary-text-hover-color)}:host fluent-button.signed-out::part(control){color:var(--login-signed-out-button-text-color,var(--neutral-fill-foreground-rest));background:var(--login-signed-out-button-background,padding-box linear-gradient(var(--neutral-fill-rest),var(--neutral-fill-rest)),border-box var(--neutral-stroke-control-rest))}:host fluent-button.signed-out::part(control):focus-within,:host fluent-button.signed-out::part(control):hover{background:var(--login-signed-out-button-hover-background,var(--neutral-fill-stealth-hover))}:host fluent-button.small::part(control):hover{background:0 0}:host fluent-button:focus-visible{outline-style:var(--focus-ring-style,auto)}:host fluent-card{--fill-color:var(--login-popup-background-color, var(--neutral-layer-1));padding:var(--login-popup-padding,16px)}:host .login-root .small .signed-in-person{padding:0;background:0 0}:host .login-root .small .signed-in-person:focus-within,:host .login-root .small .signed-in-person:hover{background:0 0}:host .login-root .account-list{padding:calc(var(--design-unit) * 1px) 0;margin:0}:host .login-root .account-item{height:auto;min-width:auto;margin-top:4px;background:var(--login-popup-background-color,var(--neutral-layer-1));list-style-type:none;cursor:pointer}:host .login-root .account-item:hover{background:var(--login-account-item-hover-bg-color,var(--neutral-fill-stealth-hover));--person-background-color:$login-account-item-hover-bg-color}:host .login-root .flyout .flyout-command{color:var(--login-flyout-command-text-color,var(--accent-foreground-rest))}:host .login-root .flyout .popup-content .commands{display:flex;align-items:flex-end;justify-content:flex-end}:host .login-root .flyout .popup-content .commands fluent-button::part(control){color:var(--login-command-button-text-color,var(--neutral-fill-foreground-rest));background:var(--login-command-button-background-color,var(--neutral-fill-stealth-rest));word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host .login-root .flyout .popup-content .commands fluent-button::part(control):hover{background:var(--login-command-button-hover-background-color,var(--neutral-fill-stealth-hover))}:host .login-root .flyout .popup-content .content .main-profile{margin-bottom:56px;margin-top:27px}:host .login-root .flyout .popup-content .add-account{padding-top:16px}:host .login-root .flyout .popup-content .add-account fluent-button::part(control){color:var(--login-add-account-button-text-color,var(--neutral-fill-foreground-rest));background:var(--login-add-account-button-background-color,var(--neutral-fill-stealth-rest));word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host .login-root .flyout .popup-content .add-account fluent-button::part(control):hover{background:var(--login-add-account-button-hover-background-color,var(--neutral-fill-stealth-hover))}\n`];","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nexport const strings: Record<string, string> = {\n  signInLinkSubtitle: 'Sign In',\n  signOutLinkSubtitle: 'Sign Out',\n  signInWithADifferentAccount: 'Sign in with a different account'\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { CSSResult, html, TemplateResult } from 'lit';\nimport { property, state } from 'lit/decorators.js';\nimport { classMap } from 'lit/directives/class-map.js';\nimport { ifDefined } from 'lit/directives/if-defined.js';\nimport { Providers, ProviderState, IProviderAccount, mgtHtml, MgtTemplatedTaskComponent } from '@microsoft/mgt-element';\n\nimport { AvatarSize, IDynamicPerson, ViewType } from '../../graph/types';\nimport { MgtFlyout, registerMgtFlyoutComponent } from '../sub-components/mgt-flyout/mgt-flyout';\nimport { getUserWithPhoto } from '../../graph/graph.userWithPhoto';\nimport { MgtPerson, registerMgtPersonComponent } from '../mgt-person/mgt-person';\n\nimport { getSvg, SvgIcon } from '../../utils/SvgHelper';\n\nimport { styles } from './mgt-login-css';\nimport { strings } from './strings';\n\nimport '../../styles/style-helper';\n\nimport { fluentListbox, fluentProgressRing, fluentButton, fluentCard } from '@fluentui/web-components';\nimport { registerFluentComponents } from '../../utils/FluentComponents';\nimport { registerComponent } from '@microsoft/mgt-element';\nimport { TaskStatus } from '@lit/task';\n\n/**\n * loginViewType describes the enum strings that can be passed in to determine\n * size of the mgt-login control.\n */\nexport type LoginViewType = 'avatar' | 'compact' | 'full';\n\ninterface PersonViewConfig {\n  view: ViewType;\n  avatarSize: AvatarSize;\n}\n\nexport const registerMgtLoginComponent = () => {\n  registerFluentComponents(fluentListbox, fluentProgressRing, fluentButton, fluentCard);\n\n  registerMgtFlyoutComponent();\n  registerMgtPersonComponent();\n  registerComponent('login', MgtLogin);\n};\n\n/**\n * Web component button and flyout control to facilitate Microsoft identity platform authentication\n *\n * @export\n * @class MgtLogin\n * @extends {MgtTemplatedTaskComponent}\n *\n * @fires {CustomEvent<undefined>} loginInitiated - Fired when login is initiated by the user\n * @fires {CustomEvent<undefined>} loginCompleted - Fired when login completes\n * @fires {CustomEvent<undefined>} loginFailed - Fired when login fails\n * @fires {CustomEvent<undefined>} logoutInitiated - Fired when logout is initiated by the user\n * @fires {CustomEvent<undefined>} logoutCompleted - Fired when logout completed\n *\n * @template signed-in-button-content (dataContext: {personDetails, personImage})\n * @template signed-out-button-content (dataContext: null)\n * @template flyout-commands (dataContext: {handleSignOut})\n * @template flyout-person-details (dataContext: {personDetails, personImage})\n *\n * @cssprop --login-signed-in-background - {String} the background properties of the component when signed in.\n * @cssprop --login-signed-in-hover-background - {String} the background properties of the component when signed in.\n * @cssprop --login-signed-out-button-background - {String} the background properties of the component when signed out.\n * @cssprop --login-signed-out-button-hover-background - {String} the background properties of the component when signed out.\n * @cssprop --login-signed-out-button-text-color - {Color} the background color of the component when signed out.\n * @cssprop --login-button-padding - {Length} the padding of the button. Default is 0px.\n * @cssprop --login-popup-background-color - {Color} the background color of the popup.\n * @cssprop --login-popup-command-button-background-color - {Color} the color of the background to the popup command button.\n * @cssprop --login-popup-padding - {Length} the padding applied to the popup card. Default is 16px.\n * @cssprop --login-add-account-button-text-color - {Color} the color for the text and icon of the add account button.\n * @cssprop --login-add-account-button-background-color - {Color} the color for the background and icon of the add account button.\n * @cssprop --login-add-account-button-hover-background-color - {Color} the color for the background and icon of the add account button on hover.\n * @cssprop --login-command-button-text-color - {Color} the color for the text of the command button.\n * @cssprop --login-command-button-background-color - {Color} the color for the background of the command button.\n * @cssprop --login-command-button-hover-background-color - {Color} the color for the background of the command button on hovering.\n * @cssprop --login-account-item-hover-bg-color - {Color} the background color of the account item on hover.\n * @cssprop --login-flyout-command-text-color - {Color} the color for the text of the flyout command button.\n * @cssprop --login-person-avatar-size - {Length} the size of the avatar in the person component. Default is 40px.\n */\nexport class MgtLogin extends MgtTemplatedTaskComponent {\n  /**\n   * Array of styles to apply to the element. The styles should be defined\n   * using the `css` tag function.\n   */\n  static get styles(): CSSResult[] {\n    return styles;\n  }\n  /**\n   * Returns the object of strings for localization\n   *\n   * @readonly\n   * @protected\n   * @memberof MgtLogin\n   */\n  protected get strings(): Record<string, string> {\n    return strings;\n  }\n\n  /**\n   * Allows developer to use specific user details for login.\n   *\n   * @type {IDynamicPerson}\n   */\n  @property({\n    attribute: 'user-details',\n    type: Object\n  })\n  public userDetails: IDynamicPerson;\n\n  /**\n   * Determines if presence is shown for logged in user\n   * defaults to false\n   *\n   * @type {boolean}\n   */\n  @property({\n    attribute: 'show-presence',\n    type: Boolean\n  })\n  public showPresence = false;\n\n  /**\n   * Determines the view style to apply to the logged in user\n   * options are 'full', 'compact', 'avatar', defaults to 'full'\n   *\n   * @type {LoginViewType}\n   */\n  @property({\n    attribute: 'login-view',\n    type: String\n  })\n  public loginView: LoginViewType = 'full';\n\n  /**\n   * Gets the flyout element\n   *\n   * @protected\n   * @type {MgtFlyout}\n   * @memberof MgtLogin\n   */\n  protected get flyout(): MgtFlyout {\n    return this.renderRoot.querySelector('.flyout');\n  }\n\n  /**\n   * Get the scopes required for login\n   *\n   * @static\n   * @return {*}  {string[]}\n   * @memberof MgtLogin\n   */\n  public static get requiredScopes(): string[] {\n    return [...new Set(['user.read', ...MgtPerson.requiredScopes])];\n  }\n\n  /**\n   * Determines if login menu popup should be showing.\n   *\n   * @private\n   * @type {boolean}\n   */\n  @state() private _isFlyoutOpen: boolean;\n\n  /**\n   * The image blob string\n   *\n   * @private\n   * @type {string}\n   * @memberof MgtLogin\n   */\n  private _image: string;\n\n  /**\n   * Suffix for user details key\n   *\n   * @private\n   * @type {string}\n   * @memberof MgtLogin\n   */\n  private get _userDetailsKey() {\n    return '-userDetails';\n  }\n\n  @state() private _arrowKeyLocation = -1;\n\n  constructor() {\n    super();\n    this._isFlyoutOpen = false;\n  }\n\n  /**\n   * Invoked each time the custom element is appended into a document-connected element\n   *\n   * @memberof MgtLogin\n   */\n  public connectedCallback() {\n    super.connectedCallback();\n    this.addEventListener('click', e => e.stopPropagation());\n  }\n\n  /**\n   * Initiate login\n   *\n   * @returns {Promise<void>}\n   * @memberof MgtLogin\n   */\n  public async login(): Promise<void> {\n    const provider = Providers.globalProvider;\n    // (If we have user details or the consumer doesn't cancel the loginInitiated event) and the provider doesn't support multi-account, we don't have to login.\n    // This condition is to prevent the login popup from showing up when the user is already logged in while still ensuring the loginIntiated event is raised\n    if ((this.userDetails || !this.fireCustomEvent('loginInitiated')) && !provider.isMultiAccountSupportedAndEnabled) {\n      return;\n    }\n    if (provider?.login) {\n      await provider.login();\n\n      if (provider.state === ProviderState.SignedIn) {\n        this.fireCustomEvent('loginCompleted');\n      } else {\n        this.fireCustomEvent('loginFailed');\n      }\n    }\n  }\n\n  /**\n   * Initiate logout\n   *\n   * @returns {Promise<void>}\n   * @memberof MgtLogin\n   */\n  public logout = async (): Promise<void> => {\n    if (!this.fireCustomEvent('logoutInitiated')) {\n      return;\n    }\n\n    const provider = Providers.globalProvider;\n    if (provider?.isMultiAccountSupportedAndEnabled) {\n      localStorage.removeItem(provider.getActiveAccount().id + this._userDetailsKey);\n    }\n    if (provider?.logout) {\n      await provider.logout();\n      this.userDetails = null;\n      if (provider.isMultiAccountSupportedAndEnabled) {\n        localStorage.removeItem(provider.getActiveAccount().id + this._userDetailsKey);\n      }\n      this.hideFlyout();\n      this.fireCustomEvent('logoutCompleted');\n    }\n  };\n\n  /**\n   * Invoked on each update to perform rendering tasks. This method must return\n   * a lit-html TemplateResult. Setting properties inside this method will *not*\n   * trigger the element to update.\n   *\n   * @protected\n   * @returns {TemplateResult}\n   */\n  protected renderContent = (): TemplateResult => {\n    return html`\n      <div class=\"login-root\">\n        ${this.renderButton()}\n        ${this.renderFlyout()}\n      </div>`;\n  };\n\n  protected args(): unknown[] {\n    return [this.providerState];\n  }\n\n  /**\n   * Load state into the component.\n   *\n   * @protected\n   * @memberof MgtLogin\n   */\n  protected async loadState() {\n    const provider = Providers.globalProvider;\n    if (provider && !this.userDetails) {\n      if (provider.state === ProviderState.SignedIn) {\n        this.userDetails = await getUserWithPhoto(provider.graph.forComponent(this));\n\n        if (this.userDetails.personImage) {\n          this._image = this.userDetails.personImage;\n        }\n\n        if (provider.isMultiAccountSupportedAndEnabled) {\n          localStorage.setItem(\n            Providers.globalProvider.getActiveAccount().id + this._userDetailsKey,\n            JSON.stringify(this.userDetails)\n          );\n        }\n        this.fireCustomEvent('loginCompleted');\n      } else {\n        this.userDetails = null;\n      }\n    }\n  }\n\n  /**\n   * Render the sign in or sign out button.\n   *\n   * @protected\n   * @memberof MgtLogin\n   * @returns {TemplateResult}\n   */\n  protected renderButton(): TemplateResult {\n    const isSignedIn = Providers.globalProvider?.state === ProviderState.SignedIn;\n    const loginClasses = classMap({\n      'signed-in': isSignedIn && Boolean(this.userDetails),\n      'signed-out': !isSignedIn,\n      small: this.loginView === 'avatar'\n    });\n    const appearance = isSignedIn ? 'stealth' : 'neutral';\n    const showSignedInState = isSignedIn && this.userDetails;\n    const buttonContentTemplate = showSignedInState\n      ? this.renderSignedInButtonContent(this.userDetails, this._image)\n      : this.renderSignedOutButtonContent();\n    const expandedState: boolean | undefined = showSignedInState ? this._isFlyoutOpen : undefined;\n    return html`\n      <fluent-button\n        id=\"login-button\"\n        aria-expanded=\"${ifDefined(expandedState)}\"\n        appearance=${appearance}\n        aria-label=\"${ifDefined(isSignedIn ? undefined : this.strings.signInLinkSubtitle)}\"\n        ?disabled=${this._task.status === TaskStatus.PENDING}\n        @click=${this.onClick}\n        class=${loginClasses}>\n          ${buttonContentTemplate}\n      </fluent-button>`;\n  }\n\n  private readonly flyoutOpened = () => {\n    this._isFlyoutOpen = true;\n  };\n  private readonly flyoutClosed = () => {\n    this._isFlyoutOpen = false;\n  };\n\n  /**\n   * Render the details flyout.\n   *\n   * @protected\n   * @memberof MgtLogin\n   * @returns {TemplateResult}\n   */\n  protected renderFlyout(): TemplateResult {\n    return mgtHtml`\n      <mgt-flyout\n        class=\"flyout\"\n        light-dismiss\n        @opened=${this.flyoutOpened}\n        @closed=${this.flyoutClosed}>\n        <fluent-card\n          slot=\"flyout\"\n          tabindex=\"0\"\n          class=\"flyout-card\"\n          @keydown=${this.onUserKeyDown}\n          >\n          ${this.renderFlyoutContent()}\n        </fluent-card>\n      </mgt-flyout>`;\n  }\n\n  /**\n   * Tracks tabbing through the flyout (keydown)\n   */\n  private readonly onUserKeyDown = (e: KeyboardEvent): void => {\n    if (!this.flyout.isOpen) {\n      return;\n    }\n\n    const el = this.renderRoot.querySelector('.popup-content');\n    const focusableEls = el.querySelectorAll('ul, fluent-button');\n    const firstFocusableEl = el.querySelector('#signout-button') || focusableEls[0];\n    const lastFocusableEl =\n      el.querySelector('#signin-different-account-button') || focusableEls[focusableEls.length - 1];\n\n    if (e.key === 'Tab' && e.shiftKey && firstFocusableEl === e.target) {\n      e.preventDefault();\n      (lastFocusableEl as HTMLElement)?.focus();\n    }\n    if (e.key === 'Tab' && !e.shiftKey && lastFocusableEl === e.target) {\n      e.preventDefault();\n      (firstFocusableEl as HTMLElement)?.focus();\n    }\n    if (e.key === 'Escape') {\n      const loginButton = this.renderRoot.querySelector('#login-button');\n      (loginButton as HTMLElement)?.focus();\n    }\n    const fluentCardEl = this.renderRoot.querySelector('fluent-card');\n    if (e.shiftKey && e.key === 'Tab' && e.target === fluentCardEl) {\n      this.hideFlyout();\n    }\n  };\n\n  /**\n   * Render the flyout menu content.\n   *\n   * @protected\n   * @returns {TemplateResult}\n   * @memberof MgtLogin\n   */\n  protected renderFlyoutContent(): TemplateResult {\n    if (!this.userDetails) {\n      return;\n    }\n    return html`\n       <div class=\"popup\">\n         <div class=\"popup-content\">\n           <div class=\"commands\">\n             ${this.renderFlyoutCommands()}\n           </div>\n           <div class=\"content\">\n             <div class=\"main-profile\">\n               ${this.renderFlyoutPersonDetails(this.userDetails, this._image)}\n             </div>\n             ${this.renderAccounts()}\n           </div>\n           ${this.renderAddAccountContent()}\n         </div>\n       </div>\n     `;\n  }\n\n  private get hasMultipleAccounts(): boolean {\n    return (\n      Providers.globalProvider?.isMultiAccountSupportedAndEnabled &&\n      Providers.globalProvider?.getAllAccounts?.()?.length > 1\n    );\n  }\n\n  private get usesVerticalPersonCard(): boolean {\n    return this.loginView === 'full' || this.hasMultipleAccounts;\n  }\n\n  /**\n   * Render the flyout person details.\n   *\n   * @protected\n   * @returns {TemplateResult}\n   * @memberof MgtLogin\n   */\n  protected renderFlyoutPersonDetails(personDetails: IDynamicPerson, personImage: string): TemplateResult {\n    const template = this.renderTemplate('flyout-person-details', { personDetails, personImage });\n    return (\n      template ||\n      mgtHtml`\n        <mgt-person\n          .personDetails=${personDetails}\n          .personImage=${personImage}\n          view=\"twolines\"\n          .line2Property=${'email'}\n          ?vertical-layout=${this.usesVerticalPersonCard}\n          class=\"person\">\n        </mgt-person>`\n    );\n  }\n\n  /**\n   * Render the flyout commands.\n   *\n   * @protected\n   * @returns {TemplateResult}\n   * @memberof MgtLogin\n   */\n  protected renderFlyoutCommands(): TemplateResult {\n    const template = this.renderTemplate('flyout-commands', { handleSignOut: () => this.logout() });\n    return (\n      template ||\n      html`\n        <fluent-button\n          id=\"signout-button\"\n          appearance=\"stealth\"\n          size=\"medium\"\n          class=\"flyout-command\"\n          @click=${this.logout}\n          aria-label=${this.strings.signOutLinkSubtitle}>\n            ${this.strings.signOutLinkSubtitle}\n        </fluent-button>`\n    );\n  }\n\n  /**\n   * Render the button content.\n   *\n   * @protected\n   * @returns {TemplateResult}\n   * @memberof MgtLogin\n   */\n  protected renderButtonContent(): TemplateResult {\n    if (this.userDetails) {\n      return this.renderSignedInButtonContent(this.userDetails, this._image);\n    } else {\n      return this.renderSignedOutButtonContent();\n    }\n  }\n\n  /**\n   * Renders the button to allow adding accounts.\n   *\n   * @protected\n   * @returns\n   * @memberof MgtLogin\n   */\n  protected renderAddAccountContent() {\n    if (Providers.globalProvider.isMultiAccountSupportedAndEnabled) {\n      return html`\n        <div class=\"add-account\">\n          <fluent-button\n            id=\"signin-different-account-button\"\n            appearance=\"stealth\"\n            aria-label=\"${this.strings.signInWithADifferentAccount}\"\n            @click=${() => void this.login()}>\n            <span slot=\"start\"><i>${getSvg(SvgIcon.SelectAccount, 'currentColor')}</i></span>\n            ${this.strings.signInWithADifferentAccount}\n          </fluent-button>\n        </div>`;\n    }\n  }\n\n  private parsePersonDisplayConfiguration(): PersonViewConfig {\n    const displayConfig: PersonViewConfig = { view: 'twolines', avatarSize: 'small' };\n    switch (this.loginView) {\n      case 'avatar':\n        displayConfig.view = 'image';\n        displayConfig.avatarSize = 'small';\n        break;\n      case 'compact':\n        displayConfig.view = 'oneline';\n        displayConfig.avatarSize = 'small';\n        break;\n      case 'full':\n      default:\n        displayConfig.view = 'twolines';\n        displayConfig.avatarSize = 'auto';\n        break;\n    }\n    return displayConfig;\n  }\n\n  /**\n   * Render the button content when the user is signed in.\n   *\n   * @protected\n   * @returns {TemplateResult}\n   * @memberof MgtLogin\n   */\n  protected renderSignedInButtonContent(personDetails: IDynamicPerson, personImage: string): TemplateResult {\n    const template = this.renderTemplate('signed-in-button-content', { personDetails, personImage });\n    const displayConfig = this.parsePersonDisplayConfiguration();\n    return (\n      template ||\n      mgtHtml`\n        <mgt-person\n          .personDetails=${this.userDetails}\n          .personImage=${this._image}\n          .view=${displayConfig.view}\n          .showPresence=${this.showPresence}\n          .avatarSize=${displayConfig.avatarSize}\n          line2-property=\"email\"\n          class=\"signed-in-person\"\n        ></mgt-person>`\n    );\n  }\n\n  /**\n   * Renders multiple accounts that can be used to sign in.\n   *\n   * @return {TemplateResult}\n   * @memberof MgtLogin\n   */\n  renderAccounts(): TemplateResult {\n    if (\n      Providers.globalProvider.state === ProviderState.SignedIn &&\n      Providers.globalProvider.isMultiAccountSupportedAndEnabled\n    ) {\n      const provider = Providers.globalProvider;\n      const accounts = provider.getAllAccounts();\n\n      if (accounts?.length > 1) {\n        return html`\n          <div id=\"accounts\">\n            <ul\n              tabindex=\"0\"\n              class=\"account-list\"\n              part=\"account-list\"\n              aria-label=\"${this.ariaLabel}\"\n              @keydown=${this.handleAccountListKeyDown}\n            >\n              ${accounts\n                .filter(a => a.id !== provider.getActiveAccount().id)\n                .map(account => {\n                  const details = localStorage.getItem(account.id + this._userDetailsKey);\n                  return mgtHtml`\n                    <li\n                      tabindex=\"-1\"\n                      part=\"account-item\"\n                      class=\"account-item\"\n                      @click=${() => this.setActiveAccount(account)}\n                      @keyup=${(e: KeyboardEvent) => {\n                        if (e.key === 'Enter') this.setActiveAccount(account);\n                      }}\n                    >\n                      <mgt-person\n                        .personDetails=${details ? JSON.parse(details) : null}\n                        .fallbackDetails=${{ displayName: account.name, mail: account.mail }}\n                        .view=${'twolines'}\n                        class=\"account\"\n                      ></mgt-person>\n                    </li>`;\n                })}\n            </ul>\n          </div>\n       `;\n      }\n    }\n  }\n\n  private readonly handleAccountListKeyDown = (event: KeyboardEvent) => {\n    const list: HTMLUListElement = this.renderRoot.querySelector('ul.account-list');\n    let item: HTMLLIElement;\n    const listItems: HTMLCollection = list?.children;\n    // Default all tabindex values in li nodes to -1\n    for (const element of listItems) {\n      const el = element as HTMLLIElement;\n      el.setAttribute('tabindex', '-1');\n      el.blur();\n    }\n\n    const childElementCount = list.childElementCount;\n    const keyName = event.key;\n    if (keyName === 'ArrowDown') {\n      this._arrowKeyLocation = (this._arrowKeyLocation + 1 + childElementCount) % childElementCount;\n    } else if (keyName === 'ArrowUp') {\n      this._arrowKeyLocation = (this._arrowKeyLocation - 1 + childElementCount) % childElementCount;\n    } else if (keyName === 'Tab' || keyName === 'Escape') {\n      this._arrowKeyLocation = -1;\n      list.blur();\n      if (keyName === 'Escape') {\n        event.preventDefault();\n        event.stopPropagation();\n      }\n      return;\n    }\n\n    if (this._arrowKeyLocation > -1) {\n      item = listItems[this._arrowKeyLocation] as HTMLLIElement;\n      item.setAttribute('tabindex', '1');\n      item.focus();\n    }\n  };\n\n  /**\n   * Set one of the non-active accounts as the active account\n   *\n   * @param {IProviderAccount} account\n   * @memberof MgtLogin\n   */\n  private setActiveAccount(account: IProviderAccount) {\n    Providers.globalProvider.setActiveAccount(account);\n  }\n\n  /**\n   * Clears state of the component\n   *\n   * @protected\n   * @memberof MgtLogin\n   */\n  protected clearState() {\n    this.userDetails = null;\n    this._image = null;\n  }\n\n  /**\n   * Render the button content when the user is not signed in.\n   *\n   * @protected\n   * @returns\n   * @memberof MgtLogin\n   */\n  protected renderSignedOutButtonContent(): TemplateResult {\n    const template = this.renderTemplate('signed-out-button-content', null);\n    return (\n      template ||\n      html`\n        <span>${this.strings.signInLinkSubtitle}</span>`\n    );\n  }\n\n  /**\n   * Show the flyout and its content.\n   *\n   * @protected\n   * @memberof MgtLogin\n   */\n  protected showFlyout(): void {\n    const flyout = this.flyout;\n    if (flyout) {\n      flyout.open();\n    }\n  }\n\n  /**\n   * Dismiss the flyout.\n   *\n   * @protected\n   * @memberof MgtLogin\n   */\n  protected hideFlyout(): void {\n    const flyout = this.flyout;\n    if (flyout) {\n      flyout.close();\n    }\n  }\n\n  /**\n   * Handles the click on the button in the flyout.\n   *\n   * @private\n   * @memberof MgtLogin\n   */\n  private readonly onClick = (): void => {\n    if (this.userDetails && this._isFlyoutOpen) {\n      this.hideFlyout();\n    } else if (this.userDetails) {\n      this.showFlyout();\n    } else {\n      void this.login();\n    }\n  };\n}\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport {\n  IGraph,\n  prepScopes,\n  CacheItem,\n  CacheService,\n  CacheStore,\n  BatchResponse,\n  CollectionResponse\n} from '@microsoft/mgt-element';\nimport { Group } from '@microsoft/microsoft-graph-types';\nimport { schemas } from './cacheStores';\n\nconst groupTypeValues = ['any', 'unified', 'security', 'mailenabledsecurity', 'distribution'] as const;\n\n/**\n * Group Type enumeration\n *\n * @export\n * @enum {string}\n */\nexport type GroupType = (typeof groupTypeValues)[number];\nexport const isGroupType = (value: unknown): value is GroupType =>\n  typeof value === 'string' && groupTypeValues.includes(value as GroupType);\nexport const groupTypeConverter = (value: string, defaultValue: GroupType = 'any'): GroupType =>\n  isGroupType(value) ? value : defaultValue;\n\n/**\n * Object to be stored in cache\n */\nexport interface CacheGroup extends CacheItem {\n  /**\n   * stringified json representing a user\n   */\n  group?: string;\n}\n\n/**\n * Object to be stored in cache representing individual people\n */\ninterface CacheGroupQuery extends CacheItem {\n  /**\n   * json representing a person stored as string\n   */\n  groups?: string[];\n  /**\n   * top number of results\n   */\n  top?: number;\n}\n\n/**\n * Defines the expiration time\n */\nconst getGroupsInvalidationTime = (): number =>\n  CacheService.config.groups.invalidationPeriod || CacheService.config.defaultInvalidationPeriod;\n\n/**\n * Whether the groups store is enabled\n */\nconst getIsGroupsCacheEnabled = (): boolean => CacheService.config.groups.isEnabled && CacheService.config.isEnabled;\n\nconst validGroupQueryScopes = [\n  'GroupMember.Read.All',\n  'Group.Read.All',\n  'Directory.Read.All',\n  'Group.ReadWrite.All',\n  'Directory.ReadWrite.All'\n];\n\nconst validTransitiveGroupMemberScopes = [\n  'GroupMember.Read.All',\n  'Group.Read.All',\n  'Directory.Read.All',\n  'GroupMember.ReadWrite.All',\n  'Group.ReadWrite.All'\n];\n\n/**\n * Searches the Graph for Groups\n *\n * @export\n * @param {IGraph} graph\n * @param {string} query - what to search for\n * @param {number} [top=10] - number of groups to return\n * @param {GroupType} [groupTypes=[\"any\"]] - the type of group to search for\n * @returns {Promise<Group[]>} An array of Groups\n */\nexport const findGroups = async (\n  graph: IGraph,\n  query: string,\n  top = 10,\n  groupTypes: GroupType[] = ['any'],\n  groupFilters = ''\n): Promise<Group[]> => {\n  let cache: CacheStore<CacheGroupQuery>;\n  const key = `${query ? query : '*'}*${groupTypes.join('+')}*${groupFilters}:${top}`;\n\n  if (getIsGroupsCacheEnabled()) {\n    cache = CacheService.getCache(schemas.groups, schemas.groups.stores.groupsQuery);\n    const cacheGroupQuery = await cache.getValue(key);\n    if (cacheGroupQuery && getGroupsInvalidationTime() > Date.now() - cacheGroupQuery.timeCached) {\n      if (cacheGroupQuery.top >= top) {\n        // if request is less than the cache's requests, return a slice of the results\n        return cacheGroupQuery.groups.map(x => JSON.parse(x) as Group).slice(0, top + 1);\n      }\n      // if the new request needs more results than what's presently in the cache, graph must be called again\n    }\n  }\n\n  let filterQuery = '';\n  let responses: Map<string, BatchResponse<CollectionResponse<Group>>>;\n  const batchedResult: Group[] = [];\n\n  if (query !== '') {\n    filterQuery = `(startswith(displayName,'${query}') or startswith(mailNickname,'${query}') or startswith(mail,'${query}'))`;\n  }\n\n  if (groupFilters) {\n    filterQuery += `${query ? ' and ' : ''}${groupFilters}`;\n  }\n\n  if (!groupTypes.includes('any')) {\n    const batch = graph.createBatch<CollectionResponse<Group>>();\n\n    const filterGroups: string[] = [];\n\n    if (groupTypes.includes('unified')) {\n      filterGroups.push(\"groupTypes/any(c:c+eq+'Unified')\");\n    }\n\n    if (groupTypes.includes('security')) {\n      filterGroups.push('(mailEnabled eq false and securityEnabled eq true)');\n    }\n\n    if (groupTypes.includes('mailenabledsecurity')) {\n      filterGroups.push('(mailEnabled eq true and securityEnabled eq true)');\n    }\n\n    if (groupTypes.includes('distribution')) {\n      filterGroups.push('(mailEnabled eq true and securityEnabled eq false)');\n    }\n\n    filterQuery = filterQuery ? `${filterQuery} and ` : '';\n    for (const filter of filterGroups) {\n      batch.get(filter, `/groups?$filter=${filterQuery + filter}`, validGroupQueryScopes);\n    }\n\n    try {\n      responses = await batch.executeAll();\n\n      for (const filterGroup of filterGroups) {\n        if (responses.get(filterGroup).content.value) {\n          for (const group of responses.get(filterGroup).content.value) {\n            const repeat = batchedResult.find(batchedGroup => batchedGroup.id === group.id);\n            if (!repeat) {\n              batchedResult.push(group);\n            }\n          }\n        }\n      }\n    } catch (_) {\n      try {\n        const queries: Promise<CollectionResponse<Group>>[] = [];\n        for (const filter of filterGroups) {\n          queries.push(\n            graph\n              .api('groups')\n              .filter(`${filterQuery} and ${filter}`)\n              .top(top)\n              .count(true)\n              .header('ConsistencyLevel', 'eventual')\n              .middlewareOptions(prepScopes(validGroupQueryScopes))\n              .get() as Promise<CollectionResponse<Group>>\n          );\n        }\n        return (await Promise.all(queries)).map(x => x.value).reduce((a, b) => a.concat(b), []);\n      } catch (e) {\n        return [];\n      }\n    }\n  } else {\n    if (batchedResult.length === 0) {\n      const result = (await graph\n        .api('groups')\n        .filter(filterQuery)\n        .top(top)\n        .count(true)\n        .header('ConsistencyLevel', 'eventual')\n        .middlewareOptions(prepScopes(validGroupQueryScopes))\n        .get()) as CollectionResponse<Group>;\n      if (getIsGroupsCacheEnabled() && result) {\n        await cache.putValue(key, { groups: result.value.map(x => JSON.stringify(x)), top });\n      }\n      return result ? result.value : null;\n    }\n  }\n\n  return batchedResult;\n};\n\n/**\n * Searches the Graph for group members\n *\n * @export\n * @param {IGraph} graph\n * @param {string} query - what to search for\n * @param {string} groupId - what to search for\n * @param {number} [top=10] - number of groups to return\n * @param {boolean} [transitive=false] - whether the return should contain a flat list of all nested members\n * @param {GroupType} [groupTypes=[\"any\"]] - the type of group to search for\n * @returns {Promise<Group[]>} An array of Groups\n */\nexport const findGroupsFromGroup = async (\n  graph: IGraph,\n  query: string,\n  groupId: string,\n  top = 10,\n  transitive = false,\n  groupTypes: GroupType[] = ['any']\n): Promise<Group[]> => {\n  let cache: CacheStore<CacheGroupQuery>;\n  const key = `${groupId}:${query || '*'}:${groupTypes.join('+')}:${transitive}`;\n\n  if (getIsGroupsCacheEnabled()) {\n    cache = CacheService.getCache(schemas.groups, schemas.groups.stores.groupsQuery);\n    const cacheGroupQuery = await cache.getValue(key);\n    if (cacheGroupQuery && getGroupsInvalidationTime() > Date.now() - cacheGroupQuery.timeCached) {\n      if (cacheGroupQuery.top >= top) {\n        // if request is less than the cache's requests, return a slice of the results\n        return cacheGroupQuery.groups.map(x => JSON.parse(x) as Group).slice(0, top + 1);\n      }\n      // if the new request needs more results than what's presently in the cache, graph must be called again\n    }\n  }\n\n  const apiUrl = `groups/${groupId}/${transitive ? 'transitiveMembers' : 'members'}/microsoft.graph.group`;\n  let filterQuery = '';\n  if (query !== '') {\n    filterQuery = `(startswith(displayName,'${query}') or startswith(mailNickname,'${query}') or startswith(mail,'${query}'))`;\n  }\n\n  if (!groupTypes.includes('any')) {\n    const filterGroups = [];\n\n    if (groupTypes.includes('unified')) {\n      filterGroups.push(\"groupTypes/any(c:c+eq+'Unified')\");\n    }\n\n    if (groupTypes.includes('security')) {\n      filterGroups.push('(mailEnabled eq false and securityEnabled eq true)');\n    }\n\n    if (groupTypes.includes('mailenabledsecurity')) {\n      filterGroups.push('(mailEnabled eq true and securityEnabled eq true)');\n    }\n\n    if (groupTypes.includes('distribution')) {\n      filterGroups.push('(mailEnabled eq true and securityEnabled eq false)');\n    }\n\n    filterQuery += (query !== '' ? ' and ' : '') + filterGroups.join(' or ');\n  }\n\n  const result = (await graph\n    .api(apiUrl)\n    .filter(filterQuery)\n    .count(true)\n    .top(top)\n    .header('ConsistencyLevel', 'eventual')\n    .middlewareOptions(prepScopes(validTransitiveGroupMemberScopes))\n    .get()) as CollectionResponse<Group>;\n\n  if (getIsGroupsCacheEnabled() && result) {\n    await cache.putValue(key, { groups: result.value.map(x => JSON.stringify(x)), top });\n  }\n\n  return result ? result.value : null;\n};\n\n/**\n * async promise, returns all Graph groups associated with the id provided\n *\n * @param {string} id\n * @returns {(Promise<User>)}\n * @memberof Graph\n */\nexport const getGroup = async (graph: IGraph, id: string, requestedProps?: string[]): Promise<Group> => {\n  let cache: CacheStore<CacheGroup>;\n\n  if (getIsGroupsCacheEnabled()) {\n    cache = CacheService.getCache(schemas.groups, schemas.groups.stores.groups);\n    // check cache\n    const group = await cache.getValue(id);\n\n    // is it stored and is timestamp good?\n    if (group && getGroupsInvalidationTime() > Date.now() - group.timeCached) {\n      const cachedData = group.group ? (JSON.parse(group.group) as Group) : null;\n      const uniqueProps =\n        requestedProps && cachedData ? requestedProps.filter(prop => !Object.keys(cachedData).includes(prop)) : null;\n\n      // return without any worries\n      if (!uniqueProps || uniqueProps.length <= 1) {\n        return cachedData;\n      }\n    }\n  }\n\n  let apiString = `/groups/${id}`;\n  if (requestedProps) {\n    apiString = apiString + '?$select=' + requestedProps.toString();\n  }\n\n  // else we must grab it\n  const response = (await graph.api(apiString).middlewareOptions(prepScopes(validGroupQueryScopes)).get()) as Group;\n  if (getIsGroupsCacheEnabled()) {\n    await cache.putValue(id, { group: JSON.stringify(response) });\n  }\n  return response;\n};\n\n/**\n * Returns a Promise of Graph Groups array associated with the groupIds array\n *\n * @export\n * @param {IGraph} graph\n * @param {string[]} groupIds, an array of string ids\n * @returns {Promise<Group[]>}\n */\nexport const getGroupsForGroupIds = async (graph: IGraph, groupIds: string[], filters = ''): Promise<Group[]> => {\n  if (!groupIds || groupIds.length === 0) {\n    return [];\n  }\n  const batch = graph.createBatch();\n  const groupDict: Record<string, Group | Promise<Group>> = {};\n  const notInCache: string[] = [];\n  let cache: CacheStore<CacheGroup>;\n\n  if (getIsGroupsCacheEnabled()) {\n    cache = CacheService.getCache(schemas.groups, schemas.groups.stores.groups);\n  }\n\n  for (const id of groupIds) {\n    groupDict[id] = null;\n    let group: CacheGroup;\n    if (getIsGroupsCacheEnabled()) {\n      group = await cache.getValue(id);\n    }\n    if (group && getGroupsInvalidationTime() > Date.now() - group.timeCached) {\n      groupDict[id] = group.group ? (JSON.parse(group.group) as Group) : null;\n    } else if (id !== '') {\n      let apiUrl = `/groups/${id}`;\n      if (filters) {\n        apiUrl = `${apiUrl}?$filters=${filters}`;\n      }\n      batch.get(id, apiUrl, validGroupQueryScopes);\n      notInCache.push(id);\n    }\n  }\n  try {\n    const responses = await batch.executeAll();\n    // iterate over groupIds to ensure the order of ids\n    for (const id of groupIds) {\n      const response = responses.get(id);\n      if (response?.content) {\n        groupDict[id] = response.content as Group;\n        if (getIsGroupsCacheEnabled()) {\n          await cache.putValue(id, { group: JSON.stringify(response.content) });\n        }\n      }\n    }\n    return Promise.all(Object.values(groupDict));\n  } catch (_) {\n    // fallback to making the request one by one\n    try {\n      // call getGroup for all the users that weren't cached\n      groupIds\n        .filter(id => notInCache.includes(id))\n        .forEach(id => {\n          groupDict[id] = getGroup(graph, id);\n        });\n      if (getIsGroupsCacheEnabled()) {\n        // store all users that weren't retrieved from the cache, into the cache\n        await Promise.all(\n          groupIds\n            .filter(id => notInCache.includes(id))\n            .map(async id => await cache.putValue(id, { group: JSON.stringify(await groupDict[id]) }))\n        );\n      }\n      return Promise.all(Object.values(groupDict));\n    } catch (e) {\n      return [];\n    }\n  }\n};\n\n/**\n * Gets groups from the graph that are in the group ids\n *\n * @param graph\n * @param query\n * @param groupId\n * @param top\n * @param transitive\n * @param groupTypes\n * @param filters\n * @returns\n */\nexport const findGroupsFromGroupIds = async (\n  graph: IGraph,\n  query: string,\n  groupIds: string[],\n  top = 10,\n  groupTypes: GroupType[] = ['any'],\n  filters = ''\n): Promise<Group[]> => {\n  const foundGroups: Group[] = [];\n  const graphGroups = await findGroups(graph, query, top, groupTypes, filters);\n  if (graphGroups) {\n    for (const group of graphGroups) {\n      if (group.id && groupIds.includes(group.id)) {\n        foundGroups.push(group);\n      }\n    }\n  }\n  return foundGroups;\n};\n","// THIS FILE IS AUTO GENERATED\n// ANY CHANGES WILL BE LOST DURING BUILD\n// MODIFY THE .SCSS FILE INSTEAD\n\nimport { css, CSSResult } from 'lit';\n/**\n * exports lit-element css\n * @export styles\n */\nexport const styles: CSSResult[] = [\n  css`\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, \"Segoe UI\", \"Segoe UI Web (West European)\", \"Segoe UI\", -apple-system, \"BlinkMacSystemFont\", \"Roboto\", \"Helvetica Neue\", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:\"\\\\\\e70d\"}.ms-icon-chevron-up::before{content:\"\\\\\\e70e\"}.ms-icon-contact::before{content:\"\\\\\\e77b\"}.ms-icon-add-friend::before{content:\"\\\\\\e8fa\"}.ms-icon-outlook-logo-inverser::before{content:\"\\\\\\eb6d\"}:host{--person-details-wrapper-width:0;width:auto}:host fluent-text-field{width:100%}:host fluent-text-field::part(root){display:flex;flex-wrap:wrap;height:auto;background:padding-box linear-gradient(var(--people-picker-input-background,var(--neutral-fill-input-rest)),var(--people-picker-input-background,var(--neutral-fill-input-rest))),border-box var(--people-picker-input-border-color,var(--neutral-stroke-input-rest))}:host fluent-text-field::part(root):hover{background:padding-box linear-gradient(var(--people-picker-input-hover-background,var(--neutral-fill-input-hover)),var(--people-picker-input-hover-background,var(--neutral-fill-input-hover))),border-box var(--people-picker-input-hover-border-color,var(--neutral-stroke-input-hover))}:host fluent-text-field::part(root):focus,:host fluent-text-field::part(root):focus-within{background:padding-box linear-gradient(var(--people-picker-input-focus-background,var(--neutral-fill-input-focus)),var(--people-picker-input-focus-background,var(--neutral-fill-input-focus))),border-box var(--people-picker-input-focus-border-color,var(--neutral-stroke-input-focus))}:host fluent-text-field::part(start){margin:unset}:host fluent-text-field::part(control){width:auto;flex-grow:1;min-width:25%;height:calc((var(--base-height-multiplier) + var(--density)) * var(--design-unit) * 1px);word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host fluent-text-field::part(control)::placeholder{color:var(--people-picker-input-placeholder-text-color,var(--input-placeholder-rest))}:host fluent-text-field::part(control):hover::placeholder{color:var(--people-picker-input-placeholder-hover-text-color,var(--input-placeholder-hover))}:host fluent-text-field::part(control):focus-within::placeholder,:host fluent-text-field::part(control):focus::placeholder{color:var(--people-picker-input-placeholder-focus-text-color,var(--input-placeholder-filled))}:host fluent-text-field .search-icon{display:flex;padding-top:10px;padding-inline-start:10px}:host fluent-text-field .search-icon svg path{fill:var(--people-picker-search-icon-color,currentColor)}:host .selected-list{display:flex;flex-wrap:wrap;column-gap:5px;padding:unset;margin:0 5px}:host .selected-list-item{display:flex;column-gap:5px;border-radius:100px;margin-top:3px;background-color:var(--people-picker-selected-option-background-color,var(--person-background-color,var(--neutral-layer-3)))}:host .selected-list-item.highlighted{background-color:var(--people-picker-selected-option-highlight-background-color,var(--accent-fill-rest))}:host .selected-list-item-close-icon{display:flex;justify-content:center;align-items:center;padding-inline-end:8px;cursor:pointer}:host .selected-list-item-close-icon svg path{fill:var(--people-picker-remove-selected-close-icon-color,currentColor)}:host .selected-list-item .person-image-selected{width:max-content;--person-avatar-size:var(--people-picker-selected-person-avatar-size, 24px)}:host fluent-card{margin-top:4px;background-color:var(--people-picker-dropdown-background-color,var(--fill-color))}:host .searched-people-list{list-style:none;padding:4px;margin:auto}:host .searched-people-list-result{padding:4px;border-radius:4px;background:var(--people-picker-dropdown-result-background-color,var(--person-background-color,transparent))}:host .searched-people-list-result:hover{background:var(--people-picker-dropdown-result-hover-background-color,var(--person-background-color,var(--neutral-fill-input-hover)))}:host .searched-people-list-result:focus,:host .searched-people-list-result:focus-within{background:var(--people-picker-dropdown-result-focus-background-color,var(--person-background-color,var(--neutral-fill-input-focus)))}:host .searched-people-list-result .person-image-result{--person-avatar-size:var(--people-picker-result-person-avatar-size, 40px)}:host .message-parent{display:flex;place-content:center;flex-direction:row;padding:10px 15px;column-gap:5px}:host .message-parent .loading-text,:host .message-parent .search-error-text{font-style:normal;font-weight:600;font-size:14px;line-height:19px;text-align:center;color:var(--people-picker-no-results-text-color,var(--neutral-foreground-hint))}\n`];","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nexport const strings = {\n  inputPlaceholderText: 'Search for a name',\n  maxSelectionsPlaceHolder: 'Max contacts added',\n  maxSelectionsAriaLabel: 'Maximum contact selections reached',\n  noResultsFound: \"We didn't find any matches.\",\n  loadingMessage: 'Loading...',\n  selected: 'selected',\n  removeSelectedUser: 'Remove ',\n  selectContact: 'select a contact',\n  suggestionsTitle: 'Suggested contacts'\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { html, TemplateResult } from 'lit';\nimport { property, state } from 'lit/decorators.js';\nimport { repeat } from 'lit/directives/repeat.js';\nimport { TaskStatus } from '@lit/task';\nimport {\n  findGroups,\n  getGroupsForGroupIds,\n  GroupType,\n  getGroup,\n  findGroupsFromGroupIds,\n  isGroupType,\n  groupTypeConverter\n} from '../../graph/graph.groups';\nimport {\n  findPeople,\n  getPeople,\n  PersonType,\n  personTypeConverter,\n  UserType,\n  userTypeConverter\n} from '../../graph/graph.people';\nimport {\n  findUsers,\n  findGroupMembers,\n  findUsersFromGroupIds,\n  getUser,\n  getUsersForUserIds,\n  getUsers\n} from '../../graph/graph.user';\nimport { IDynamicPerson } from '../../graph/types';\nimport {\n  Providers,\n  ProviderState,\n  MgtTemplatedTaskComponent,\n  arraysAreEqual,\n  IGraph,\n  mgtHtml\n} from '@microsoft/mgt-element';\nimport '../../styles/style-helper';\nimport { debounce, isValidEmail } from '../../utils/Utils';\nimport { MgtPerson, defaultPersonProperties, registerMgtPersonComponent } from '../mgt-person/mgt-person';\nimport { MgtFlyout, registerMgtFlyoutComponent } from '../sub-components/mgt-flyout/mgt-flyout';\nimport { styles } from './mgt-people-picker-css';\nimport { SvgIcon, getSvg } from '../../utils/SvgHelper';\nimport { fluentTextField, fluentCard } from '@fluentui/web-components';\nimport { registerFluentComponents } from '../../utils/FluentComponents';\nimport { strings } from './strings';\nimport { Person, User } from '@microsoft/microsoft-graph-types';\nimport { registerComponent } from '@microsoft/mgt-element';\nimport { registerMgtSpinnerComponent } from '../sub-components/mgt-spinner/mgt-spinner';\nimport { isGraphError } from '../../graph/isGraphError';\nimport { type PersonCardInteraction, personCardConverter } from './../PersonCardInteraction';\n\nexport { GroupType } from '../../graph/graph.groups';\nexport { PersonType, UserType } from '../../graph/graph.people';\n\nexport const registerMgtPeoplePickerComponent = () => {\n  registerFluentComponents(fluentTextField, fluentCard);\n\n  registerMgtFlyoutComponent();\n  registerMgtPersonComponent();\n  registerMgtSpinnerComponent();\n  registerComponent('people-picker', MgtPeoplePicker);\n};\n\n/**\n * Web component used to search for people from the Microsoft Graph\n *\n * @export\n * @class MgtPicker\n * @extends {MgtTemplatedTaskComponent}\n *\n * @fires {CustomEvent<IDynamicPerson[]>} selectionChanged - Fired when set of selected people changes\n *\n * @cssprop --people-picker-selected-option-background-color - {Color} the background color of the selected person.\n * @cssprop --people-picker-selected-option-highlight-background-color - {Color} the background color of the selected person when you select it for copy/cut.\n * @cssprop --people-picker-dropdown-background-color - {Color} the background color of the dropdown card.\n * @cssprop --people-picker-dropdown-result-background-color - {Color} the background color of the dropdown result.\n * @cssprop --people-picker-dropdown-result-hover-background-color - {Color} the background color of the dropdown result on hover.\n * @cssprop --people-picker-dropdown-result-focus-background-color - {Color} the background color of the dropdown result on focus.\n * @cssprop --people-picker-no-results-text-color - {Color} the no results found text color.\n * @cssprop --people-picker-input-background - {Color} the input background color.\n * @cssprop --people-picker-input-border-color - {Color} the input border color.\n * @cssprop --people-picker-input-hover-background - {Color} the input background color when you hover.\n * @cssprop --people-picker-input-hover-border-color - {Color} the input border color when you hover\n * @cssprop --people-picker-input-focus-background - {Color} the input background color when you focus.\n * @cssprop --people-picker-input-focus-border-color - {Color} the input border color when you focus.\n * @cssprop --people-picker-input-placeholder-focus-text-color - {Color} the placeholder text color when you focus.\n * @cssprop --people-picker-input-placeholder-hover-text-color - {Color} the placeholder text color when you hover.\n * @cssprop --people-picker-input-placeholder-text-color - {Color} the placeholder text color.\n * @cssprop --people-picker-search-icon-color - {Color} the search icon color\n * @cssprop --people-picker-remove-selected-close-icon-color - {Color} the remove selected person close icon color.\n * @cssprop --people-picker-result-person-avatar-size - {Length} the avatar size of the person in the result. Default is 40px.\n * @cssprop --people-picker-selected-person-avatar-size - {Length} the avatar size of the selected person. Default is 24px.\n */\nexport class MgtPeoplePicker extends MgtTemplatedTaskComponent {\n  /**\n   * Array of styles to apply to the element. The styles should be defined\n   * user the `css` tag function.\n   */\n  static get styles() {\n    return styles;\n  }\n\n  /**\n   * The strings to be used for localizing the component.\n   *\n   * @readonly\n   * @protected\n   * @memberof MgtPeoplePicker\n   */\n  protected get strings() {\n    return strings;\n  }\n\n  /**\n   * Gets the flyout element\n   *\n   * @protected\n   * @type {MgtFlyout}\n   * @memberof MgtLogin\n   */\n  protected get flyout(): MgtFlyout {\n    return this.renderRoot.querySelector('.flyout');\n  }\n\n  /**\n   * Gets the input element\n   *\n   * @protected\n   * @type {MgtFlyout}\n   * @memberof MgtLogin\n   */\n  protected get input(): HTMLInputElement {\n    return this.renderRoot.querySelector('fluent-text-field');\n  }\n\n  /**\n   * value determining if search is filtered to a group.\n   *\n   * @type {string}\n   */\n  @property({ attribute: 'group-id', converter: value => value.trim() })\n  public groupId: string;\n\n  /**\n   * array of groups for search to be filtered by.\n   *\n   * @type {string[]}\n   */\n  @property({\n    attribute: 'group-ids',\n    converter: value => {\n      return value.split(',').map(v => v.trim());\n    }\n  })\n  public groupIds: string[] = [];\n  /**\n   * Value determining if search is filtered to a group.\n   * Valid options are 'any', 'person', 'group'\n   *\n   * @type {PersonType}\n   */\n  @property({\n    attribute: 'type',\n    converter: value => personTypeConverter(value, 'any')\n  })\n  public type: PersonType = 'any';\n\n  /**\n   * Type of groups to search for - requires personType to be set to \"Group\" or \"All\"\n   * Valid values are 'any', 'unified', 'security', 'mailenabledsecurity', 'distribution'\n   * Default is ['any'].\n   *\n   * @type {GroupType}\n   */\n  @property({\n    attribute: 'group-type',\n    converter: value => {\n      const defaultResult: GroupType[] = ['any'];\n      if (!value || value.length === 0) {\n        return defaultResult;\n      }\n\n      const values = value.split(',');\n      const groupTypes: GroupType[] = [];\n\n      for (let v of values) {\n        v = v.trim();\n        if (isGroupType(v)) {\n          groupTypes.push(groupTypeConverter(v));\n        }\n      }\n\n      if (groupTypes.length === 0) {\n        return defaultResult;\n      }\n\n      return groupTypes;\n    }\n  })\n  public groupType: GroupType[] = ['any'];\n\n  /**\n   * The type of user to search for.\n   * Valid options are 'any', 'user', 'contact'\n   * Default is any.\n   *\n   * @type {UserType}\n   * @memberof MgtPeoplePicker\n   */\n  @property({\n    attribute: 'user-type',\n    converter: value => userTypeConverter(value)\n  })\n  public userType: UserType = 'any';\n\n  /**\n   * whether the return should contain a flat list of all nested members\n   *\n   * @type {boolean}\n   */\n  @property({\n    attribute: 'transitive-search',\n    type: Boolean\n  })\n  public transitiveSearch = false;\n\n  /**\n   * containing object of IDynamicPerson.\n   *\n   * @type {IDynamicPerson[]}\n   */\n  @property({\n    attribute: 'people',\n    type: Object\n  })\n  public people: IDynamicPerson[] | null = null;\n\n  /**\n   * determining how many people to show in list.\n   *\n   * @type {number}\n   */\n  @property({\n    attribute: 'show-max',\n    type: Number\n  })\n  public showMax = 6;\n\n  /**\n   * Sets whether the person image should be fetched\n   * from the Microsoft Graph\n   *\n   * @type {boolean}\n   * @memberof MgtPerson\n   */\n  @property({\n    attribute: 'disable-images',\n    type: Boolean\n  })\n  public disableImages = false;\n\n  @property({\n    attribute: 'show-presence',\n    type: Boolean\n  })\n  public showPresence: boolean;\n\n  /**\n   * Sets how the person-card is invoked\n   * Set to PersonCardInteraction.none to not show the card\n   *\n   * @type {PersonCardInteraction}\n   * @memberof MgtPerson\n   */\n  @property({\n    attribute: 'person-card',\n    converter: value => personCardConverter(value)\n  })\n  public personCardInteraction: PersonCardInteraction = 'none';\n\n  /**\n   * array of user picked people.\n   *\n   * @type {IDynamicPerson[]}\n   */\n  public get selectedPeople(): IDynamicPerson[] {\n    return this._selectedPeople;\n  }\n  @property({\n    attribute: 'selected-people',\n    type: Array\n  })\n  public set selectedPeople(value: IDynamicPerson[]) {\n    if (!value) value = [];\n    if (!arraysAreEqual(this._selectedPeople, value)) {\n      this._selectedPeople = value;\n      this.fireCustomEvent('selectionChanged', this._selectedPeople);\n    }\n  }\n\n  /**\n   * array of people to be selected upon initialization\n   *\n   * @type {string[]}\n   * @memberof MgtPeoplePicker\n   */\n  @property({\n    attribute: 'default-selected-user-ids',\n    converter: value => {\n      return value.split(',').map(v => v.trim());\n    },\n    type: String\n  })\n  public defaultSelectedUserIds: string[] = [];\n\n  /**\n   * array of groups to be selected upon initialization\n   *\n   * @type {string[]}\n   * @memberof MgtPeoplePicker\n   */\n  @property({\n    attribute: 'default-selected-group-ids',\n    converter: value => {\n      return value.split(',').map(v => v.trim());\n    },\n    type: String\n  })\n  public defaultSelectedGroupIds: string[] = [];\n\n  /**\n   * Placeholder text.\n   *\n   * @type {string}\n   * @memberof MgtPeoplePicker\n   */\n  @property({\n    attribute: 'placeholder',\n    type: String\n  })\n  public placeholder: string;\n\n  /**\n   * Determines whether component should be disabled or not\n   *\n   * @type {boolean}\n   * @memberof MgtPeoplePicker\n   */\n  @property({\n    attribute: 'disabled',\n    type: Boolean\n  })\n  public disabled = false;\n\n  /**\n   * Determines if a user can enter an email without selecting a person\n   *\n   * @type {boolean}\n   * @memberof MgtPeoplePicker\n   */\n  @property({\n    attribute: 'allow-any-email',\n    type: Boolean\n  })\n  public allowAnyEmail = false;\n\n  /**\n   * Determines whether component allows multiple or single selection of people\n   *\n   * @type {string}\n   * @memberof MgtPeoplePicker\n   */\n  @property({\n    attribute: 'selection-mode',\n    type: String\n  })\n  public selectionMode: string;\n\n  /**\n   * Array of the only users to be searched.\n   *\n   * @type {string[]}\n   * @memberof MgtPeoplePicker\n   */\n  @property({\n    attribute: 'user-ids',\n    converter: value => {\n      return value.split(',').map(v => v.trim());\n    },\n    type: String\n  })\n  public userIds: string[] = [];\n\n  /**\n   * Filters that can be set on the user properties query.\n   */\n  @property({ attribute: 'user-filters' })\n  public userFilters: string;\n\n  /**\n   * Filters that can be set on the people query properties.\n   */\n  @property({ attribute: 'people-filters' })\n  public peopleFilters: string;\n\n  /**\n   * Filters that can be set on the group query properties.\n   */\n  @property({ attribute: 'group-filters' })\n  public groupFilters: string;\n\n  /**\n   * Label that can be set on the people picker input to provide context to\n   * assistive technologies\n   */\n  @property({\n    attribute: 'aria-label',\n    type: String\n  })\n  public ariaLabel: string;\n\n  /**\n   * Get the scopes required for people picker\n   *\n   * @static\n   * @return {*}  {string[]}\n   * @memberof MgtPeoplePicker\n   */\n  public static get requiredScopes(): string[] {\n    return [\n      ...new Set([\n        'user.read.all',\n        'people.read',\n        'group.read.all',\n        'user.readbasic.all',\n        'contacts.read',\n        ...MgtPerson.requiredScopes\n      ])\n    ];\n  }\n\n  /**\n   * User input in search.\n   *\n   * @protected\n   * @type {string}\n   * @memberof MgtPeoplePicker\n   */\n  @state()\n  protected userInput = '';\n\n  private _selectedPeople: IDynamicPerson[] = [];\n\n  private defaultPeople: IDynamicPerson[];\n\n  // tracking of user arrow key input for selection\n  @state() private _arrowSelectionCount = -1;\n  // List of people requested if group property is provided\n  private _groupPeople: IDynamicPerson[];\n  private _debouncedSearch: { (): void; (): void };\n  private defaultSelectedUsers: IDynamicPerson[] = [];\n  private defaultSelectedGroups: IDynamicPerson[] = [];\n  // List of users highlighted for copy/cut-pasting\n  @state() private _highlightedUsers: Element[] = [];\n  // current user index to the left of the highlighted users\n  private _currentHighlightedUserPos = 0;\n\n  /**\n   * Checks if the input is focused.\n   */\n  @state() private _isFocused = false;\n\n  /**\n   * Switch to determine if a typed email can be set.\n   */\n  @state() private _setAnyEmail = false;\n\n  /**\n   * List of people found from the graph calls.\n   */\n  @state() private _foundPeople: IDynamicPerson[];\n\n  constructor() {\n    super();\n\n    this.addEventListener('copy', this.handleCopy);\n    this.addEventListener('cut', this.handleCut);\n    this.addEventListener('paste', this.handlePaste);\n    this.addEventListener('selectionChanged', this.handleSelectionChanged);\n  }\n\n  /**\n   * Disable the inner input of the fluent-text-field.\n   */\n  private disableTextInput() {\n    const inputControl = this.input.shadowRoot.querySelector<HTMLInputElement>('input');\n    if (inputControl) {\n      inputControl.setAttribute('disabled', 'true');\n      inputControl.value = '';\n    }\n  }\n\n  /**\n   * Enable the inner input of the fluent-text-field.\n   */\n  private enableTextInput() {\n    const inputControl = this.input.shadowRoot.querySelector<HTMLInputElement>('input');\n    if (inputControl) {\n      inputControl.removeAttribute('disabled');\n      inputControl.focus();\n    }\n  }\n\n  /**\n   * Clears the disabled property on the people picker when used in single mode.\n   */\n  private readonly handleSelectionChanged = () => {\n    if (this.selectedPeople.length === 0 && !this.disabled) {\n      this.enableTextInput();\n    }\n  };\n\n  private get hasMaxSelections(): boolean {\n    return this.selectionMode === 'single' && this.selectedPeople.length >= 1;\n  }\n\n  /**\n   * Focuses the input element when focus is called\n   *\n   * @param {FocusOptions} [options]\n   * @memberof MgtPeoplePicker\n   */\n  public focus(options?: FocusOptions) {\n    if (!this.input) {\n      return;\n    }\n    this.input.focus(options);\n    this.input.select();\n  }\n\n  /**\n   * Queries the microsoft graph for a user based on the user id and adds them to the selectedPeople array\n   *\n   * @param {readonly string []} an array of user ids to add to selectedPeople\n   * @returns {Promise<void>}\n   * @memberof MgtPeoplePicker\n   */\n  public async selectUsersById(userIds: readonly string[]): Promise<void> {\n    const provider = Providers.globalProvider;\n    const graph = Providers.globalProvider.graph;\n    if (provider && provider.state === ProviderState.SignedIn) {\n      // eslint-disable-next-line guard-for-in, @typescript-eslint/no-for-in-array\n      for (const id in userIds) {\n        const userId = userIds[id];\n        try {\n          const personDetails = await getUser(graph, userId, defaultPersonProperties);\n          this.addPerson(personDetails);\n        } catch (e: unknown) {\n          // This caters for allow-any-email property if it's enabled on the component\n          // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access, @typescript-eslint/no-unsafe-call\n          if (isGraphError(e) && e.message?.includes('does not exist') && this.allowAnyEmail) {\n            if (isValidEmail(userId)) {\n              const anyMailUser = {\n                mail: userId,\n                displayName: userId\n              };\n              this.addPerson(anyMailUser);\n            }\n          }\n        }\n      }\n    }\n  }\n  /**\n   * Queries the microsoft graph for a group of users from a group id, and adds them to the selectedPeople\n   *\n   * @param {readonly string []} an array of group ids to add to selectedPeople\n   * @returns {Promise<void>}\n   * @memberof MgtPeoplePicker\n   */\n  public async selectGroupsById(groupIds: readonly string[]): Promise<void> {\n    const provider = Providers.globalProvider;\n    const graph = Providers.globalProvider.graph;\n    if (provider && provider.state === ProviderState.SignedIn) {\n      // eslint-disable-next-line guard-for-in, @typescript-eslint/no-for-in-array\n      for (const id in groupIds) {\n        try {\n          const groupDetails = await getGroup(graph, groupIds[id]);\n          this.addPerson(groupDetails);\n        } catch (e) {\n          // no-op\n        }\n      }\n    }\n  }\n\n  /**\n   * Invoked on each update to perform rendering tasks. This method must return a lit-html TemplateResult.\n   * Setting properties inside this method will not trigger the element to update.\n   *\n   * @returns {TemplateResult}\n   * @memberof MgtPeoplePicker\n   */\n  public render(): TemplateResult {\n    const defaultTemplate = this.renderTemplate('default', { people: this._foundPeople });\n    if (defaultTemplate) {\n      return defaultTemplate;\n    }\n\n    const selectedPeopleTemplate = this.renderSelectedPeople(this.selectedPeople);\n    const inputTemplate = this.renderInput(selectedPeopleTemplate);\n    const flyoutTemplate = this.renderFlyout(inputTemplate);\n\n    return html`\n      <div>\n        ${flyoutTemplate}\n      </div>\n    `;\n  }\n\n  protected args(): unknown[] {\n    return [\n      this.providerState,\n      this.groupId,\n      this.groupIds,\n      this.type,\n      this.groupType,\n      this.userType,\n      this.transitiveSearch,\n      this.people,\n      this.showMax,\n      this.defaultSelectedUserIds,\n      this.defaultSelectedGroupIds,\n      this.userIds,\n      this.userFilters,\n      this.peopleFilters,\n      this.groupFilters\n    ];\n  }\n\n  /**\n   * Clears state of the component\n   *\n   * @protected\n   * @memberof MgtPeoplePicker\n   */\n  protected clearState(): void {\n    this.selectedPeople = [];\n    this.userInput = '';\n    this._highlightedUsers = [];\n    this._currentHighlightedUserPos = 0;\n  }\n\n  /**\n   * Render the input text box.\n   *\n   * @protected\n   * @returns {TemplateResult}\n   * @memberof MgtPeoplePicker\n   */\n  protected renderInput(selectedPeopleTemplate: TemplateResult): TemplateResult {\n    const placeholder = this.disabled ? '' : this.placeholder || this.strings.inputPlaceholderText;\n    const maxSelectionsAriaLabel = this.hasMaxSelections ? this.strings.maxSelectionsAriaLabel : '';\n\n    const searchIcon = html`<span class=\"search-icon\">${getSvg(SvgIcon.Search)}</span>`;\n    const startSlot = this.selectedPeople?.length > 0 ? selectedPeopleTemplate : searchIcon;\n    return html`\n      <fluent-text-field\n        autocomplete=\"off\"\n        appearance=\"outline\"\n        slot=\"anchor\"\n        id=\"people-picker-input\"\n        role=\"combobox\"\n        placeholder=${this.hasMaxSelections ? this.strings.maxSelectionsPlaceHolder : placeholder}\n        aria-label=${this.ariaLabel || maxSelectionsAriaLabel || placeholder || this.strings.selectContact}\n        aria-expanded=${this.flyout?.isOpen ?? false}\n        @click=\"${this.hasMaxSelections ? undefined : this.handleInputClick}\"\n        @focus=\"${this.hasMaxSelections ? undefined : this.gainedFocus}\"\n        @keydown=\"${this.hasMaxSelections ? undefined : this.onUserKeyDown}\"\n        @input=\"${this.hasMaxSelections ? undefined : this.onUserInput}\"\n        @blur=\"${this.lostFocus}\"\n        ?disabled=${this.disabled}\n      >\n        <span slot=\"start\">${startSlot}</span>\n      </fluent-text-field>\n    `;\n  }\n\n  /**\n   * Render the selected people tokens.\n   *\n   * @protected\n   * @returns {TemplateResult}\n   * @memberof MgtPeoplePicker\n   */\n  protected renderSelectedPeople(selectedPeople?: IDynamicPerson[]): TemplateResult {\n    if (!selectedPeople?.length) {\n      return html``;\n    }\n\n    return html`\n       <ul\n        id=\"selected-list\"\n        aria-label=\"${this.strings.selected}\"\n        class=\"selected-list\">\n          ${repeat(\n            selectedPeople,\n            person => person?.id,\n            person => html`\n            <li class=\"selected-list-item\">\n              ${\n                this.renderTemplate(\n                  'selected-person',\n                  { person },\n                  `selected-${person?.id ? person.id : person.displayName}`\n                ) || this.renderSelectedPerson(person)\n              }\n\n              <div\n                role=\"button\"\n                tabindex=\"0\"\n                class=\"selected-list-item-close-icon\"\n                aria-label=\"${this.strings.removeSelectedUser}${person?.displayName ?? ''}\"\n                @click=\"${(e: UIEvent) => this.removePerson(person, e)}\"\n                @keydown=\"${(e: KeyboardEvent) => this.handleRemovePersonKeyDown(person, e)}\">\n                  ${getSvg(SvgIcon.Close)}\n              </div>\n          </li>`\n          )}\n      </ul>`;\n  }\n  /**\n   * Render the flyout chrome.\n   *\n   * @protected\n   * @returns {TemplateResult}\n   * @memberof MgtPeoplePicker\n   */\n  protected renderFlyout(anchor: TemplateResult): TemplateResult {\n    return mgtHtml`\n       <mgt-flyout light-dismiss class=\"flyout\">\n         ${anchor}\n         <fluent-card\n          tabindex=\"0\"\n          slot=\"flyout\"\n          class=\"flyout-root\"\n          @wheel=${(e: WheelEvent) => this.handleSectionScroll(e)}\n          @keydown=${(e: KeyboardEvent) => this.onUserKeyDown(e)}\n          class=\"custom\">\n           ${this.renderFlyoutContent()}\n         </fluent-card>\n       </mgt-flyout>\n     `;\n  }\n\n  /**\n   * Render the appropriate state in the results flyout.\n   *\n   * @protected\n   * @returns {TemplateResult}\n   * @memberof MgtPeoplePicker\n   */\n  protected renderFlyoutContent(): TemplateResult {\n    if (this._task.status === TaskStatus.PENDING) {\n      return this.renderLoading();\n    }\n\n    const people = this._foundPeople;\n\n    if (!people || people.length === 0 || this.showMax === 0) {\n      return this.renderNoData();\n    } else {\n      return this.renderSearchResults(people);\n    }\n  }\n\n  /**\n   * Render the loading state.\n   *\n   * @protected\n   * @returns\n   * @memberof MgtPeoplePicker\n   */\n  protected renderLoading = (): TemplateResult => {\n    return (\n      this.renderTemplate('loading', null) ||\n      mgtHtml`\n         <div class=\"message-parent\">\n           <mgt-spinner></mgt-spinner>\n           <div aria-label=\"${this.strings.loadingMessage}\" class=\"loading-text\">\n             ${this.strings.loadingMessage}\n           </div>\n         </div>\n       `\n    );\n  };\n\n  /**\n   * Render the state when no results are found for the search query.\n   *\n   * @protected\n   * @returns {TemplateResult}\n   * @memberof MgtPeoplePicker\n   */\n  protected renderNoData(): TemplateResult {\n    if (!this._isFocused) {\n      return;\n    }\n    return (\n      this.renderTemplate('error', null) ||\n      this.renderTemplate('no-data', null) ||\n      html`\n         <div class=\"message-parent\">\n           <div aria-label=${this.strings.noResultsFound} class=\"search-error-text\">\n             ${this.strings.noResultsFound}\n           </div>\n         </div>\n       `\n    );\n  }\n\n  /**\n   * Render the list of search results.\n   *\n   * @protected\n   * @param {IDynamicPerson[]} people\n   * @returns\n   * @memberof MgtPeoplePicker\n   */\n  protected renderSearchResults(people: IDynamicPerson[]) {\n    const filteredPeople = people.filter(person => person.id);\n    return html`\n      <ul\n        id=\"suggestions-list\"\n        class=\"searched-people-list\"\n        role=\"listbox\"\n        aria-live=\"polite\"\n        title=${this.strings.suggestionsTitle}\n      >\n        ${repeat(\n          filteredPeople,\n          person => person.id,\n          person => html`\n          <li\n            id=\"${person.id}\"\n            class=\"searched-people-list-result\"\n            role=\"option\"\n            @click=\"${() => this.handleSuggestionClick(person)}\">\n              ${this.renderPersonResult(person)}\n          </li>\n        `\n        )}\n      </ul>\n     `;\n  }\n\n  /**\n   * Render an individual person search result.\n   *\n   * @protected\n   * @param {IDynamicPerson} person\n   * @returns {TemplateResult}\n   * @memberof MgtPeoplePicker\n   */\n  protected renderPersonResult(person: IDynamicPerson): TemplateResult {\n    return (\n      this.renderTemplate('person', { person }, person.id) ||\n      mgtHtml`\n         <mgt-person\n          class=\"person-image-result\"\n          ?show-presence=${this.showPresence}\n          view=\"twolines\"\n          line2-property=\"jobTitle,mail\"\n          .personDetails=${person}\n          ?fetch-image=${!this.disableImages}\n          person-card=\"none\"\n        ></mgt-person>`\n    );\n  }\n\n  /**\n   * Render an individual selected person token.\n   *\n   * @protected\n   * @param {IDynamicPerson} person\n   * @returns {TemplateResult}\n   * @memberof MgtPeoplePicker\n   */\n  protected renderSelectedPerson(person: IDynamicPerson): TemplateResult {\n    return mgtHtml`\n       <mgt-person\n         class=\"person-image-selected\"\n         .personDetails=${person}\n         ?fetch-image=${!this.disableImages}\n         view=\"oneline\"\n         person-card=${this.personCardInteraction}\n        ></mgt-person>\n     `;\n  }\n\n  /**\n   * Async query to Graph for members of group if determined by developer.\n   * set's `this.groupPeople` to those members.\n   */\n  protected async loadState(): Promise<void> {\n    this._groupPeople = null;\n    this._foundPeople = null;\n    this.defaultPeople = null;\n    let people = this.people;\n    const input = this.userInput.toLowerCase();\n    const provider = Providers.globalProvider;\n\n    if (people?.length) {\n      if (input) {\n        const displayNameMatch = people.filter(person => person?.displayName.toLowerCase().includes(input));\n        people = displayNameMatch;\n      }\n    } else if (!people && provider && provider.state === ProviderState.SignedIn) {\n      const graph = provider.graph.forComponent(this);\n\n      if (!input.length) {\n        if (this.defaultPeople) {\n          people = this.defaultPeople;\n        } else {\n          if (this.groupId || this.groupIds.length) {\n            if (this._groupPeople === null) {\n              if (this.groupId) {\n                try {\n                  if (this.type === 'group') {\n                    this._groupPeople = await findGroupMembers(\n                      graph,\n                      null,\n                      this.groupId,\n                      this.showMax,\n                      this.type,\n                      this.transitiveSearch\n                    );\n                  } else {\n                    this._groupPeople = await findGroupMembers(\n                      graph,\n                      null,\n                      this.groupId,\n                      this.showMax,\n                      this.type,\n                      this.transitiveSearch,\n                      this.userFilters,\n                      this.peopleFilters\n                    );\n                  }\n                } catch (_) {\n                  this._groupPeople = [];\n                }\n              } else {\n                if (this.type === 'group') {\n                  try {\n                    this._groupPeople = await getGroupsForGroupIds(graph, this.groupIds, this.groupFilters);\n                  } catch (_) {\n                    this._groupPeople = [];\n                  }\n                } else {\n                  try {\n                    const peopleInGroups = await findUsersFromGroupIds(\n                      graph,\n                      '',\n                      this.groupIds,\n                      this.showMax,\n                      this.type,\n                      this.transitiveSearch,\n                      this.userFilters\n                    );\n                    this._groupPeople = peopleInGroups;\n                  } catch (_) {\n                    this._groupPeople = [];\n                  }\n                }\n              }\n            }\n            people = this._groupPeople || [];\n          } else if (this.type === 'person' || this.type === 'any') {\n            if (this.userIds.length) {\n              people = await getUsersForUserIds(graph, this.userIds, '', this.userFilters);\n            } else {\n              const isUserOrContactType = this.userType === 'user' || this.userType === 'contact';\n              if (this.userFilters && isUserOrContactType) {\n                people = await getUsers(graph, this.userFilters, this.showMax);\n              } else {\n                people = await getPeople(graph, this.userType, this.peopleFilters, this.showMax);\n              }\n            }\n          } else if (this.type === 'group') {\n            let groups = (await findGroups(graph, '', this.showMax, this.groupType, this.groupFilters)) || [];\n            // eslint-disable-next-line @typescript-eslint/dot-notation\n            if (groups.length > 0 && groups[0]['value']) {\n              // eslint-disable-next-line @typescript-eslint/dot-notation, @typescript-eslint/no-unsafe-assignment\n              groups = groups[0]['value'];\n            }\n            people = groups;\n          }\n          this.defaultPeople = people;\n        }\n      }\n\n      if (\n        (this.defaultSelectedUserIds.length > 0 || this.defaultSelectedGroupIds.length > 0) &&\n        !this.selectedPeople.length &&\n        !this.defaultSelectedUsers.length &&\n        !this.defaultSelectedGroups.length\n      ) {\n        this.defaultSelectedUsers = await getUsersForUserIds(graph, this.defaultSelectedUserIds, '', this.userFilters);\n        this.defaultSelectedGroups = await getGroupsForGroupIds(\n          graph,\n          this.defaultSelectedGroupIds,\n          this.peopleFilters\n        );\n\n        this.defaultSelectedGroups = this.defaultSelectedGroups.filter(group => {\n          return group !== null;\n        });\n\n        this.defaultSelectedUsers = this.defaultSelectedUsers.filter(user => {\n          return user !== null;\n        });\n\n        this.selectedPeople = [...this.defaultSelectedUsers, ...this.defaultSelectedGroups];\n        this.requestUpdate();\n      }\n\n      if (input) {\n        people = [];\n\n        if (this.groupId) {\n          people =\n            (await findGroupMembers(\n              graph,\n              input,\n              this.groupId,\n              this.showMax,\n              this.type,\n              this.transitiveSearch,\n              this.userFilters,\n              this.peopleFilters\n            )) || [];\n        } else {\n          if (this.type === 'person' || this.type === 'any') {\n            try {\n              // Default UserType === any\n              if (this.userType === 'contact' || this.userType === 'user') {\n                // we might have a user-filters property set, search for users with it.\n                if (this.userIds?.length) {\n                  // has the user-ids property set\n                  people = await getUsersForUserIds(graph, this.userIds, input, this.userFilters);\n                } else {\n                  people = await findUsers(graph, input, this.showMax, this.userFilters);\n                }\n              } else {\n                if (!this.groupIds.length) {\n                  if (this.userIds?.length) {\n                    // has the user-ids property set\n                    people = await getUsersForUserIds(graph, this.userIds, input, this.userFilters);\n                  } else {\n                    people = (await findPeople(graph, input, this.showMax, this.userType, this.peopleFilters)) || [];\n                  }\n                } else {\n                  // Does not work when the PersonType = person.\n                  try {\n                    people = await findUsersFromGroupIds(\n                      graph,\n                      input,\n                      this.groupIds,\n                      this.showMax,\n                      this.type,\n                      this.transitiveSearch,\n                      this.userFilters\n                    );\n                  } catch (_) {\n                    // nop\n                  }\n                }\n              }\n            } catch (e) {\n              // nop\n            }\n\n            // Don't follow this path if a people-filters attribute is set on the component as the\n            // default type === PersonType.person\n            if (people && people.length < this.showMax && this.userType !== 'contact' && this.type !== 'person') {\n              try {\n                const users = (await findUsers(graph, input, this.showMax, this.userFilters)) || [];\n\n                // make sure only unique people\n                const peopleIds = new Set(people.map(p => p.id));\n                for (const user of users) {\n                  if (!peopleIds.has(user.id)) {\n                    people.push(user);\n                  }\n                }\n              } catch (e) {\n                // no-op\n              }\n            }\n          }\n\n          if ((this.type === 'group' || this.type === 'any') && people.length < this.showMax) {\n            if (this.groupIds.length) {\n              try {\n                people = await findGroupsFromGroupIds(\n                  graph,\n                  input,\n                  this.groupIds,\n                  this.showMax,\n                  this.groupType,\n                  this.userFilters\n                );\n              } catch (_) {\n                // no-op\n              }\n            } else {\n              let groups = [];\n              try {\n                groups = (await findGroups(graph, input, this.showMax, this.groupType, this.groupFilters)) || [];\n                people = people.concat(groups);\n              } catch (e) {\n                // nop\n              }\n            }\n          }\n        }\n      }\n    }\n    // people = this.getUniquePeople(people);\n    this._foundPeople = this.filterPeople(people);\n  }\n\n  /**\n   * Gets the Groups in a list of group IDs.\n   *\n   * @param graph the graph object\n   * @param people already found groups\n   * @returns groups found\n   */\n  private async getGroupsForGroupIds(graph: IGraph, people: IDynamicPerson[]) {\n    const groups = await getGroupsForGroupIds(graph, this.groupIds, this.groupFilters);\n    for (const group of groups as IDynamicPerson[]) {\n      people = people.concat(group);\n    }\n    people = people.filter(person => person);\n    return people;\n  }\n\n  /**\n   * Hide the results flyout.\n   *\n   * @protected\n   * @memberof MgtPeoplePicker\n   */\n  protected hideFlyout(): void {\n    const flyout = this.flyout;\n    if (flyout) {\n      flyout.close();\n    }\n    if (this.input) {\n      this.input.setAttribute('aria-activedescendant', '');\n    }\n    this._arrowSelectionCount = -1;\n  }\n\n  /**\n   * Show the results flyout.\n   *\n   * @protected\n   * @memberof MgtPeoplePicker\n   */\n  protected showFlyout(): void {\n    const flyout = this.flyout;\n    if (flyout) {\n      flyout.open();\n    }\n    this._arrowSelectionCount = -1;\n  }\n\n  /**\n   * Removes person from selected people\n   *\n   * @param person - person and details pertaining to user selected\n   */\n  protected removePerson(person: IDynamicPerson, e: UIEvent): void {\n    e.stopPropagation();\n    const filteredPersonArr = this.selectedPeople.filter(p => {\n      if (!person.id && p.displayName) {\n        return p.displayName !== person.displayName;\n      }\n      return p.id !== person.id;\n    });\n    if (this.hasMaxSelections) {\n      this.enableTextInput();\n    }\n    this.selectedPeople = filteredPersonArr;\n    void this.loadState();\n  }\n\n  /**\n   * Checks if key pressed is an `Enter` key before removing person\n   *\n   * @param person\n   * @param e\n   */\n  protected handleRemovePersonKeyDown(person: IDynamicPerson, e: KeyboardEvent): void {\n    if (e.key === 'Enter') {\n      this.removePerson(person, e);\n    }\n  }\n\n  /**\n   * Tracks when user selects person from picker\n   *\n   * @param person - contains details pertaining to selected user\n   * @param event - tracks user event\n   */\n  protected addPerson(person: IDynamicPerson): void {\n    if (person) {\n      setTimeout(() => {\n        this.clearInput();\n      }, 50);\n      const duplicatePeople = this.selectedPeople.filter(p => {\n        if (!person.id && p.displayName) {\n          return p.displayName === person.displayName;\n        }\n        return p.id === person.id;\n      });\n\n      if (duplicatePeople.length === 0) {\n        this.selectedPeople = [...this.selectedPeople, person];\n        void this.loadState();\n        this._foundPeople = [];\n        this._arrowSelectionCount = -1;\n      }\n    }\n  }\n\n  private clearInput() {\n    this.clearHighlighted();\n    if (this.selectionMode !== 'single') {\n      this.input.value = '';\n    }\n    this.userInput = '';\n  }\n\n  // handle input click\n  private readonly handleInputClick = () => {\n    if (!this.flyout.isOpen) {\n      this.handleUserSearch();\n    }\n  };\n\n  // handle input focus\n  private readonly gainedFocus = () => {\n    this.clearHighlighted();\n    this._isFocused = true;\n    void this.loadState();\n    this.showFlyout();\n  };\n\n  // handle input blur\n  private readonly lostFocus = () => {\n    this._isFocused = false;\n    if (this.input) {\n      this.input.setAttribute('aria-activedescendant', '');\n    }\n\n    const peopleList = this.renderRoot.querySelector('.people-list');\n\n    if (peopleList) {\n      for (const el of peopleList.children) {\n        el.classList.remove('focused');\n        el.setAttribute('aria-selected', 'false');\n      }\n    }\n\n    this.requestUpdate();\n  };\n\n  /**\n   * Handles input from the key up events on the keyboard.\n   */\n  private readonly onUserKeyUp = (event: KeyboardEvent): void => {\n    const keyName = event.key;\n    const isCmdOrCtrlKey = event.getModifierState('Control') || event.getModifierState('Meta');\n    const isPaste = isCmdOrCtrlKey && keyName === 'v';\n    const isArrowKey = ['ArrowDown', 'ArrowRight', 'ArrowUp', 'ArrowLeft'].includes(keyName);\n\n    if ((!isPaste && isCmdOrCtrlKey) || isArrowKey) {\n      if (isCmdOrCtrlKey || ['ArrowLeft', 'ArrowRight'].includes(keyName)) {\n        // Only hide the flyout when you're doing selections with Left/Right Arrow key\n        this.hideFlyout();\n      }\n\n      if (keyName === 'ArrowDown') {\n        if (!this.flyout.isOpen && this._isFocused) {\n          this.handleUserSearch();\n        }\n      }\n      return;\n    }\n\n    if (['Tab', 'Enter', 'Shift'].includes(keyName)) return;\n\n    if (keyName === 'Escape') {\n      this.clearInput();\n      this._foundPeople = [];\n      this._arrowSelectionCount = -1;\n      return;\n    }\n\n    if (keyName === 'Backspace' && this.userInput.length === 0 && this.selectedPeople.length > 0) {\n      this.clearHighlighted();\n      // remove last person in selected list\n      this.selectedPeople = this.selectedPeople.splice(0, this.selectedPeople.length - 1);\n      void this.loadState();\n      this.hideFlyout();\n      return;\n    }\n\n    if ([';', ','].includes(keyName)) {\n      if (this.allowAnyEmail) {\n        this._setAnyEmail = true;\n        event.preventDefault();\n        event.stopPropagation();\n      }\n      return;\n    }\n  };\n\n  private readonly onUserInput = (event: InputEvent) => {\n    const input = event.target as HTMLInputElement;\n    this.userInput = input.value;\n    if (this.userInput) {\n      const validEmail = isValidEmail(this.userInput);\n      if (validEmail && this.allowAnyEmail) {\n        if (this._setAnyEmail) {\n          this.handleAnyEmail();\n        }\n      } else {\n        this.handleUserSearch();\n      }\n      this._setAnyEmail = false;\n    }\n  };\n\n  private handleAnyEmail() {\n    this._arrowSelectionCount = -1;\n    if (isValidEmail(this.userInput)) {\n      const anyMailUser = {\n        mail: this.userInput,\n        displayName: this.userInput\n      };\n      this.addPerson(anyMailUser);\n    }\n    this.hideFlyout();\n    if (this.input) {\n      this.input.focus();\n      this._isFocused = true;\n    }\n  }\n\n  // handle suggestion list item click\n  private handleSuggestionClick(person: IDynamicPerson): void {\n    this.addPerson(person);\n    if (this.hasMaxSelections) {\n      this.disableTextInput();\n      this.input.value = '';\n    }\n    this.hideFlyout();\n  }\n\n  /**\n   * Tracks event on user input in search\n   *\n   * @param input - input text\n   */\n  private handleUserSearch() {\n    if (!this._debouncedSearch) {\n      this._debouncedSearch = debounce(async () => {\n        await this._task.run();\n        this._arrowSelectionCount = -1;\n        this.showFlyout();\n      }, 400);\n    }\n\n    this._debouncedSearch();\n  }\n\n  /**\n   * Tracks event on user search (keydown)\n   *\n   * @param event - event tracked on user input (keydown)\n   */\n  private readonly onUserKeyDown = (event: KeyboardEvent): void => {\n    event.stopPropagation();\n    const keyName = event.key;\n    const selectedList = this.renderRoot.querySelector('.selected-list');\n    const isCmdOrCtrlKey = event.getModifierState('Control') || event.getModifierState('Meta');\n    if (isCmdOrCtrlKey && selectedList) {\n      const selectedPeople = selectedList.querySelectorAll('mgt-person.person-image-selected');\n      this.hideFlyout();\n      if (isCmdOrCtrlKey && keyName === 'ArrowLeft') {\n        this._currentHighlightedUserPos =\n          (this._currentHighlightedUserPos - 1 + selectedPeople.length) % selectedPeople.length;\n        if (this._currentHighlightedUserPos >= 0 && !Number.isNaN(this._currentHighlightedUserPos)) {\n          this._highlightedUsers.push(selectedPeople[this._currentHighlightedUserPos]);\n        } else {\n          this._currentHighlightedUserPos = 0;\n        }\n      } else if (isCmdOrCtrlKey && keyName === 'ArrowRight') {\n        const person = this._highlightedUsers.pop();\n        if (person) {\n          const personParent = person.parentElement;\n          if (personParent) {\n            this.clearHighlighted(personParent);\n            this._currentHighlightedUserPos++;\n          }\n        }\n      } else if (isCmdOrCtrlKey && keyName === 'a') {\n        this._highlightedUsers = [];\n        selectedPeople.forEach(person => this._highlightedUsers.push(person));\n      }\n      if (this._highlightedUsers) {\n        this.highlightSelectedPeople(this._highlightedUsers);\n      }\n      return;\n    }\n\n    this.clearHighlighted();\n\n    if (!this.flyout.isOpen) {\n      return;\n    }\n\n    if (keyName === 'ArrowUp' || keyName === 'ArrowDown') {\n      this.handleArrowSelection(event);\n      event.preventDefault();\n    }\n\n    if (keyName === 'Enter') {\n      if (!event.shiftKey && this._foundPeople) {\n        event.preventDefault();\n\n        const foundPerson = this._foundPeople[this._arrowSelectionCount];\n        if (foundPerson) {\n          this.addPerson(foundPerson);\n          this.hideFlyout();\n          this.input.value = '';\n          if (this.hasMaxSelections) {\n            this.disableTextInput();\n          }\n          return;\n        }\n      }\n\n      if (this.allowAnyEmail) {\n        this.handleAnyEmail();\n      } else {\n        this.showFlyout();\n      }\n    }\n\n    if ([';', ',', 'Tab'].includes(keyName)) {\n      if (this.allowAnyEmail) {\n        // need to ensure the tab key does tab things\n        if ('Tab' !== keyName) event.preventDefault();\n        this.userInput = this.input.value;\n        this.handleAnyEmail();\n      }\n    }\n    // need to ensure that the tab key hides the flyout even if the input doesn't have an email address\n    if (keyName === 'Tab') {\n      this.hideFlyout();\n    }\n  };\n\n  /**\n   * Gets the text of the highlighed people and writes it to the clipboard\n   */\n  private async writeHighlightedText() {\n    const copyText = [];\n    for (const element of this._highlightedUsers) {\n      // eslint-disable-next-line @typescript-eslint/dot-notation\n      const { id, displayName, mail, userPrincipalName, scoredEmailAddresses } = element['_personDetails'] as Person &\n        User;\n      let emailAddress: string;\n      if (scoredEmailAddresses && scoredEmailAddresses.length > 0) {\n        emailAddress = scoredEmailAddresses.pop().address;\n      } else {\n        emailAddress = userPrincipalName || mail;\n      }\n\n      copyText.push({ id, displayName, email: emailAddress });\n    }\n    let copiedTextStr = '';\n    if (copyText.length > 0) {\n      copiedTextStr = JSON.stringify(copyText);\n    }\n\n    await navigator.clipboard.writeText(copiedTextStr);\n  }\n\n  /**\n   * Handles the cut event when it is fired\n   */\n  private readonly handleCut = () => {\n    this.writeHighlightedText().then(\n      () => {\n        this.removeHighlightedOnCut();\n      },\n      () => {\n        // intentionally left blank\n      }\n    );\n  };\n\n  /**\n   * Handles the copy event when it is fired\n   */\n  private readonly handleCopy = () => {\n    void this.writeHighlightedText();\n  };\n\n  /**\n   * Parses the copied people text and adds them when you paste\n   */\n  private readonly handlePaste = () => {\n    navigator.clipboard.readText().then(\n      copiedText => {\n        if (copiedText) {\n          try {\n            const people: IDynamicPerson[] = JSON.parse(copiedText) as IDynamicPerson[];\n            if (people && people.length > 0) {\n              for (const person of people) {\n                this.addPerson(person);\n              }\n            }\n          } catch (error) {\n            if (error instanceof SyntaxError) {\n              const delimiters = [',', ';'];\n              let listOfUsers: string[];\n              try {\n                for (const delimiter of delimiters) {\n                  listOfUsers = copiedText.split(delimiter);\n                  if (listOfUsers.length > 1) {\n                    this.hideFlyout();\n                    void this.selectUsersById(listOfUsers);\n                    break;\n                  }\n                }\n                // eslint-disable-next-line no-empty\n              } catch (_) {}\n            }\n          }\n        }\n      },\n      // eslint-disable-next-line @typescript-eslint/no-unused-vars\n      error => {\n        // 'navigator.clipboard.readText is not a function' error is thrown in Mozilla\n        // more information here https://developer.mozilla.org/en-US/docs/Web/API/Clipboard/readText#browser_compatibility\n        // Firefox only supports reading the clipboard in browser extensions,\n        // using the \"clipboardRead\" extension permission.\n      }\n    );\n  };\n\n  /**\n   * Removes only the highlighted elements from the peoplePicker during cut operations.\n   */\n  private removeHighlightedOnCut() {\n    this.selectedPeople = this.selectedPeople.splice(0, this.selectedPeople.length - this._highlightedUsers.length);\n    this._highlightedUsers = [];\n    this._currentHighlightedUserPos = 0;\n    void this.loadState();\n    this.hideFlyout();\n  }\n  /**\n   * Changes the color class to show which people are selected for copy/cut-paste\n   *\n   * @param people list of selected people classes\n   */\n  private highlightSelectedPeople(people: Element[]) {\n    for (const person of people) {\n      const parentElement = person?.parentElement;\n      parentElement.classList.add('highlighted');\n    }\n  }\n\n  /**\n   * Defaults the people class back to the normal view\n   */\n  private clearHighlighted(node?: Element) {\n    if (node) {\n      node.classList.remove('highlighted');\n    } else {\n      for (const person of this._highlightedUsers) {\n        const parentElement = person.parentElement;\n        if (parentElement) {\n          parentElement.classList.remove('highlighted');\n        }\n      }\n      this._highlightedUsers = [];\n      this._currentHighlightedUserPos = 0;\n    }\n  }\n\n  /**\n   * Tracks user key selection for arrow key selection of people\n   *\n   * @param event - tracks user key selection\n   */\n  private handleArrowSelection(event?: KeyboardEvent): void {\n    const peopleList = this.renderRoot.querySelector('.searched-people-list');\n\n    if (peopleList?.children?.length) {\n      if (event) {\n        // update arrow count\n        if (event.key === 'ArrowUp') {\n          if (this._arrowSelectionCount === -1) {\n            this._arrowSelectionCount = 0;\n          } else {\n            this._arrowSelectionCount =\n              (this._arrowSelectionCount - 1 + peopleList.children.length) % peopleList.children.length;\n          }\n        }\n        if (event.key === 'ArrowDown') {\n          if (this._arrowSelectionCount === -1) {\n            this._arrowSelectionCount = 0;\n          } else {\n            this._arrowSelectionCount =\n              (this._arrowSelectionCount + 1 + peopleList.children.length) % peopleList.children.length;\n          }\n        }\n      }\n\n      for (const person of peopleList?.children ?? []) {\n        const p = person as HTMLElement;\n        p.setAttribute('aria-selected', 'false');\n        p.blur();\n        p.removeAttribute('tabindex');\n      }\n\n      // set selected background\n      // set aria-selected to true\n      const focusedItem = peopleList.children[this._arrowSelectionCount] as HTMLElement;\n\n      if (focusedItem) {\n        focusedItem.setAttribute('tabindex', '0');\n        focusedItem.focus();\n        focusedItem.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'nearest' });\n        focusedItem.setAttribute('aria-selected', 'true');\n        this.input.setAttribute('aria-activedescendant', focusedItem?.id);\n      }\n    }\n  }\n\n  /**\n   * Filters people searched from already selected people\n   *\n   * @param people - array of people returned from query to Graph\n   */\n  private filterPeople(people: IDynamicPerson[]): IDynamicPerson[] {\n    // check if people need to be updated\n    // ensuring people list is displayed\n    // find ids from selected people\n    const uniquePeople: IDynamicPerson[] = [];\n    if (people && people.length > 0) {\n      people = people.filter(person => person);\n      const idFilter = this.selectedPeople.map(el => {\n        return el.id ? el.id : el.displayName;\n      });\n\n      // filter id's\n      const filtered = people.filter((person: IDynamicPerson) => {\n        if (person?.id) {\n          return idFilter.indexOf(person.id) === -1;\n        } else {\n          return idFilter.indexOf(person?.displayName) === -1;\n        }\n      });\n\n      // remove duplicates\n      const dupsSet = new Set<string>();\n      for (const d of filtered) {\n        const person = JSON.stringify(d);\n        dupsSet.add(person);\n      }\n\n      dupsSet.forEach((person: string) => {\n        const p: IDynamicPerson = JSON.parse(person) as IDynamicPerson;\n        uniquePeople.push(p);\n      });\n    }\n    return uniquePeople;\n  }\n\n  // stop propagating wheel event to flyout so mouse scrolling works\n  private handleSectionScroll(e: WheelEvent) {\n    const target = this.renderRoot.querySelector('.flyout-root');\n    if (target) {\n      if (\n        !(e.deltaY < 0 && target.scrollTop === 0) &&\n        !(e.deltaY > 0 && target.clientHeight + target.scrollTop >= target.scrollHeight - 1)\n      ) {\n        e.stopPropagation();\n      }\n    }\n  }\n}\n","// THIS FILE IS AUTO GENERATED\n// ANY CHANGES WILL BE LOST DURING BUILD\n// MODIFY THE .SCSS FILE INSTEAD\n\nimport { css, CSSResult } from 'lit';\n/**\n * exports lit-element css\n * @export styles\n */\nexport const styles: CSSResult[] = [\n  css`\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, \"Segoe UI\", \"Segoe UI Web (West European)\", \"Segoe UI\", -apple-system, \"BlinkMacSystemFont\", \"Roboto\", \"Helvetica Neue\", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:\"\\\\\\e70d\"}.ms-icon-chevron-up::before{content:\"\\\\\\e70e\"}.ms-icon-contact::before{content:\"\\\\\\e77b\"}.ms-icon-add-friend::before{content:\"\\\\\\e8fa\"}.ms-icon-outlook-logo-inverser::before{content:\"\\\\\\eb6d\"}:host .container{display:flex;flex-direction:column;position:relative}:host .dropdown{display:none;position:absolute;z-index:1000;top:34px}:host .dropdown.visible{display:flex}:host .dropdown .team-photo{width:24px;position:inherit;border-radius:50%;margin:0 6px}:host .dropdown .team-start-slot{width:max-content}:host .dropdown .team-parent-name{width:auto}:host .loading-text,:host .search-error-text{font-style:normal;font-weight:400;font-size:14px;line-height:20px}:host .message-parent{display:flex;flex-direction:row;gap:5px;padding:5px}:host .message-parent .loading-text{margin:auto}:host fluent-card{background:var(--channel-picker-dropdown-background-color,var(--fill-color));padding:2px;--card-height:auto;--width:var(--card-width)}:host fluent-text-field{width:100%}:host fluent-text-field::part(root){background:padding-box linear-gradient(var(--channel-picker-input-background-color,var(--neutral-fill-input-rest)),var(--channel-picker-input-background-color,var(--neutral-fill-input-rest))),border-box var(--channel-picker-input-border-color,var(--neutral-stroke-input-rest))}:host fluent-text-field::part(root):hover{background:padding-box linear-gradient(var(--channel-picker-input-background-color-hover,var(--neutral-fill-input-hover)),var(--channel-picker-input-background-color-hover,var(--neutral-fill-input-hover))),border-box var(--channel-picker-input-hover-border-color,var(--neutral-stroke-input-hover))}:host fluent-text-field::part(root):focus,:host fluent-text-field::part(root):focus-within{background:padding-box linear-gradient(var(--channel-picker-input-background-color-focus,var(--neutral-fill-input-focus)),var(--channel-picker-input-background-color-focus,var(--neutral-fill-input-focus))),border-box var(--channel-picker-input-focus-border-color,var(--neutral-stroke-input-focus))}:host fluent-text-field::part(control){word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host fluent-text-field::part(control)::placeholder{color:var(--channel-picker-input-placeholder-text-color,var(--input-placeholder-rest))}:host fluent-text-field::part(control):hover::placeholder{color:var(--channel-picker-input-placeholder-text-color-hover,var(--input-placeholder-hover))}:host fluent-text-field::part(control):focus-within::placeholder,:host fluent-text-field::part(control):focus::placeholder{color:var(--channel-picker-input-placeholder-text-color-focus,var(--input-placeholder-filled))}:host fluent-text-field .search-icon svg path{fill:var(--channel-picker-search-icon-color,currentColor)}:host fluent-text-field .down-chevron{height:auto;min-width:auto}:host fluent-text-field .down-chevron svg path{fill:var(--channel-picker-down-chevron-color,currentColor)}:host fluent-text-field .up-chevron{height:auto;min-width:auto}:host fluent-text-field .up-chevron svg path{fill:var(--channel-picker-up-chevron-color,currentColor)}:host fluent-text-field .close-icon{height:auto;min-width:auto}:host fluent-text-field .close-icon svg path{fill:var(--channel-picker-close-icon-color,currentColor)}:host fluent-tree-view{min-width:100%;--tree-item-nested-width:2em}:host fluent-tree-item{width:100%;--tree-item-nested-width:2em}:host fluent-tree-item:focus-visible{outline:0}:host fluent-tree-item::part(expand-collapse-button){background:0 0}:host fluent-tree-item::part(content-region),:host fluent-tree-item::part(positioning-region){color:var(--channel-picker-dropdown-item-text-color,currentColor);background:var(--channel-picker-dropdown-background-color,transparent);border:calc(var(--stroke-width) * 2px) solid transparent;height:auto}:host fluent-tree-item::part(content-region):hover,:host fluent-tree-item::part(positioning-region):hover{background:var(--channel-picker-dropdown-item-background-color-hover,var(--neutral-fill-stealth-hover))}:host fluent-tree-item::part(content-region):hover::part(expand-collapse-button),:host fluent-tree-item::part(positioning-region):hover::part(expand-collapse-button){background:var(--channel-picker-dropdown-item-background-color-hover,var(--neutral-fill-stealth-hover))}:host fluent-tree-item fluent-tree-item::part(content-region){height:auto}:host fluent-breadcrumb-item{color:var(--channel-picker-dropdown-item-text-color-selected,var(--neutral-foreground-rest))}:host fluent-breadcrumb-item .team-parent-name{font-weight:700}:host fluent-breadcrumb-item .team-photo{width:19px;position:inherit;border-radius:50%}:host fluent-breadcrumb-item .arrow{margin-left:8px;margin-right:8px}:host fluent-breadcrumb-item .arrow svg{stroke:var(--channel-picker-arrow-fill,var(--neutral-foreground-rest))}[dir=rtl] :host{--direction:rtl}[dir=rtl] .dropdown{text-align:right}[dir=rtl] .arrow{transform:scaleX(-1);filter:fliph;filter:FlipH;margin-right:0;margin-left:5px}[dir=rtl] .selected-team{padding-left:10px}[dir=rtl] .message-parent .loading-text{right:auto;left:10px;padding-right:8px;text-align:right}@media (forced-colors:active) and (prefers-color-scheme:dark){:host fluent-text-field svg{stroke:#fff!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host fluent-text-field svg{stroke:#000!important}}\n`];","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { IGraph, CacheService, CacheStore, prepScopes } from '@microsoft/mgt-element';\nimport { Team, Channel } from '@microsoft/microsoft-graph-types';\nimport {\n  getPhotoForResource,\n  CachePhoto,\n  getPhotoInvalidationTime,\n  getIsPhotosCacheEnabled\n} from '../../graph/graph.photos';\nimport { schemas } from '../../graph/cacheStores';\nimport { CollectionResponse } from '@microsoft/mgt-element';\nimport { DropdownItem } from './teams-channel-picker-types';\n\nconst teamReadScopes = [\n  'Team.ReadBasic.All',\n  'TeamSettings.Read.All',\n  'TeamSettings.ReadWrite.All',\n  'User.Read.All',\n  'User.ReadWrite.All'\n];\n\nconst channelReadScopes = ['Channel.ReadBasic.All', 'ChannelSettings.Read.All', 'ChannelSettings.ReadWrite.All'];\n\nconst teamPhotoReadScopes = ['Team.ReadBasic.All', 'TeamSettings.Read.All', 'TeamSettings.ReadWrite.All'];\n\n/**\n * async promise, returns all Teams associated with the user logged in\n *\n * @returns {Promise<Team[]>}\n * @memberof Graph\n */\nexport const getAllMyTeams = async (graph: IGraph): Promise<Team[]> => {\n  const scopes = teamReadScopes;\n  const teams = (await graph\n    .api('/me/joinedTeams')\n    .select(['displayName', 'id', 'isArchived'])\n    .middlewareOptions(prepScopes(scopes))\n    .get()) as CollectionResponse<Team>;\n\n  return teams?.value;\n};\n\n/** An object collection of cached photos. */\ntype CachePhotos = Record<string, CachePhoto>;\n\n/**\n * Load the photos for a give set of teamIds\n *\n * @param graph {IGraph}\n * @param teamIds {string[]}\n * @returns {Promise<CachePhotos>}\n */\nexport const getTeamsPhotosForPhotoIds = async (graph: IGraph, teamIds: string[]): Promise<CachePhotos> => {\n  let cache: CacheStore<CachePhoto>;\n  let photos: CachePhotos = {};\n\n  if (getIsPhotosCacheEnabled()) {\n    cache = CacheService.getCache<CachePhoto>(schemas.photos, schemas.photos.stores.teams);\n    for (const id of teamIds) {\n      try {\n        const photoDetail = await cache.getValue(id);\n        if (photoDetail && getPhotoInvalidationTime() > Date.now() - photoDetail.timeCached) {\n          photos[id] = photoDetail;\n        }\n      } catch (_) {\n        // no-op\n      }\n    }\n    if (Object.keys(photos).length) {\n      return photos;\n    }\n  }\n\n  photos = {};\n\n  for (const id of teamIds) {\n    try {\n      const photoDetail = await getPhotoForResource(graph, `/teams/${id}`, teamPhotoReadScopes);\n      if (getIsPhotosCacheEnabled() && photoDetail) {\n        await cache.putValue(id, photoDetail);\n      }\n      photos[id] = photoDetail;\n    } catch (_) {\n      // no-op\n    }\n  }\n\n  return photos;\n};\n\n/**\n * Creates an array of DropdownItems from an array of Teams populated with channels and photos\n *\n * @param graph {IGraph}\n * @param teams {Team[]} the teams to get channels for\n * @returns {Promise<DropdownItem[]>} a promise that resolves to an array of DropdownItems\n */\nexport const getChannelsForTeams = async (graph: IGraph, teams: Team[]): Promise<DropdownItem[]> => {\n  const batch = graph.createBatch<CollectionResponse<Channel>>();\n\n  for (const team of teams) {\n    batch.get(team.id, `teams/${team.id}/channels`, channelReadScopes);\n  }\n\n  const responses = await batch.executeAll();\n  const result: DropdownItem[] = [];\n  for (const team of teams) {\n    const channelsForTeam = responses.get(team.id);\n    // skip over any teams that don't have channels\n    if (!channelsForTeam?.content?.value?.length) continue;\n    result.push({\n      item: team,\n      channels: channelsForTeam.content.value.map(c => ({ item: c }))\n    });\n  }\n  return result;\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nexport const strings = {\n  inputPlaceholderText: 'Select a channel',\n  noResultsFound: \"We didn't find any matches.\",\n  loadingMessage: 'Loading...',\n  photoFor: 'Teams photo for',\n  teamsChannels: 'Teams and channels results',\n  closeButtonAriaLabel: 'remove the selected channel'\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport * as MicrosoftGraph from '@microsoft/microsoft-graph-types';\nimport { html, TemplateResult } from 'lit';\nimport { state } from 'lit/decorators.js';\nimport { classMap } from 'lit/directives/class-map.js';\nimport { TaskStatus } from '@lit/task';\nimport { Providers, ProviderState, MgtTemplatedTaskComponent, mgtHtml } from '@microsoft/mgt-element';\nimport '../../styles/style-helper';\nimport { getSvg, SvgIcon } from '../../utils/SvgHelper';\nimport { debounce } from '../../utils/Utils';\nimport { styles } from './mgt-teams-channel-picker-css';\nimport { getAllMyTeams, getChannelsForTeams, getTeamsPhotosForPhotoIds } from './mgt-teams-channel-picker.graph';\nimport { strings } from './strings';\nimport { repeat } from 'lit/directives/repeat.js';\nimport { registerFluentComponents } from '../../utils/FluentComponents';\nimport {\n  fluentBreadcrumb,\n  fluentBreadcrumbItem,\n  fluentTreeView,\n  fluentTreeItem,\n  fluentCard,\n  fluentTextField\n} from '@fluentui/web-components';\nimport { registerComponent } from '@microsoft/mgt-element';\nimport { registerMgtSpinnerComponent } from '../sub-components/mgt-spinner/mgt-spinner';\nimport { SelectedChannel, DropdownItem, ChannelPickerItemState } from './teams-channel-picker-types';\n\nexport const registerMgtTeamsChannelPickerComponent = () => {\n  registerFluentComponents(\n    fluentBreadcrumb,\n    fluentBreadcrumbItem,\n    fluentCard,\n    fluentTreeView,\n    fluentTreeItem,\n    fluentTextField\n  );\n  registerMgtSpinnerComponent();\n  registerComponent('teams-channel-picker', MgtTeamsChannelPicker);\n};\n\n/**\n * Web component used to select channels from a User's Microsoft Teams profile\n *\n *\n * @class MgtTeamsChannelPicker\n * @extends {MgtTemplatedTaskComponent}\n *\n * @fires {CustomEvent<SelectedChannel | null>} selectionChanged - Fired when the selection changes\n *\n * @cssprop --channel-picker-input-border-color - {Color} Input border color\n * @cssprop --channel-picker-input-background-color - {Color} Input section background color\n * @cssprop --channel-picker-input-background-color-hover - {Color} Input background hover color\n * @cssprop --channel-picker-input-background-color-focus - {Color} Input background focus color\n *\n * @cssprop --channel-picker-dropdown-background-color - {Color} Background color of dropdown area\n * @cssprop --channel-picker-dropdown-item-text-color - {Color} Text color of the dropdown text.\n * @cssprop --channel-picker-dropdown-item-background-color-hover - {Color} Background color of channel or team during hover\n * @cssprop --channel-picker-dropdown-item-text-color-selected - {Color} Text color of channel or team during after selection\n *\n * @cssprop --channel-picker-arrow-fill - {Color} Color of arrow svg\n * @cssprop --channel-picker-input-placeholder-text-color - {Color} Color of placeholder text\n * @cssprop --channel-picker-input-placeholder-text-color-focus - {Color} Color of placeholder text during focus state\n * @cssprop --channel-picker-input-placeholder-text-color-hover - {Color} Color of placeholder text during hover state\n *\n * @cssprop --channel-picker-search-icon-color - {Color} the search icon color.\n * @cssprop --channel-picker-down-chevron-color - {Color} the down chevron icon color.\n * @cssprop --channel-picker-up-chevron-color - {Color} the up chevron icon color.\n * @cssprop --channel-picker-close-icon-color - {Color} the close icon color.\n *\n */\nexport class MgtTeamsChannelPicker extends MgtTemplatedTaskComponent {\n  /**\n   * Array of styles to apply to the element. The styles should be defined\n   * user the `css` tag function.\n   */\n  static get styles() {\n    return styles;\n  }\n\n  /**\n   * Strings for localization\n   *\n   * @readonly\n   * @protected\n   * @memberof MgtTeamsChannelPicker\n   */\n  protected get strings() {\n    return strings;\n  }\n\n  private teamsPhotos = {};\n\n  /**\n   * Gets Selected item to be used\n   *\n   * @readonly\n   * @type {SelectedChannel}\n   * @memberof MgtTeamsChannelPicker\n   */\n  public get selectedItem(): SelectedChannel | null {\n    if (this._selectedItemState) {\n      return { channel: this._selectedItemState.item, team: this._selectedItemState.parent.item };\n    } else {\n      return null;\n    }\n  }\n\n  /**\n   * Get the scopes required for teams channel picker\n   *\n   * @static\n   * @return {*}  {string[]}\n   * @memberof MgtTeamsChannelPicker\n   */\n  public static get requiredScopes(): string[] {\n    return ['team.readbasic.all', 'channel.readbasic.all'];\n  }\n\n  private set items(value) {\n    if (this._items === value) {\n      return;\n    }\n    this._items = value;\n    this._treeViewState = value ? this.generateTreeViewState(value) : [];\n    this.resetFocusState();\n  }\n  private get items(): DropdownItem[] | undefined {\n    return this._items;\n  }\n\n  private get _inputWrapper(): HTMLInputElement | null {\n    return this.renderRoot.querySelector<HTMLInputElement>('fluent-text-field');\n  }\n  // User input in search\n  private get _input(): HTMLInputElement | null {\n    const wrapper = this._inputWrapper;\n    const input = wrapper?.shadowRoot.querySelector<HTMLInputElement>('input');\n    return input;\n  }\n  private _inputValue = '';\n\n  @state() private _selectedItemState: ChannelPickerItemState;\n  private _items: DropdownItem[] | undefined;\n  private _treeViewState: ChannelPickerItemState[] = [];\n  private _focusList: ChannelPickerItemState[] = [];\n\n  // focus state\n  private debouncedSearch: () => void;\n\n  // determines loading state\n  @state() private _isDropdownVisible: boolean;\n\n  constructor() {\n    super();\n    this._inputValue = '';\n    this._treeViewState = [];\n    this._focusList = [];\n    this._isDropdownVisible = false;\n  }\n\n  /**\n   * Invoked each time the custom element is appended into a document-connected element\n   *\n   * @memberof MgtTeamsChannelPicker\n   */\n  public connectedCallback() {\n    super.connectedCallback();\n    window.addEventListener('click', this.handleWindowClick);\n    this.addEventListener('focus', this.loadTeamsIfNotLoaded);\n    this.addEventListener('mouseover', this.loadTeamsIfNotLoaded);\n    this.addEventListener('blur', this.lostFocus);\n\n    const ownerDocument = this.renderRoot.ownerDocument;\n    if (ownerDocument) {\n      ownerDocument.documentElement.setAttribute('dir', this.direction);\n    }\n  }\n\n  /**\n   * Invoked each time the custom element is disconnected from the document's DOM\n   *\n   * @memberof MgtTeamsChannelPicker\n   */\n  public disconnectedCallback() {\n    window.removeEventListener('click', this.handleWindowClick);\n    this.removeEventListener('focus', this.loadTeamsIfNotLoaded);\n    this.removeEventListener('mouseover', this.loadTeamsIfNotLoaded);\n    this.removeEventListener('blur', this.lostFocus);\n    super.disconnectedCallback();\n  }\n\n  protected args(): unknown[] {\n    return [];\n  }\n\n  /**\n   * selects a channel by looking up the id in the Graph\n   *\n   * @param {string} channelId MicrosoftGraph.Channel.id\n   * @returns {Promise<return>} A promise that will resolve to true if channel was selected\n   * @memberof MgtTeamsChannelPicker\n   */\n  public async selectChannelById(channelId: string): Promise<boolean> {\n    const provider = Providers.globalProvider;\n    if (provider && provider.state === ProviderState.SignedIn) {\n      // since the component normally handles loading on hover, forces the load for items\n      if (!this.items) {\n        await this._task.run();\n      }\n\n      for (const item of this._treeViewState) {\n        for (const channel of item.channels) {\n          if (channel.item.id === channelId) {\n            item.isExpanded = true;\n            this.selectChannel(channel);\n            this.markSelectedChannelInDropdown(channelId);\n            return true;\n          }\n        }\n      }\n    }\n    return false;\n  }\n\n  /**\n   * Marks a channel selected by ID as selected in the dropdown menu.\n   * It ensures the parent team is set to as expanded to show the channel.\n   *\n   * @param channelId ID string of the selected channel\n   */\n  private markSelectedChannelInDropdown(channelId: string) {\n    const treeItem = this.renderRoot.querySelector(`[id='${channelId}']`);\n    if (treeItem) {\n      treeItem.setAttribute('selected', 'true');\n      if (treeItem.parentElement) {\n        treeItem.parentElement.setAttribute('expanded', 'true');\n      }\n    }\n  }\n\n  /**\n   * Called from the base class while the _task is in a pending state\n   * This calls to the renderContent method as the loading indicator is nested inside the dropdown\n   * This ensures that the component shows a control immediately and only shows a loading indicator\n   * if the user interacts with the component while the _task is pending.\n   */\n  protected renderLoading = () => this.renderContent();\n\n  /**\n   * Invoked by the render method when the _task has been completed\n   *\n   * @returns\n   * @memberof MgtTeamsChannelPicker\n   */\n  public renderContent = () => {\n    const dropdownClasses = {\n      dropdown: true,\n      visible: this._isDropdownVisible\n    };\n\n    return (\n      this.renderTemplate('default', { teams: this.items ?? [] }) ||\n      html`\n        <div class=\"container\" @blur=${this.lostFocus}>\n          <fluent-text-field\n            autocomplete=\"off\"\n            appearance=\"outline\"\n            id=\"teams-channel-picker-input\"\n            role=\"combobox\"\n            placeholder=\"${this._selectedItemState ? '' : this.strings.inputPlaceholderText} \"\n            aria-label=${this.strings.inputPlaceholderText}\n            aria-expanded=\"${this._isDropdownVisible}\"\n            label=\"teams-channel-picker-input\"\n            @focus=${this.handleFocus}\n            @keyup=${this.handleInputChanged}\n            @click=${this.handleInputClick}\n            @keydown=${this.handleInputKeydown}\n          >\n            <div tabindex=\"0\" slot=\"start\" style=\"width: max-content;\">${this.renderSelected()}</div>\n            <div tabindex=\"0\" slot=\"end\">${this.renderChevrons()}${this.renderCloseButton()}</div>\n          </fluent-text-field>\n          <fluent-card\n            class=${classMap(dropdownClasses)}\n          >\n            ${this.renderDropdown()}\n          </fluent-card>\n        </div>`\n    );\n  };\n\n  /**\n   * Handles clicks on the input section.\n   *\n   * @param e {UIEvent}\n   */\n  handleInputClick = (e: UIEvent) => {\n    e.stopPropagation();\n    this.gainedFocus();\n  };\n\n  handleInputKeydown = (e: KeyboardEvent) => {\n    const keyName = e.key;\n    if (['ArrowDown', 'Enter'].includes(keyName)) {\n      if (!this._isDropdownVisible) {\n        this.gainedFocus();\n      } else {\n        // focus on the first item on the list. Ideally, focus on the selected.\n        const firstTreeItem = this.renderRoot.querySelector<HTMLElement>('fluent-tree-item');\n        firstTreeItem.focus();\n      }\n    } else if (keyName === 'Escape') {\n      this.lostFocus();\n    }\n  };\n\n  /**\n   * Renders selected channel\n   *\n   * @protected\n   * @returns\n   * @memberof MgtTeamsChannelPicker\n   */\n  protected renderSelected() {\n    if (!this._selectedItemState) {\n      return this.renderSearchIcon();\n    }\n    let icon: TemplateResult;\n    if (this._selectedItemState.parent.channels) {\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access, @typescript-eslint/no-unsafe-assignment\n      const src = this.teamsPhotos[this._selectedItemState.parent.item.id]?.photo;\n      icon = html`<img\n        class=\"team-photo\"\n        alt=\"${this._selectedItemState.parent.item.displayName}\"\n        role=\"img\"\n        src=${src} />`;\n    }\n\n    const parentName = this._selectedItemState?.parent?.item?.displayName.trim();\n    const channelName = this._selectedItemState?.item?.displayName.trim();\n\n    return html`\n      <fluent-breadcrumb title=${this._selectedItemState.item.displayName}>\n        <fluent-breadcrumb-item>\n          <span slot=\"start\">${icon}</span>\n          <span class=\"team-parent-name\">${parentName}</span>\n          <span slot=\"separator\" class=\"arrow\">${getSvg(SvgIcon.TeamSeparator, '#000000')}</span>\n        </fluent-breadcrumb-item>\n        <fluent-breadcrumb-item>${channelName}</fluent-breadcrumb-item>\n      </fluent-breadcrumb>`;\n  }\n\n  /**\n   * Clears the state of the component\n   *\n   * @protected\n   * @memberof MgtTeamsChannelPicker\n   */\n  protected clearState(): void {\n    this._inputValue = '';\n    this._treeViewState = [];\n    this._focusList = [];\n    this._isDropdownVisible = false;\n  }\n\n  /**\n   * Renders search icon\n   *\n   * @protected\n   * @returns\n   * @memberof MgtTeamsChannelPicker\n   */\n  protected renderSearchIcon() {\n    return html`\n      <div class=\"search-icon\">\n        ${getSvg(SvgIcon.Search, '#252424')}\n      </div>\n    `;\n  }\n\n  /**\n   * Renders close button\n   *\n   * @protected\n   * @returns\n   * @memberof MgtTeamsChannelPicker\n   */\n  protected renderCloseButton() {\n    return html`\n      <fluent-button\n        appearance=\"stealth\"\n        class=\"close-icon\"\n        style=\"display:none\"\n        aria-label=${this.strings.closeButtonAriaLabel}\n        @click=${this.onClickCloseButton}\n        @keydown=${this.onKeydownCloseButton}>\n        <svg width=\"8\" height=\"8\" viewBox=\"0 0 8 8\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M0.0885911 0.215694L0.146447 0.146447C0.320013 -0.0271197 0.589437 -0.046405 0.784306 0.0885911L0.853553 0.146447L4 3.293L7.14645 0.146447C7.34171 -0.0488154 7.65829 -0.0488154 7.85355 0.146447C8.04882 0.341709 8.04882 0.658291 7.85355 0.853553L4.707 4L7.85355 7.14645C8.02712 7.32001 8.0464 7.58944 7.91141 7.78431L7.85355 7.85355C7.67999 8.02712 7.41056 8.0464 7.21569 7.91141L7.14645 7.85355L4 4.707L0.853553 7.85355C0.658291 8.04882 0.341709 8.04882 0.146447 7.85355C-0.0488154 7.65829 -0.0488154 7.34171 0.146447 7.14645L3.293 4L0.146447 0.853553C-0.0271197 0.679987 -0.046405 0.410563 0.0885911 0.215694L0.146447 0.146447L0.0885911 0.215694Z\" fill=\"#212121\"/>\n        </svg>\n      </fluent-button>\n    `;\n  }\n\n  /**\n   * Handles clicks on the close button after selecting a channel.\n   *\n   * @param e {UIEvent}\n   */\n  onClickCloseButton = () => {\n    this.removeSelectedChannel(null);\n  };\n\n  /**\n   * Handles keypresses on the close button.\n   *\n   * @param e {KeyboardEvent}\n   */\n  onKeydownCloseButton = (e: KeyboardEvent) => {\n    if (e.key === 'Enter') this.removeSelectedChannel(null);\n  };\n\n  /**\n   * Displays the close button after selecting a channel.\n   */\n  protected showCloseIcon() {\n    const downChevron = this.renderRoot.querySelector<HTMLElement>('.down-chevron');\n    const upChevron = this.renderRoot.querySelector<HTMLElement>('.up-chevron');\n    const closeIcon = this.renderRoot.querySelector<HTMLElement>('.close-icon');\n    if (downChevron) {\n      downChevron.style.display = 'none';\n    }\n    if (upChevron) {\n      upChevron.style.display = 'none';\n    }\n\n    if (closeIcon) {\n      closeIcon.style.display = null;\n    }\n  }\n\n  /**\n   * Renders down chevron icon\n   *\n   * @protected\n   * @returns\n   * @memberof MgtTeamsChannelPicker\n   */\n  protected renderDownChevron() {\n    return html`\n      <fluent-button appearance=\"stealth\" class=\"down-chevron\" @click=${this.gainedFocus}>\n        <svg width=\"12\" height=\"12\" viewBox=\"0 0 12 12\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M2.21967 4.46967C2.51256 4.17678 2.98744 4.17678 3.28033 4.46967L6 7.18934L8.71967 4.46967C9.01256 4.17678 9.48744 4.17678 9.78033 4.46967C10.0732 4.76256 10.0732 5.23744 9.78033 5.53033L6.53033 8.78033C6.23744 9.07322 5.76256 9.07322 5.46967 8.78033L2.21967 5.53033C1.92678 5.23744 1.92678 4.76256 2.21967 4.46967Z\" fill=\"#212121\" />\n        </svg>\n      </fluent-button>`;\n  }\n\n  /**\n   * Renders up chevron icon\n   *\n   * @protected\n   * @returns\n   * @memberof MgtTeamsChannelPicker\n   */\n  protected renderUpChevron() {\n    return html`\n      <fluent-button appearance=\"stealth\" style=\"display:none\" class=\"up-chevron\" @click=${this.handleUpChevronClick}>\n        <svg width=\"12\" height=\"12\" viewBox=\"0 0 12 12\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M2.21967 7.53033C2.51256 7.82322 2.98744 7.82322 3.28033 7.53033L6 4.81066L8.71967 7.53033C9.01256 7.82322 9.48744 7.82322 9.78033 7.53033C10.0732 7.23744 10.0732 6.76256 9.78033 6.46967L6.53033 3.21967C6.23744 2.92678 5.76256 2.92678 5.46967 3.21967L2.21967 6.46967C1.92678 6.76256 1.92678 7.23744 2.21967 7.53033Z\" fill=\"#212121\" />\n        </svg>\n      </fluent-button>`;\n  }\n\n  /**\n   * Renders both chevrons\n   */\n  private renderChevrons() {\n    return html`${this.renderUpChevron()}${this.renderDownChevron()}`;\n  }\n\n  /**\n   * Renders dropdown content\n   *\n   * @returns\n   * @memberof MgtTeamsChannelPicker\n   */\n  protected renderDropdown() {\n    if (this._task.status === TaskStatus.PENDING || !this._treeViewState) {\n      return this.renderLoadingIndicator();\n    }\n\n    if (this._treeViewState) {\n      if (this._treeViewState.length === 0 && this._inputValue.length > 0) {\n        return this.renderError();\n      }\n\n      return this.renderDropdownList(this._treeViewState);\n    }\n\n    return html``;\n  }\n\n  /**\n   * Renders the dropdown list recursively\n   *\n   * @protected\n   * @param {ChannelPickerItemState[]} items\n   * @returns\n   * @memberof MgtTeamsChannelPicker\n   */\n  protected renderDropdownList(items: ChannelPickerItemState[]) {\n    if (items && items.length > 0) {\n      let icon: TemplateResult = null;\n\n      return html`\n        <fluent-tree-view\n          class=\"tree-view\"\n          dir=${this.direction}\n          aria-live=\"polite\"\n          aria-relevant=\"all\"\n          aria-atomic=\"true\"\n          aria-label=${this.strings.teamsChannels}\n          aria-orientation=\"horizontal\"\n          @keydown=${this.onKeydownTreeView}>\n          ${repeat(\n            items,\n            (itemObj: ChannelPickerItemState) => itemObj?.item,\n            (obj: ChannelPickerItemState) => {\n              if (obj.channels) {\n                icon = html`<img\n                  class=\"team-photo\"\n                  alt=\"${this.strings.photoFor} ${obj.item.displayName}\"\n                  src=${// eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n                  this.teamsPhotos[obj.item.id]?.photo}\n                />`;\n              }\n              return html`\n                <fluent-tree-item\n                  ?expanded=${obj?.isExpanded}\n                  @click=${this.handleTeamTreeItemClick}>\n                    <span slot=\"start\">${icon}</span>${obj.item.displayName}\n                    ${repeat(\n                      obj?.channels,\n                      (channels: ChannelPickerItemState) => channels.item,\n                      (channel: ChannelPickerItemState) => {\n                        return this.renderItem(channel);\n                      }\n                    )}\n                </fluent-tree-item>`;\n            }\n          )}\n        </fluent-tree-view>`;\n    }\n    return null;\n  }\n\n  /**\n   * Renders each Channel or Team\n   *\n   * @param {ChannelPickerItemState} itemState\n   * @returns\n   * @memberof MgtTeamsChannelPicker\n   */\n  protected renderItem(itemState: ChannelPickerItemState) {\n    return html`\n      <fluent-tree-item\n        id=${itemState?.item?.id}\n        @keydown=${(e: KeyboardEvent) => this.onUserKeyDown(e, itemState)}\n        @click=${() => this.handleItemClick(itemState)}>\n          ${itemState?.item.displayName}\n      </fluent-tree-item>`;\n  }\n\n  /**\n   * Renders an error message when no channel or teams match the query\n   *\n   * @protected\n   * @returns\n   * @memberof MgtTeamsChannelPicker\n   */\n  protected renderError = (): TemplateResult => {\n    const template = this.renderTemplate('error', null, 'error');\n\n    return (\n      template ||\n      html`\n        <div class=\"message-parent\">\n          <div\n            label=\"search-error-text\"\n            aria-live=\"polite\"\n            aria-relevant=\"all\"\n            aria-atomic=\"true\"\n            class=\"search-error-text\"\n          >\n            ${this.strings.noResultsFound}\n          </div>\n        </div>\n      `\n    );\n  };\n\n  /**\n   * Renders loading spinner while channels are fetched from the Graph\n   *\n   * @protected\n   * @returns\n   * @memberof MgtTeamsChannelPicker\n   */\n  protected renderLoadingIndicator = (): TemplateResult => {\n    const template = this.renderTemplate('loading', null, 'loading');\n\n    return (\n      template ||\n      mgtHtml`\n        <div class=\"message-parent\">\n          <mgt-spinner></mgt-spinner>\n          <div label=\"loading-text\" aria-label=\"loading\" class=\"loading-text\">\n            ${this.strings.loadingMessage}\n          </div>\n        </div>\n      `\n    );\n  };\n\n  /**\n   * Queries Microsoft Graph for Teams & respective channels then sets to items list\n   *\n   * @protected\n   * @memberof MgtTeamsChannelPicker\n   */\n  protected async loadState() {\n    const provider = Providers.globalProvider;\n    let teams: MicrosoftGraph.Team[];\n    if (provider && provider.state === ProviderState.SignedIn) {\n      const graph = provider.graph.forComponent(this);\n\n      teams = await getAllMyTeams(graph);\n      teams = teams.filter(t => !t.isArchived);\n\n      const teamsIds = teams.map(t => t.id);\n      this.teamsPhotos = await getTeamsPhotosForPhotoIds(graph, teamsIds);\n\n      this._items = await getChannelsForTeams(graph, teams);\n    }\n    this.filterList();\n    this.resetFocusState();\n  }\n\n  /**\n   * Clears the selectedItem state.\n   *\n   * @memberof MgtTeamsChannelPicker\n   */\n  clearSelectedItem() {\n    this.removeSelectedChannel();\n  }\n\n  /**\n   * Handles operations that are performed on the DOM when you remove a\n   * channel. For example on clicking the X button.\n   *\n   * @param item a selected channel item\n   */\n  private removeSelectedChannel(item?: ChannelPickerItemState) {\n    this.selectChannel(item);\n    const treeItems = this.renderRoot.querySelectorAll('fluent-tree-item');\n    if (treeItems) {\n      treeItems.forEach((treeItem: HTMLElement) => {\n        treeItem.removeAttribute('expanded');\n        treeItem.removeAttribute('selected');\n      });\n    }\n  }\n\n  onKeydownTreeView = (e: KeyboardEvent) => {\n    const keyName = e.key;\n    if (keyName === 'Escape') {\n      this.lostFocus();\n    }\n  };\n\n  private handleItemClick(item: ChannelPickerItemState) {\n    if (item.channels) {\n      item.isExpanded = !item.isExpanded;\n    } else {\n      this.selectChannel(item);\n      this.lostFocus();\n    }\n  }\n\n  handleTeamTreeItemClick = (event: Event) => {\n    event.preventDefault();\n    event.stopImmediatePropagation();\n    const element = event.target as HTMLElement;\n    if (element) {\n      const expanded = element.getAttribute('expanded');\n\n      if (expanded) {\n        element.removeAttribute('expanded');\n      } else {\n        element.setAttribute('expanded', 'true');\n      }\n      element.removeAttribute('selected');\n      const hasId = element.getAttribute('id');\n      if (hasId) {\n        element.setAttribute('selected', 'true');\n      }\n    }\n  };\n\n  handleInputChanged = (e: KeyboardEvent) => {\n    const target = e.target as HTMLInputElement;\n    if (this._inputValue !== target?.value) {\n      this._inputValue = target?.value;\n    } else {\n      return;\n    }\n\n    // shows list\n    this.gainedFocus();\n\n    if (!this.debouncedSearch) {\n      this.debouncedSearch = debounce(() => {\n        this.filterList();\n      }, 400);\n    }\n\n    this.debouncedSearch();\n  };\n\n  private onUserKeyDown(e: KeyboardEvent, item?: ChannelPickerItemState) {\n    const key = e.code;\n    switch (key) {\n      case 'Enter':\n        this.selectChannel(item);\n        this.resetFocusState();\n        this.lostFocus();\n        e.preventDefault();\n        break;\n      case 'Backspace':\n        if (this._inputValue.length === 0 && this._selectedItemState) {\n          this.selectChannel(null);\n          this.resetFocusState();\n          e.preventDefault();\n        }\n        break;\n    }\n  }\n\n  private filterList() {\n    if (this.items) {\n      this._treeViewState = this.generateTreeViewState(this.items, this._inputValue);\n      this.resetFocusState();\n    }\n  }\n\n  private generateTreeViewState(\n    tree: DropdownItem[],\n    filterString = '',\n    parent: ChannelPickerItemState = null\n  ): ChannelPickerItemState[] {\n    const treeView: ChannelPickerItemState[] = [];\n    filterString = filterString.toLowerCase();\n\n    if (tree) {\n      for (const item of tree) {\n        let stateItem: ChannelPickerItemState;\n\n        if (filterString.length === 0 || item.item.displayName.toLowerCase().includes(filterString)) {\n          stateItem = { item: item.item, parent };\n          if (item.channels) {\n            stateItem.channels = this.generateTreeViewState(item.channels, '', stateItem);\n            stateItem.isExpanded = filterString.length > 0;\n          }\n        } else if (item.channels) {\n          const newStateItem = { item: item.item, parent };\n          const channels = this.generateTreeViewState(item.channels, filterString, newStateItem);\n          if (channels.length > 0) {\n            stateItem = newStateItem;\n            stateItem.channels = channels;\n            stateItem.isExpanded = true;\n          }\n        }\n\n        if (stateItem) {\n          treeView.push(stateItem);\n        }\n      }\n    }\n    return treeView;\n  }\n\n  // generates a flat list from a tree to facilitate easier focus\n  // navigation\n  private generateFocusList(items: ChannelPickerItemState[]): ChannelPickerItemState[] {\n    if (!items || items.length === 0) {\n      return [];\n    }\n\n    let array: ChannelPickerItemState[] = [];\n\n    for (const item of items) {\n      array.push(item);\n      if (item.channels && item.isExpanded) {\n        array = [...array, ...this.generateFocusList(item.channels)];\n      }\n    }\n\n    return array;\n  }\n\n  private resetFocusState() {\n    this._focusList = this.generateFocusList(this._treeViewState);\n    this.requestUpdate();\n  }\n\n  private readonly loadTeamsIfNotLoaded = () => {\n    if (!this.items && this._task.status !== TaskStatus.PENDING) {\n      void this._task.run();\n    }\n  };\n\n  private readonly handleWindowClick = (e: MouseEvent) => {\n    if (e.target !== this) {\n      this.lostFocus();\n    }\n  };\n\n  private readonly gainedFocus = () => {\n    const input = this._input;\n    if (input) {\n      input.focus();\n    }\n\n    this._isDropdownVisible = true;\n    this.toggleChevron();\n    this.resetFocusState();\n    this.requestUpdate();\n  };\n\n  private readonly lostFocus = () => {\n    this._inputValue = '';\n    if (this._input) {\n      this._input.value = this._inputValue;\n      this._input.textContent = '';\n    }\n    const wrapper = this._inputWrapper;\n    if (wrapper) wrapper.value = '';\n\n    this._isDropdownVisible = false;\n    this.filterList();\n    this.toggleChevron();\n    this.requestUpdate();\n\n    if (this._selectedItemState !== undefined) {\n      this.showCloseIcon();\n    }\n  };\n\n  handleFocus = () => {\n    this.lostFocus();\n    this.gainedFocus();\n  };\n\n  private selectChannel(item?: ChannelPickerItemState) {\n    if (item && this._selectedItemState !== item) {\n      this._input?.setAttribute('disabled', 'true');\n    } else {\n      this._input?.removeAttribute('disabled');\n    }\n    this._selectedItemState = item;\n    this.lostFocus();\n    this.fireCustomEvent('selectionChanged', this.selectedItem);\n  }\n\n  /**\n   * Hides the close icon.\n   */\n  private hideCloseIcon() {\n    const closeIcon = this.renderRoot.querySelector<HTMLElement>('.close-icon');\n    if (closeIcon) {\n      closeIcon.style.display = 'none';\n    }\n  }\n\n  /**\n   * Toggles the up and down chevron depending on the dropdown\n   * visibility.\n   */\n  private toggleChevron() {\n    const downChevron = this.renderRoot.querySelector<HTMLElement>('.down-chevron');\n    const upChevron = this.renderRoot.querySelector<HTMLElement>('.up-chevron');\n    if (this._isDropdownVisible) {\n      if (downChevron) {\n        downChevron.style.display = 'none';\n      }\n      if (upChevron) {\n        upChevron.style.display = null;\n      }\n    } else {\n      if (downChevron) {\n        downChevron.style.display = null;\n        this.hideCloseIcon();\n      }\n      if (upChevron) {\n        upChevron.style.display = 'none';\n      }\n    }\n    this.hideCloseIcon();\n  }\n\n  handleUpChevronClick = (e: Event) => {\n    e.stopPropagation();\n    this.lostFocus();\n  };\n}\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { TodoTaskList, TodoTask } from '@microsoft/microsoft-graph-types';\nimport { IGraph, prepScopes } from '@microsoft/mgt-element';\nimport { CollectionResponse } from '@microsoft/mgt-element';\n\nexport interface LinkedResource {\n  id: string;\n  webUrl: string;\n  applicationName: string;\n  displayName: string;\n  externalId: string;\n}\n\nconst writeTaskScopes = ['Tasks.ReadWrite'];\nconst readTaskScopes = ['Tasks.Read', 'Tasks.ReadWrite'];\n\n/**\n * Get all todo tasks for a specific task list.\n *\n * @export\n * @param {IGraph} graph\n * @param {string} listId\n * @returns {Promise<TodoTask[]>}\n */\nexport const getTodoTasks = async (graph: IGraph, listId: string): Promise<TodoTask[]> => {\n  const tasks = (await graph\n    .api(`/me/todo/lists/${listId}/tasks`)\n    .header('Cache-Control', 'no-store')\n    .middlewareOptions(prepScopes(readTaskScopes))\n    .get()) as CollectionResponse<TodoTask>;\n\n  return tasks?.value;\n};\n\n/**\n * Get a specific todo task.\n *\n * @export\n * @param {IGraph} graph\n * @param {string} listId\n * @param {string} taskId\n * @returns {Promise<TodoTask>}\n */\nexport const getTodoTask = async (graph: IGraph, listId: string, taskId: string): Promise<TodoTask> =>\n  (await graph\n    .api(`/me/todo/lists/${listId}/tasks/${taskId}`)\n    .header('Cache-Control', 'no-store')\n    .middlewareOptions(prepScopes(readTaskScopes))\n    .get()) as TodoTask;\n\n/**\n * get all todo task lists\n *\n * @export\n * @param {IGraph} graph\n * @returns {Promise<TodoTaskList[]>}\n */\nexport const getTodoTaskLists = async (graph: IGraph): Promise<TodoTaskList[]> => {\n  const taskLists = (await graph\n    .api('/me/todo/lists')\n    .header('Cache-Control', 'no-store')\n    .middlewareOptions(prepScopes(readTaskScopes))\n    .get()) as CollectionResponse<TodoTaskList>;\n\n  return taskLists?.value;\n};\n\n/**\n * Get a specific todo task list.\n *\n * @export\n * @param {IGraph} graph\n * @param {string} listId\n * @returns {Promise<TodoTaskList>}\n */\nexport const getTodoTaskList = async (graph: IGraph, listId: string): Promise<TodoTaskList> =>\n  (await graph\n    .api(`/me/todo/lists/${listId}`)\n    .header('Cache-Control', 'no-store')\n    .middlewareOptions(prepScopes(readTaskScopes))\n    .get()) as TodoTaskList;\n\n/**\n * Create a new todo task.\n *\n * @export\n * @param {IGraph} graph\n * @param {string} listId\n * @param {{ title: string; dueDateTime: { dateTime: string; timeZone: string } }} taskData\n * @returns {Promise<TodoTask>}\n */\nexport const createTodoTask = async (\n  graph: IGraph,\n  listId: string,\n  taskData: { title: string; dueDateTime?: { dateTime: string; timeZone: string } }\n): Promise<TodoTask> =>\n  (await graph\n    .api(`/me/todo/lists/${listId}/tasks`)\n    .header('Cache-Control', 'no-store')\n    .middlewareOptions(prepScopes(writeTaskScopes))\n    .post(taskData)) as TodoTask;\n\n/**\n * Create a new todo task list.\n *\n * @export\n * @param {IGraph} graph\n * @param {{ displayName: string }} list\n * @returns {Promise<TodoTaskList>}\n */\nexport const createTodoTaskList = async (graph: IGraph, listData: { displayName: string }): Promise<TodoTaskList> =>\n  (await graph\n    .api('/me/todo/lists')\n    .header('Cache-Control', 'no-store')\n    .middlewareOptions(prepScopes(writeTaskScopes))\n    .post(listData)) as TodoTaskList;\n\n/**\n * Delete a todo task.\n *\n * @export\n * @param {IGraph} graph\n * @param {string} listId\n * @param {string} taskId\n * @returns {Promise<void>}\n */\nexport const deleteTodoTask = async (graph: IGraph, listId: string, taskId: string): Promise<void> => {\n  await graph\n    .api(`/me/todo/lists/${listId}/tasks/${taskId}`)\n    .header('Cache-Control', 'no-store')\n    .middlewareOptions(prepScopes(writeTaskScopes))\n    .delete();\n};\n\n/**\n * Delete a todo task list.\n *\n * @export\n * @param {IGraph} graph\n * @param {string} listId\n * @returns {Promise<void>}\n */\nexport const deleteTodoTaskList = async (graph: IGraph, listId: string): Promise<void> => {\n  await graph\n    .api(`/me/todo/lists/${listId}`)\n    .header('Cache-Control', 'no-store')\n    .middlewareOptions(prepScopes(writeTaskScopes))\n    .delete();\n};\n\n/**\n * Update a todo task.\n *\n * @export\n * @param {IGraph} graph\n * @param {string} listId\n * @param {string} taskId\n * @param {TodoTask} taskData\n * @returns {Promise<TodoTask>}\n */\nexport const updateTodoTask = async (\n  graph: IGraph,\n  listId: string,\n  taskId: string,\n  taskData: TodoTask\n): Promise<TodoTask> =>\n  (await graph\n    .api(`/me/todo/lists/${listId}/tasks/${taskId}`)\n    .header('Cache-Control', 'no-store')\n    .middlewareOptions(prepScopes(writeTaskScopes))\n    .patch(taskData)) as TodoTask;\n\n/**\n * Update a todo task list.\n *\n * @export\n * @param {IGraph} graph\n * @param {string} listId\n * @param {TodoTaskList} taskListData\n * @returns {Promise<TodoTaskList>}\n */\nexport const updateTodoTaskList = async (\n  graph: IGraph,\n  listId: string,\n  taskListData: TodoTaskList\n): Promise<TodoTaskList> =>\n  (await graph\n    .api(`/me/todo/lists/${listId}`)\n    .header('Cache-Control', 'no-store')\n    .middlewareOptions(prepScopes(writeTaskScopes))\n    .patch(taskListData)) as TodoTaskList;\n","// THIS FILE IS AUTO GENERATED\n// ANY CHANGES WILL BE LOST DURING BUILD\n// MODIFY THE .SCSS FILE INSTEAD\n\nimport { css, CSSResult } from 'lit';\n/**\n * exports lit-element css\n * @export styles\n */\nexport const styles: CSSResult[] = [\n  css`\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, \"Segoe UI\", \"Segoe UI Web (West European)\", \"Segoe UI\", -apple-system, \"BlinkMacSystemFont\", \"Roboto\", \"Helvetica Neue\", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:\"\\\\\\e70d\"}.ms-icon-chevron-up::before{content:\"\\\\\\e70e\"}.ms-icon-contact::before{content:\"\\\\\\e77b\"}.ms-icon-add-friend::before{content:\"\\\\\\e8fa\"}.ms-icon-outlook-logo-inverser::before{content:\"\\\\\\eb6d\"}:host{display:flex;flex-direction:column;color:var(--color,var(--neutral-foreground-rest))}:host input[type=date]::-webkit-calendar-picker-indicator,:host input[type=date]::-webkit-inner-spin-button{display:none;appearance:none}:host .task-icon{font-family:FabricMDL2Icons;user-select:none}:host .task-icon.divider{vertical-align:initial;margin:0 12px;font-size:16px}:host .header{margin:var(--tasks-header-margin,0 0 12px 0);padding:var(--tasks-title-padding,0);display:flex;align-items:center;justify-content:space-between}:host .header .header__loading{max-width:90px;width:100%;height:20px;background:#f2f2f2}:host .header select{font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px);border:none;appearance:none;cursor:pointer}:host .header select::-ms-expand{display:none}:host .header .plan-title{font-size:var(--tasks-plan-title-font-size,1.1em);padding:var(--tasks-plan-title-padding,5px)}:host .header .add-bar{display:flex}:host .header .add-bar .add-bar-item{flex:1 1 auto}:host .header .new-task-due{display:flex}:host .header .new-task-due input{flex:1 1 auto;background-color:var(--task-background-color,var(--neutral-layer-floating))}:host .header .title-cont{flex:1 1 auto;display:flex;align-items:center;height:var(--tasks-new-button-height,34px)}:host .header .new-task-button{flex:0 0 auto;display:flex;justify-content:center;align-items:center;width:var(--tasks-new-button-width,auto);height:var(--tasks-new-button-height,32px);border-radius:2px;padding:0 20px;background:var(--tasks-new-button-background,#0078d4);border:var(--tasks-new-button-border,solid 1px transparent);color:var(--tasks-new-button-color,#fff);user-select:none;cursor:pointer}:host .header .new-task-button span{font-size:14px;font-weight:600;letter-spacing:.1px;line-height:14px}:host .header .new-task-button .task-icon{margin-right:8px}:host .header .new-task-button.hidden{visibility:hidden}:host .header .new-task-button:hover{background:var(--tasks-new-button-hover-background,#106ebe)}:host .header .new-task-button:active{background:var(--tasks-new-button-active-background,#005a9e)}:host .task{position:relative;margin:var(--task-margin,0 0 0 0);padding:var(--task-padding,0 0 0 0);background-color:var(--task-background-color,var(--neutral-layer-floating));border:var(--task-border,var(--neutral-stroke-input-active));border-radius:8px}:host .task .task-content{display:flex}:host .task .task-content .divider{position:absolute;height:2px;left:0;right:0;bottom:0;background-color:var(--task-background-color,var(--neutral-layer-floating))}:host .task .task-content .task-details-container{flex:1;display:grid;grid-template-columns:auto 1fr;-ms-grid-columns:auto 1fr;grid-template-rows:auto auto auto auto;-ms-grid-rows:auto auto auto auto;justify-content:space-between;align-items:flex-start;color:var(--task-detail-color,var(--neutral-foreground-hint));font-size:12px;font-weight:600;white-space:normal;margin-bottom:12px}:host .task .task-content .task-details-container .task-detail{width:100%;height:100%;margin:4px 24px 6px 0;display:flex;justify-content:flex-start;align-items:center}:host .task .task-content .task-details-container .task-title{color:var(--task-color,var(--neutral-foreground-rest));font-size:14px;font-weight:600;grid-row:1;grid-column:1/3;grid-column:1;-ms-grid-column-span:2;margin:22px 0 4px}:host .task .task-content .task-details-container .task-group{min-height:24px;grid-row:2;grid-column:1}:host .task .task-content .task-details-container .task-bucket{min-height:24px;grid-row:2;grid-column:2}:host .task .task-content .task-details-container .task-due{justify-content:flex-end;align-items:flex-start;grid-row:4;grid-column:1/3;grid-column:1;-ms-grid-column-span:2}:host .task .task-content .task-details-container.tablet{grid-template-columns:1fr .5fr 1fr .5fr;-ms-grid-columns:1fr .5fr 1fr .5fr;grid-template-rows:auto auto;-ms-grid-rows:auto auto}:host .task .task-content .task-details-container.tablet.no-plan{grid-template-columns:0 1fr 1fr 1fr;-ms-grid-columns:0 1fr 1fr 1fr}:host .task .task-content .task-details-container.tablet .task-detail{margin:4px 24px 6px 0}:host .task .task-content .task-details-container.tablet .task-title{grid-row:1;grid-column:1/5;grid-column:1;-ms-grid-column-span:4}:host .task .task-content .task-details-container.tablet .task-group{grid-row:2;grid-column:1}:host .task .task-content .task-details-container.tablet .task-bucket{grid-row:2;grid-column:2}:host .task .task-content .task-details-container.tablet .task-assignee{grid-row:2;grid-column:3}:host .task .task-content .task-details-container.tablet .task-due{justify-content:flex-start;align-items:center;grid-row:2;grid-column:4}:host .task .task-content .task-details-container.desktop{grid-template-columns:2fr 1fr .5fr 1fr .5fr;-ms-grid-columns:2fr 1fr .5fr 1fr .5fr;grid-template-rows:auto;-ms-grid-rows:auto;margin:0}:host .task .task-content .task-details-container.desktop.no-plan{grid-template-columns:2fr 0 1fr 1fr 1fr;-ms-grid-columns:2fr 0 1fr 1fr 1fr}:host .task .task-content .task-details-container.desktop .task-detail{margin:0 24px 0 0}:host .task .task-content .task-details-container.desktop .task-title{padding:0;grid-row:1;grid-column:1}:host .task .task-content .task-details-container.desktop .task-group{min-height:61px;grid-row:1;grid-column:2}:host .task .task-content .task-details-container.desktop .task-bucket{grid-row:1;grid-column:3}:host .task .task-content .task-details-container.desktop .task-assignee{grid-row:1;grid-column:4}:host .task .task-content .task-details-container.desktop .task-due{justify-content:flex-start;align-items:center;grid-row:1;grid-column:5}:host .task .task-content .task-details-container svg{vertical-align:middle;margin-right:4px}:host .task .task-content .task-details-container svg path{fill:var(--task-detail-color,var(--neutral-foreground-hint))}:host .task .task-content .task-details-container select,:host .task .task-content .task-details-container span{vertical-align:middle;color:var(--task-detail-color,var(--neutral-foreground-hint))}:host .task .task-content .task-details-container .task-icon{color:#797775;margin-right:8px}:host .task .task-content .task-details-container .people{color:var(--task-detail-color,var(--neutral-foreground-hint));font-size:16px}:host .task .task-content .task-details-container .person{display:inline-block}:host .task .task-content .task-details-container .picker{background-color:var(--task-background-color,var(--neutral-layer-floating));background-clip:padding-box;width:var(--mgt-flyout-set-width,350px);color:var(--task-detail-color,var(--neutral-foreground-hint))}:host .task .task-content .task-details-container .picker .people-picker{--separator-margin:0px 10px 0px 10px}:host .task .task-content .task-details-container input,:host .task .task-content .task-details-container select{color:var(--task-detail-color,var(--neutral-foreground-hint));font-size:.9em;background-color:var(--task-background-color,var(--neutral-layer-floating))}:host .task .task-check-container{font-family:FabricMDL2Icons;border-radius:50%;color:#fff;cursor:pointer;display:flex;align-items:var(--task-icon-alignment,flex-start);margin:21px 10px 20px 20px;user-select:none}:host .task .task-check-container.complete .task-check{background-color:var(--task-icon-background-completed,#00ad56);border:var(--task-icon-border-completed,solid 1px #fff);color:var(--task-icon-color-completed,#fff)}:host .task .task-check-container.complete .task-content .task-details-container .task-title{text-decoration:line-through;color:var(--task-detail-color,var(--neutral-foreground-hint))}:host .task .task-check-container .task-check{font-family:FabricMDL2Icons;font-size:12px;width:18px;height:18px;border-radius:var(--task-icon-border-radius,50%);border:var(--task-icon-border,solid 1px #797775);color:var(--task-color,var(--neutral-foreground-rest));display:flex;justify-content:center;align-items:center;background-color:var(--task-icon-background,transparent);user-select:none}:host .task .task-check-container .task-check.loading .task-check-content{animation:rotate-icon 2s infinite linear}:host .task .task-options{cursor:pointer;user-select:none;margin:16px 8px 0 0}:host .task.read-only .task-check-container{cursor:default}:host .task.complete{background:var(--task-complete-background,var(--neutral-layer-1));border:var(--task-complete-border,2px dotted inherit)}:host .task.complete .task-content .task-details-container .task-title{text-decoration:line-through;color:var(--task-detail-color,var(--neutral-foreground-hint))}:host .task.new-task{margin:var(--task-new-margin,var(--task-margin,0 0 24px 0));display:flex;flex-direction:row}:host .task.new-task .self-assign{display:none}:host .task.new-task .assign-to{border:0;background:0 0}:host .task.new-task .fake-check-box{width:15px;height:15px;cursor:pointer;margin:0 5px}:host .task.new-task .fake-check-box::after{font-family:FabricMDL2Icons;content:\"uE739\"}:host .task.new-task .fake-check-box~:checked{font-family:FabricMDL2Icons;content:\"uE73A\"}:host .task.new-task .task-content{flex:1 1 auto;align-content:center;vertical-align:middle;margin:0 0 0 12px}:host .task.new-task .task-content .task-details-container{display:flex;flex-direction:column;align-items:stretch;margin:0}:host .task.new-task .task-content .task-details-container .task-title{display:flex;height:32px;padding:2px}:host .task.new-task .task-content .task-details-container .task-title input{flex:1;margin:var(--task-new-input-margin,0 24px 0 16px);padding:var(--task-new-input-padding,6px);font-size:var(--task-new-input-font-size,14px);font-weight:600;border:var(--task-new-border,none);border-bottom:1px solid #e1dfdd;outline:0;border-radius:0;background-color:var(--task-background-color,var(--neutral-layer-floating))}:host .task.new-task .task-content .task-details-container .task-title input:hover{border-bottom:1px solid #106ebe}:host .task.new-task .task-content .task-details-container .task-title input:active{border-bottom:1px solid #005a9e}:host .task.new-task .task-content .task-details-container .task-title input:focus{border-bottom:1px solid #0078d4}:host .task.new-task .task-content .task-details-container .task-details{display:flex;justify-content:stretch;align-items:center;flex-wrap:wrap;margin:14px 0 14px 4px}:host .task.new-task .task-content .task-details-container .task-details .new-task-group{margin:8px 16px}:host .task.new-task .task-content .task-details-container .task-details .new-task-bucket{margin:8px 16px}:host .task.new-task .task-content .task-details-container .task-details .new-task-due{margin:8px 16px}:host .task.new-task .task-content .task-details-container .task-details .new-task-assignee{margin:8px 16px;min-width:80px}:host .task.new-task .task-content .task-details-container .task-details .task-people label{display:flex;align-content:center;align-items:center}:host .task.new-task .task-content .task-details-container .task-details input,:host .task.new-task .task-content .task-details-container .task-details select{font-size:12px;font-weight:600;border:var(--task-new-select-border,none);border-bottom:1px solid #e1dfdd}:host .task.new-task .task-content .task-details-container .task-details input:hover,:host .task.new-task .task-content .task-details-container .task-details select:hover{border-bottom:1px solid #106ebe}:host .task.new-task .task-content .task-details-container .task-details input:active,:host .task.new-task .task-content .task-details-container .task-details select:active{border-bottom:1px solid #005a9e}:host .task.new-task .task-content .task-details-container .task-details input:focus,:host .task.new-task .task-content .task-details-container .task-details select:focus{border-bottom:1px solid #0078d4}:host .task.new-task .task-add-button-container{margin-right:28px}:host .task.new-task .task-add-button-container .task-add,:host .task.new-task .task-add-button-container .task-cancel{justify-content:center;align-items:center;cursor:pointer;flex:0 0 auto;display:flex;width:var(--tasks-new-button-width,100px);height:var(--tasks-new-button-height,32px);border-radius:4px;border:var(--tasks-new-button-border,solid 1px #e5e5e5);font-size:14px;line-height:20px}:host .task.new-task .task-add-button-container .task-add{color:#fff;background:var(--task-new-add-button-background,#0078d4);margin:22px 0 12px auto}:host .task.new-task .task-add-button-container .task-cancel{color:var(--task-new-cancel-button-color,var(--neutral-foreground-rest))}:host .task.new-task .task-add-button-container.disabled .task-add{color:var(--task-new-cancel-button-color,var(--neutral-foreground-rest));background:var(--task-new-add-button-disabled-background,#fff);cursor:default}@keyframes rotate-icon{from{transform:rotate(0)}to{transform:rotate(360deg)}}[dir=rtl] .arrow-options{--arrow-options-left:auto}[dir=rtl] .dot-options{--dot-options-translatex:translateX(60px)}[dir=rtl] .task-details{margin-right:14px!important}[dir=rtl] .task-icon{margin-left:8px}[dir=rtl] .task-detail svg{margin-left:4px}@media (forced-colors:active) and (prefers-color-scheme:dark){:host svg{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}:host svg path{fill:#fff!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host svg{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}:host svg path{fill:#000!important;fill-rule:nonzero!important;clip-rule:nonzero!important}}:host{border-radius:8px;width:100%}:host .task,:host.loading-task{margin-block:1px;box-shadow:var(--task-box-shadow,var(--elevation-shadow-card-active));width:100%;display:flex;background-color:var(--task-background-color,var(--neutral-layer-floating))}:host .task.new-task,:host.loading-task.new-task{margin:14px 0 1px;box-shadow:var(--task-box-shadow,var(--elevation-shadow-card-active))}:host .task.complete,:host.loading-task.complete{border:1px solid var(--task-border-completed,var(--neutral-stroke-input-active));background:var(--task-complete-background,var(--neutral-layer-1))}:host .task.complete .task-details .task-due,:host .task.complete .task-details .title,:host.loading-task.complete .task-details .task-due,:host.loading-task.complete .task-details .title{text-decoration:line-through}:host .task.read-only,:host.loading-task.read-only{opacity:1}:host .task:hover,:host.loading-task:hover{background-color:var(--task-background-color-hover,var(--neutral-fill-hover));border-radius:8px}:host .task .task-details,:host.loading-task .task-details{box-sizing:border-box;display:flex;flex-direction:row;align-items:center;padding:2px;line-height:24px;border-radius:4px;width:100%}:host .task .task-details .task>div,:host.loading-task .task-details .task>div{display:flex;align-items:center;width:200px}:host .task .task-details .task-delete,:host.loading-task .task-details .task-delete{display:flex}:host .task .task-details .container,:host.loading-task .task-details .container{display:flex;width:100%}:host .task .task-details .task-due,:host.loading-task .task-details .task-due{min-width:120px;margin-inline-end:12px;height:32px;text-decoration:inherit;display:flex}:host fluent-text-field::part(end),:host fluent-text-field::part(start){margin-inline:unset}:host fluent-text-field::part(control){padding:0;cursor:pointer}:host fluent-text-field::part(root){background:0 0}:host fluent-text-field.new-task{width:100%;height:34px}:host fluent-text-field.new-task div.start .add-icon{display:flex;margin-inline:10px}:host fluent-text-field.new-task div:nth-child(2){display:flex;align-items:center}:host fluent-text-field.new-task div:nth-child(2) .calendar{display:flex;align-items:center}:host fluent-text-field.new-task div:nth-child(2) .calendar svg{fill:var(--task-color,var(--neutral-foreground-rest))}:host fluent-text-field.new-task div:nth-child(2) .calendar .date{margin-inline-start:10px;color:var(--task-color,var(--neutral-foreground-rest));width:auto;cursor:pointer}:host fluent-text-field.new-task div:nth-child(2) .calendar input{flex:1;border:none;border-bottom:1px solid var(--task-color,var(--neutral-foreground-rest));outline:0;border-radius:0}:host fluent-text-field.new-task div:nth-child(2) .calendar input:hover{border-bottom:1px solid var(--task-date-input-hover-color,var(--neutral-layer-1))}:host fluent-text-field.new-task div:nth-child(2) .calendar input:active,:host fluent-text-field.new-task div:nth-child(2) .calendar input:focus{border-bottom:1px solid var(--task-date-input-active-color,var(--accent-fill-rest))}:host fluent-text-field.title{flex-grow:1;display:inline}:host fluent-text-field.date{color:var(--task-detail-color,var(--neutral-foreground-hint))}:host fluent-text-field::after{border-bottom:none}:host fluent-text-field.dark::part(control){color-scheme:dark}:host fluent-button.task-add-icon.neutral,:host fluent-button.task-cancel-icon.neutral,:host fluent-button.task-delete.neutral{fill:var(--task-color,var(--neutral-foreground-rest))}:host fluent-button.task-add-icon.neutral::part(control),:host fluent-button.task-cancel-icon.neutral::part(control),:host fluent-button.task-delete.neutral::part(control){border:none;background:inherit}:host fluent-button.task-add-icon.neutral::part(control) svg,:host fluent-button.task-cancel-icon.neutral::part(control) svg,:host fluent-button.task-delete.neutral::part(control) svg{fill:var(--task-color,var(--neutral-foreground-rest))}:host fluent-checkbox.complete div>svg .filled{display:block}:host fluent-checkbox.complete div>svg .regular{display:none}:host fluent-checkbox.complete div>svg path{fill:var(--task-radio-background-color,var(--accent-fill-rest))}:host fluent-checkbox div>svg .filled{display:none}:host fluent-checkbox div>svg .regular{display:block}:host fluent-checkbox div>svg path{fill:var(--task-background-color,var(--neutral-layer-floating))}:host fluent-checkbox::part(control){margin-inline-start:10px;background:0 0;border-radius:50%}:host fluent-checkbox::part(label){margin-inline-end:unset;width:100%}\n`];","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nexport const strings = {\n  cancelNewTaskSubtitle: 'Cancel',\n  newTaskPlaceholder: 'Add a task',\n  newTaskLabel: 'New Task Input',\n  editTaskLabel: 'Edit Task Input',\n  addTaskButtonSubtitle: 'Add',\n  deleteTaskOption: 'Delete',\n  editTaskOption: 'Edit',\n  dueDate: 'Due date',\n  newTaskDateInputLabel: 'New Task Date Input',\n  changeTaskDateInputLabel: 'Change Task Date Input',\n  newTaskNameInputLabel: 'New Task Name Input',\n  cancelAddingTask: 'Cancel adding a new task'\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\nexport const strings = {\n  cancelNewTaskSubtitle: 'Cancel',\n  newTaskPlaceholder: 'Add a task',\n  addTaskButtonSubtitle: 'Add',\n  removeTaskSubtitle: 'Delete Task'\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { html, TemplateResult } from 'lit';\nimport { property } from 'lit/decorators.js';\nimport { ComponentMediaQuery, Providers, ProviderState, MgtTemplatedTaskComponent } from '@microsoft/mgt-element';\nimport { strings } from './strings';\nimport { registerFluentComponents } from '../../utils/FluentComponents';\nimport { fluentTextField, fluentButton, fluentCalendar } from '@fluentui/web-components';\nimport { TodoTask } from '@microsoft/microsoft-graph-types';\n/**\n * The foundation for creating task based components.\n *\n * @export\n * @class MgtTasksBase\n * @extends {MgtTemplatedComponent}\n */\nexport abstract class MgtTasksBase extends MgtTemplatedTaskComponent {\n  /**\n   * determines if tasks are un-editable\n   *\n   * @type {boolean}\n   */\n  @property({ attribute: 'read-only', type: Boolean })\n  public readOnly: boolean;\n\n  /**\n   * sets whether the header is rendered\n   *\n   * @type {boolean}\n   * @memberof MgtTasksBase\n   */\n  @property({ attribute: 'hide-header', type: Boolean })\n  public hideHeader: boolean;\n\n  /**\n   * sets whether the options are rendered\n   *\n   * @type {boolean}\n   * @memberof MgtTasksBase\n   */\n  @property({ attribute: 'hide-options', type: Boolean })\n  public hideOptions: boolean;\n\n  /**\n   * if set, the component will only show tasks from the target list\n   *\n   * @type {string}\n   */\n  @property({ attribute: 'target-id', type: String })\n  public targetId: string;\n\n  /**\n   * if set, the component will first show tasks from this list\n   *\n   * @type {string}\n   * @memberof MgtTodo\n   */\n  @property({ attribute: 'initial-id', type: String })\n  public initialId: string;\n\n  private _previousMediaQuery: ComponentMediaQuery;\n\n  protected get strings(): Record<string, string> {\n    return strings;\n  }\n\n  constructor() {\n    super();\n\n    registerFluentComponents(fluentTextField, fluentButton, fluentCalendar);\n\n    this.clearState();\n    this._previousMediaQuery = this.mediaQuery;\n  }\n\n  protected args(): unknown[] {\n    return [this.providerState, this.targetId, this.initialId];\n  }\n\n  /**\n   * updates provider state\n   *\n   * @memberof MgtTasksBase\n   */\n  public connectedCallback() {\n    super.connectedCallback();\n    window.addEventListener('resize', this.onResize);\n  }\n\n  /**\n   * removes updates on provider state\n   *\n   * @memberof MgtTasksBase\n   */\n  public disconnectedCallback() {\n    window.removeEventListener('resize', this.onResize);\n    super.disconnectedCallback();\n  }\n\n  /**\n   * Render the loading state\n   *\n   * @protected\n   * @returns {TemplateResult}\n   * @memberof MgtTasksBase\n   */\n  protected renderLoading = (): TemplateResult => {\n    return this.renderLoadingTask();\n  };\n\n  /**\n   * Invoked by render when the task is in a completed state\n   */\n  protected renderContent = () => {\n    const provider = Providers.globalProvider;\n    if (!provider || provider.state !== ProviderState.SignedIn) {\n      return html``;\n    }\n\n    const picker = this.renderPicker();\n    const newTaskTemplate = this.renderNewTask();\n    const tasksTemplate = this.renderTasks();\n\n    return html`\n      ${picker}\n      ${newTaskTemplate}\n      <div class=\"tasks\" dir=${this.direction}>\n        ${tasksTemplate}\n      </div>\n    `;\n  };\n\n  /**\n   * Render a task in a loading state.\n   *\n   * @protected\n   * @returns\n   * @memberof MgtTodo\n   */\n  protected renderLoadingTask() {\n    return html`\n      <div class=\"task loading-task\">\n        <div class=\"task-details\">\n          <div class=\"title\"></div>\n          <div class=\"task-due\"></div>\n          <div class=\"task-delete\"></div>\n        </div>\n      </div>\n    `;\n  }\n\n  /**\n   * Render the panel for creating a new task.\n   *\n   * @protected\n   * @memberof MgtTasksBase\n   */\n  protected abstract renderNewTask(): TemplateResult;\n\n  /**\n   * Render the generic picker.\n   *\n   * @protected\n   * @memberof MgtTasksBase\n   */\n  protected abstract renderPicker(): TemplateResult;\n\n  /**\n   * Render the list of todo tasks\n   *\n   * @protected\n   * @abstract\n   * @param {ITask[]} tasks\n   * @returns {TemplateResult}\n   * @memberof MgtTasksBase\n   */\n  protected abstract renderTasks(): TemplateResult;\n\n  /**\n   * Make a service call to create the new task object.\n   *\n   * @protected\n   * @abstract\n   * @memberof MgtTasksBase\n   */\n  protected abstract createNewTask(): Promise<void>;\n\n  /**\n   * Clear the form data from the new task panel.\n   *\n   * @protected\n   * @memberof MgtTasksBase\n   */\n  protected abstract clearNewTaskData(): void;\n\n  /**\n   * Clear the component state.\n   *\n   * @protected\n   * @memberof MgtTasksBase\n   */\n  protected clearState(): void {\n    this.requestUpdate();\n  }\n\n  /**\n   * Handle when a task is clicked\n   *\n   * @protected\n   * @param {Event} e\n   * @param {TodoTask} task\n   * @memberof MgtTasksBase\n   */\n  protected handleTaskClick = (task: TodoTask): void => {\n    this.fireCustomEvent('taskClick', { task });\n  };\n\n  /**\n   * Convert a date to a properly formatted string\n   *\n   * @protected\n   * @param {Date} date\n   * @returns\n   * @memberof MgtTasksBase\n   */\n  protected dateToInputValue(date: Date): string {\n    if (date) {\n      return new Date(date.getTime() - date.getTimezoneOffset() * 60000).toISOString().split('T')[0];\n    }\n\n    return null;\n  }\n\n  private readonly onResize = () => {\n    if (this.mediaQuery !== this._previousMediaQuery) {\n      this._previousMediaQuery = this.mediaQuery;\n      this.requestUpdate();\n    }\n  };\n}\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { html, nothing, TemplateResult } from 'lit';\nimport { state } from 'lit/decorators.js';\nimport { classMap } from 'lit/directives/class-map.js';\nimport { ifDefined } from 'lit/directives/if-defined.js';\nimport { repeat } from 'lit/directives/repeat.js';\nimport { fluentCheckbox, fluentRadioGroup, fluentButton } from '@fluentui/web-components';\nimport { IGraph, mgtHtml, registerComponent, Providers, ProviderState } from '@microsoft/mgt-element';\nimport { TodoTaskList, TodoTask, TaskStatus } from '@microsoft/microsoft-graph-types';\nimport {\n  createTodoTask,\n  deleteTodoTask,\n  getTodoTaskList,\n  getTodoTaskLists,\n  getTodoTasks,\n  updateTodoTask\n} from './graph.todo';\nimport { styles } from './mgt-todo-css';\nimport { strings } from './strings';\nimport { registerMgtPickerComponent } from '../mgt-picker/mgt-picker';\nimport { MgtTasksBase } from '../mgt-tasks-base/mgt-tasks-base';\nimport { registerFluentComponents } from '../../utils/FluentComponents';\nimport { isElementDark } from '../../utils/isDark';\nimport { getSvg, SvgIcon } from '../../utils/SvgHelper';\n\n/**\n * Filter function\n */\nexport type TodoFilter = (task: TodoTask) => boolean;\n\nexport const registerMgtTodoComponent = () => {\n  registerFluentComponents(fluentCheckbox, fluentRadioGroup, fluentButton);\n  registerMgtPickerComponent();\n  registerComponent('todo', MgtTodo);\n};\n\n/**\n * component enables the user to view, add, remove, complete, or edit todo tasks. It works with tasks in Microsoft Planner or Microsoft To-Do.\n *\n * @export\n * @class MgtTodo\n * @extends {MgtTasksBase}\n *\n * @cssprop --task-color - {Color} - Task text color\n * @cssprop --task-background-color - {Color} - Task background color\n * @cssprop --task-complete-background - {Color} - Task background color when completed\n * @cssprop --task-date-input-active-color - {Color} - Task date input active color\n * @cssprop --task-date-input-hover-color - {Color} - Task date input hover color\n * @cssprop --task-background-color-hover - {Color} - Task background when hovered\n * @cssprop --task-box-shadow - {Color} - Task box shadow color\n * @cssprop --task-border-completed - {Color} - Task border color when completed\n * @cssprop --task-radio-background-color - {Color} - Task radio background color\n */\nexport class MgtTodo extends MgtTasksBase {\n  /**\n   * Array of styles to apply to the element. The styles should be defined\n   * using the `css` tag function.\n   */\n  public static get styles() {\n    return styles;\n  }\n  /**\n   * Strings for localization\n   *\n   * @readonly\n   * @protected\n   * @memberof MgtTodo\n   */\n  protected get strings() {\n    return strings;\n  }\n\n  /**\n   * Optional filter function when rendering tasks\n   *\n   * @type {TodoFilter}\n   * @memberof MgtTodo\n   */\n  public taskFilter: TodoFilter;\n\n  /**\n   * Get the scopes required for todo\n   *\n   * @static\n   * @return {*}  {string[]}\n   * @memberof MgtTodo\n   */\n  public static get requiredScopes(): string[] {\n    return ['tasks.read', 'tasks.readwrite'];\n  }\n  @state() private _tasks: TodoTask[];\n  @state() private _taskBeingUpdated: TodoTask;\n  @state() private _updatingTaskDate: boolean;\n  @state() private _isChangedDueDate = false;\n\n  @state() private _newTaskDueDate: Date;\n  @state() private _newTaskName: string;\n  @state() private _changedTaskName: string;\n  @state() private _isNewTaskBeingAdded: boolean;\n  @state() private _graph: IGraph;\n  @state() private currentList: TodoTaskList;\n  @state() private _isDarkMode = false;\n\n  constructor() {\n    super();\n    this._graph = null;\n    this._newTaskDueDate = null;\n    this._tasks = [];\n    this.addEventListener('selectionChanged', this.handleSelectionChanged);\n    this.addEventListener('blur', this.handleBlur);\n  }\n\n  /**\n   * updates provider state\n   *\n   * @memberof MgtTodo\n   */\n  public connectedCallback() {\n    super.connectedCallback();\n    window.addEventListener('darkmodechanged', this.onThemeChanged);\n    // invoked to ensure we have the correct initial value for _isDarkMode\n    this.onThemeChanged();\n  }\n\n  /**\n   * removes updates on provider state\n   *\n   * @memberof MgtTodo\n   */\n  public disconnectedCallback() {\n    window.removeEventListener('darkmodechanged', this.onThemeChanged);\n    super.disconnectedCallback();\n  }\n\n  private readonly onThemeChanged = () => {\n    this._isDarkMode = isElementDark(this);\n  };\n\n  /**\n   * Render the list of todo tasks\n   */\n  protected renderTasks(): TemplateResult {\n    let tasks = this._tasks;\n    if (tasks && this.taskFilter) {\n      tasks = tasks.filter(task => this.taskFilter(task));\n    }\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n    const completedTasks = tasks.filter(task => task.status === 'completed');\n\n    const taskTemplates = repeat(\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n      tasks.filter(task => task.status !== 'completed'),\n      task => task.id,\n      task => this.renderTask(task)\n    );\n\n    const completedTaskTemplates = repeat(\n      completedTasks\n        .sort((a, b) => {\n          return a.lastModifiedDateTime < b.lastModifiedDateTime ? -1 : 1;\n        })\n        .filter(task => task.status === 'completed'),\n      task => task.id,\n      task => this.renderTask(task)\n    );\n    return html`\n      ${taskTemplates}\n      ${completedTaskTemplates}\n    `;\n  }\n\n  /**\n   * Render the generic picker or the task list displayName.\n   *\n   */\n  protected renderPicker() {\n    if (this.targetId) {\n      return html`<p>${this.currentList?.displayName}</p>`;\n    } else {\n      return mgtHtml`\n        <mgt-picker\n          resource=\"me/todo/lists\"\n          scopes=\"tasks.read, tasks.readwrite\"\n          key-name=\"displayName\"\n          selected-value=\"${ifDefined(this.currentList?.displayName)}\"\n          placeholder=\"Select a task list\">\n        </mgt-picker>`;\n    }\n  }\n\n  /**\n   * Render the panel for creating a new task\n   *\n   * @protected\n   * @returns {TemplateResult}\n   * @memberof MgtTodo\n   */\n  protected renderNewTask = (): TemplateResult => {\n    const addIcon = this._newTaskName\n      ? html`\n        <fluent-checkbox\n          class=\"task-add-icon\"\n          @click=\"${this.addTask}\">\n        </fluent-checkbox>\n      `\n      : html`\n        <span class=\"add-icon\">${getSvg(SvgIcon.Add)}</span>\n      `;\n\n    const cancelIcon = html`\n      <fluent-button\n        aria-label=${this.strings.cancelAddingTask}\n        class=\"task-cancel-icon\" \n        @click=\"${this.clearNewTaskData}\"\n      >\n        ${getSvg(SvgIcon.Cancel)}\n      </fluent-button>\n    `;\n    const dateClass = { dark: this._isDarkMode, date: true };\n    const calendarTemplate = html`\n      <fluent-text-field\n        autocomplete=\"off\"\n        type=\"date\"\n        id=\"new-taskDate-input\"\n        class=\"${classMap(dateClass)}\"\n        aria-label=\"${this.strings.newTaskDateInputLabel}\"\n        .value=\"${this.dateToInputValue(this._newTaskDueDate)}\"\n        @change=\"${this.handleDateChange}\"\n      >\n      </fluent-text-field>\n    `;\n\n    const newTaskDetails = this.readOnly\n      ? nothing\n      : html`\n      <fluent-text-field\n        autocomplete=\"off\"\n        appearance=\"outline\"\n        class=\"new-task\"\n        id=\"new-task-name-input\"\n        aria-label=\"${this.strings.newTaskLabel}\"\n        .value=${this._newTaskName}\n        placeholder=\"${this.strings.newTaskPlaceholder}\"\n        @keydown=\"${this.handleKeyDown}\"\n        @input=\"${this.handleInput}\"\n      >\n        <div slot=\"start\" class=\"start\">${addIcon}</div>\n        ${\n          this._newTaskName\n            ? html`\n              <div slot=\"end\" class=\"end\">\n                <span class=\"calendar\">${calendarTemplate}</span>\n                ${cancelIcon}\n              </div> `\n            : html``\n        }\n      </fluent-text-field>\n    `;\n    return html`\n      ${\n        this.currentList\n          ? html`\n            <div dir=${this.direction} class=\"task new-task incomplete\">\n              ${newTaskDetails}\n            </div>\n        `\n          : html``\n      }  \n     `;\n  };\n\n  /**\n   * Handle a change in taskList.\n   *\n   * @protected\n   * @param {CustomEvent} e\n   * @returns {TemplateResult}\n   * @memberof MgtTodo\n   */\n\n  protected handleSelectionChanged = (e: CustomEvent<TodoTaskList>) => {\n    this.currentList = e.detail;\n    void this.loadTasks(this.currentList);\n  };\n\n  /**\n   * Render task details.\n   *\n   * @protected\n   * @param {TodoTask} task\n   * @returns {TemplateResult}\n   * @memberof MgtTodo\n   */\n  protected renderTaskDetails = (task: TodoTask) => {\n    const context = { task, list: this.currentList };\n\n    if (this.hasTemplate('task')) {\n      return this.renderTemplate('task', context, task.id);\n    }\n\n    let taskDetailsTemplate = null;\n\n    const taskDeleteTemplate = html`\n      <fluent-button class=\"task-delete\"\n        @click=\"${() => this.removeTask(task.id)}\"\n        aria-label=\"${this.strings.deleteTaskOption}\">\n        ${getSvg(SvgIcon.Delete)}\n      </fluent-button>`;\n\n    if (this.hasTemplate('task-details')) {\n      taskDetailsTemplate = this.renderTemplate('task-details', context, `task-details-${task.id}`);\n    } else {\n      const dateClass = { dark: this._isDarkMode, date: true, 'task-due': true };\n      const calendarTemplate = html`\n        <fluent-text-field\n          autocomplete=\"off\"\n          type=\"date\"\n          id=\"${task.id}-taskDate-input\"\n          class=\"${classMap(dateClass)}\"\n          aria-label=\"${this.strings.changeTaskDateInputLabel}\"\n          .value=\"${\n            task.dueDateTime\n              ? this.dateToInputValue(new Date(task.dueDateTime.dateTime))\n              : this._taskBeingUpdated === task\n              ? this.dateToInputValue(this._newTaskDueDate)\n              : nothing\n          }\"\n          @change=\"${this.handleDateUpdate}\"\n          @focus=\"${(e: KeyboardEvent) => this.updatingTask(e, task)}\"\n          @blur=\"${this.handleBlur}\"\n        >\n        </fluent-text-field>\n      `;\n      const changeTaskDetailsTemplate = html`\n          <fluent-text-field \n            autocomplete=\"off\"\n            appearance=\"outline\"\n            class=\"title\"\n            id=${task.id}\n            .value=\"${task.title ? task.title : this._taskBeingUpdated === task ? this._changedTaskName : ''}\"\n            aria-label=\"${this.strings.editTaskLabel}\"\n            @keydown=\"${(e: KeyboardEvent) => this.handleChange(e, task)}\"\n            @input=\"${(e: KeyboardEvent) => this.handleChange(e, task)}\"\n            @focus=\"${(e: KeyboardEvent) => this.updatingTask(e, task)}\"\n          >\n          </fluent-text-field>\n          ${task.dueDateTime || this._taskBeingUpdated === task ? html`${calendarTemplate}` : nothing}\n          ${taskDeleteTemplate}\n      `;\n\n      taskDetailsTemplate = html`\n      <div class=\"task-details\">\n        ${changeTaskDetailsTemplate}\n      </div>\n      `;\n    }\n\n    return html`${taskDetailsTemplate}`;\n  };\n\n  /**\n   * Render a task in the list.\n   *\n   * @protected\n   * @param {TodoTask} task\n   * @returns {TemplateResult}\n   * @memberof MgtTodo\n   */\n  protected renderTask = (task: TodoTask) => {\n    const isCompleted = task.status === 'completed';\n\n    const taskClasses = classMap({\n      complete: isCompleted,\n      'read-only': this.readOnly,\n      task: true\n    });\n\n    const checkboxClasses = classMap({\n      complete: isCompleted\n    });\n\n    const taskCheckContent = html`${getSvg(SvgIcon.CheckMark)}`;\n\n    return html`\n      <div class=${taskClasses} @blur=\"${this.handleBlur}\">\n        <fluent-checkbox \n          id=${task.id} \n          class=${checkboxClasses}\n          ?checked=${isCompleted}\n          @click=\"${() => this.handleTaskCheckClick(task)}\"\n          @keydown=\"${(e: KeyboardEvent) => this.handleTaskCheckKeydown(e, task)}\"\n        >\n          <div slot=\"checked-indicator\">\n            ${taskCheckContent}\n          </div>\n        </fluent-checkbox>\n        ${this.renderTaskDetails(task)}\n      </div>\n    `;\n  };\n\n  /**\n   * loads tasks from dataSource\n   *\n   * @returns {Promise<void>}\n   * @memberof MgtTodo\n   */\n  protected loadState = async (): Promise<void> => {\n    const provider = Providers.globalProvider;\n    if (!provider || provider.state !== ProviderState.SignedIn) {\n      return;\n    }\n\n    if (!this._graph) {\n      const graph = provider.graph.forComponent(this);\n      this._graph = graph;\n    }\n\n    if (!this.currentList && !this.initialId) {\n      const lists = await getTodoTaskLists(this._graph);\n      const defaultList = lists?.find(l => l.wellknownListName === 'defaultList');\n      if (defaultList) await this.loadTasks(defaultList);\n    }\n\n    if (this.targetId) {\n      // Call to get the displayName of the list\n      this.currentList = await getTodoTaskList(this._graph, this.targetId);\n      this._tasks = await getTodoTasks(this._graph, this.targetId);\n    } else if (this.initialId) {\n      // Call to get the displayName of the list\n      this.currentList = await getTodoTaskList(this._graph, this.initialId);\n      this._tasks = await getTodoTasks(this._graph, this.initialId);\n    }\n  };\n\n  /**\n   * Send a request the Graph to create a new todo task item\n   *\n   * @protected\n   * @returns {Promise<void>}\n   * @memberof MgtTodo\n   */\n  protected async createNewTask(): Promise<void> {\n    const listId = this.currentList.id;\n    const taskData = {\n      title: this._newTaskName\n    };\n\n    if (this._newTaskDueDate) {\n      // eslint-disable-next-line @typescript-eslint/dot-notation\n      taskData['dueDateTime'] = {\n        dateTime: new Date(this._newTaskDueDate).toLocaleDateString(),\n        timeZone: 'UTC'\n      };\n    }\n\n    const task = await createTodoTask(this._graph, listId, taskData);\n    this._tasks.unshift(task);\n  }\n\n  /**\n   * Create a new todo task and add it to the list\n   *\n   * @protected\n   * @returns {Promise<void>}\n   * @memberof MgtTodo\n   */\n  protected addTask = async (): Promise<void> => {\n    if (this._isNewTaskBeingAdded || !this._newTaskName) {\n      return;\n    }\n\n    this._isNewTaskBeingAdded = true;\n\n    try {\n      await this.createNewTask();\n    } finally {\n      this.clearNewTaskData();\n      this._isNewTaskBeingAdded = false;\n    }\n  };\n\n  /**\n   *Update a todo task in the todo list\n   * @protected\n   * @returns {Promise<void>}\n   * @memberof MgtTodo\n   */\n  protected updateTask = async (task: TodoTask): Promise<void> => {\n    try {\n      if (!this._changedTaskName && !this._isChangedDueDate) {\n        return;\n      }\n      await this.updateTaskItem(task);\n    } finally {\n      this.clearNewTaskData();\n    }\n  };\n\n  /**\n   * Send a request the Graph to update a todo task item\n   *\n   * @protected\n   * @returns {Promise<void>}\n   * @memberof MgtTodo\n   */\n  protected async updateTaskItem(task: TodoTask): Promise<void> {\n    const listId = this.currentList.id;\n    let taskData: TodoTask = {};\n\n    if (this._changedTaskName && this._changedTaskName !== task.title) {\n      taskData = {\n        title: this._changedTaskName\n      };\n    }\n\n    if (this._updatingTaskDate) {\n      if (!this._isChangedDueDate) {\n        return;\n      }\n      if (this._newTaskDueDate) {\n        taskData.dueDateTime = {\n          dateTime: new Date(this._newTaskDueDate).toLocaleDateString(),\n          timeZone: 'UTC'\n        };\n      } else if (this._isChangedDueDate && !this._newTaskDueDate) {\n        taskData.dueDateTime = null;\n      } else {\n        taskData.dueDateTime = null;\n      }\n    }\n\n    if (!Object.keys(taskData).length) {\n      return;\n    }\n    const updatedTask = await updateTodoTask(this._graph, listId, task.id, taskData);\n    const taskIndex = this._tasks.findIndex(t => t.id === updatedTask.id);\n    this._tasks[taskIndex] = updatedTask;\n  }\n\n  /**\n   * Clear out the new task metadata input fields\n   *\n   * @protected\n   * @memberof MgtTodo\n   */\n  protected clearNewTaskData = (): void => {\n    this._newTaskDueDate = null;\n    this._newTaskName = '';\n    this._changedTaskName = '';\n    this._isChangedDueDate = false;\n    this.focusOnTaskInput();\n  };\n\n  protected focusOnTaskInput = (): void => {\n    const taskInputWrapper = this.renderRoot.querySelector<HTMLInputElement>('#new-task-name-input');\n    const input = taskInputWrapper?.shadowRoot.querySelector<HTMLInputElement>('input');\n    if (input) {\n      input.focus();\n    }\n  };\n\n  /**\n   * Clear the state of the component\n   *\n   * @protected\n   * @memberof MgtTodo\n   */\n  protected clearState = (): void => {\n    super.clearState();\n    this.currentList = null;\n    this._tasks = [];\n    this._taskBeingUpdated = null;\n  };\n\n  private readonly loadTasks = async (list: TodoTaskList): Promise<void> => {\n    this.currentList = list;\n\n    this._tasks = await getTodoTasks(this._graph, list.id);\n  };\n\n  private readonly updateTaskStatus = async (task: TodoTask, taskStatus: TaskStatus): Promise<void> => {\n    // Change the task status\n    task.status = taskStatus;\n\n    // Send update request\n    const listId = this.currentList.id;\n    task = await updateTodoTask(this._graph, listId, task.id, task);\n\n    const taskIndex = this._tasks.findIndex(t => t.id === task.id);\n    this._tasks[taskIndex] = task;\n    await this._task.run();\n  };\n\n  private readonly removeTask = async (taskId: string): Promise<void> => {\n    this._tasks = this._tasks.filter(t => t.id !== taskId);\n    this.requestUpdate();\n\n    const listId = this.currentList.id;\n    await deleteTodoTask(this._graph, listId, taskId);\n\n    this._tasks = this._tasks.filter(t => t.id !== taskId);\n  };\n\n  private handleTaskCheckClick(task: TodoTask) {\n    this.handleTaskClick(task);\n    if (!this.readOnly) {\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n      if (task.status === 'completed') {\n        void this.updateTaskStatus(task, 'notStarted');\n      } else {\n        void this.updateTaskStatus(task, 'completed');\n      }\n    }\n  }\n\n  private handleTaskCheckKeydown(e: KeyboardEvent, task: TodoTask) {\n    if (e.key === 'Enter' && !this.readOnly) {\n      this.handleTaskClick(task);\n      if (task.status === 'completed') {\n        void this.updateTaskStatus(task, 'notStarted');\n      } else {\n        void this.updateTaskStatus(task, 'completed');\n      }\n    }\n  }\n\n  private readonly handleInput = (e: MouseEvent) => {\n    if ((e.target as HTMLInputElement).id === 'new-task-name-input') {\n      this._newTaskName = (e.target as HTMLInputElement).value;\n    }\n  };\n\n  private readonly handleChange = async (e: KeyboardEvent, task: TodoTask) => {\n    if ((e.target as HTMLInputElement).id === task.id) {\n      if (e.key === 'Enter') {\n        await this.updateTask(task);\n        (e.target as HTMLInputElement)?.blur();\n      }\n      this._changedTaskName = (e.target as HTMLInputElement).value;\n    }\n  };\n\n  private readonly handleKeyDown = async (e: KeyboardEvent) => {\n    if (e.key === 'Enter' && (e.target as HTMLInputElement).id === 'new-task-name-input') {\n      await this.addTask();\n    }\n  };\n\n  private readonly updatingTask = (e: KeyboardEvent, task: TodoTask) => {\n    if ((e.target as HTMLInputElement).id === task.id) {\n      this._taskBeingUpdated = task;\n    }\n    if ((e.target as HTMLInputElement).id === `${task.id}-taskDate-input`) {\n      this._updatingTaskDate = true;\n      this._taskBeingUpdated = task;\n    }\n  };\n\n  private readonly handleBlur = () => {\n    const task = this._taskBeingUpdated;\n    const targets = this.renderRoot.querySelectorAll('fluent-text-field');\n    for (const target of targets) {\n      if (\n        task &&\n        ((target as HTMLInputElement).id === task.id || (target as HTMLInputElement).id === `${task.id}-taskDate-input`)\n      ) {\n        void this.updateTask(task);\n        (target as HTMLElement)?.blur();\n        this._taskBeingUpdated = null;\n        this._updatingTaskDate = false;\n      }\n    }\n  };\n\n  private readonly handleDateChange = (e: Event) => {\n    const value = (e.target as HTMLInputElement).value;\n    if (value) {\n      this._newTaskDueDate = new Date(value + 'T17:00');\n    } else {\n      this._newTaskDueDate = null;\n    }\n  };\n\n  private readonly handleDateUpdate = (e: Event) => {\n    const task = this._taskBeingUpdated;\n    if (task) {\n      const value = (e.target as HTMLInputElement).value;\n      if (value) {\n        this._newTaskDueDate = new Date(value + 'T17:00');\n      } else {\n        this._newTaskDueDate = null;\n      }\n\n      if (task.dueDateTime && this._newTaskDueDate) {\n        this._isChangedDueDate = new Date(task.dueDateTime.dateTime) !== this._newTaskDueDate;\n      } else if (task.dueDateTime || this._newTaskDueDate) {\n        this._isChangedDueDate = true;\n      } else {\n        this._isChangedDueDate = false;\n      }\n    }\n  };\n}\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { SwatchRGB, baseLayerLuminance, isDark } from '@fluentui/web-components';\n\n/**\n * Utility to help quickly determine if an element is dark based fluentui theme\n *\n * @param element HTMLElement to check if dark\n * @returns true if the element is dark\n */\nexport const isElementDark = (element: HTMLElement) => {\n  const luminance = baseLayerLuminance.getValueFor(element);\n  return isDark(SwatchRGB.create(luminance, luminance, luminance));\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nexport const strings = {\n  placeholder: 'Search',\n  title: 'Search'\n};\n","// THIS FILE IS AUTO GENERATED\n// ANY CHANGES WILL BE LOST DURING BUILD\n// MODIFY THE .SCSS FILE INSTEAD\n\nimport { css, CSSResult } from 'lit';\n/**\n * exports lit-element css\n * @export styles\n */\nexport const styles: CSSResult[] = [\n  css`\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, \"Segoe UI\", \"Segoe UI Web (West European)\", \"Segoe UI\", -apple-system, \"BlinkMacSystemFont\", \"Roboto\", \"Helvetica Neue\", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:\"\\\\\\e70d\"}.ms-icon-chevron-up::before{content:\"\\\\\\e70e\"}.ms-icon-contact::before{content:\"\\\\\\e77b\"}.ms-icon-add-friend::before{content:\"\\\\\\e8fa\"}.ms-icon-outlook-logo-inverser::before{content:\"\\\\\\eb6d\"}:host fluent-search{width:100%}\n`];","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { CSSResult, html, TemplateResult } from 'lit';\nimport { property } from 'lit/decorators.js';\nimport { MgtBaseTaskComponent } from '@microsoft/mgt-element';\nimport { fluentSearch } from '@fluentui/web-components';\nimport { registerFluentComponents } from '../../utils/FluentComponents';\nimport { strings } from './strings';\nimport { styles } from './mgt-search-box-css';\nimport { debounce } from '../../utils/Utils';\nimport { registerComponent } from '@microsoft/mgt-element';\n\nexport const registerMgtSearchBoxComponent = () => {\n  registerFluentComponents(fluentSearch);\n  registerComponent('search-box', MgtSearchBox);\n};\n\n/**\n * Web component used to enter a search value to power search scenarios.\n *\n * @fires {CustomEvent<string>} searchTermChanged - Fired when the search term is changed\n *\n * @class MgtSearchBox\n * @extends {MgtBaseComponent}\n */\nexport class MgtSearchBox extends MgtBaseTaskComponent {\n  /**\n   * Array of styles to apply to the element. The styles should be defined\n   * user the `css` tag function.\n   */\n  static get styles(): CSSResult[] {\n    return styles;\n  }\n\n  /**\n   * Provides strings for localization\n   *\n   * @readonly\n   * @protected\n   * @memberof MgtSearchBox\n   */\n  protected get strings() {\n    return strings;\n  }\n\n  /**\n   * The placeholder rendered in the search input (for example, `Select a user` or `Select a task list`).\n   *\n   * @type {string}\n   * @memberof MgtSearchBox\n   */\n  @property({\n    attribute: 'placeholder',\n    type: String\n  })\n  public placeholder: string;\n\n  /**\n   * Value of the search term\n   *\n   * @type {string}\n   * @memberof MgtSearchBox\n   */\n  @property({\n    attribute: 'search-term',\n    type: String\n  })\n  public get searchTerm() {\n    return this._searchTerm;\n  }\n  public set searchTerm(value) {\n    this._searchTerm = value;\n    this.fireSearchTermChanged();\n  }\n\n  /**\n   * Debounce delay of the search input in milliseconds\n   *\n   * @type {number}\n   * @memberof MgtSearchBox\n   */\n  @property({\n    attribute: 'debounce-delay',\n    type: Number,\n    reflect: true\n  })\n  public debounceDelay: number;\n  private _searchTerm = '';\n  private debouncedSearchTermChanged: () => void;\n\n  constructor() {\n    super();\n    this.debounceDelay = 300;\n  }\n\n  /**\n   * Renders the component\n   *\n   * @return {TemplateResult}\n   * @memberof MgtSearchBox\n   */\n  protected readonly renderContent = (): TemplateResult => {\n    return html`\n      <fluent-search\n        autocomplete=\"off\"\n        class=\"search-term-input\"\n        appearance=\"outline\"\n        value=${this.searchTerm ?? ''}\n        placeholder=${this.placeholder ? this.placeholder : strings.placeholder}\n        title=${this.title ? this.title : strings.title}\n        @input=${this.onInputChanged}\n        @change=${this.onInputChanged}\n      >\n      </fluent-search>`;\n  };\n\n  private readonly onInputChanged = (e: Event) => {\n    this.searchTerm = (e.target as HTMLInputElement).value;\n  };\n\n  /**\n   * Fires and debounces the custom event to listeners\n   */\n  private fireSearchTermChanged() {\n    if (!this.debouncedSearchTermChanged) {\n      this.debouncedSearchTermChanged = debounce(() => {\n        this.fireCustomEvent('searchTermChanged', this.searchTerm);\n      }, this.debounceDelay);\n    }\n\n    this.debouncedSearchTermChanged();\n  }\n}\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nexport const strings = {\n  modified: 'modified on',\n  back: 'Back',\n  next: 'Next',\n  pages: 'pages',\n  page: 'Page'\n};\n","// THIS FILE IS AUTO GENERATED\n// ANY CHANGES WILL BE LOST DURING BUILD\n// MODIFY THE .SCSS FILE INSTEAD\n\nimport { css, CSSResult } from 'lit';\n/**\n * exports lit-element css\n * @export styles\n */\nexport const styles: CSSResult[] = [\n  css`\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, \"Segoe UI\", \"Segoe UI Web (West European)\", \"Segoe UI\", -apple-system, \"BlinkMacSystemFont\", \"Roboto\", \"Helvetica Neue\", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:\"\\\\\\e70d\"}.ms-icon-chevron-up::before{content:\"\\\\\\e70e\"}.ms-icon-contact::before{content:\"\\\\\\e77b\"}.ms-icon-add-friend::before{content:\"\\\\\\e8fa\"}.ms-icon-outlook-logo-inverser::before{content:\"\\\\\\eb6d\"}.search-results{scroll-margin:100px}.search-result-grid{font-size:14px;margin:16px 4px;display:grid;grid-template-columns:32px 2fr 0fr;gap:.5rem}.search-result{font-size:14px;margin:16px 4px}.file-icon{--file-type-icon-height:32px}.search-result-info{margin:4px 0;display:inline-flex}.search-result-date{padding-top:3px}.search-result-date__shimmer{border-radius:4px;margin-top:2%;margin-left:5px;height:10px;width:200px}.search-result-summary{margin:4px 0;color:var(--body-subtle-text-color)}.search-result-thumbnail__shimmer{width:126px;height:72px}.search-result-thumbnail img{height:72px;max-width:126px;width:126px;object-fit:cover}.search-result-url{font-size:14px;font-weight:600;margin:4px 0}.search-result-url a{color:var(--color);text-decoration:none}.search-result-url a:hover{text-decoration:underline}.search-result-content__shimmer{border-radius:4px;margin-top:10px;height:10px}.search-result-name{font-size:16px;font-weight:600;margin:4px 0}.search-result-name__shimmer{border-radius:4px;margin-top:10px;height:10px;width:20%}.search-result-name a{color:var(--color);text-decoration:none}.search-result-name a:hover{text-decoration:underline}.search-result-author__shimmer{width:24px;height:24px}.search-result-icon{width:30px;height:30px}.search-result-icon__shimmer{width:32px;height:32px}.search-result-icon img{width:100%}.search-result-icon svg,.search-result-icon svg>path{width:100%;height:100%;fill:var(--neutral-foreground-rest);fill-rule:nonzero!important;clip-rule:nonzero!important}.search-results-page-active{border-bottom-style:solid;border-bottom-color:var(--accent-base-color)}.search-results-page svg,.search-results-page svg>path{height:12px;fill:var(--neutral-foreground-rest);fill-rule:nonzero!important;clip-rule:nonzero!important}.search-result-answer{box-shadow:var(--answer-box-shadow,0 3.2px 7.2px rgba(0,0,0,.132),0 .6px 1.8px rgba(0,0,0,.108));border-radius:var(--answer-border-radius,4px);border:var(--answer-border,none);padding:var(--answer-padding,10px)}.search-results-pages{margin:16px 4px}\n`];","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { html, HTMLTemplateResult, nothing, TemplateResult } from 'lit';\nimport { property, state } from 'lit/decorators.js';\nimport {\n  CacheService,\n  CacheStore,\n  equals,\n  prepScopes,\n  Providers,\n  ProviderState,\n  mgtHtml,\n  BetaGraph,\n  BatchResponse,\n  CollectionResponse,\n  MgtTemplatedTaskComponent\n} from '@microsoft/mgt-element';\n\nimport { schemas } from '../../graph/cacheStores';\nimport { strings } from './strings';\nimport { styles } from './mgt-search-results-css';\nimport {\n  DirectoryObject,\n  Drive,\n  DriveItem,\n  EntityType,\n  List,\n  ListItem,\n  Message,\n  SearchHit,\n  SearchHitsContainer,\n  SearchRequest,\n  SearchResponse,\n  Site\n} from '@microsoft/microsoft-graph-types';\nimport { SearchRequest as BetaSearchRequest } from '@microsoft/microsoft-graph-types-beta';\nimport {\n  getIsResponseCacheEnabled,\n  getNameFromUrl,\n  getRelativeDisplayDate,\n  getResponseInvalidationTime,\n  sanitizeSummary,\n  trimFileExtension\n} from '../../utils/Utils';\nimport { getSvg, SvgIcon } from '../../utils/SvgHelper';\nimport { fluentSkeleton, fluentButton, fluentTooltip, fluentDivider } from '@fluentui/web-components';\nimport { registerFluentComponents } from '../../utils/FluentComponents';\nimport { CacheResponse } from '../CacheResponse';\nimport { registerComponent } from '@microsoft/mgt-element';\nimport { registerMgtFileComponent } from '../mgt-file/mgt-file';\nimport { registerMgtPersonComponent } from '../mgt-person/mgt-person';\n\n/**\n * Object representing a thumbnail\n */\ninterface Thumbnail {\n  /**\n   * The url of the Thumbnail\n   */\n  url?: string;\n}\n\n/**\n * Object representing a Binary Thumbnail\n */\ninterface BinaryThumbnail {\n  /**\n   * The url of the Thumbnail\n   */\n  url?: string;\n\n  /**\n   * The web Url of the Thumbnail\n   */\n  thumbnailWebUrl?: string;\n}\n\n/**\n * Object representing a Search Answer\n */\ninterface Answer {\n  '@odata.type': string;\n  displayName?: string;\n  description?: string;\n  webUrl?: string;\n}\n\n/**\n * Object representing a search resource supporting thumbnails\n */\ninterface ThumbnailResource {\n  thumbnail: Thumbnail;\n}\n\ninterface UserResource {\n  lastModifiedBy?: {\n    user?: {\n      email?: string;\n    };\n  };\n  userPrincipalName?: string;\n}\n\n/**\n * Object representing a Search Resource\n */\ntype SearchResource = Partial<\n  DriveItem & Site & List & Message & ListItem & Drive & DirectoryObject & Answer & ThumbnailResource & UserResource\n>;\n\n/**\n * Object representing a full Search Response\n */\ntype SearchResponseCollection = CollectionResponse<SearchResponse>;\n\nexport const registerMgtSearchResultsComponent = () => {\n  registerFluentComponents(fluentSkeleton, fluentButton, fluentTooltip, fluentDivider);\n\n  registerMgtFileComponent();\n  registerMgtPersonComponent();\n  registerComponent('search-results', MgtSearchResults);\n};\n\n/**\n * **Preview component** Custom element for making Microsoft Graph get queries.\n * Component may change before general availability release.\n *\n * @fires {CustomEvent<DataChangedDetail>} dataChange - Fired when data changes\n *\n * @cssprop --answer-border-radius - {Length} Border radius of an answer\n * @cssprop --answer-box-shadow - {Length} Box shadow of an answer\n * @cssprop --answer-border - {Length} Border of an answer\n * @cssprop --answer-padding - {Length} Padding of an answer\n *\n * @class mgt-search-results\n * @extends {MgtTemplatedTaskComponent}\n */\nexport class MgtSearchResults extends MgtTemplatedTaskComponent {\n  /**\n   * Default page size is 10\n   */\n  private _size = 10;\n\n  /**\n   * Array of styles to apply to the element. The styles should be defined\n   * user the `css` tag function.\n   */\n  static get styles() {\n    return styles;\n  }\n\n  /**\n   * Gets all the localization strings for the component\n   */\n  protected get strings() {\n    return strings;\n  }\n\n  private _queryString: string;\n\n  /**\n   * The query to send to Microsoft Search\n   *\n   * @type {string}\n   * @memberof MgtSearchResults\n   */\n  public get queryString(): string {\n    return this._queryString;\n  }\n  @property({\n    attribute: 'query-string',\n    type: String\n  })\n  public set queryString(value: string) {\n    if (this._queryString !== value) {\n      this._queryString = value;\n      this.currentPage = 1;\n    }\n  }\n\n  /**\n   * Query template to use in complex search scenarios\n   * Query Templates are currently supported only on the beta endpoint\n   */\n  @property({\n    attribute: 'query-template',\n    type: String\n  })\n  public queryTemplate: string;\n\n  /**\n   * One or more types of resources expected in the response.\n   * Possible values are: list, site, listItem, message, event,\n   * drive, driveItem, externalItem.\n   *\n   * @type {string[]}\n   * @memberof MgtSearchResults\n   */\n  @property({\n    attribute: 'entity-types',\n    converter: value => {\n      return value.split(',').map(v => v.trim());\n    },\n    type: String\n  })\n  public entityTypes: string[] = ['driveItem', 'listItem', 'site'];\n\n  /**\n   * The scopes to request\n   *\n   * @type {string[]}\n   * @memberof MgtSearchResults\n   */\n  @property({\n    attribute: 'scopes',\n    converter: (value, _type) => {\n      return value ? value.toLowerCase().split(',') : null;\n    }\n  })\n  public scopes: string[] = [];\n\n  /**\n   * Content sources to use with External Items\n   *\n   * @type {string[]}\n   * @memberof MgtSearchResults\n   */\n  @property({\n    attribute: 'content-sources',\n    converter: (value, _type) => {\n      return value ? value.toLowerCase().split(',') : null;\n    }\n  })\n  public contentSources: string[] = [];\n\n  /**\n   * Api version to use for request\n   *\n   * @type {string}\n   * @memberof MgtSearchResults\n   */\n  @property({\n    attribute: 'version',\n    reflect: true,\n    type: String\n  })\n  public version = 'v1.0';\n\n  /**\n   * Specifies the offset for the search results.\n   * Offset 0 returns the very first result.\n   *\n   * @type {number}\n   * @memberof MgtSearchResults\n   */\n  public get from(): number {\n    return (this.currentPage - 1) * this.size;\n  }\n\n  /**\n   * The size of the page to be retrieved.\n   * The maximum value is 1000.\n   *\n   * @type {number}\n   * @memberof MgtSearchResults\n   */\n  public get size(): number {\n    return this._size;\n  }\n  @property({\n    attribute: 'size',\n    reflect: true,\n    type: Number\n  })\n  public set size(value) {\n    if (value > this.maxPageSize) {\n      this._size = this.maxPageSize;\n    } else {\n      this._size = value;\n    }\n  }\n\n  /**\n   * The maximum number of pages to be clickable\n   * in the paging control\n   *\n   * @type {number}\n   * @memberof MgtSearchResults\n   */\n  @property({\n    attribute: 'paging-max',\n    reflect: true,\n    type: Number\n  })\n  public pagingMax = 7;\n\n  /**\n   * Sets whether the result thumbnail should be fetched\n   * from the Microsoft Graph\n   *\n   * @type {boolean}\n   * @memberof MgtSearchResults\n   */\n  @property({\n    attribute: 'fetch-thumbnail',\n    type: Boolean\n  })\n  public fetchThumbnail: boolean;\n\n  /**\n   * Contains the fields to be returned for each resource\n   *\n   * @type {string[]}\n   * @memberof MgtSearchResults\n   */\n  @property({\n    attribute: 'fields',\n    converter: value => {\n      return value.split(',').map(v => v.trim());\n    },\n    type: String\n  })\n  public fields: string[];\n\n  /**\n   * This triggers hybrid sort for messages : the first 3 messages are the most relevant.\n   * This property is only applicable to entityType=message\n   *\n   * @type {boolean}\n   * @memberof MgtSearchResults\n   */\n  @property({\n    attribute: 'enable-top-results',\n    reflect: true,\n    type: Boolean\n  })\n  public enableTopResults = false;\n\n  /**\n   * Enables cache on the response from the specified resource\n   * default = false\n   *\n   * @type {boolean}\n   * @memberof MgtSearchResults\n   */\n  @property({\n    attribute: 'cache-enabled',\n    reflect: true,\n    type: Boolean\n  })\n  public cacheEnabled = false;\n\n  /**\n   * Invalidation period of the cache for the responses in milliseconds\n   *\n   * @type {number}\n   * @memberof MgtSearchResults\n   */\n  @property({\n    attribute: 'cache-invalidation-period',\n    reflect: true,\n    type: Number\n  })\n  public cacheInvalidationPeriod = 30000;\n\n  /**\n   * Gets or sets the response of the request\n   *\n   * @type any\n   * @memberof MgtSearchResults\n   */\n  @state() private response: SearchResponseCollection;\n\n  private isRefreshing = false;\n  private get searchEndpoint() {\n    return '/search/query';\n  }\n  private get maxPageSize() {\n    return 1000;\n  }\n  private readonly defaultFields: string[] = [\n    'webUrl',\n    'lastModifiedBy',\n    'lastModifiedDateTime',\n    'summary',\n    'displayName',\n    'name'\n  ];\n\n  @property({ attribute: false })\n  public currentPage = 1;\n\n  constructor() {\n    super();\n  }\n\n  protected args(): unknown[] {\n    return [\n      this.providerState,\n      this.queryString,\n      this.queryTemplate,\n      this.entityTypes,\n      this.contentSources,\n      this.scopes,\n      this.version,\n      this.size,\n      this.fetchThumbnail,\n      this.fields,\n      this.enableTopResults,\n      this.currentPage\n    ];\n  }\n\n  /**\n   * Refresh the data\n   *\n   * @param {boolean} [hardRefresh=false]\n   * if false (default), the component will only update if the data changed\n   * if true, the data will be first cleared and reloaded completely\n   * @memberof MgtSearchResults\n   */\n  public refresh(hardRefresh = false) {\n    this.isRefreshing = true;\n    if (hardRefresh) {\n      this.clearState();\n    }\n    void this._task.run();\n  }\n\n  /**\n   * Clears state of the component\n   *\n   * @protected\n   * @memberof MgtSearchResults\n   */\n  protected clearState(): void {\n    this.response = null;\n  }\n\n  /**\n   * Invoked on each update to perform rendering tasks. This method must return\n   * a lit-html TemplateResult. Setting properties inside this method will *not*\n   * trigger the element to update.\n   */\n  protected renderContent = (): TemplateResult => {\n    let renderedTemplate: TemplateResult = null;\n    let headerTemplate: TemplateResult = null;\n    let footerTemplate: TemplateResult = null;\n\n    if (this.hasTemplate('header')) {\n      headerTemplate = this.renderTemplate('header', this.response);\n    }\n\n    footerTemplate = this.renderFooter(this.response?.value[0]?.hitsContainers[0]);\n\n    if (this.response && this.hasTemplate('default')) {\n      renderedTemplate = this.renderTemplate('default', this.response) || html``;\n    } else if (this.response?.value[0]?.hitsContainers[0]) {\n      renderedTemplate = html`${this.response?.value[0]?.hitsContainers[0]?.hits?.map(result =>\n        this.renderResult(result)\n      )}`;\n    } else if (this.hasTemplate('no-data')) {\n      renderedTemplate = this.renderTemplate('no-data', null);\n    } else {\n      renderedTemplate = html``;\n    }\n\n    return html`\n      ${headerTemplate}\n      <div class=\"search-results\">\n        ${renderedTemplate}\n      </div>\n      ${footerTemplate}`;\n  };\n\n  /**\n   * load state into the component.\n   *\n   * @protected\n   * @returns\n   * @memberof MgtSearchResults\n   */\n  protected async loadState() {\n    const provider = Providers.globalProvider;\n\n    this.error = null;\n\n    if (!provider || provider.state !== ProviderState.SignedIn) {\n      return;\n    }\n\n    if (this.queryString) {\n      try {\n        const requestOptions = this.getRequestOptions();\n\n        let cache: CacheStore<CacheResponse>;\n        const key = JSON.stringify({\n          endpoint: `${this.version}${this.searchEndpoint}`,\n          requestOptions\n        });\n        let response: SearchResponseCollection = null;\n\n        if (this.shouldRetrieveCache()) {\n          cache = CacheService.getCache<CacheResponse>(schemas.search, schemas.search.stores.responses);\n          const result: CacheResponse = getIsResponseCacheEnabled() ? await cache.getValue(key) : null;\n          if (result && getResponseInvalidationTime(this.cacheInvalidationPeriod) > Date.now() - result.timeCached) {\n            response = JSON.parse(result.response) as SearchResponseCollection;\n          }\n        }\n\n        if (!response) {\n          const graph = provider.graph.forComponent(this);\n          let request = graph.api(this.searchEndpoint).version(this.version);\n\n          if (this.scopes?.length) {\n            request = request.middlewareOptions(prepScopes(this.scopes));\n          }\n\n          response = (await request.post({ requests: [requestOptions] })) as SearchResponseCollection;\n\n          if (this.fetchThumbnail) {\n            const thumbnailBatch = graph.createBatch<BinaryThumbnail>();\n            const thumbnailBatchBeta = BetaGraph.fromGraph(graph).createBatch<BinaryThumbnail>();\n\n            const hits =\n              response.value?.length && response.value[0].hitsContainers?.length\n                ? response.value[0].hitsContainers[0]?.hits ?? []\n                : [];\n            for (const element of hits) {\n              const resource = element.resource as SearchResource;\n              if (\n                (resource.size > 0 || resource.webUrl?.endsWith('.aspx')) &&\n                (resource['@odata.type'] === '#microsoft.graph.driveItem' ||\n                  resource['@odata.type'] === '#microsoft.graph.listItem')\n              ) {\n                if (resource['@odata.type'] === '#microsoft.graph.listItem') {\n                  thumbnailBatchBeta.get(\n                    element.hitId.toString(),\n                    `/sites/${resource.parentReference.siteId}/pages/${resource.id}`\n                  );\n                } else {\n                  thumbnailBatch.get(\n                    element.hitId.toString(),\n                    `/drives/${resource.parentReference.driveId}/items/${resource.id}/thumbnails/0/medium`\n                  );\n                }\n              }\n            }\n\n            /**\n             * Based on the batch response, augment the search result resource with the thumbnail url\n             *\n             * @param thumbnailResponse\n             */\n            const augmentResponse = (thumbnailResponse: Map<string, BatchResponse<BinaryThumbnail>>) => {\n              if (thumbnailResponse && thumbnailResponse.size > 0) {\n                for (const [k, value] of thumbnailResponse) {\n                  const result: SearchHit = response.value[0].hitsContainers[0].hits[k] as SearchHit;\n                  const thumbnail: Thumbnail =\n                    result.resource['@odata.type'] === '#microsoft.graph.listItem'\n                      ? { url: value.content.thumbnailWebUrl }\n                      : { url: value.content.url };\n                  (result.resource as SearchResource).thumbnail = thumbnail;\n                }\n              }\n            };\n\n            try {\n              augmentResponse(await thumbnailBatch.executeAll());\n              augmentResponse(await thumbnailBatchBeta.executeAll());\n            } catch {\n              // no-op\n            }\n          }\n\n          if (this.shouldUpdateCache() && response) {\n            cache = CacheService.getCache<CacheResponse>(schemas.search, schemas.search.stores.responses);\n            await cache.putValue(key, { response: JSON.stringify(response) });\n          }\n        }\n\n        if (!equals(this.response, response)) {\n          this.response = response;\n        }\n      } catch (e: unknown) {\n        this.error = e as Error;\n      }\n\n      if (this.response) {\n        this.error = null;\n      }\n    } else {\n      this.response = null;\n    }\n    this.isRefreshing = false;\n    this.fireCustomEvent('dataChange', { response: this.response, error: this.error as Error });\n  }\n\n  /**\n   * Render the loading state.\n   *\n   * @protected\n   * @returns\n   * @memberof MgtSearchResults\n   */\n  protected readonly renderLoading = (): TemplateResult => {\n    return (\n      this.renderTemplate('loading', null) ||\n      // creates an array of n items where n is the current max number of results, this builds a shimmer for that many results\n      html`\n        ${[...Array<number>(this.size)].map(() => {\n          return html`\n            <div class=\"search-result\">\n              <div class=\"search-result-grid\">\n                <div class=\"search-result-icon\">\n                  <fluent-skeleton class=\"search-result-icon__shimmer\" shape=\"rect\" shimmer></fluent-skeleton>\n                </div>\n                <div class=\"searc-result-content\">\n                  <div class=\"search-result-name\">\n                    <fluent-skeleton class=\"search-result-name__shimmer\" shape=\"rect\" shimmer></fluent-skeleton>\n                  </div>\n                  <div class=\"search-result-info\">\n                    <div class=\"search-result-author\">\n                      <fluent-skeleton class=\"search-result-author__shimmer\" shape=\"circle\" shimmer></fluent-skeleton>\n                    </div>\n                    <div class=\"search-result-date\">\n                      <fluent-skeleton class=\"search-result-date__shimmer\" shape=\"rect\" shimmer></fluent-skeleton>\n                    </div>\n                  </div>\n                  <fluent-skeleton class=\"search-result-content__shimmer\" shape=\"rect\" shimmer></fluent-skeleton>\n                  <fluent-skeleton class=\"search-result-content__shimmer\" shape=\"rect\" shimmer></fluent-skeleton>\n                </div>\n                ${\n                  this.fetchThumbnail &&\n                  html`\n                    <div class=\"search-result-thumbnail\">\n                      <fluent-skeleton class=\"search-result-thumbnail__shimmer\" shape=\"rect\" shimmer></fluent-skeleton>\n                    </div>\n                  `\n                }\n              </div>\n              <fluent-divider></fluent-divider>\n            </div>\n          `;\n        })}\n       `\n    );\n  };\n\n  /**\n   * Render the result item.\n   *\n   * @protected\n   * @returns\n   * @memberof MgtSearchResults\n   */\n  protected renderResult(result: SearchHit): TemplateResult {\n    const type = this.getResourceType(result.resource);\n    if (this.hasTemplate(`result-${type}`)) {\n      return this.renderTemplate(`result-${type}`, result, result.hitId);\n    } else {\n      switch (result.resource['@odata.type']) {\n        case '#microsoft.graph.driveItem':\n          return this.renderDriveItem(result);\n        case '#microsoft.graph.site':\n          return this.renderSite(result);\n        case '#microsoft.graph.person':\n          return this.renderPerson(result);\n        case '#microsoft.graph.drive':\n        case '#microsoft.graph.list':\n          return this.renderList(result);\n        case '#microsoft.graph.listItem':\n          return this.renderListItem(result);\n        case '#microsoft.graph.search.bookmark':\n          return this.renderBookmark(result);\n        case '#microsoft.graph.search.acronym':\n          return this.renderAcronym(result);\n        case '#microsoft.graph.search.qna':\n          return this.renderQnA(result);\n        default:\n          return this.renderDefault(result);\n      }\n    }\n  }\n\n  /**\n   * Renders the footer with pages if required\n   *\n   * @param hitsContainer Search results\n   */\n  private renderFooter(hitsContainer: SearchHitsContainer) {\n    if (this.pagingRequired(hitsContainer)) {\n      const pages = this.getActivePages(hitsContainer.total);\n\n      return html`\n        <div class=\"search-results-pages\">\n          ${this.renderPreviousPage()}\n          ${this.renderFirstPage(pages)}\n          ${this.renderAllPages(pages)}\n          ${this.renderNextPage()}\n        </div>\n      `;\n    }\n  }\n\n  /**\n   * Validates if paging is required based on the provided results\n   *\n   * @param hitsContainer\n   */\n  private pagingRequired(hitsContainer: SearchHitsContainer) {\n    return hitsContainer?.moreResultsAvailable || this.currentPage * this.size < hitsContainer?.total;\n  }\n\n  /**\n   * Gets a list of active pages to render for paging purposes\n   *\n   * @param totalResults Total number of results of the search query\n   */\n  private getActivePages(totalResults: number) {\n    const getFirstPage = () => {\n      const medianPage = this.currentPage - Math.floor(this.pagingMax / 2) - 1;\n\n      if (medianPage >= Math.floor(this.pagingMax / 2)) {\n        return medianPage;\n      } else {\n        return 0;\n      }\n    };\n\n    const pages: number[] = [];\n    const firstPage = getFirstPage();\n\n    if (firstPage + 1 > this.pagingMax - this.currentPage || this.pagingMax === this.currentPage) {\n      for (\n        let i = firstPage + 1;\n        i < Math.ceil(totalResults / this.size) &&\n        i < this.pagingMax + (this.currentPage - 1) &&\n        pages.length < this.pagingMax - 2;\n        ++i\n      ) {\n        pages.push(i + 1);\n      }\n    } else {\n      for (let i = firstPage; i < this.pagingMax; ++i) {\n        pages.push(i + 1);\n      }\n    }\n\n    return pages;\n  }\n\n  /**\n   * Renders all sequential pages buttons\n   *\n   * @param pages\n   */\n  private renderAllPages(pages: number[]) {\n    return html`\n      ${pages.map(\n        page =>\n          html`\n            <fluent-button\n              title=\"${strings.page} ${page}\"\n              appearance=\"stealth\"\n              class=\"${page === this.currentPage ? 'search-results-page-active' : 'search-results-page'}\"\n              @click=\"${() => this.onPageClick(page)}\">\n                ${page}\n            </fluent-button>`\n      )}`;\n  }\n\n  /**\n   * Renders the \"First page\" button\n   *\n   * @param pages\n   */\n  private renderFirstPage(pages: number[]) {\n    return html`\n      ${\n        pages.some(page => page === 1)\n          ? nothing\n          : html`\n              <fluent-button\n                 title=\"${strings.page} 1\"\n                 appearance=\"stealth\"\n                 class=\"search-results-page\"\n                 @click=\"${this.onFirstPageClick}\">\n                 1\n               </fluent-button>`\n          ? html`\n              <fluent-button\n                id=\"page-back-dot\"\n                appearance=\"stealth\"\n                class=\"search-results-page\"\n                title=\"${this.getDotButtonTitle()}\"\n                @click=\"${() => this.onPageClick(this.currentPage - Math.ceil(this.pagingMax / 2))}\"\n              >\n                ...\n              </fluent-button>`\n          : nothing\n      }`;\n  }\n\n  /**\n   * Constructs the \"dot dot dot\" button title\n   */\n  private getDotButtonTitle() {\n    return `${strings.back} ${Math.ceil(this.pagingMax / 2)} ${strings.pages}`;\n  }\n\n  /**\n   * Renders the \"Previous page\" button\n   */\n  private renderPreviousPage() {\n    return this.currentPage > 1\n      ? html`\n          <fluent-button\n            appearance=\"stealth\"\n            class=\"search-results-page\"\n            title=\"${strings.back}\"\n            @click=\"${this.onPageBackClick}\">\n              ${getSvg(SvgIcon.ChevronLeft)}\n            </fluent-button>`\n      : nothing;\n  }\n\n  /**\n   * Renders the \"Next page\" button\n   */\n  private renderNextPage() {\n    return !this.isLastPage()\n      ? html`\n          <fluent-button\n            appearance=\"stealth\"\n            class=\"search-results-page\"\n            title=\"${strings.next}\"\n            aria-label=\"${strings.next}\"\n            @click=\"${this.onPageNextClick}\">\n              ${getSvg(SvgIcon.ChevronRight)}\n            </fluent-button>`\n      : nothing;\n  }\n\n  /**\n   * Triggers a specific page click\n   *\n   * @param pageNumber\n   */\n  private onPageClick(pageNumber: number) {\n    this.currentPage = pageNumber;\n    this.scrollToFirstResult();\n  }\n\n  /**\n   * Triggers a first page click\n   *\n   */\n  private readonly onFirstPageClick = () => {\n    this.currentPage = 1;\n    this.scrollToFirstResult();\n  };\n\n  /**\n   * Triggers a previous page click\n   */\n  private readonly onPageBackClick = () => {\n    this.currentPage--;\n    this.scrollToFirstResult();\n  };\n\n  /**\n   * Triggers a next page click\n   */\n  private readonly onPageNextClick = () => {\n    this.currentPage++;\n    this.scrollToFirstResult();\n  };\n\n  /**\n   * Validates if the current page is the last page of the collection\n   */\n  private isLastPage() {\n    return this.currentPage === Math.ceil(this.response.value[0].hitsContainers[0].total / this.size);\n  }\n\n  /**\n   * Scroll to the top of the search results\n   */\n  private scrollToFirstResult() {\n    const target = this.renderRoot.querySelector('.search-results');\n    target.scrollIntoView({\n      block: 'start',\n      behavior: 'smooth'\n    });\n  }\n\n  /**\n   * Gets the resource type (entity) of a search result\n   *\n   * @param resource\n   */\n  private getResourceType(resource: SearchResource) {\n    return resource['@odata.type'].split('.').pop();\n  }\n\n  /**\n   * Renders a driveItem entity\n   *\n   * @param result\n   */\n  private renderDriveItem(result: SearchHit) {\n    const resource = result.resource as SearchResource;\n    return mgtHtml`\n      <div class=\"search-result-grid\">\n        <div class=\"search-result-icon\">\n          <mgt-file\n            .fileDetails=\"${result.resource}\"\n            view=\"image\"\n            class=\"file-icon\">\n          </mgt-file>\n        </div>\n        <div class=\"search-result-content\">\n          <div class=\"search-result-name\">\n            <a href=\"${resource.webUrl}?Web=1\" target=\"_blank\">${trimFileExtension(resource.name)}</a>\n          </div>\n          <div class=\"search-result-info\">\n            <div class=\"search-result-author\">\n              <mgt-person\n                person-query=${resource.lastModifiedBy.user.email}\n                view=\"oneline\"\n                person-card=\"hover\"\n                show-presence=\"true\">\n              </mgt-person>\n            </div>\n            <div class=\"search-result-date\">\n              &nbsp; ${strings.modified} ${getRelativeDisplayDate(new Date(resource.lastModifiedDateTime))}\n            </div>\n          </div>\n          <div class=\"search-result-summary\" .innerHTML=\"${sanitizeSummary(result.summary)}\"></div>\n        </div>\n        ${\n          resource.thumbnail?.url &&\n          html`\n          <div class=\"search-result-thumbnail\">\n            <a href=\"${resource.webUrl}\" target=\"_blank\"><img alt=\"${resource.name}\" src=\"${resource.thumbnail?.url}\" /></a>\n          </div>`\n        }\n\n      </div>\n      <fluent-divider></fluent-divider>\n    `;\n  }\n\n  /**\n   * Renders a site entity\n   *\n   * @param result\n   * @returns\n   */\n  private renderSite(result: SearchHit): HTMLTemplateResult {\n    const resource = result.resource as SearchResource;\n    return html`\n      <div class=\"search-result-grid\">\n        <div class=\"search-result-icon\">\n          ${this.getResourceIcon(resource)}\n        </div>\n        <div class=\"searc-result-content\">\n          <div class=\"search-result-name\">\n            <a href=\"${resource.webUrl}\" target=\"_blank\">${resource.displayName}</a>\n          </div>\n          <div class=\"search-result-info\">\n            <div class=\"search-result-url\">\n              <a href=\"${resource.webUrl}\" target=\"_blank\">${resource.webUrl}</a>\n            </div>\n          </div>\n          <div class=\"search-result-summary\" .innerHTML=\"${sanitizeSummary(result.summary)}\"></div>\n        </div>\n      </div>\n      <fluent-divider></fluent-divider>\n    `;\n  }\n\n  /**\n   * Renders a list entity\n   *\n   * @param result\n   * @returns\n   */\n  private renderList(result: SearchHit): HTMLTemplateResult {\n    const resource = result.resource as SearchResource;\n    return mgtHtml`\n      <div class=\"search-result-grid\">\n        <div class=\"search-result-icon\">\n          <mgt-file\n            .fileDetails=\"${result.resource}\"\n            view=\"image\">\n          </mgt-file>\n        </div>\n        <div class=\"search-result-content\">\n          <div class=\"search-result-name\">\n            <a href=\"${resource.webUrl}?Web=1\" target=\"_blank\">\n              ${trimFileExtension(resource.name || getNameFromUrl(resource.webUrl))}\n            </a>\n          </div>\n          <div class=\"search-result-summary\" .innerHTML=\"${sanitizeSummary(result.summary)}\"></div>\n        </div>\n      </div>\n      <fluent-divider></fluent-divider>\n    `;\n  }\n\n  /**\n   * Renders a listItem entity\n   *\n   * @param result\n   * @returns\n   */\n  private renderListItem(result: SearchHit): HTMLTemplateResult {\n    const resource = result.resource as SearchResource;\n    return mgtHtml`\n      <div class=\"search-result-grid\">\n        <div class=\"search-result-icon\">\n          ${resource.webUrl.endsWith('.aspx') ? getSvg(SvgIcon.News) : getSvg(SvgIcon.FileOuter)}\n        </div>\n        <div class=\"search-result-content\">\n          <div class=\"search-result-name\">\n            <a href=\"${resource.webUrl}?Web=1\" target=\"_blank\">\n              ${trimFileExtension(resource.name || getNameFromUrl(resource.webUrl))}\n            </a>\n          </div>\n          <div class=\"search-result-info\">\n            <div class=\"search-result-author\">\n              <mgt-person\n                person-query=${resource.lastModifiedBy.user.email}\n                view=\"oneline\"\n                person-card=\"hover\"\n                show-presence=\"true\">\n              </mgt-person>\n            </div>\n            <div class=\"search-result-date\">\n              &nbsp; ${strings.modified} ${getRelativeDisplayDate(new Date(resource.lastModifiedDateTime))}\n            </div>\n          </div>\n          <div class=\"search-result-summary\" .innerHTML=\"${sanitizeSummary(result.summary)}\"></div>\n        </div>\n        ${\n          resource.thumbnail?.url &&\n          html`\n          <div class=\"search-result-thumbnail\">\n            <a href=\"${resource.webUrl}\" target=\"_blank\"><img alt=\"${trimFileExtension(\n              resource.name || getNameFromUrl(resource.webUrl)\n            )}\" src=\"${resource.thumbnail?.url || nothing}\" /></a>\n          </div>`\n        }\n      </div>\n      <fluent-divider></fluent-divider>\n    `;\n  }\n\n  /**\n   * Renders a person entity\n   *\n   * @param result\n   * @returns\n   */\n  private renderPerson(result: SearchHit): HTMLTemplateResult {\n    const resource = result.resource as SearchResource;\n    return mgtHtml`\n      <div class=\"search-result\">\n        <mgt-person\n          view=\"fourlines\"\n          person-query=${resource.userPrincipalName}\n          person-card=\"hover\"\n          show-presence=\"true\">\n        </mgt-person>\n      </div>\n      <fluent-divider></fluent-divider>\n    `;\n  }\n\n  /**\n   * Renders a bookmark entity\n   *\n   * @param result\n   */\n  private renderBookmark(result: SearchHit) {\n    return this.renderAnswer(result, SvgIcon.DoubleBookmark);\n  }\n\n  /**\n   * Renders an acronym entity\n   *\n   * @param result\n   */\n  private renderAcronym(result: SearchHit) {\n    return this.renderAnswer(result, SvgIcon.BookOpen);\n  }\n\n  /**\n   * Renders a qna entity\n   *\n   * @param result\n   */\n  private renderQnA(result: SearchHit) {\n    return this.renderAnswer(result, SvgIcon.BookQuestion);\n  }\n\n  /**\n   * Renders an answer entity\n   *\n   * @param result\n   */\n  private renderAnswer(result: SearchHit, icon: SvgIcon) {\n    const resource = result.resource as SearchResource;\n    return html`\n      <div class=\"search-result-grid search-result-answer\">\n        <div class=\"search-result-icon\">\n          ${getSvg(icon)}\n        </div>\n        <div class=\"search-result-content\">\n          <div class=\"search-result-name\">\n            <a href=\"${this.getResourceUrl(resource)}?Web=1\" target=\"_blank\">${resource.displayName}</a>\n          </div>\n          <div class=\"search-result-summary\">${resource.description}</div>\n        </div>\n      </div>\n      <fluent-divider></fluent-divider>\n    `;\n  }\n\n  /**\n   * Renders any entity\n   *\n   * @param result\n   */\n  private renderDefault(result: SearchHit) {\n    const resource = result.resource as SearchResource;\n    const resourceUrl = this.getResourceUrl(resource);\n    return html`\n      <div class=\"search-result-grid\">\n        <div class=\"search-result-icon\">\n          ${this.getResourceIcon(resource)}\n        </div>\n        <div class=\"search-result-content\">\n          <div class=\"search-result-name\">\n            ${\n              resourceUrl\n                ? html`\n                  <a href=\"${resourceUrl}?Web=1\" target=\"_blank\">${this.getResourceName(resource)}</a>\n                `\n                : html`\n                  ${this.getResourceName(resource)}\n                `\n            }\n          </div>\n          <div class=\"search-result-summary\" .innerHTML=\"${this.getResultSummary(result)}\"></div>\n        </div>\n      </div>\n      <fluent-divider></fluent-divider>\n    `;\n  }\n\n  /**\n   * Gets default resource URLs\n   *\n   * @param resource\n   */\n  private getResourceUrl(resource: SearchResource) {\n    return resource.webUrl || /* resource.url ||*/ resource.webLink || null;\n  }\n\n  /**\n   * Gets default resource Names\n   *\n   * @param resource\n   */\n  private getResourceName(resource: SearchResource) {\n    return resource.displayName || resource.subject || trimFileExtension(resource.name);\n  }\n\n  /**\n   * Gets default result summary\n   *\n   * @param resource\n   */\n  private getResultSummary(result: SearchHit) {\n    return sanitizeSummary(result.summary || (result.resource as SearchResource)?.description || null);\n  }\n\n  /**\n   * Gets default resource icon\n   *\n   * @param resource\n   */\n  private getResourceIcon(resource: SearchResource) {\n    switch (resource['@odata.type']) {\n      case '#microsoft.graph.site':\n        return getSvg(SvgIcon.Globe);\n      case '#microsoft.graph.message':\n        return getSvg(SvgIcon.Email);\n      case '#microsoft.graph.event':\n        return getSvg(SvgIcon.Event);\n      case 'microsoft.graph.chatMessage':\n        return getSvg(SvgIcon.SmallChat);\n      default:\n        return getSvg(SvgIcon.FileOuter);\n    }\n  }\n\n  /**\n   * Validates if cache should be retrieved\n   *\n   * @returns\n   */\n  private shouldRetrieveCache(): boolean {\n    return getIsResponseCacheEnabled() && this.cacheEnabled && !this.isRefreshing;\n  }\n\n  /**\n   * Validates if cache should be updated\n   *\n   * @returns\n   */\n  private shouldUpdateCache(): boolean {\n    return getIsResponseCacheEnabled() && this.cacheEnabled;\n  }\n\n  /**\n   * Builds the appropriate RequestOption for the search query\n   *\n   * @returns\n   */\n  private getRequestOptions(): SearchRequest | BetaSearchRequest {\n    const requestOptions: SearchRequest = {\n      entityTypes: this.entityTypes as EntityType[],\n      query: {\n        queryString: this.queryString\n      },\n      from: this.from ? this.from : undefined,\n      size: this.size ? this.size : undefined,\n      fields: this.getFields(),\n      enableTopResults: this.enableTopResults ? this.enableTopResults : undefined\n    };\n\n    if (this.entityTypes.includes('externalItem')) {\n      requestOptions.contentSources = this.contentSources;\n    }\n\n    if (this.version === 'beta') {\n      (requestOptions as BetaSearchRequest).query.queryTemplate = this.queryTemplate ? this.queryTemplate : undefined;\n    }\n\n    return requestOptions;\n  }\n\n  /**\n   * Gets the fields and default fields for default render methods\n   *\n   * @returns\n   */\n  private getFields(): string[] {\n    if (this.fields) {\n      return this.defaultFields.concat(this.fields);\n    }\n\n    return undefined;\n  }\n}\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { provideFluentDesignSystem } from '@fluentui/web-components';\n\n/**\n * Provides a design system to the fluent components\n */\nconst designSystem = provideFluentDesignSystem();\n\n/**\n * Registers fluent components to the design system\n *\n * @param fluentComponents array of fluent components to register\n * @returns\n */\nexport const registerFluentComponents = (...fluentComponents: (() => unknown)[]) => {\n  if (!fluentComponents?.length) {\n    return;\n  }\n\n  for (const component of fluentComponents) {\n    designSystem.register(component());\n  }\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * Defines icon used by svgHelper\n *\n * @export\n * @enum {number}\n */\nexport enum SvgIcon {\n  /**\n   * Arrow Icon pointing down\n   */\n  ArrowDown,\n\n  /**\n   * Icon separates team from channel in selection\n   */\n  TeamSeparator,\n\n  /**\n   * Search icon\n   */\n  Search,\n\n  /**\n   * Skype Arrow icon (out of office status)\n   */\n  SkypeArrow,\n\n  /**\n   * Smaller email icon used in top of person card\n   */\n  SmallEmail,\n\n  /**\n   * Smaller email, hovered version, icon used in top of person card\n   */\n  SmallEmailHovered,\n\n  /**\n   * Smaller chat icon used in top of person card\n   */\n  SmallChat,\n\n  /**\n   * Small chat icon, hover version, used in top of person card\n   */\n  SmallChatHovered,\n\n  /**\n   * Video icon used in top of person card\n   */\n  Video,\n\n  /**\n   * Videoicon, hovered version used in top of person card\n   */\n  VideoHovered,\n\n  /**\n   * Downward chevron\n   */\n  ExpandDown,\n\n  /**\n   * Overview icon\n   */\n  Overview,\n\n  /**\n   * Paper plane\n   */\n  Send,\n\n  /**\n   * Phone/Mail icon\n   */\n  Contact,\n\n  /**\n   * Copy to clipboard\n   */\n  Copy,\n\n  /**\n   * A phone handset\n   */\n  Phone,\n\n  /**\n   * A cellphone\n   */\n  CellPhone,\n\n  /**\n   * Chat message\n   */\n  Chat,\n\n  /**\n   * Call icon\n   */\n  Call,\n\n  /**\n   * Call icon, hovered version\n   */\n  CallHovered,\n\n  /**\n   * Confirmation icon\n   */\n  Confirmation,\n  /**\n   * Company department\n   */\n  Department,\n\n  /**\n   *\n   * Dot Icon\n   */\n  Dot,\n\n  /**\n   * Email message\n   */\n  Email,\n\n  /**\n   * Location indicator\n   */\n  OfficeLocation,\n\n  /**\n   * A person\n   */\n  Person,\n\n  /**\n   * Messages\n   */\n  Messages,\n\n  /**\n   * Organization tree\n   */\n  Organization,\n\n  /**\n   * Right facing chevron\n   */\n  ExpandRight,\n\n  /**\n   * Person profile\n   */\n  Profile,\n\n  /**\n   * Balloon\n   */\n  Birthday,\n\n  /**\n   * File icon\n   */\n  File,\n\n  /**\n   * Files icon\n   */\n  Files,\n\n  /**\n   * Back arrow\n   */\n  Back,\n\n  /**\n   * Close icon\n   */\n  Close,\n\n  /**\n   * Upload icon\n   */\n  Upload,\n\n  /**\n   * File Cloud icon\n   */\n  FileCloud,\n\n  /**\n   * Drag File Mouse Icon\n   */\n  DragFile,\n\n  /**\n   *\n   * Cancel icon\n   */\n  Cancel,\n\n  /**\n   *\n   * Checkmark icon\n   *\n   */\n  CheckMark,\n\n  /**\n   *\n   * Radio icon\n   *\n   */\n  Radio,\n\n  /**\n   *\n   * Success icon\n   */\n  Success,\n\n  /**\n   *\n   * Fail icon\n   */\n  Fail,\n\n  /**\n   *\n   * account selection\n   */\n  SelectAccount,\n\n  /**\n   * News\n   */\n  News,\n\n  /**\n   * Bookmark\n   */\n  DoubleBookmark,\n\n  /**\n   * Left chevron\n   */\n  ChevronLeft,\n\n  /**\n   * Right chevron\n   */\n  ChevronRight,\n\n  /**\n   * Event\n   */\n  Event,\n\n  /**\n   * Q&A\n   */\n  BookOpen,\n\n  /**\n   * File outer icon\n   */\n  FileOuter,\n\n  /**\n   * Book question icon\n   */\n  BookQuestion,\n\n  /**\n   * Globe icon\n   */\n  Globe,\n  /**\n   * Delete icon\n   */\n  Delete,\n\n  /**\n   *\n   * Add icon\n   */\n  Add,\n\n  /**\n   *\n   * Calendar icon\n   */\n  Calendar,\n  Planner,\n  Milestone,\n  PersonAdd,\n  PresenceAvailable,\n  PresenceOofAvailable,\n  PresenceBusy,\n  PresenceOofBusy,\n  PresenceDnd,\n  PresenceOofDnd,\n  PresenceAway,\n  PresenceOofAway,\n  PresenceOffline,\n  PresenceStatusUnknown,\n\n  /**\n   * Loading icon\n   */\n  Loading\n}\n\nimport { html } from 'lit';\n\n/**\n * returns an svg\n *\n * @param svgIcon defined by name\n * @param color hex value\n */\nexport const getSvg = (svgIcon: SvgIcon, color?: string) => {\n  switch (svgIcon) {\n    case SvgIcon.ArrowDown:\n      return html`\n        <svg width=\"12\" height=\"12\" viewBox=\"0 0 12 12\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M6 9L2.46447 5.46447H6H9.53553L6 9Z\" />\n        </svg>\n      `;\n\n    case SvgIcon.TeamSeparator:\n      return html`\n        <svg width=\"6\" height=\"10\" viewBox=\"0 0 6 10\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path\n            fill-rule=\"evenodd\"\n            clip-rule=\"evenodd\"\n            d=\"M5.70711 5L1.49999 9.20711L0.792886 8.50001L4.29289 5L0.792887 1.49999L1.49999 0.792885L5.70711 5Z\"\n            fill=${color}\n          />\n        </svg>\n      `;\n\n    case SvgIcon.Search:\n      return html`\n        <svg width=\"12\" height=\"12\" viewBox=\"0 0 12 12\" fill=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M7.30887 8.01596C6.53903 8.63179 5.56252 9.00004 4.5 9.00004C2.01472 9.00004 0 6.98531 0 4.50002C0 2.01473 2.01472 0 4.5 0C6.98528 0 9 2.01473 9 4.50002C9 5.56252 8.63177 6.53901 8.01597 7.30885L11.8536 11.1464C12.0488 11.3417 12.0488 11.6583 11.8536 11.8536C11.6583 12.0488 11.3417 12.0488 11.1464 11.8536L7.30887 8.01596ZM8 4.50002C8 2.56701 6.433 1 4.5 1C2.567 1 1 2.56701 1 4.50002C1 6.43302 2.567 8.00003 4.5 8.00003C6.433 8.00003 8 6.43302 8 4.50002Z\" fill=\"currentColor\"/>\n        </svg>`;\n\n    case SvgIcon.SkypeArrow:\n      return html`\n        <svg viewBox=\"0 0 12 10\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path\n            d=\"M3.95184 0.480534C4.23385 0.10452 4.70926 -0.0724722 5.1685 0.0275755C5.62775 0.127623 5.98645 0.486329 6.0865 0.945575C6.18655 1.40482 6.00956 1.88023 5.63354 2.16224L4.07196 3.72623H10.7988C11.4622 3.72623 12 4.26403 12 4.92744C12 5.59086 11.4622 6.12866 10.7988 6.12866H4.07196L5.63114 7.68784C6.0955 8.15225 6.0955 8.90515 5.63114 9.36955C5.51655 9.48381 5.38119 9.57514 5.23234 9.63862C5.09341 9.69857 4.94399 9.73042 4.79269 9.73232C4.63498 9.73233 4.4789 9.70046 4.33382 9.63862C4.18765 9.57669 4.05593 9.48507 3.94703 9.36955L0.343377 5.7659C-0.114459 5.29881 -0.114459 4.55128 0.343377 4.08419L3.95184 0.480534Z\"\n            fill=\"#B4009E\"\n          />\n        </svg>\n      `;\n\n    case SvgIcon.SmallEmail:\n      return html`\n        <svg width=\"17\" height=\"14\" viewBox=\"0 0 17 14\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path class=\"filled\" d=\"M16 3.373V10.5C16 11.8807 14.8807 13 13.5 13H2.5C1.11929 13 -7.62939e-05 11.8807 -7.62939e-05 10.5V3.373L7.74649 7.93097C7.90297 8.02301 8.09704 8.02301 8.25351 7.93097L16 3.373ZM13.5 0C14.7871 0 15.847 0.972604 15.9848 2.22293L8 6.91991L0.0151832 2.22293C0.15304 0.972604 1.21294 0 2.5 0H13.5Z\" fill=\"currentColor\"/>\n          <path class=\"regular\" d=\"M13.608 0.833496C14.9887 0.833496 16.108 1.95278 16.108 3.3335V11.3335C16.108 12.7142 14.9887 13.8335 13.608 13.8335H2.60803C1.22732 13.8335 0.108032 12.7142 0.108032 11.3335V3.3335C0.108032 1.95278 1.22732 0.833496 2.60803 0.833496H13.608ZM15.108 4.7945L8.36154 8.76446C8.23115 8.84117 8.07464 8.85395 7.93554 8.80281L7.85452 8.76446L1.10803 4.7965V11.3335C1.10803 12.1619 1.77961 12.8335 2.60803 12.8335H13.608C14.4365 12.8335 15.108 12.1619 15.108 11.3335V4.7945ZM13.608 1.8335H2.60803C1.77961 1.8335 1.10803 2.50507 1.10803 3.3335V3.6355L8.10803 7.75341L15.108 3.6345V3.3335C15.108 2.50507 14.4365 1.8335 13.608 1.8335Z\" fill=\"currentColor\"/>\n        </svg>\n      `;\n\n    case SvgIcon.SmallChat:\n      return html`\n        <svg width=\"17\" height=\"17\" viewBox=\"0 0 17 17\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path class=\"filled\" d=\"M8 0C12.4183 0 16 3.58172 16 8C16 12.4183 12.4183 16 8 16C6.72679 16 5.49591 15.7018 4.38669 15.1393L4.266 15.075L0.621091 15.9851C0.311269 16.0625 0.0262241 15.8369 0.00130987 15.5438L0.00114131 15.4624L0.0149329 15.3787L0.925 11.735L0.86169 11.6153C0.406602 10.7186 0.124331 9.74223 0.0327466 8.72826L0.00737596 8.34634L0 8C0 3.58172 3.58172 0 8 0ZM8.5 9H5.5L5.41012 9.00806C5.17688 9.05039 5 9.25454 5 9.5C5 9.74546 5.17688 9.94961 5.41012 9.99194L5.5 10H8.5L8.58988 9.99194C8.82312 9.94961 9 9.74546 9 9.5C9 9.25454 8.82312 9.05039 8.58988 9.00806L8.5 9ZM10.5 6H5.5L5.41012 6.00806C5.17688 6.05039 5 6.25454 5 6.5C5 6.74546 5.17688 6.94961 5.41012 6.99194L5.5 7H10.5L10.5899 6.99194C10.8231 6.94961 11 6.74546 11 6.5C11 6.25454 10.8231 6.05039 10.5899 6.00806L10.5 6Z\" fill=\"currentColor\"/>\n          <path class=\"regular\" d=\"M8.38599 0.833496C12.8043 0.833496 16.386 4.41522 16.386 8.8335C16.386 13.2518 12.8043 16.8335 8.38599 16.8335C7.11277 16.8335 5.8819 16.5353 4.77267 15.9728L4.65199 15.9085L1.00708 16.8186C0.697255 16.8959 0.41221 16.6704 0.387296 16.3773L0.387128 16.2959L0.400919 16.2122L1.31099 12.5685L1.24768 12.4488C0.792589 11.5521 0.510317 10.5757 0.418733 9.56176L0.393362 9.17984L0.385986 8.8335C0.385986 4.41522 3.96771 0.833496 8.38599 0.833496ZM8.38599 1.8335C4.51999 1.8335 1.38599 4.9675 1.38599 8.8335C1.38599 10.0505 1.69653 11.2213 2.27951 12.2584C2.32645 12.3419 2.34809 12.4365 2.34291 12.5308L2.32873 12.6247L1.57299 15.6455L4.59703 14.8918C4.65892 14.8764 4.72261 14.8731 4.78472 14.8814L4.87629 14.9026L4.963 14.941C5.9996 15.5233 7.16969 15.8335 8.38599 15.8335C12.252 15.8335 15.386 12.6995 15.386 8.8335C15.386 4.9675 12.252 1.8335 8.38599 1.8335ZM8.88599 9.8335C9.16213 9.8335 9.38599 10.0574 9.38599 10.3335C9.38599 10.579 9.20911 10.7831 8.97586 10.8254L8.88599 10.8335H5.88599C5.60984 10.8335 5.38599 10.6096 5.38599 10.3335C5.38599 10.088 5.56286 9.88389 5.79611 9.84155L5.88599 9.8335H8.88599ZM10.886 6.8335C11.1621 6.8335 11.386 7.05735 11.386 7.3335C11.386 7.57896 11.2091 7.7831 10.9759 7.82544L10.886 7.8335L5.88599 7.8335C5.60984 7.8335 5.38599 7.60964 5.38599 7.3335C5.38599 7.08804 5.56286 6.88389 5.79611 6.84155L5.88599 6.8335L10.886 6.8335Z\" fill=\"currentColor\"/>\n        </svg>\n      `;\n\n    case SvgIcon.Video:\n      return html`\n        <svg width=\"17\" height=\"13\" viewBox=\"0 0 17 13\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path class=\"filled\" d=\"M11 2.5C11 1.11929 9.88071 0 8.5 0H2.5C1.11929 0 0 1.11929 0 2.5V9.5C0 10.8807 1.11929 12 2.5 12H8.5C9.88071 12 11 10.8807 11 9.5V2.5ZM12 3.93082V8.08149L14.7642 10.4319C15.2512 10.8461 16 10.4999 16 9.86055V2.19315C16 1.55685 15.2575 1.20962 14.7692 1.61756L12 3.93082Z\" fill=\"currentColor\"/>\n          <path class=\"regular\" d=\"M2.72095 0.833496C1.34024 0.833496 0.220947 1.95278 0.220947 3.3335V10.3335C0.220947 11.7142 1.34024 12.8335 2.72095 12.8335H9.72095C11.1017 12.8335 12.2209 11.7142 12.2209 10.3335V9.33348L14.6209 11.1335C15.2802 11.6279 16.2209 11.1575 16.2209 10.3335V3.33348C16.2209 2.50944 15.2802 2.03905 14.6209 2.53348L12.2209 4.33348V3.3335C12.2209 1.95278 11.1017 0.833496 9.72095 0.833496H2.72095ZM12.2209 5.58348L15.2209 3.33348V10.3335L12.2209 8.08348V5.58348ZM11.2209 3.3335V10.3335C11.2209 11.1619 10.5494 11.8335 9.72095 11.8335H2.72095C1.89252 11.8335 1.22095 11.1619 1.22095 10.3335V3.3335C1.22095 2.50507 1.89252 1.8335 2.72095 1.8335H9.72095C10.5494 1.8335 11.2209 2.50507 11.2209 3.3335Z\" fill=\"currentColor\"/>\n        </svg>\n      `;\n\n    case SvgIcon.ExpandDown: {\n      return html`\n        <svg width=\"15\" height=\"8\" viewBox=\"0 0 15 8\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M14 1L7.5 7L1 1\" stroke=\"currentColor\" />\n        </svg>\n      `;\n    }\n\n    case SvgIcon.Overview:\n      return html`\n        <svg width=\"16\" height=\"13\" viewBox=\"0 0 16 13\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M3.5 10.5C2.67157 10.5 2 9.82843 2 9V4C2 3.17157 2.67157 2.5 3.5 2.5H12.5C13.3284 2.5 14 3.17157 14 4V9C14 9.82843 13.3284 10.5 12.5 10.5H3.5ZM3.5 3.5C3.22386 3.5 3 3.72386 3 4V5.5H13V4C13 3.72386 12.7761 3.5 12.5 3.5H3.5ZM5 6.5H3V9C3 9.27614 3.22386 9.5 3.5 9.5H5V6.5ZM6 9.5H12.5C12.7761 9.5 13 9.27614 13 9V6.5H6V9.5ZM0 3C0 1.61929 1.11929 0.5 2.5 0.5H13.5C14.8807 0.5 16 1.61929 16 3V10C16 11.3807 14.8807 12.5 13.5 12.5H2.5C1.11929 12.5 0 11.3807 0 10V3ZM2.5 1.5C1.67157 1.5 1 2.17157 1 3V10C1 10.8284 1.67157 11.5 2.5 11.5H13.5C14.3284 11.5 15 10.8284 15 10V3C15 2.17157 14.3284 1.5 13.5 1.5H2.5Z\" fill=\"#717171\"/>\n        </svg>\n      `;\n\n    case SvgIcon.Send:\n      return html`\n        <svg xmlns=\"http://www.w3.org/2000/svg\">\n          <path\n            d=\"M4.27144 8.99999L1.72572 2.45387C1.54854 1.99826 1.9928 1.56256 2.43227 1.71743L2.50153 1.74688L16.0015 8.49688C16.3902 8.69122 16.4145 9.22336 16.0744 9.45992L16.0015 9.50311L2.50153 16.2531C2.0643 16.4717 1.58932 16.0697 1.70282 15.6178L1.72572 15.5461L4.27144 8.99999L1.72572 2.45387L4.27144 8.99999ZM3.3028 3.4053L5.25954 8.43705L10.2302 8.43749C10.515 8.43749 10.7503 8.64911 10.7876 8.92367L10.7927 8.99999C10.7927 9.28476 10.5811 9.52011 10.3065 9.55736L10.2302 9.56249L5.25954 9.56205L3.3028 14.5947L14.4922 8.99999L3.3028 3.4053Z\"\n          />\n        </svg>\n      `;\n\n    case SvgIcon.Contact:\n      return html`\n        <svg width=\"16\" height=\"12\" viewBox=\"0 0 16 12\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M6 4.5C6 5.32843 5.32843 6 4.5 6C3.67157 6 3 5.32843 3 4.5C3 3.67157 3.67157 3 4.5 3C5.32843 3 6 3.67157 6 4.5ZM2 7.69879C2 7.17479 2.42479 6.75 2.94879 6.75H6.05121C6.57521 6.75 7 7.17479 7 7.69879C7 8.54603 6.42338 9.28454 5.60144 9.49003L5.54243 9.50478C4.85801 9.67589 4.14199 9.67589 3.45757 9.50478L3.39856 9.49003C2.57661 9.28454 2 8.54603 2 7.69879ZM9.5 4C9.22386 4 9 4.22386 9 4.5C9 4.77614 9.22386 5 9.5 5H12.5C12.7761 5 13 4.77614 13 4.5C13 4.22386 12.7761 4 12.5 4H9.5ZM9.5 7C9.22386 7 9 7.22386 9 7.5C9 7.77614 9.22386 8 9.5 8H12.5C12.7761 8 13 7.77614 13 7.5C13 7.22386 12.7761 7 12.5 7H9.5ZM0 1.75C0 0.783502 0.783502 0 1.75 0H14.25C15.2165 0 16 0.783502 16 1.75V10.25C16 11.2165 15.2165 12 14.25 12H1.75C0.783501 12 0 11.2165 0 10.25V1.75ZM1.75 1C1.33579 1 1 1.33579 1 1.75V10.25C1 10.6642 1.33579 11 1.75 11H14.25C14.6642 11 15 10.6642 15 10.25V1.75C15 1.33579 14.6642 1 14.25 1H1.75Z\" fill=\"#717171\"/>\n        </svg>\n      `;\n\n    case SvgIcon.Call:\n      return html`\n        <svg width=\"13\" height=\"17\" viewBox=\"0 0 13 17\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path class=\"filled\" d=\"M3.98706 1.06589C4.89545 0.792081 5.86254 1.19479 6.31418 2.01224L6.38841 2.16075L7.04987 3.63213C7.46246 4.54992 7.28209 5.61908 6.60754 6.3496L6.47529 6.48248L5.43194 7.45541C5.24417 7.63298 5.38512 8.32181 6.06527 9.49986C6.67716 10.5597 7.17487 11.0552 7.41986 11.0823L7.4628 11.082L7.5158 11.0716L9.56651 10.4446C10.1332 10.2713 10.7438 10.4487 11.1298 10.8865L11.2215 11.0014L12.5781 12.8815C13.1299 13.6462 13.0689 14.6842 12.4533 15.378L12.3314 15.5039L11.7886 16.018C10.7948 16.9592 9.34348 17.2346 8.07389 16.7231C6.13867 15.9433 4.38077 14.1607 2.78368 11.3945C1.18323 8.62242 0.519004 6.20438 0.815977 4.13565C0.99977 2.85539 1.87301 1.78674 3.07748 1.3462L3.27036 1.28192L3.98706 1.06589Z\" fill=\"currentColor\"/>\n          <path class=\"regular\" d=\"M3.9292 0.399388L3.2125 0.615419C1.90898 1.00834 0.951582 2.1215 0.758116 3.46915C0.461142 5.53787 1.12537 7.95591 2.72582 10.728C4.32291 13.4942 6.0808 15.2768 8.01603 16.0565C9.28562 16.5681 10.7369 16.2927 11.7308 15.3515L12.2736 14.8374C13.0011 14.1485 13.1065 13.0275 12.5202 12.215L11.1636 10.3349C10.788 9.81423 10.1226 9.59039 9.50865 9.7781L7.45794 10.4051L7.40494 10.4154C7.17877 10.4485 6.65754 9.95942 6.00741 8.83335C5.32726 7.65531 5.1863 6.96648 5.37408 6.7889L6.41743 5.81598C7.19937 5.08681 7.43039 3.94078 6.99201 2.96562L6.33055 1.49424C5.91866 0.578005 4.89102 0.109471 3.9292 0.399388ZM5.41847 1.90427L6.07993 3.37564C6.34277 3.96031 6.20426 4.64744 5.73543 5.08463L4.68953 6.05994C4.02044 6.69268 4.24206 7.77567 5.14138 9.33335C5.98759 10.799 6.75958 11.5233 7.58908 11.3977L7.71341 11.3711L9.80102 10.7344C10.0057 10.6718 10.2275 10.7464 10.3527 10.92L11.7093 12.8001C12.0024 13.2064 11.9497 13.7669 11.586 14.1113L11.0432 14.6254C10.3333 15.2977 9.29663 15.4944 8.38977 15.129C6.6917 14.4448 5.08689 12.8175 3.59185 10.228C2.09375 7.63319 1.48745 5.42604 1.74797 3.61125C1.88616 2.64864 2.57001 1.85352 3.5011 1.57287L4.2178 1.35684C4.69871 1.21188 5.21253 1.44615 5.41847 1.90427Z\" fill=\"currentColor\"/>\n        </svg>\n      `;\n\n    case SvgIcon.Confirmation:\n      return html`\n      <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path d=\"M7.03212 13.9072L3.56056 10.0017C3.28538 9.69214 2.81132 9.66425 2.50174 9.93944C2.19215 10.2146 2.16426 10.6887 2.43945 10.9983L6.43945 15.4983C6.72614 15.8208 7.2252 15.8355 7.53034 15.5303L18.0303 5.03033C18.3232 4.73744 18.3232 4.26256 18.0303 3.96967C17.7374 3.67678 17.2626 3.67678 16.9697 3.96967L7.03212 13.9072Z\" fill=\"#009E00\"/>\n      </svg>\n      `;\n\n    case SvgIcon.Copy:\n      return html`\n        <svg width=\"13\" height=\"14\" viewBox=\"0 0 13 14\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path\n            d=\"M12.625 5.50293V14H3.875V11.375H0.375V0H6.24707L8.87207 2.625H9.74707L12.625 5.50293ZM10 5.25H11.1279L10 4.12207V5.25ZM3.875 2.625H7.62793L5.87793 0.875H1.25V10.5H3.875V2.625ZM11.75 6.125H9.125V3.5H4.75V13.125H11.75V6.125Z\"\n          />\n        </svg>\n      `;\n\n    case SvgIcon.Phone:\n      return html`\n        <svg width=\"15\" height=\"15\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 2048 2048\" fill=\"none\">\n            <path d=\"M1607 1213q44 0 84 16t72 48l220 220q31 31 47 71t17 85q0 44-16 84t-48 72l-14 14q-54 54-99 96t-94 70-109 44-143 15q-125 0-257-39t-262-108-256-164-237-207-206-238-162-256T38 775 0 523q0-83 14-142t43-108 70-93 96-99l16-16q31-31 71-48t85-17q44 0 84 17t72 48l220 220q31 31 47 71t17 85q0 44-15 78t-37 63-48 51-49 45-37 44-15 49q0 38 27 65l551 551q27 27 65 27 26 0 48-15t45-37 45-48 51-49 62-37 79-15zm-83 707q72 0 120-13t88-39 76-64 85-86q27-27 27-65 0-18-14-42t-38-52-51-55-56-54-51-47-37-35q-27-27-66-27-26 0-48 15t-44 37-45 48-52 49-62 37-79 15q-44 0-84-16t-72-48L570 927q-31-31-47-71t-17-85q0-44 15-78t37-63 48-51 49-46 37-44 15-48q0-39-27-66-13-13-34-36t-47-51-54-56-56-52-51-37-43-15q-38 0-65 27l-85 85q-37 37-64 76t-40 87-14 120q0 112 36 231t101 238 153 234 192 219 219 190 234 150 236 99 226 36z\" fill=\"${color}\"></path>\n        </svg>\n      `;\n\n    case SvgIcon.CellPhone:\n      return html`\n        <svg width=\"10\" height=\"16\" viewBox=\"0 0 10 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M4 12C3.72386 12 3.5 12.2239 3.5 12.5C3.5 12.7761 3.72386 13 4 13H6C6.27614 13 6.5 12.7761 6.5 12.5C6.5 12.2239 6.27614 12 6 12H4ZM2 0C0.89543 0 0 0.895431 0 2V14C0 15.1046 0.895431 16 2 16H8C9.10457 16 10 15.1046 10 14V2C10 0.89543 9.10457 0 8 0H2ZM1 2C1 1.44772 1.44772 1 2 1H8C8.55228 1 9 1.44772 9 2V14C9 14.5523 8.55228 15 8 15H2C1.44772 15 1 14.5523 1 14V2Z\" fill=\"#717171\"/>\n        </svg>\n      `;\n\n    case SvgIcon.Chat:\n      return html`\n        <svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M8 0C12.4183 0 16 3.58172 16 8C16 12.4183 12.4183 16 8 16C6.72679 16 5.49591 15.7018 4.38669 15.1393L4.266 15.075L0.621091 15.9851C0.311269 16.0625 0.0262241 15.8369 0.00130987 15.5438L0.00114131 15.4624L0.0149329 15.3787L0.925 11.735L0.86169 11.6153C0.406602 10.7186 0.124331 9.74223 0.0327466 8.72826L0.00737596 8.34634L0 8C0 3.58172 3.58172 0 8 0ZM8 1C4.13401 1 1 4.13401 1 8C1 9.21704 1.31054 10.3878 1.89352 11.4249C1.94046 11.5084 1.9621 11.603 1.95692 11.6973L1.94274 11.7912L1.187 14.812L4.21104 14.0583C4.27294 14.0429 4.33662 14.0396 4.39873 14.0479L4.4903 14.0691L4.57701 14.1075C5.61362 14.6898 6.7837 15 8 15C11.866 15 15 11.866 15 8C15 4.13401 11.866 1 8 1ZM8.5 9C8.77614 9 9 9.22386 9 9.5C9 9.74546 8.82312 9.94961 8.58988 9.99194L8.5 10H5.5C5.22386 10 5 9.77614 5 9.5C5 9.25454 5.17688 9.05039 5.41012 9.00806L5.5 9H8.5ZM10.5 6C10.7761 6 11 6.22386 11 6.5C11 6.74546 10.8231 6.94961 10.5899 6.99194L10.5 7L5.5 7C5.22386 7 5 6.77614 5 6.5C5 6.25454 5.17688 6.05039 5.41012 6.00806L5.5 6L10.5 6Z\" fill=\"#717171\"/>\n        </svg>\n      `;\n\n    case SvgIcon.Department:\n      return html`\n        <svg width=\"17\" height=\"14\" viewBox=\"0 0 17 14\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M4 1.5V3H2C0.895431 3 0 3.89543 0 5V12C0 13.1046 0.895432 14 2 14H14.0026C15.1071 14 16.0026 13.1046 16.0026 12V5C16.0026 3.89543 15.1071 3 14.0026 3H12V1.5C12 0.671573 11.3284 0 10.5 0H5.5C4.67157 0 4 0.671573 4 1.5ZM5.5 1H10.5C10.7761 1 11 1.22386 11 1.5V3H5V1.5C5 1.22386 5.22386 1 5.5 1ZM2 4H14.0026C14.5549 4 15.0026 4.44772 15.0026 5V7H12L12 6.50073C12 6.22459 11.7761 6.00073 11.5 6.00073C11.2239 6.00073 11 6.22459 11 6.50074L11 7H5V6.50073C5 6.22459 4.77614 6.00073 4.5 6.00073C4.22386 6.00073 4 6.22459 4 6.50073V7H1V5C1 4.44772 1.44772 4 2 4ZM11 8L11 8.5C11 8.77615 11.2239 9 11.5 9C11.7762 9 12 8.77614 12 8.5L12 8H15.0026V12C15.0026 12.5523 14.5549 13 14.0026 13H2C1.44772 13 1 12.5523 1 12V8H4V8.5C4 8.77614 4.22386 9 4.5 9C4.77614 9 5 8.77614 5 8.5V8H11Z\" fill=\"#717171\"/>\n        </svg>\n      `;\n\n    case SvgIcon.Dot:\n      return html`\n        <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M6.25 10C6.25 10.6904 5.69036 11.25 5 11.25C4.30964 11.25 3.75 10.6904 3.75 10C3.75 9.30964 4.30964 8.75 5 8.75C5.69036 8.75 6.25 9.30964 6.25 10ZM11.25 10C11.25 10.6904 10.6904 11.25 10 11.25C9.30964 11.25 8.75 10.6904 8.75 10C8.75 9.30964 9.30964 8.75 10 8.75C10.6904 8.75 11.25 9.30964 11.25 10ZM15 11.25C15.6904 11.25 16.25 10.6904 16.25 10C16.25 9.30964 15.6904 8.75 15 8.75C14.3096 8.75 13.75 9.30964 13.75 10C13.75 10.6904 14.3096 11.25 15 11.25Z\" fill=\"#242424\"/>\n        </svg>\n        `;\n\n    case SvgIcon.Email:\n      return html`\n        <svg width=\"16\" height=\"13\" viewBox=\"0 0 16 13\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M13.5 0C14.8807 0 16 1.11929 16 2.5V10.5C16 11.8807 14.8807 13 13.5 13H2.5C1.11929 13 0 11.8807 0 10.5V2.5C0 1.11929 1.11929 0 2.5 0H13.5ZM15 3.961L8.25351 7.93097C8.12311 8.00767 7.96661 8.02045 7.82751 7.96932L7.74649 7.93097L1 3.963V10.5C1 11.3284 1.67157 12 2.5 12H13.5C14.3284 12 15 11.3284 15 10.5V3.961ZM13.5 1H2.5C1.67157 1 1 1.67157 1 2.5V2.802L8 6.91991L15 2.801V2.5C15 1.67157 14.3284 1 13.5 1Z\" fill=\"#717171\"/>\n        </svg>\n      `;\n\n    case SvgIcon.OfficeLocation:\n      return html`\n        <svg width=\"14\" height=\"16\" viewBox=\"0 0 14 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <title>Location icon</title>\n          <path d=\"M10 7C10 8.65685 8.65685 10 7 10C5.34315 10 4 8.65685 4 7C4 5.34315 5.34315 4 7 4C8.65685 4 10 5.34315 10 7ZM9 7C9 5.89543 8.10457 5 7 5C5.89543 5 5 5.89543 5 7C5 8.10457 5.89543 9 7 9C8.10457 9 9 8.10457 9 7ZM11.9497 11.955C14.6834 9.2201 14.6834 4.78601 11.9497 2.05115C9.21608 -0.683716 4.78392 -0.683716 2.05025 2.05115C-0.683418 4.78601 -0.683418 9.2201 2.05025 11.955L3.57128 13.4538L5.61408 15.4389L5.74691 15.5567C6.52168 16.1847 7.65623 16.1455 8.38611 15.4391L10.8223 13.0691L11.9497 11.955ZM2.75499 2.75619C5.09944 0.410715 8.90055 0.410715 11.245 2.75619C13.5294 5.04153 13.5879 8.71039 11.4207 11.0667L11.245 11.2499L9.92371 12.5539L7.69315 14.7225L7.60016 14.8021C7.24594 15.0699 6.7543 15.0698 6.40012 14.802L6.30713 14.7224L3.3263 11.817L2.75499 11.2499L2.57927 11.0667C0.412077 8.71039 0.47065 5.04153 2.75499 2.75619Z\" fill=\"#717171\"/>\n        </svg>\n      `;\n\n    case SvgIcon.Birthday:\n      return html`\n        <svg width=\"14\" height=\"13\" viewBox=\"0 0 14 13\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M5.81357 0.667333C6.07581 0.320242 6.48151 0 7 0C7.51849 0 7.92419 0.320242 8.18643 0.667333C8.45471 1.0224 8.63508 1.47991 8.69561 1.93392C8.75552 2.3832 8.70532 2.89341 8.42852 3.3086C8.134 3.75039 7.63965 4 7 4C6.36035 4 5.866 3.75039 5.57148 3.3086C5.29468 2.89341 5.24448 2.3832 5.30439 1.93392C5.36492 1.47991 5.54529 1.0224 5.81357 0.667333ZM6.40353 2.7539C6.484 2.87461 6.63965 3 7 3C7.36035 3 7.516 2.87461 7.59647 2.7539C7.69468 2.60659 7.74448 2.3668 7.70439 2.06608C7.66492 1.77009 7.54529 1.4776 7.38857 1.27017C7.22581 1.05476 7.08151 1 7 1C6.91849 1 6.77419 1.05476 6.61143 1.27017C6.45471 1.4776 6.33508 1.77009 6.29561 2.06608C6.25552 2.3668 6.30532 2.60659 6.40353 2.7539ZM1 7C1 5.89543 1.89543 5 3 5H11C12.1046 5 13 5.89543 13 7V12H13.5C13.7761 12 14 12.2239 14 12.5C14 12.7761 13.7761 13 13.5 13H0.5C0.223858 13 0 12.7761 0 12.5C0 12.2239 0.223858 12 0.5 12H1V7ZM2 12H12V9.01931C11.9109 9.10285 11.8174 9.18842 11.7208 9.27412C11.4006 9.55804 11.0346 9.85319 10.6715 10.0802C10.3274 10.2953 9.90815 10.5 9.5 10.5C8.77182 10.5 8.30806 9.98986 8.00471 9.65617C7.9834 9.63273 7.96289 9.61016 7.94312 9.58869C7.5876 9.20261 7.35769 9 7 9C6.64231 9 6.4124 9.20261 6.05688 9.58869C6.03711 9.61016 6.0166 9.63273 5.99529 9.65617C5.69194 9.98986 5.22818 10.5 4.5 10.5C4.10587 10.5 3.69263 10.2897 3.35907 10.0789C3.00198 9.85313 2.63516 9.55951 2.31117 9.27666C2.20329 9.18247 2.09896 9.08844 2 8.9971V12ZM2 7.59993C2.05039 7.65198 2.11363 7.71652 2.1873 7.7902C2.38843 7.99132 2.6649 8.25801 2.96883 8.52334C3.27484 8.79049 3.59802 9.04687 3.89343 9.23362C4.21237 9.43525 4.41413 9.5 4.5 9.5C4.75817 9.5 4.93171 9.33433 5.32125 8.91131L5.32447 8.90781C5.65956 8.5439 6.16039 8 7 8C7.83961 8 8.34044 8.5439 8.67553 8.90781L8.67875 8.91131C9.06828 9.33433 9.24183 9.5 9.5 9.5C9.6106 9.5 9.82569 9.42967 10.1414 9.23229C10.4381 9.04681 10.7573 8.79196 11.0573 8.52588C11.3554 8.26163 11.6238 7.99594 11.8184 7.7955C11.89 7.72165 11.9513 7.65703 12 7.60506V7C12 6.44772 11.5523 6 11 6H3C2.44772 6 2 6.44772 2 7V7.59993Z\" fill=\"#717171\"/>\n        </svg>\n      `;\n\n    case SvgIcon.Person:\n      return html`\n        <svg width=\"14\" height=\"16\" viewBox=\"0 0 14 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M7 0C4.79086 0 3 1.79086 3 4C3 6.20914 4.79086 8 7 8C9.20914 8 11 6.20914 11 4C11 1.79086 9.20914 0 7 0ZM4 4C4 2.34315 5.34315 1 7 1C8.65685 1 10 2.34315 10 4C10 5.65685 8.65685 7 7 7C5.34315 7 4 5.65685 4 4ZM2.00873 9C0.903151 9 0 9.88687 0 11C0 12.6912 0.83281 13.9663 2.13499 14.7966C3.41697 15.614 5.14526 16 7 16C8.85474 16 10.583 15.614 11.865 14.7966C13.1672 13.9663 14 12.6912 14 11C14 9.89557 13.1045 9.00001 12 9.00001L2.00873 9ZM1 11C1 10.4467 1.44786 10 2.00873 10L12 10C12.5522 10 13 10.4478 13 11C13 12.3088 12.3777 13.2837 11.3274 13.9534C10.2568 14.636 8.73511 15 7 15C5.26489 15 3.74318 14.636 2.67262 13.9534C1.62226 13.2837 1 12.3088 1 11Z\" fill=\"#717171\"/>\n        </svg>\n      `;\n\n    case SvgIcon.Messages:\n      return html`\n        <svg width=\"16\" height=\"13\" viewBox=\"0 0 16 13\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M13.5 0C14.8807 0 16 1.11929 16 2.5V10.5C16 11.8807 14.8807 13 13.5 13H2.5C1.11929 13 0 11.8807 0 10.5V2.5C0 1.11929 1.11929 0 2.5 0H13.5ZM15 3.961L8.25351 7.93097C8.12311 8.00767 7.96661 8.02045 7.82751 7.96932L7.74649 7.93097L1 3.963V10.5C1 11.3284 1.67157 12 2.5 12H13.5C14.3284 12 15 11.3284 15 10.5V3.961ZM13.5 1H2.5C1.67157 1 1 1.67157 1 2.5V2.802L8 6.91991L15 2.801V2.5C15 1.67157 14.3284 1 13.5 1Z\" fill=\"#717171\"/>\n        </svg>\n      `;\n\n    case SvgIcon.Organization:\n      return html`\n        <svg width=\"16\" height=\"17\" viewBox=\"0 0 16 17\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M7.99992 0C6.34271 0 4.99927 1.34344 4.99927 3.00066C4.99927 4.48754 6.08073 5.72183 7.49999 5.95985V7.5H4.5C3.67157 7.5 3 8.17157 3 9V10.0416C1.5811 10.2799 0.5 11.514 0.5 13.0007C0.5 14.6579 1.84344 16.0013 3.50066 16.0013C5.15787 16.0013 6.50131 14.6579 6.50131 13.0007C6.50131 11.5136 5.41954 10.2791 4 10.0414V9C4 8.72386 4.22386 8.5 4.5 8.5H11.5C11.7761 8.5 12 8.72386 12 9V10.0416C10.5811 10.2799 9.5 11.514 9.5 13.0007C9.5 14.6579 10.8434 16.0013 12.5007 16.0013C14.1579 16.0013 15.5013 14.6579 15.5013 13.0007C15.5013 11.5136 14.4195 10.2791 13 10.0414V9C13 8.17157 12.3284 7.5 11.5 7.5H8.49999V5.95983C9.91918 5.72176 11.0006 4.48749 11.0006 3.00066C11.0006 1.34344 9.65714 0 7.99992 0ZM5.99927 3.00066C5.99927 1.89572 6.89499 1 7.99992 1C9.10485 1 10.0006 1.89572 10.0006 3.00066C10.0006 4.10559 9.10485 5.00131 7.99992 5.00131C6.89499 5.00131 5.99927 4.10559 5.99927 3.00066ZM1.5 13.0007C1.5 11.8957 2.39572 11 3.50066 11C4.60559 11 5.50131 11.8957 5.50131 13.0007C5.50131 14.1056 4.60559 15.0013 3.50066 15.0013C2.39572 15.0013 1.5 14.1056 1.5 13.0007ZM12.5007 11C13.6056 11 14.5013 11.8957 14.5013 13.0007C14.5013 14.1056 13.6056 15.0013 12.5007 15.0013C11.3957 15.0013 10.5 14.1056 10.5 13.0007C10.5 11.8957 11.3957 11 12.5007 11Z\" fill=\"#717171\"/>\n        </svg>\n      `;\n\n    case SvgIcon.ExpandRight:\n      return html`\n        <svg width=\"8\" height=\"13\" viewBox=\"0 0 8 13\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M1 12L6.5 6.5L1 1\" stroke=\"#B8B8B8\" stroke-width=\"2\" />\n        </svg>\n      `;\n\n    case SvgIcon.Profile:\n      return html`\n        <svg width=\"14\" height=\"16\" viewBox=\"0 0 14 16\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M7 0C4.79086 0 3 1.79086 3 4C3 6.20914 4.79086 8 7 8C9.20914 8 11 6.20914 11 4C11 1.79086 9.20914 0 7 0ZM4 4C4 2.34315 5.34315 1 7 1C8.65685 1 10 2.34315 10 4C10 5.65685 8.65685 7 7 7C5.34315 7 4 5.65685 4 4ZM2.00873 9C0.903151 9 0 9.88687 0 11C0 12.6912 0.83281 13.9663 2.13499 14.7966C3.41697 15.614 5.14526 16 7 16C8.85474 16 10.583 15.614 11.865 14.7966C13.1672 13.9663 14 12.6912 14 11C14 9.89557 13.1045 9.00001 12 9.00001L2.00873 9ZM1 11C1 10.4467 1.44786 10 2.00873 10L12 10C12.5522 10 13 10.4478 13 11C13 12.3088 12.3777 13.2837 11.3274 13.9534C10.2568 14.636 8.73511 15 7 15C5.26489 15 3.74318 14.636 2.67262 13.9534C1.62226 13.2837 1 12.3088 1 11Z\" fill=\"#717171\"/>\n        </svg>\n      `;\n\n    case SvgIcon.File:\n      return html`\n        <svg width=\"28\" height=\"28\" viewBox=\"0 0 20 28\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path\n            opacity=\"0.64\"\n            d=\"M19.613 6.993L13.018 0.421C12.7473 0.15221 12.3815 0.000947397 12 0H1.4C0.628 0 0 0.615 0 1.372V24.642C0 25.391 0.622 26 1.386 26H18.6C19.372 26 20 25.385 20 24.628V7.923C20 7.577 19.86 7.237 19.613 6.993Z\"\n            fill=\"#605E5C\"\n          />\n          <path\n            d=\"M19 24.628C19 24.83 18.816 25 18.6 25H1.386C1.173 25 1 24.84 1 24.642V1.372C1 1.17 1.184 1 1.4 1H12V6.6C12 7.372 12.628 8 13.4 8H19V24.628Z\"\n            fill=\"white\"\n          />\n          <path d=\"M18.204 6.99994L13 1.81494V6.59994C13 6.81994 13.18 6.99994 13.4 6.99994H18.204Z\" fill=\"white\" />\n        </svg>\n      `;\n\n    case SvgIcon.Files:\n      return html`\n        <svg width=\"17\" height=\"15\" viewBox=\"0 0 17 15\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M14.9956 4.07309V4C14.9956 2.61929 13.8763 1.5 12.4956 1.5H7.66418L6.06391 0.299946C5.80428 0.105247 5.48851 0 5.16399 0H2.5C1.11916 0 -0.000181445 1.11949 2.20615e-08 2.50033L0.0011832 11.4978C0.00135142 12.7772 0.962583 13.8321 2.2023 13.9798C2.2867 13.9945 2.37375 14.0021 2.46289 14.0021H13.1798C13.8981 14.0021 14.5156 13.4929 14.6524 12.7877L16.0097 5.78769C16.1587 5.01967 15.696 4.29703 14.9956 4.07309ZM2.5 1H5.16399C5.27216 1 5.37742 1.03508 5.46396 1.09998L7.19756 2.40002C7.2841 2.46492 7.38936 2.5 7.49753 2.5H12.4956C13.324 2.5 13.9956 3.17157 13.9956 4V4.00214H3.824C3.10596 4.00214 2.48863 4.511 2.35158 5.21583L1.05351 11.8916C1.01941 11.7661 1.0012 11.634 1.00118 11.4976L1 2.5002C0.999891 1.67169 1.6715 1 2.5 1ZM3.33319 5.4067C3.37888 5.17176 3.58465 5.00214 3.824 5.00214H14.5372C14.8515 5.00214 15.0879 5.28874 15.028 5.59732L13.6706 12.5973C13.6251 12.8324 13.4192 13.0021 13.1798 13.0021H2.46289C2.14845 13.0021 1.91206 12.7154 1.97208 12.4067L3.33319 5.4067Z\" fill=\"#717171\"/>\n        </svg>\n      `;\n\n    case SvgIcon.Back:\n      return html`\n        <svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path\n            d=\"M16 8.5H1.95312L8.10156 14.6484L7.39844 15.3516L0.046875 8L7.39844 0.648438L8.10156 1.35156L1.95312 7.5H16V8.5Z\"\n          />\n        </svg>\n      `;\n\n    case SvgIcon.Close:\n      return html`\n        <svg width=\"10\" height=\"10\" viewBox=\"0 0 10 10\" fill=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M5.73838 5.032L9.70337 1.067L8.99638 0.360001L5.03137 4.325L1.06637 0.360001L0.359375 1.067L4.32438 5.032L0.359375 8.997L1.06637 9.704L5.03137 5.739L8.99638 9.704L9.70337 8.997L5.73838 5.032Z\" fill=\"currentColor\"/>\n        </svg>\n     `;\n    case SvgIcon.Upload:\n      return html`\n        <svg class=\"upload-icon\" width=\"21\" height=\"12\" viewBox=\"0 0 20 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M4.5 2C4.08579 2 3.75 2.33579 3.75 2.75C3.75 3.16421 4.08579 3.5 4.5 3.5H15C15.4142 3.5 15.75 3.16421 15.75 2.75C15.75 2.33579 15.4142 2 15 2H4.5ZM10.4963 17.3493C10.4466 17.7154 10.1328 17.9976 9.75311 17.9976C9.3389 17.9976 9.00311 17.6618 9.00311 17.2476L9.00249 7.05856L6.02995 10.026L5.94578 10.0986C5.65202 10.3162 5.23537 10.2917 4.96929 10.0253C4.67661 9.73215 4.67695 9.25728 4.97005 8.96459L9.25962 4.67989C9.33377 4.61512 9.42089 4.56485 9.5169 4.53385L9.59777 4.51072C9.64749 4.50019 9.69837 4.4947 9.74849 4.4947L9.80855 4.49661L9.87781 4.50451L9.99828 4.53462L10.0895 4.57254L10.1259 4.59371L10.2169 4.6523L10.2875 4.71481L14.5303 8.96546L14.6029 9.04964C14.8205 9.34345 14.7959 9.7601 14.5294 10.0261L14.4452 10.0987C14.1514 10.3162 13.7347 10.2917 13.4687 10.0251L10.5025 7.05456L10.5031 17.2476L10.4963 17.3493Z\" fill=\"#ffffff\"/>\n        </svg>\n      `;\n\n    case SvgIcon.FileCloud:\n      return html`\n        <svg width=\"16\" height=\"16\"  xmlns=\"http://www.w3.org/2000/svg\">\n          <path\n            d=\"m8,0c2.8166,0 4.4145,1.9233 4.6469,4.246l0.071,0c1.8127,0 3.2821,1.5119 3.2821,3.377c0,0.0953 -0.0038,0.1897 -0.0114,0.283c-0.322,-0.4017 -0.6967,-0.7591 -1.1138,-1.062c-0.3104,-0.9329 -1.1627,-1.598 -2.1568,-1.598l-0.0711,0c-0.5137,0 -0.9439,-0.3893 -0.9951,-0.9005c-0.2021,-2.0206 -1.5433,-3.3455 -3.6518,-3.3455c-2.1139,0 -3.4489,1.3159 -3.6518,3.3455c-0.0511,0.5112 -0.4813,0.9005 -0.9951,0.9005l-0.071,0c-1.2539,0 -2.2821,1.0579 -2.2821,2.377c0,1.3191 1.0282,2.377 2.2821,2.377l2.6655,0c-0.087,0.323 -0.1466,0.6572 -0.1762,1l-2.4893,0c-1.8127,0 -3.2821,-1.5119 -3.2821,-3.377c0,-1.8029 1.3731,-3.2758 3.102,-3.372l0.2511,-0.005c0.2338,-2.338 1.8303,-4.246 4.6469,-4.246zm3.5,16c2.4853,0 4.5,-2.0147 4.5,-4.5c0,-2.4853 -2.0147,-4.5 -4.5,-4.5c-2.4853,0 -4.5,2.0147 -4.5,4.5c0,2.4853 2.0147,4.5 4.5,4.5zm0,-7c0.2761,0 0.5,0.2239 0.5,0.5l0,1.5l1.5,0c0.2761,0 0.5,0.2239 0.5,0.5c0,0.2761 -0.2239,0.5 -0.5,0.5l-1.5,0l0,1.5c0,0.2761 -0.2239,0.5 -0.5,0.5c-0.2761,0 -0.5,-0.2239 -0.5,-0.5l0,-1.5l-1.5,0c-0.2761,0 -0.5,-0.2239 -0.5,-0.5c0,-0.2761 0.2239,-0.5 0.5,-0.5l1.5,0l0,-1.5c0,-0.2761 0.2239,-0.5 0.5,-0.5z\" fill=\"#0078D4\"\n          />\n        </svg>\n      `;\n\n    case SvgIcon.DragFile:\n      return html`\n        <svg width=\"13\" height=\"16\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path\n            d=\"m0,1.00189c0,-0.8451 0.983,-1.3091 1.636,-0.772l11.006,9.0622c0.724,0.5964 0.302,1.772 -0.636,1.772l-5.592,0c-0.435,0 -0.849,0.1892 -1.134,0.5185l-3.524,4.0725c-0.606,0.7003 -1.756,0.2717 -1.756,-0.6544l0,-13.9988zm12.006,9.0622l-11.006,-9.0622l0,13.9988l3.524,-4.0724c0.475,-0.5488 1.164,-0.8642 1.89,-0.8642l5.592,0z\"\n          />\n        </svg>\n      `;\n\n    case SvgIcon.Cancel:\n      return html`\n        <svg width=\"11\" height=\"11\" viewBox=\"0 0 11 11\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M0.588591 0.715694L0.646447 0.646447C0.820013 0.47288 1.08944 0.453595 1.28431 0.588591L1.35355 0.646447L6 5.293L10.6464 0.646447C10.8417 0.451185 11.1583 0.451185 11.3536 0.646447C11.5488 0.841709 11.5488 1.15829 11.3536 1.35355L6.707 6L11.3536 10.6464C11.5271 10.82 11.5464 11.0894 11.4114 11.2843L11.3536 11.3536C11.18 11.5271 10.9106 11.5464 10.7157 11.4114L10.6464 11.3536L6 6.707L1.35355 11.3536C1.15829 11.5488 0.841709 11.5488 0.646447 11.3536C0.451185 11.1583 0.451185 10.8417 0.646447 10.6464L5.293 6L0.646447 1.35355C0.47288 1.17999 0.453595 0.910563 0.588591 0.715694L0.646447 0.646447L0.588591 0.715694Z\" fill=\"currentColor\"/>\n        </svg>\n     `;\n\n    case SvgIcon.Success:\n      return html`\n        <svg width=\"12\" height=\"12\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path fill=\"#009E00\" d=\"m6.322,12c3.492,0 6.323,-2.6863 6.323,-6c0,-3.3137 -2.831,-6 -6.323,-6c-3.491,0 -6.322,2.6863 -6.322,6c0,3.3137 2.831,6 6.322,6z\"/>\n          <path fill=\"white\" d=\"m9.629,3.7509c-0.131,-0.125 -0.31,-0.1952 -0.496,-0.1952c-0.187,0 -0.365,0.0702 -0.497,0.1952l-3.267,3.1l-1.393,-1.3222c-0.177,-0.1695 -0.436,-0.2361 -0.68,-0.1746c-0.243,0.0615 -0.433,0.2418 -0.497,0.4725c-0.065,0.2307 0.005,0.4767 0.184,0.6449l1.807,1.7154c0.019,0.0331 0.041,0.0646 0.066,0.094c0.289,0.2562 0.738,0.2562 1.027,0c0.024,-0.0294 0.047,-0.0609 0.065,-0.0941l3.681,-3.4931c0.275,-0.2603 0.275,-0.6824 0,-0.9428z\"/>\n        </svg>\n      `;\n\n    case SvgIcon.CheckMark:\n      return html`\n      <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path class=\"filled\" d=\"M10 0C15.5228 0 20 4.47715 20 10C20 15.5228 15.5228 20 10 20C4.47715 20 0 15.5228 0 10C0 4.47715 4.47715 0 10 0ZM13.2197 6.96967L8.75 11.4393L6.78033 9.46967C6.48744 9.17678 6.01256 9.17678 5.71967 9.46967C5.42678 9.76256 5.42678 10.2374 5.71967 10.5303L8.21967 13.0303C8.51256 13.3232 8.98744 13.3232 9.28033 13.0303L14.2803 8.03033C14.5732 7.73744 14.5732 7.26256 14.2803 6.96967C13.9874 6.67678 13.5126 6.67678 13.2197 6.96967Z\" fill=\"currentColor\"/>\n        <path class=\"regular\" d=\"M10 1.5C5.30558 1.5 1.5 5.30558 1.5 10C1.5 14.6944 5.30558 18.5 10 18.5C14.6944 18.5 18.5 14.6944 18.5 10C18.5 5.30558 14.6944 1.5 10 1.5ZM0 10C0 4.47715 4.47715 0 10 0C15.5228 0 20 4.47715 20 10C20 15.5228 15.5228 20 10 20C4.47715 20 0 15.5228 0 10Z\" fill=\"currentColor\"/>\n      </svg>\n      `;\n\n    case SvgIcon.Radio:\n      return html`\n      <svg width=\"66\" height=\"20\" viewBox=\"0 0 66 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n        <rect x=\"0.5\" y=\"0.5\" width=\"19\" height=\"19\" rx=\"9.5\" fill=\"#F3F3F3\"/>\n        <rect x=\"0.5\" y=\"0.5\" width=\"19\" height=\"19\" rx=\"9.5\" stroke=\"#636363\"/>\n        <path d=\"M36.5596 16H35.1924L33.5107 13.2178C33.1963 12.6982 32.9274 12.3656 32.7041 12.2197C32.4808 12.0693 32.2096 11.9941 31.8906 11.9941H30.7627V16H29.6143V6.19727H32.54C33.3923 6.19727 34.1009 6.42285 34.666 6.87402C35.2357 7.3252 35.5205 7.99056 35.5205 8.87012C35.5205 9.56283 35.3405 10.1439 34.9805 10.6133C34.6204 11.0827 34.126 11.4222 33.4971 11.6318V11.6592C33.7021 11.7822 33.8822 11.9167 34.0371 12.0625C34.1921 12.2083 34.3561 12.4225 34.5293 12.7051L36.5596 16ZM30.7627 7.23633V10.9551H32.3213C32.891 10.9551 33.3649 10.7705 33.7432 10.4014C34.126 10.0322 34.3174 9.55371 34.3174 8.96582C34.3174 8.44173 34.1465 8.02246 33.8047 7.70801C33.4674 7.39355 32.9775 7.23633 32.335 7.23633H30.7627ZM42.8008 16H41.6797V14.9062H41.6523C41.4108 15.3255 41.1123 15.64 40.7568 15.8496C40.4059 16.0592 39.9958 16.1641 39.5264 16.1641C38.8701 16.1641 38.3392 15.9727 37.9336 15.5898C37.528 15.207 37.3252 14.6989 37.3252 14.0654C37.3252 13.4684 37.5303 12.974 37.9404 12.582C38.3506 12.1901 38.9316 11.9395 39.6836 11.8301L41.6797 11.5635V11.4062C41.6797 10.8184 41.543 10.4014 41.2695 10.1553C40.9961 9.90462 40.6315 9.7793 40.1758 9.7793C39.8112 9.7793 39.4603 9.84766 39.123 9.98438C38.7858 10.1211 38.4691 10.3307 38.1729 10.6133L37.5166 9.93652C37.9085 9.55827 38.3255 9.28027 38.7676 9.10254C39.2096 8.9248 39.7018 8.83594 40.2441 8.83594C41.0918 8.83594 41.7298 9.05469 42.1582 9.49219C42.5866 9.92513 42.8008 10.5768 42.8008 11.4473V16ZM41.6797 13.1562V12.459L39.9912 12.6914C39.4762 12.7643 39.0889 12.8942 38.8291 13.0811C38.5693 13.2679 38.4395 13.5618 38.4395 13.9629C38.4395 14.3822 38.5602 14.7035 38.8018 14.9268C39.0479 15.1455 39.3464 15.2549 39.6973 15.2549C40.3034 15.2549 40.7842 15.0566 41.1396 14.6602C41.4997 14.2637 41.6797 13.7624 41.6797 13.1562ZM49.7939 14.8105C49.5342 15.2617 49.2038 15.6012 48.8027 15.8291C48.4062 16.0524 47.9346 16.1641 47.3877 16.1641C46.5081 16.1641 45.804 15.8519 45.2754 15.2275C44.7513 14.5986 44.4893 13.7441 44.4893 12.6641C44.4893 11.5065 44.7809 10.5791 45.3643 9.88184C45.9476 9.18457 46.7246 8.83594 47.6953 8.83594C48.1784 8.83594 48.5931 8.93164 48.9395 9.12305C49.2904 9.3099 49.5752 9.59245 49.7939 9.9707H49.8213V5.63672H50.9424V16H49.8213V14.8105H49.7939ZM45.6377 12.6094C45.6377 13.416 45.8245 14.054 46.1982 14.5234C46.5765 14.9883 47.0824 15.2207 47.7158 15.2207C48.3447 15.2207 48.8529 14.9951 49.2402 14.5439C49.6276 14.0928 49.8213 13.5231 49.8213 12.835V11.8027C49.8213 11.2376 49.6322 10.7591 49.2539 10.3672C48.8802 9.97526 48.4085 9.7793 47.8389 9.7793C47.1553 9.7793 46.6175 10.0299 46.2256 10.5312C45.8337 11.0326 45.6377 11.7253 45.6377 12.6094ZM53.7861 7.3252C53.5583 7.3252 53.3669 7.25 53.2119 7.09961C53.057 6.94466 52.9795 6.75553 52.9795 6.53223C52.9795 6.30892 53.057 6.12207 53.2119 5.97168C53.3669 5.81673 53.5583 5.73926 53.7861 5.73926C54.014 5.73926 54.2054 5.81673 54.3604 5.97168C54.5153 6.12207 54.5928 6.30892 54.5928 6.53223C54.5928 6.75553 54.5153 6.94466 54.3604 7.09961C54.2054 7.25 54.014 7.3252 53.7861 7.3252ZM54.333 16H53.2119V9H54.333V16ZM59.5283 16.1641C58.4938 16.1641 57.6667 15.8382 57.0469 15.1865C56.4316 14.5303 56.124 13.6621 56.124 12.582C56.124 11.4108 56.443 10.4948 57.0811 9.83398C57.7191 9.17318 58.5895 8.84049 59.6924 8.83594C60.736 8.83138 61.5495 9.15267 62.1328 9.7998C62.7207 10.4469 63.0146 11.3379 63.0146 12.4727C63.0146 13.5938 62.6979 14.4893 62.0645 15.1592C61.4355 15.8291 60.5902 16.1641 59.5283 16.1641ZM59.6104 15.2207C60.335 15.2207 60.891 14.986 61.2783 14.5166C61.6702 14.0426 61.8662 13.375 61.8662 12.5137C61.8662 11.6341 61.6702 10.9596 61.2783 10.4902C60.8864 10.0163 60.3304 9.7793 59.6104 9.7793C58.8903 9.7793 58.3206 10.0254 57.9014 10.5176C57.4821 11.0098 57.2725 11.6842 57.2725 12.541C57.2725 13.3704 57.4844 14.0244 57.9082 14.5029C58.332 14.9814 58.8994 15.2207 59.6104 15.2207Z\" fill=\"#1A1A1A\"/>\n      </svg>\n      `;\n\n    case SvgIcon.Fail:\n      return html`\n        <svg width=\"12\" height=\"12\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path fill=\"#EF355D\" d=\"m6,12c3.314,0 6,-2.6863 6,-6c0,-3.3137 -2.686,-6 -6,-6c-3.314,0 -6,2.6863 -6,6c0,3.3137 2.686,6 6,6z\"/>\n          <path fill=\"white\" d=\"m6.943,6.0004l1.544,-1.5444c0.169,-0.1683 0.236,-0.4142 0.174,-0.6448c-0.061,-0.2306 -0.241,-0.4107 -0.472,-0.4722c-0.231,-0.0616 -0.477,0.0049 -0.645,0.1742l-1.544,1.5443l-1.545,-1.5443c-0.26,-0.259 -0.681,-0.2583 -0.941,0.0014c-0.26,0.2598 -0.26,0.6808 -0.001,0.9414l1.544,1.5444l-1.544,1.5444c-0.259,0.2606 -0.259,0.6815 0.001,0.9413c0.26,0.2598 0.681,0.2604 0.941,0.0015l1.545,-1.5444l1.544,1.5444c0.261,0.2589 0.682,0.2583 0.942,-0.0015c0.259,-0.2598 0.26,-0.6807 0.001,-0.9413l-1.544,-1.5444z\" />\n        </svg>\n      `;\n\n    case SvgIcon.SelectAccount:\n      return html`\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"17\" height=\"17\" viewBox=\"0 0 17 17\" fill=\"none\">\n      <path fill=${color} d=\"M6.22176 13.9567C3.55468 13.653 2 11.8026 2 10V9.5C2 8.67157 2.67157 8 3.5 8H5.59971C5.43777 8.31679 5.30564 8.65136 5.20703 9H3.5C3.22386 9 3 9.22386 3 9.5V10C3 11.1281 3.88187 12.333 5.50235 12.7996C5.69426 13.216 5.93668 13.6043 6.22176 13.9567ZM9.62596 5.06907C9.70657 4.81036 9.75 4.53525 9.75 4.25C9.75 2.73122 8.51878 1.5 7 1.5C5.48122 1.5 4.25 2.73122 4.25 4.25C4.25 5.53662 5.13357 6.61687 6.32704 6.91706C6.64202 6.55055 7.00446 6.226 7.40482 5.95294C7.27488 5.98371 7.13934 6 7 6C6.0335 6 5.25 5.2165 5.25 4.25C5.25 3.2835 6.0335 2.5 7 2.5C7.9665 2.5 8.75 3.2835 8.75 4.25C8.75 4.73141 8.55561 5.16743 8.24104 5.48382C8.67558 5.28783 9.14016 5.14664 9.62596 5.06907ZM10.5 15C12.9853 15 15 12.9853 15 10.5C15 8.01472 12.9853 6 10.5 6C8.01472 6 6 8.01472 6 10.5C6 12.9853 8.01472 15 10.5 15ZM10.5 8C10.7761 8 11 8.22386 11 8.5V10H12.5C12.7761 10 13 10.2239 13 10.5C13 10.7761 12.7761 11 12.5 11H11V12.5C11 12.7761 10.7761 13 10.5 13C10.2239 13 10 12.7761 10 12.5V11H8.5C8.22386 11 8 10.7761 8 10.5C8 10.2239 8.22386 10 8.5 10H10V8.5C10 8.22386 10.2239 8 10.5 8Z\"/>\n    </svg>\n  `;\n\n    case SvgIcon.News:\n      return html`\n        <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path d=\"M18.75 20H5.25C3.51697 20 2.10075 18.6435 2.00514 16.9344L2 16.75V6.25C2 5.05914 2.92516 4.08436 4.09595 4.00519L4.25 4H16.75C17.9409 4 18.9156 4.92516 18.9948 6.09595L19 6.25V7H19.75C20.9409 7 21.9156 7.92516 21.9948 9.09595L22 9.25V16.75C22 18.483 20.6435 19.8992 18.9344 19.9949L18.75 20H5.25H18.75ZM5.25 18.5H18.75C19.6682 18.5 20.4212 17.7929 20.4942 16.8935L20.5 16.75V9.25C20.5 8.8703 20.2178 8.55651 19.8518 8.50685L19.75 8.5H19V16.25C19 16.6297 18.7178 16.9435 18.3518 16.9932L18.25 17C17.8703 17 17.5565 16.7178 17.5068 16.3518L17.5 16.25V6.25C17.5 5.8703 17.2178 5.55651 16.8518 5.50685L16.75 5.5H4.25C3.8703 5.5 3.55651 5.78215 3.50685 6.14823L3.5 6.25V16.75C3.5 17.6682 4.20711 18.4212 5.10647 18.4942L5.25 18.5H18.75H5.25ZM12.246 14.5H15.2522C15.6665 14.5 16.0022 14.8358 16.0022 15.25C16.0022 15.6297 15.7201 15.9435 15.354 15.9932L15.2522 16H12.246C11.8318 16 11.496 15.6642 11.496 15.25C11.496 14.8703 11.7782 14.5565 12.1442 14.5068L12.246 14.5H15.2522H12.246ZM9.24328 11.0045C9.6575 11.0045 9.99328 11.3403 9.99328 11.7545V15.25C9.99328 15.6642 9.6575 16 9.24328 16H5.74776C5.33355 16 4.99776 15.6642 4.99776 15.25V11.7545C4.99776 11.3403 5.33355 11.0045 5.74776 11.0045H9.24328ZM8.49328 12.5045H6.49776V14.5H8.49328V12.5045ZM12.246 11.0045H15.2522C15.6665 11.0045 16.0022 11.3403 16.0022 11.7545C16.0022 12.1342 15.7201 12.448 15.354 12.4976L15.2522 12.5045H12.246C11.8318 12.5045 11.496 12.1687 11.496 11.7545C11.496 11.3748 11.7782 11.061 12.1442 11.0113L12.246 11.0045H15.2522H12.246ZM5.74776 7.50247H15.2522C15.6665 7.50247 16.0022 7.83826 16.0022 8.25247C16.0022 8.63217 15.7201 8.94596 15.354 8.99563L15.2522 9.00247H5.74776C5.33355 9.00247 4.99776 8.66669 4.99776 8.25247C4.99776 7.87278 5.27991 7.55898 5.64599 7.50932L5.74776 7.50247H15.2522H5.74776Z\" fill=\"none\" />\n      </svg>\n      `;\n\n    case SvgIcon.DoubleBookmark:\n      return html`\n        <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M4 6.74814C4 5.50535 5.00742 4.49786 6.25013 4.49786H15.2506C16.4933 4.49786 17.5008 5.50535 17.5008 6.74814V21.2499C17.5008 21.5185 17.3572 21.7666 17.1243 21.9003C16.8914 22.0341 16.6048 22.0332 16.3728 21.8978L10.7504 18.6179L5.12797 21.8978C4.89599 22.0332 4.60936 22.0341 4.37648 21.9003C4.14359 21.7666 4 21.5185 4 21.2499V6.74814ZM6.25013 5.99805C5.83589 5.99805 5.50008 6.33387 5.50008 6.74814V19.944L10.3725 17.1016C10.606 16.9653 10.8948 16.9653 11.1283 17.1016L16.0007 19.944V6.74814C16.0007 6.33387 15.6649 5.99805 15.2506 5.99805H6.25013ZM15.2497 2C17.8732 2 20 4.12691 20 6.75058V18.6232C20 19.0374 19.6642 19.3733 19.25 19.3733C18.8357 19.3733 18.4999 19.0374 18.4999 18.6232V6.75058C18.4999 4.95543 17.0448 3.50018 15.2497 3.50018H6.63687C6.63687 3.50018 6.75016 2.94339 7.43379 2.41948C8.00023 2 8.60182 2 8.60182 2H15.2497Z\" fill=\"none\" />\n        </svg>\n      `;\n\n    case SvgIcon.ChevronLeft:\n      return html`\n        <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M15.5303 4.21967C15.8232 4.51256 15.8232 4.98744 15.5303 5.28033L8.81066 12L15.5303 18.7197C15.8232 19.0126 15.8232 19.4874 15.5303 19.7803C15.2374 20.0732 14.7626 20.0732 14.4697 19.7803L7.21967 12.5303C6.92678 12.2374 6.92678 11.7626 7.21967 11.4697L14.4697 4.21967C14.7626 3.92678 15.2374 3.92678 15.5303 4.21967Z\" fill=\"none\" />\n        </svg>`;\n\n    case SvgIcon.ChevronRight:\n      return html`\n        <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"currentColor\" aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M8.46967 4.21967C8.17678 4.51256 8.17678 4.98744 8.46967 5.28033L15.1893 12L8.46967 18.7197C8.17678 19.0126 8.17678 19.4874 8.46967 19.7803C8.76256 20.0732 9.23744 20.0732 9.53033 19.7803L16.7803 12.5303C17.0732 12.2374 17.0732 11.7626 16.7803 11.4697L9.53033 4.21967C9.23744 3.92678 8.76256 3.92678 8.46967 4.21967Z\" fill=\"currentColor\" />\n        </svg>`;\n\n    case SvgIcon.Delete:\n      return html`\n        <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M8.5 4H11.5C11.5 3.17157 10.8284 2.5 10 2.5C9.17157 2.5 8.5 3.17157 8.5 4ZM7.5 4C7.5 2.61929 8.61929 1.5 10 1.5C11.3807 1.5 12.5 2.61929 12.5 4H17.5C17.7761 4 18 4.22386 18 4.5C18 4.77614 17.7761 5 17.5 5H16.4456L15.2521 15.3439C15.0774 16.8576 13.7957 18 12.2719 18H7.72813C6.20431 18 4.92256 16.8576 4.7479 15.3439L3.55437 5H2.5C2.22386 5 2 4.77614 2 4.5C2 4.22386 2.22386 4 2.5 4H7.5ZM5.74131 15.2292C5.85775 16.2384 6.71225 17 7.72813 17H12.2719C13.2878 17 14.1422 16.2384 14.2587 15.2292L15.439 5H4.56101L5.74131 15.2292ZM8.5 7.5C8.77614 7.5 9 7.72386 9 8V14C9 14.2761 8.77614 14.5 8.5 14.5C8.22386 14.5 8 14.2761 8 14V8C8 7.72386 8.22386 7.5 8.5 7.5ZM12 8C12 7.72386 11.7761 7.5 11.5 7.5C11.2239 7.5 11 7.72386 11 8V14C11 14.2761 11.2239 14.5 11.5 14.5C11.7761 14.5 12 14.2761 12 14V8Z\" fill=\"currentColor\"/>\n        </svg>\n    `;\n\n    case SvgIcon.Add:\n      return html`\n        <svg width=\"16\" height=\"15\" viewBox=\"0 0 16 15\" fill=\"currentColor\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M8.39563 0.5C8.39563 0.223858 8.17177 0 7.89563 0C7.61949 0 7.39563 0.223858 7.39563 0.5V7H0.89563C0.619487 7 0.39563 7.22386 0.39563 7.5C0.39563 7.77614 0.619487 8 0.89563 8H7.39563V14.5C7.39563 14.7761 7.61949 15 7.89563 15C8.17177 15 8.39563 14.7761 8.39563 14.5V8H14.8956C15.1718 8 15.3956 7.77614 15.3956 7.5C15.3956 7.22386 15.1718 7 14.8956 7H8.39563V0.5Z\" fill=\"${color}\"/>\n        </svg>`;\n\n    case SvgIcon.Calendar:\n      return html`\n        <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M7 11C7.55228 11 8 10.5523 8 10C8 9.44771 7.55228 9 7 9C6.44772 9 6 9.44771 6 10C6 10.5523 6.44772 11 7 11ZM8 13C8 13.5523 7.55228 14 7 14C6.44772 14 6 13.5523 6 13C6 12.4477 6.44772 12 7 12C7.55228 12 8 12.4477 8 13ZM10 11C10.5523 11 11 10.5523 11 10C11 9.44771 10.5523 9 10 9C9.44771 9 9 9.44771 9 10C9 10.5523 9.44771 11 10 11ZM11 13C11 13.5523 10.5523 14 10 14C9.44771 14 9 13.5523 9 13C9 12.4477 9.44771 12 10 12C10.5523 12 11 12.4477 11 13ZM13 11C13.5523 11 14 10.5523 14 10C14 9.44771 13.5523 9 13 9C12.4477 9 12 9.44771 12 10C12 10.5523 12.4477 11 13 11ZM17 5.5C17 4.11929 15.8807 3 14.5 3H5.5C4.11929 3 3 4.11929 3 5.5V14.5C3 15.8807 4.11929 17 5.5 17H14.5C15.8807 17 17 15.8807 17 14.5V5.5ZM4 7H16V14.5C16 15.3284 15.3284 16 14.5 16H5.5C4.67157 16 4 15.3284 4 14.5V7ZM5.5 4H14.5C15.3284 4 16 4.67157 16 5.5V6H4V5.5C4 4.67157 4.67157 4 5.5 4Z\" fill=${color}/>\n        </svg>\n    `;\n\n    case SvgIcon.Planner:\n      return html`\n        <svg width=\"24\" height=\"24\" fill=\"none\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M17.75 3A3.25 3.25 0 0 1 21 6.25v11.5A3.25 3.25 0 0 1 17.75 21H6.25A3.25 3.25 0 0 1 3 17.75V6.25A3.25 3.25 0 0 1 6.25 3h11.5Zm1.75 5.5h-15v9.25c0 .966.784 1.75 1.75 1.75h11.5a1.75 1.75 0 0 0 1.75-1.75V8.5Zm-11.75 6a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5Zm4.25 0a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5Zm-4.25-4a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5Zm4.25 0a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5Zm4.25 0a1.25 1.25 0 1 1 0 2.5 1.25 1.25 0 0 1 0-2.5Zm1.5-6H6.25A1.75 1.75 0 0 0 4.5 6.25V7h15v-.75a1.75 1.75 0 0 0-1.75-1.75Z\" fill=\"${color}\"/>\n        </svg>`;\n\n    case SvgIcon.Milestone:\n      return html`\n        <svg width=\"24\" height=\"24\" fill=\"${color}\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M15.25 13c.966 0 1.75.784 1.75 1.75v4.5A1.75 1.75 0 0 1 15.25 21H3.75A1.75 1.75 0 0 1 2 19.25v-4.5c0-.966.783-1.75 1.75-1.75h11.5ZM21 14.899v5.351a.75.75 0 0 1-1.494.102l-.006-.102v-5.338a3.006 3.006 0 0 0 1.5-.013Zm-5.75-.399H3.75a.25.25 0 0 0-.25.25v4.5c0 .138.111.25.25.25h11.5a.25.25 0 0 0 .25-.25v-4.5a.25.25 0 0 0-.25-.25Zm5-4.408a1.908 1.908 0 1 1 0 3.816 1.908 1.908 0 0 1 0-3.816ZM15.244 3c.967 0 1.75.784 1.75 1.75v4.5a1.75 1.75 0 0 1-1.75 1.75h-11.5a1.75 1.75 0 0 1-1.75-1.75v-4.5a1.75 1.75 0 0 1 1.607-1.744L3.745 3h11.5Zm0 1.5h-11.5l-.057.007a.25.25 0 0 0-.193.243v4.5c0 .138.112.25.25.25h11.5a.25.25 0 0 0 .25-.25v-4.5a.25.25 0 0 0-.25-.25ZM20.25 3a.75.75 0 0 1 .743.648L21 3.75v5.351a3.004 3.004 0 0 0-1.5-.013V3.75a.75.75 0 0 1 .75-.75Z\" fill=\"${color}\"/>\n        </svg>`;\n\n    case SvgIcon.PersonAdd:\n      return html`\n        <svg width=\"20\" height=\"20\" viewBox=\"0 0 20 20\" xmlns=\"http://www.w3.org/2000/svg\" class=\"svg\" fill=\"currentColor\">\n          <path d=\"M9 2a4 4 0 100 8 4 4 0 000-8zM6 6a3 3 0 116 0 3 3 0 01-6 0z\"></path>\n          <path d=\"M4 11a2 2 0 00-2 2c0 1.7.83 2.97 2.13 3.8A9.14 9.14 0 009 18c.41 0 .82-.02 1.21-.06A5.5 5.5 0 019.6 17 12 12 0 019 17a8.16 8.16 0 01-4.33-1.05A3.36 3.36 0 013 13a1 1 0 011-1h5.6c.18-.36.4-.7.66-1H4z\"></path>\n          <path d=\"M14.5 19a4.5 4.5 0 100-9 4.5 4.5 0 000 9zm0-7c.28 0 .5.22.5.5V14h1.5a.5.5 0 010 1H15v1.5a.5.5 0 01-1 0V15h-1.5a.5.5 0 010-1H14v-1.5c0-.28.22-.5.5-.5z\"></path>\n        </svg>`;\n    case SvgIcon.Event:\n      return html`\n        <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M17.75 3C19.5449 3 21 4.45507 21 6.25V17.75C21 19.5449 19.5449 21 17.75 21H6.25C4.45507 21 3 19.5449 3 17.75V6.25C3 4.45507 4.45507 3 6.25 3H17.75ZM19.5 8.5H4.5V17.75C4.5 18.7165 5.2835 19.5 6.25 19.5H17.75C18.7165 19.5 19.5 18.7165 19.5 17.75V8.5ZM7.75 14.5C8.44036 14.5 9 15.0596 9 15.75C9 16.4404 8.44036 17 7.75 17C7.05964 17 6.5 16.4404 6.5 15.75C6.5 15.0596 7.05964 14.5 7.75 14.5ZM12 14.5C12.6904 14.5 13.25 15.0596 13.25 15.75C13.25 16.4404 12.6904 17 12 17C11.3096 17 10.75 16.4404 10.75 15.75C10.75 15.0596 11.3096 14.5 12 14.5ZM7.75 10.5C8.44036 10.5 9 11.0596 9 11.75C9 12.4404 8.44036 13 7.75 13C7.05964 13 6.5 12.4404 6.5 11.75C6.5 11.0596 7.05964 10.5 7.75 10.5ZM12 10.5C12.6904 10.5 13.25 11.0596 13.25 11.75C13.25 12.4404 12.6904 13 12 13C11.3096 13 10.75 12.4404 10.75 11.75C10.75 11.0596 11.3096 10.5 12 10.5ZM16.25 10.5C16.9404 10.5 17.5 11.0596 17.5 11.75C17.5 12.4404 16.9404 13 16.25 13C15.5596 13 15 12.4404 15 11.75C15 11.0596 15.5596 10.5 16.25 10.5ZM17.75 4.5H6.25C5.2835 4.5 4.5 5.2835 4.5 6.25V7H19.5V6.25C19.5 5.2835 18.7165 4.5 17.75 4.5Z\" fill=\"none\" />\n        </svg>\n      `;\n\n    case SvgIcon.BookOpen:\n      return html`\n        <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M12 19.1375C11.4986 19.6686 10.788 20 10 20H3.75C2.7835 20 2 19.2165 2 18.25V5.75C2 4.7835 2.7835 4 3.75 4H10C10.788 4 11.4986 4.33145 12 4.86253C12.5014 4.33145 13.212 4 14 4H20.25C21.2165 4 22 4.7835 22 5.75V18.25C22 19.2165 21.2165 20 20.25 20H14C13.212 20 12.5014 19.6686 12 19.1375ZM3.5 5.75V18.25C3.5 18.3881 3.61193 18.5 3.75 18.5H10C10.6904 18.5 11.25 17.9404 11.25 17.25V6.75C11.25 6.05964 10.6904 5.5 10 5.5H3.75C3.61193 5.5 3.5 5.61193 3.5 5.75ZM12.75 17.25C12.75 17.9404 13.3096 18.5 14 18.5H20.25C20.3881 18.5 20.5 18.3881 20.5 18.25V5.75C20.5 5.61193 20.3881 5.5 20.25 5.5H14C13.3096 5.5 12.75 6.05964 12.75 6.75V17.25Z\" fill=\"none\" />\n        </svg>\n      `;\n\n    case SvgIcon.FileOuter:\n      return html`\n        <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M6 2C4.89543 2 4 2.89543 4 4V20C4 21.1046 4.89543 22 6 22H18C19.1046 22 20 21.1046 20 20V9.82777C20 9.29733 19.7893 8.78863 19.4142 8.41355L13.5864 2.58579C13.2114 2.21071 12.7027 2 12.1722 2H6ZM5.5 4C5.5 3.72386 5.72386 3.5 6 3.5H12V8C12 9.10457 12.8954 10 14 10H18.5V20C18.5 20.2761 18.2761 20.5 18 20.5H6C5.72386 20.5 5.5 20.2761 5.5 20V4ZM17.3793 8.5H14C13.7239 8.5 13.5 8.27614 13.5 8V4.62066L17.3793 8.5Z\" fill=\"none\" />\n        </svg>\n      `;\n\n    case SvgIcon.BookQuestion:\n      return html`\n        <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M10.9998 8.01752C10.9905 8.42363 10.6584 8.74999 10.25 8.74999C9.5 8.74999 9.5 7.9989 9.5 7.9989L9.5 7.99777L9.50001 7.99539L9.50006 7.99017C9.50032 7.9755 9.50072 7.96084 9.50144 7.94618C9.50262 7.92198 9.50473 7.89159 9.50846 7.8559C9.51591 7.78477 9.52996 7.69092 9.55665 7.58186C9.60973 7.36492 9.71565 7.07652 9.92848 6.78906C10.3825 6.17582 11.1982 5.72727 12.513 5.7501C13.4627 5.76659 14.3059 6.16497 14.834 6.82047C15.371 7.48704 15.5517 8.3902 15.1964 9.27853C14.8342 10.1839 14.0149 10.5437 13.5442 10.7503L13.4932 10.7728C13.2147 10.8957 13.0813 10.9599 13.0013 11.024L13 11.0251L13 11.7492C13.0001 12.1634 12.6643 12.4999 12.2501 12.5C11.8359 12.5 11.5001 12.1643 11.5 11.7501L11.5 11C11.5 10.4769 11.752 10.1029 12.0633 9.85345C12.3134 9.65303 12.6276 9.51483 12.8491 9.4174L12.8875 9.40049C13.4292 9.16137 13.6868 9.01346 13.8036 8.72145C13.9483 8.35977 13.8789 8.02596 13.6659 7.76153C13.4439 7.48604 13.0371 7.25943 12.487 7.24988C11.5518 7.23364 11.2425 7.53509 11.134 7.68162C11.0656 7.77404 11.0309 7.86797 11.0137 7.93838C11.0052 7.973 11.0017 7.99908 11.0003 8.01197L10.9998 8.01752ZM12.25 15.5C12.8023 15.5 13.25 15.0523 13.25 14.5C13.25 13.9477 12.8023 13.5 12.25 13.5C11.6977 13.5 11.25 13.9477 11.25 14.5C11.25 15.0523 11.6977 15.5 12.25 15.5ZM4 4.5C4 3.11929 5.11929 2 6.5 2H18C19.3807 2 20.5 3.11929 20.5 4.5V18.75C20.5 19.1642 20.1642 19.5 19.75 19.5H5.5C5.5 20.0523 5.94772 20.5 6.5 20.5H19.75C20.1642 20.5 20.5 20.8358 20.5 21.25C20.5 21.6642 20.1642 22 19.75 22H6.5C5.11929 22 4 20.8807 4 19.5V4.5ZM5.5 4.5V18H19V4.5C19 3.94772 18.5523 3.5 18 3.5H6.5C5.94772 3.5 5.5 3.94772 5.5 4.5Z\" fill=\"none\" />\n        </svg>\n      `;\n\n    case SvgIcon.Globe:\n      return html`\n        <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M12.0001 1.99805C17.5238 1.99805 22.0016 6.47589 22.0016 11.9996C22.0016 17.5233 17.5238 22.0011 12.0001 22.0011C6.47638 22.0011 1.99854 17.5233 1.99854 11.9996C1.99854 6.47589 6.47638 1.99805 12.0001 1.99805ZM14.939 16.4993H9.06118C9.71322 18.9135 10.8466 20.5011 12.0001 20.5011C13.1536 20.5011 14.2869 18.9135 14.939 16.4993ZM7.5084 16.4999L4.78591 16.4998C5.74425 18.0328 7.1777 19.2384 8.88008 19.9104C8.3578 19.0906 7.92681 18.0643 7.60981 16.8949L7.5084 16.4999ZM19.2143 16.4998L16.4918 16.4999C16.168 17.8337 15.7004 18.9995 15.119 19.9104C16.716 19.2804 18.0757 18.1814 19.0291 16.7833L19.2143 16.4998ZM7.09351 9.99895H3.7359L3.73115 10.0162C3.57906 10.6525 3.49854 11.3166 3.49854 11.9996C3.49854 13.0558 3.69112 14.0669 4.0431 14.9999L7.21626 14.9995C7.07396 14.0504 6.99854 13.0422 6.99854 11.9996C6.99854 11.3156 7.031 10.6464 7.09351 9.99895ZM15.397 9.99901H8.60316C8.53514 10.6393 8.49853 11.309 8.49853 11.9996C8.49853 13.0591 8.58468 14.0694 8.73827 14.9997H15.2619C15.4155 14.0694 15.5016 13.0591 15.5016 11.9996C15.5016 11.309 15.465 10.6393 15.397 9.99901ZM20.2647 9.99811L16.9067 9.99897C16.9692 10.6464 17.0016 11.3156 17.0016 11.9996C17.0016 13.0422 16.9262 14.0504 16.7839 14.9995L19.9571 14.9999C20.309 14.0669 20.5016 13.0558 20.5016 11.9996C20.5016 11.3102 20.4196 10.64 20.2647 9.99811ZM8.88114 4.08875L8.85823 4.09747C6.81092 4.91218 5.1549 6.49949 4.25023 8.49935L7.29835 8.49972C7.61171 6.74693 8.15855 5.221 8.88114 4.08875ZM12.0001 3.49805L11.8844 3.50335C10.619 3.6191 9.39651 5.62107 8.8288 8.4993H15.1714C14.6052 5.62914 13.388 3.63033 12.1264 3.50436L12.0001 3.49805ZM15.1201 4.08881L15.2269 4.2629C15.8961 5.37537 16.4043 6.83525 16.7018 8.49972L19.7499 8.49935C18.8853 6.58795 17.3343 5.05341 15.4113 4.21008L15.1201 4.08881Z\" />\n        </svg>\n      `;\n\n    case SvgIcon.PresenceAvailable:\n      return html`\n        <svg fill=\"#13a10e\" aria-hidden=\"true\" width=\"10\" height=\"10\" viewBox=\"0 0 10 10\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M5 10A5 5 0 1 0 5 0a5 5 0 0 0 0 10Zm2.1-5.9L4.85 6.35a.5.5 0 0 1-.7 0l-1-1a.5.5 0 0 1 .7-.7l.65.64 1.9-1.9a.5.5 0 0 1 .7.71Z\" fill=\"#13a10e\"></path>\n        </svg>`;\n\n    case SvgIcon.PresenceOofAvailable:\n      return html`\n        <svg fill=\"#13a10e\" aria-hidden=\"true\" width=\"10\" height=\"10\" viewBox=\"0 0 10 10\" xmlns=\"http://www.w3.org/2000/svg\">\n            <path d=\"M5 0a5 5 0 1 0 0 10A5 5 0 0 0 5 0ZM1 5a4 4 0 1 1 8 0 4 4 0 0 1-8 0Zm6.1-1.6c.2.2.2.5 0 .7L4.85 6.35a.5.5 0 0 1-.7 0l-1-1a.5.5 0 1 1 .7-.7l.65.64 1.9-1.9c.2-.19.5-.19.7 0Z\" fill=\"#13a10e\"></path>\n        </svg>`;\n\n    case SvgIcon.PresenceBusy:\n      return html`\n        <svg fill=\"#d13438\" aria-hidden=\"true\" width=\"10\" height=\"10\" viewBox=\"0 0 10 10\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M10 5A5 5 0 1 1 0 5a5 5 0 0 1 10 0Z\" fill=\"#d13438\"></path>\n        </svg>`;\n\n    case SvgIcon.PresenceOofBusy:\n      return html`\n        <svg fill=\"#d13438\" aria-hidden=\"true\" width=\"10\" height=\"10\" viewBox=\"0 0 10 10\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M5 1a4 4 0 1 0 0 8 4 4 0 0 0 0-8ZM0 5a5 5 0 1 1 10 0A5 5 0 0 1 0 5Z\" fill=\"#d13438\"></path>\n        </svg>\n      `;\n\n    case SvgIcon.PresenceDnd:\n      return html`\n        <svg fill=\"#d13438\" aria-hidden=\"true\" width=\"10\" height=\"10\" viewBox=\"0 0 10 10\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M5 10A5 5 0 1 0 5 0a5 5 0 0 0 0 10ZM3.5 4.5h3a.5.5 0 0 1 0 1h-3a.5.5 0 0 1 0-1Z\" fill=\"#d13438\"></path>\n        </svg>`;\n\n    case SvgIcon.PresenceOofDnd:\n      return html`\n        <svg fill=\"#d13438\" aria-hidden=\"true\" width=\"10\" height=\"10\" viewBox=\"0 0 10 10\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M5 0a5 5 0 1 0 0 10A5 5 0 0 0 5 0ZM1 5a4 4 0 1 1 8 0 4 4 0 0 1-8 0Zm2 0c0-.28.22-.5.5-.5h3a.5.5 0 0 1 0 1h-3A.5.5 0 0 1 3 5Z\" fill=\"#d13438\"></path>\n        </svg>`;\n\n    case SvgIcon.PresenceAway:\n      return html`\n        <svg fill=\"#eaa300\" aria-hidden=\"true\" width=\"10\" height=\"10\" viewBox=\"0 0 10 10\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M5 10A5 5 0 1 0 5 0a5 5 0 0 0 0 10Zm0-7v1.8l1.35 1.35a.5.5 0 1 1-.7.7l-1.5-1.5A.5.5 0 0 1 4 5V3a.5.5 0 0 1 1 0Z\" fill=\"#eaa300\"></path>\n        </svg>`;\n\n    case SvgIcon.PresenceOofAway:\n      return html`\n        <svg fill=\"#c239b3\" aria-hidden=\"true\" width=\"10\" height=\"10\" viewBox=\"0 0 10 10\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M5.35 3.85a.5.5 0 1 0-.7-.7l-1.5 1.5a.5.5 0 0 0 0 .7l1.5 1.5a.5.5 0 1 0 .7-.7L4.7 5.5h1.8a.5.5 0 1 0 0-1H4.7l.65-.65ZM5 0a5 5 0 1 0 0 10A5 5 0 0 0 5 0ZM1 5a4 4 0 1 1 8 0 4 4 0 0 1-8 0Z\" fill=\"#c239b3\"></path>\n        </svg>`;\n\n    case SvgIcon.PresenceOffline:\n      return html`\n        <svg fill=\"#929292\" aria-hidden=\"true\" width=\"10\" height=\"10\" viewBox=\"0 0 10 10\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M6.85 3.15c.2.2.2.5 0 .7L5.71 5l1.14 1.15a.5.5 0 1 1-.7.7L5 5.71 3.85 6.85a.5.5 0 1 1-.7-.7L4.29 5 3.15 3.85a.5.5 0 1 1 .7-.7L5 4.29l1.15-1.14c.2-.2.5-.2.7 0ZM0 5a5 5 0 1 1 10 0A5 5 0 0 1 0 5Zm5-4a4 4 0 1 0 0 8 4 4 0 0 0 0-8Z\" fill=\"#929292\"></path>\n        </svg>`;\n\n    case SvgIcon.PresenceStatusUnknown:\n      return html`\n        <svg fill=\"#d13438\" aria-hidden=\"true\" width=\"10\" height=\"10\" viewBox=\"0 0 10 10\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M5 1a4 4 0 1 0 0 8 4 4 0 0 0 0-8ZM0 5a5 5 0 1 1 10 0A5 5 0 0 1 0 5Z\" fill=\"#d13438\"></path>\n        </svg>`;\n\n    case SvgIcon.Loading:\n      return html`\n        <svg fill=\"#d13438\" aria-hidden=\"true\" width=\"10\" height=\"10\" viewBox=\"0 0 10 10\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M12 4.75a7.25 7.25 0 1 0 7.201 6.406c-.068-.588.358-1.156.95-1.156.515 0 .968.358 1.03.87a9.25 9.25 0 1 1-3.432-6.116V4.25a1 1 0 1 1 2.001 0v2.698l.034.052h-.034v.25a1 1 0 0 1-1 1h-3a1 1 0 1 1 0-2h.666A7.219 7.219 0 0 0 12 4.75Z\" fill=\"#212121\"/>\n        </svg>`;\n  }\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { CacheService } from '@microsoft/mgt-element';\n\nexport const getRelativeDisplayDate = (date: Date): string => {\n  const now = new Date();\n\n  // Today -> 5:23 PM\n  const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());\n  if (date >= today) {\n    return date.toLocaleString('default', {\n      hour: 'numeric',\n      minute: 'numeric'\n    });\n  }\n\n  // This week -> Sun 3:04 PM\n  const sunday = new Date(today);\n  sunday.setDate(now.getDate() - now.getDay());\n  if (date >= sunday) {\n    return date.toLocaleString('default', {\n      hour: 'numeric',\n      minute: 'numeric',\n      weekday: 'short'\n    });\n  }\n\n  // Last two week -> Sun 8/2\n  const lastTwoWeeks = new Date(sunday);\n  lastTwoWeeks.setDate(sunday.getDate() - 7);\n  if (date >= lastTwoWeeks) {\n    return date.toLocaleString('default', {\n      day: 'numeric',\n      month: 'numeric',\n      weekday: 'short'\n    });\n  }\n\n  // More than two weeks ago -> 8/1/2020\n  return date.toLocaleString('default', {\n    day: 'numeric',\n    month: 'numeric',\n    year: 'numeric'\n  });\n};\n\n/**\n * returns day, month and year\n *\n * @export\n * @param {Date} date\n * @returns\n */\nexport const getDateString = (date: Date) => {\n  const month = date.getMonth();\n  const day = date.getDate();\n  const year = date.getFullYear();\n\n  return `${day} / ${month} / ${year}`;\n};\n\n/**\n * returns month and day\n *\n * @export\n * @param {Date} date\n * @returns\n */\nexport const getShortDateString = (date: Date) => {\n  const month = date.getMonth();\n  const day = date.getDate();\n\n  return `${getMonthString(month)} ${day}`;\n};\n\n/**\n * returns month string based on number\n *\n * @export\n * @param {number} month\n * @returns {string}\n */\nexport const getMonthString = (month: number): string => {\n  switch (month) {\n    case 0:\n      return 'January';\n    case 1:\n      return 'February';\n    case 2:\n      return 'March';\n    case 3:\n      return 'April';\n    case 4:\n      return 'May';\n    case 5:\n      return 'June';\n    case 6:\n      return 'July';\n    case 7:\n      return 'August';\n    case 8:\n      return 'September';\n    case 9:\n      return 'October';\n    case 10:\n      return 'November';\n    case 11:\n      return 'December';\n    default:\n      return 'Month';\n  }\n};\n\n/**\n * returns day of week string based on number\n * where 0 === Sunday\n *\n * @export\n * @param {number} day\n * @returns {string}\n */\nexport const getDayOfWeekString = (day: number): string => {\n  switch (day) {\n    case 0:\n      return 'Sunday';\n    case 1:\n      return 'Monday';\n    case 2:\n      return 'Tuesday';\n    case 3:\n      return 'Wednesday';\n    case 4:\n      return 'Thursday';\n    case 5:\n      return 'Friday';\n    case 6:\n      return 'Saturday';\n    default:\n      return 'Day';\n  }\n};\n\n/**\n * retrieve the days in the month provided by number\n *\n * @export\n * @param {number} monthNum\n * @returns {number}\n */\nexport const getDaysInMonth = (monthNum: number): number => {\n  switch (monthNum) {\n    case 1:\n      return 28;\n\n    case 3:\n    case 5:\n    case 8:\n    case 10:\n    default:\n      return 30;\n\n    case 0:\n    case 2:\n    case 4:\n    case 6:\n    case 7:\n    case 9:\n    case 11:\n      return 31;\n  }\n};\n\n/**\n * returns serialized date from month number and year number\n *\n * @export\n * @param {number} month\n * @param {number} year\n * @returns\n */\nexport const getDateFromMonthYear = (month: number, year: number) => {\n  const yearStr = `${year}`;\n\n  let monthStr = `${month}`;\n  if (monthStr.length < 2) {\n    monthStr = '0' + monthStr;\n  }\n\n  return new Date(`${yearStr}-${monthStr}-1T12:00:00-${new Date().getTimezoneOffset() / 60}`);\n};\n\n/**\n * ensures one call at a time\n *\n * @export\n * @param {*} func\n * @param {*} time\n * @returns\n */\n// eslint-disable-next-line @typescript-eslint/ban-types\nexport const debounce = (func: Function, time: number) => {\n  let timeout: number;\n\n  return function () {\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-return, prefer-rest-params\n    const functionCall = () => func.apply(this, arguments);\n\n    window.clearTimeout(timeout);\n    timeout = window.setTimeout(functionCall, time);\n  };\n};\n\n/**\n * converts a blob to base64 encoding\n *\n * @param {Blob} blob\n * @returns {Promise<string>}\n */\nexport const blobToBase64 = (blob: Blob): Promise<string> => {\n  return new Promise((resolve, reject) => {\n    const reader = new FileReader();\n    reader.onerror = reject;\n    reader.onload = () => {\n      resolve(reader.result as string);\n    };\n    reader.readAsDataURL(blob);\n  });\n};\n\n/**\n * extracts an email address from a string\n *\n * @param {string} emailString\n * @returns {string}\n */\nexport const extractEmailAddress = (emailString: string): string => {\n  if (emailString.startsWith('[')) {\n    return emailString.match(/([a-zA-Z0-9+._-]+@[a-zA-Z0-9._-]+\\.[a-zA-Z0-9_-]+)/gi).toString();\n  } else return emailString;\n};\n\n/**\n * checks if the email string is a valid email\n *\n * @param {string} emailString\n * @returns {boolean}\n */\nexport const isValidEmail = (emailString: string): boolean => {\n  const emailRx =\n    /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n  return emailRx.test(emailString);\n};\n\n/**\n * Convert bytes to human readable.\n *\n * @param bytes\n * @param decimals\n * @returns\n */\nexport const formatBytes = (bytes: number, decimals = 2) => {\n  if (bytes === 0) return '0 Bytes';\n  const k = 1024;\n  const dm = decimals < 0 ? 0 : decimals;\n  const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];\n  const i = Math.floor(Math.log(bytes) / Math.log(k));\n\n  return `${parseFloat((bytes / Math.pow(k, i)).toFixed(dm))} ${sizes[i]}`;\n};\n\n/**\n * Formats the a provided summary to valid html\n *\n * @param summary\n * @returns string\n */\nexport const sanitizeSummary = (summary: string) => {\n  if (summary) {\n    summary = summary?.replace(/<ddd\\/>/gi, '...');\n    summary = summary?.replace(/<c0>/gi, '<b>');\n    summary = summary?.replace(/<\\/c0>/gi, '</b>');\n  }\n\n  return summary;\n};\n\n/**\n * Trims the file extension from a file name\n *\n * @param fileName\n * @returns\n */\nexport const trimFileExtension = (fileName: string) => {\n  return fileName?.replace(/\\.[^/.]+$/, '');\n};\n\n/**\n * Get the name of a piece of content from the url\n *\n * @param webUrl\n * @returns\n */\nexport const getNameFromUrl = (webUrl: string) => {\n  const url = new URL(webUrl);\n  const name = url.pathname.split('/').pop();\n  return name.replace(/-/g, ' ');\n};\n\n/**\n * Defines the expiration time\n *\n * @param currentInvalidationPeriod\n * @returns number\n */\nexport const getResponseInvalidationTime = (currentInvalidationPeriod: number) => {\n  return (\n    currentInvalidationPeriod ||\n    CacheService.config.response.invalidationPeriod ||\n    CacheService.config.defaultInvalidationPeriod\n  );\n};\n\n/**\n * Whether the response store is enabled\n *\n * @returns boolean\n */\nexport const getIsResponseCacheEnabled = () => {\n  return CacheService.config.response.isEnabled && CacheService.config.isEnabled;\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { IGraph } from './IGraph';\nimport { Client } from '@microsoft/microsoft-graph-client';\nimport { Graph } from './Graph';\n\n/**\n * The version of the Graph to use for making requests.\n */\nconst GRAPH_VERSION = 'beta';\n\n/**\n * BetaGraph\n *\n * @export\n * @class BetaGraph\n * @extends {BetaGraph}\n */\nexport class BetaGraph extends Graph {\n  /**\n   * get a BetaGraph instance based on an existing IGraph implementation.\n   *\n   * @static\n   * @param {Graph} graph\n   * @returns {BetaGraph}\n   * @memberof BetaGraph\n   */\n  public static fromGraph(graph: IGraph): BetaGraph {\n    const betaGraph = new BetaGraph(graph.client);\n    betaGraph.setComponent(graph.componentName);\n    return betaGraph;\n  }\n\n  constructor(client: Client, version: string = GRAPH_VERSION) {\n    super(client, version);\n  }\n\n  /**\n   * Returns a new instance of the Graph using the same\n   * client within the context of the provider.\n   *\n   * @param {Element} component\n   * @returns {BetaGraph}\n   * @memberof BetaGraph\n   */\n  public forComponent(component: Element | string): BetaGraph {\n    const graph = new BetaGraph(this.client);\n    this.setComponent(component);\n    return graph;\n  }\n}\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { LitElement, PropertyValueMap, PropertyValues } from 'lit';\nimport { state } from 'lit/decorators.js';\nimport { ProviderState } from '../providers/IProvider';\nimport { Providers } from '../providers/Providers';\nimport { LocalizationHelper } from '../utils/LocalizationHelper';\nimport { PACKAGE_VERSION } from '../utils/version';\n\n/**\n * Defines media query based on component width\n *\n * @export\n * @enum {string}\n */\nexport enum ComponentMediaQuery {\n  /**\n   * devices with width < 768\n   */\n  mobile = '',\n\n  /**\n   * devices with width < 1200\n   */\n  tablet = 'tablet',\n\n  /**\n   * devices with width > 1200\n   */\n  desktop = 'desktop'\n}\n\n/**\n * BaseComponent extends LitElement adding mgt specific features to all components\n *\n * @export  MgtBaseComponent\n * @abstract\n * @class MgtBaseComponent\n * @extends {LitElement}\n * @deprecated Use MgtBaseTaskComponent instead\n */\nexport abstract class MgtBaseComponent extends LitElement {\n  @state()\n  protected providerState: ProviderState = ProviderState.Loading;\n  /**\n   * Exposes the semver of the library the component is part of\n   *\n   * @readonly\n   * @static\n   * @memberof MgtBaseComponent\n   */\n  public static get packageVersion() {\n    return PACKAGE_VERSION;\n  }\n\n  /**\n   * Gets or sets the direction of the component\n   *\n   * @protected\n   * @memberof MgtBaseComponent\n   */\n  @state() protected direction: 'ltr' | 'rtl' | 'auto' = 'ltr';\n\n  /**\n   * Gets the ComponentMediaQuery of the component\n   *\n   * @readonly\n   * @type {MgtElement.ComponentMediaQuery}\n   * @memberof MgtBaseComponent\n   */\n  public get mediaQuery(): ComponentMediaQuery {\n    if (this.offsetWidth < 768) {\n      return ComponentMediaQuery.mobile;\n    } else if (this.offsetWidth < 1200) {\n      return ComponentMediaQuery.tablet;\n    } else {\n      return ComponentMediaQuery.desktop;\n    }\n  }\n\n  /**\n   * A flag to check if the component is loading data state.\n   *\n   * @protected\n   * @memberof MgtBaseComponent\n   */\n  protected get isLoadingState(): boolean {\n    return this._isLoadingState;\n  }\n\n  /**\n   * A flag to check if the component has updated once.\n   *\n   * @readonly\n   * @protected\n   * @type {boolean}\n   * @memberof MgtBaseComponent\n   */\n  protected get isFirstUpdated(): boolean {\n    return this._isFirstUpdated;\n  }\n\n  /**\n   * returns component strings\n   *\n   * @readonly\n   * @protected\n   * @memberof MgtBaseComponent\n   */\n  protected get strings(): Record<string, string> {\n    return {};\n  }\n\n  /**\n   * determines if login component is in loading state\n   *\n   * @type {boolean}\n   */\n  private _isLoadingState = false;\n\n  private _isFirstUpdated = false;\n  private _currentLoadStatePromise: Promise<unknown>;\n\n  constructor() {\n    super();\n    this.handleDirectionChanged();\n    this.handleLocalizationChanged();\n  }\n\n  /**\n   * Invoked each time the custom element is appended into a document-connected element\n   *\n   * @memberof MgtBaseComponent\n   */\n  public connectedCallback() {\n    super.connectedCallback();\n    LocalizationHelper.onStringsUpdated(this.handleLocalizationChanged);\n    LocalizationHelper.onDirectionUpdated(this.handleDirectionChanged);\n  }\n\n  /**\n   * Invoked each time the custom element is removed from a document-connected element\n   *\n   * @memberof MgtBaseComponent\n   */\n  public disconnectedCallback() {\n    super.disconnectedCallback();\n    LocalizationHelper.removeOnStringsUpdated(this.handleLocalizationChanged);\n    LocalizationHelper.removeOnDirectionUpdated(this.handleDirectionChanged);\n    Providers.removeProviderUpdatedListener(this.handleProviderUpdates);\n    Providers.removeActiveAccountChangedListener(this.handleActiveAccountUpdates);\n  }\n\n  /**\n   * Invoked when the element is first updated. Implement to perform one time\n   * work on the element after update.\n   *\n   * Setting properties inside this method will trigger the element to update\n   * again after this update cycle completes.\n   *\n   * @param _changedProperties Map of changed properties with old values\n   */\n  protected firstUpdated(changedProperties: PropertyValueMap<unknown> | Map<PropertyKey, unknown>): void {\n    super.firstUpdated(changedProperties);\n    this._isFirstUpdated = true;\n    Providers.onProviderUpdated(this.handleProviderUpdates);\n    Providers.onActiveAccountChanged(this.handleActiveAccountUpdates);\n    void this.requestStateUpdate();\n  }\n\n  /**\n   * load state into the component.\n   * Override this function to provide additional loading logic.\n   */\n  protected loadState(): Promise<void> {\n    return Promise.resolve();\n  }\n\n  /**\n   * Used to clear state in inherited components\n   */\n  protected clearState(): void {\n    // no-op\n  }\n\n  /**\n   * helps facilitate creation of events across components\n   *\n   * @protected\n   * @param {string} eventName\n   * @param {*} [detail]\n   * @param {boolean} [bubbles=false]\n   * @param {boolean} [cancelable=false]\n   * @param {boolean} [composed=false]\n   * @return {*}  {boolean}\n   * @memberof MgtBaseComponent\n   */\n  protected fireCustomEvent(\n    eventName: string,\n    detail?: unknown,\n    bubbles = false,\n    cancelable = false,\n    composed = false\n  ): boolean {\n    const event = new CustomEvent(eventName, {\n      bubbles,\n      cancelable,\n      composed,\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n      detail\n    });\n    return this.dispatchEvent(event);\n  }\n\n  /**\n   * Invoked whenever the element is updated. Implement to perform\n   * post-updating tasks via DOM APIs, for example, focusing an element.\n   *\n   * Setting properties inside this method will trigger the element to update\n   * again after this update cycle completes.\n   *\n   * * @param changedProperties Map of changed properties with old values\n   */\n  protected updated(changedProperties: PropertyValues) {\n    super.updated(changedProperties);\n    const event = new CustomEvent('updated', {\n      bubbles: true,\n      cancelable: true\n    });\n    this.dispatchEvent(event);\n  }\n\n  /**\n   * Request to reload the state.\n   * Use reload instead of load to ensure loading events are fired.\n   *\n   * @protected\n   * @memberof MgtBaseComponent\n   */\n  protected async requestStateUpdate(force = false): Promise<unknown> {\n    // the component is still bootstraping - wait until first updated\n    if (!this._isFirstUpdated) {\n      return;\n    }\n\n    // Wait for the current load promise to complete (unless forced).\n    if (this.isLoadingState && !force) {\n      await this._currentLoadStatePromise;\n    }\n\n    const provider = Providers.globalProvider;\n\n    if (!provider) {\n      return Promise.resolve();\n    }\n\n    if (provider.state === ProviderState.SignedOut) {\n      // Signed out, clear the component state\n      this.clearState();\n      return;\n    } else if (provider.state === ProviderState.Loading) {\n      // The provider state is indeterminate. Do nothing.\n      return Promise.resolve();\n    } else {\n      // Signed in, load the internal component state\n      // eslint-disable-next-line @typescript-eslint/no-misused-promises, no-async-promise-executor\n      const loadStatePromise = new Promise<void>(async (resolve, reject) => {\n        try {\n          this.setLoadingState(true);\n          this.fireCustomEvent('loadingInitiated');\n\n          await this.loadState();\n\n          this.setLoadingState(false);\n          this.fireCustomEvent('loadingCompleted');\n          resolve();\n        } catch (e) {\n          // Loading failed. Clear any partially set data.\n          this.clearState();\n\n          this.setLoadingState(false);\n          this.fireCustomEvent('loadingFailed');\n          reject(e);\n        }\n\n        // Return the load state promise.\n        // If loading + forced, chain the promises.\n        // This is to account for the lack of a cancellation token concept.\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-return, @typescript-eslint/no-unsafe-assignment\n        return (this._currentLoadStatePromise =\n          // eslint-disable-next-line @typescript-eslint/no-misused-promises\n          this.isLoadingState && !!this._currentLoadStatePromise && force\n            ? // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n              this._currentLoadStatePromise.then(() => loadStatePromise)\n            : loadStatePromise);\n      });\n    }\n  }\n\n  protected setLoadingState = (value: boolean) => {\n    if (this._isLoadingState === value) {\n      return;\n    }\n\n    this._isLoadingState = value;\n    this.requestUpdate('isLoadingState');\n  };\n\n  private readonly handleProviderUpdates = () => {\n    this.providerState = Providers.globalProvider?.state ?? ProviderState.Loading;\n    void this.requestStateUpdate();\n  };\n\n  private readonly handleActiveAccountUpdates = () => {\n    this.clearState();\n    void this.requestStateUpdate();\n  };\n\n  private readonly handleLocalizationChanged = () => {\n    LocalizationHelper.updateStringsForTag(this.tagName, this.strings);\n    this.requestUpdate();\n  };\n\n  private readonly handleDirectionChanged = () => {\n    this.direction = LocalizationHelper.getDocumentDirection();\n  };\n}\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { Task } from '@lit/task';\n\nimport { LitElement, PropertyValueMap, PropertyValues, TemplateResult, html } from 'lit';\nimport { state } from 'lit/decorators.js';\nimport { ProviderState } from '../providers/IProvider';\nimport { Providers } from '../providers/Providers';\nimport { LocalizationHelper } from '../utils/LocalizationHelper';\nimport { PACKAGE_VERSION } from '../utils/version';\nimport { ComponentMediaQuery } from './baseComponent';\n\n/**\n * BaseComponent extends LitElement adding mgt specific features to all components\n *\n * @export  MgtBaseTaskComponent\n * @abstract\n * @class MgtBaseTaskComponent\n * @extends {LitElement}\n */\nexport abstract class MgtBaseTaskComponent extends LitElement {\n  /**\n   * Supplies the component with a reactive property based on the current provider state\n   *\n   * @protected\n   * @memberof MgtBaseTaskComponent\n   */\n  @state() protected providerState: ProviderState = ProviderState.Loading;\n  /**\n   * Exposes the semver of the library the component is part of\n   *\n   * @readonly\n   * @static\n   * @memberof MgtBaseTaskComponent\n   */\n  public static get packageVersion() {\n    return PACKAGE_VERSION;\n  }\n\n  /**\n   * Gets or sets the direction of the component\n   *\n   * @protected\n   * @memberof MgtBaseTaskComponent\n   */\n  @state() protected direction: 'ltr' | 'rtl' | 'auto' = 'ltr';\n\n  /**\n   * Gets the ComponentMediaQuery of the component\n   *\n   * @readonly\n   * @type {MgtElement.ComponentMediaQuery}\n   * @memberof MgtBaseTaskComponent\n   */\n  public get mediaQuery(): ComponentMediaQuery {\n    if (this.offsetWidth < 768) {\n      return ComponentMediaQuery.mobile;\n    } else if (this.offsetWidth < 1200) {\n      return ComponentMediaQuery.tablet;\n    } else {\n      return ComponentMediaQuery.desktop;\n    }\n  }\n\n  /**\n   * A flag to check if the component has updated once.\n   *\n   * @readonly\n   * @protected\n   * @type {boolean}\n   * @memberof MgtBaseTaskComponent\n   */\n  protected get isFirstUpdated(): boolean {\n    return this._isFirstUpdated;\n  }\n\n  /**\n   * returns component strings\n   *\n   * @readonly\n   * @protected\n   * @memberof MgtBaseTaskComponent\n   */\n  protected get strings(): Record<string, string> {\n    return {};\n  }\n\n  private _isFirstUpdated = false;\n\n  constructor() {\n    super();\n    this.handleDirectionChanged();\n    this.handleLocalizationChanged();\n  }\n\n  /**\n   * Invoked each time the custom element is appended into a document-connected element\n   *\n   * @memberof MgtBaseTaskComponent\n   */\n  public connectedCallback() {\n    super.connectedCallback();\n    LocalizationHelper.onStringsUpdated(this.handleLocalizationChanged);\n    LocalizationHelper.onDirectionUpdated(this.handleDirectionChanged);\n  }\n\n  /**\n   * Invoked each time the custom element is removed from a document-connected element\n   *\n   * @memberof MgtBaseTaskComponent\n   */\n  public disconnectedCallback() {\n    super.disconnectedCallback();\n    LocalizationHelper.removeOnStringsUpdated(this.handleLocalizationChanged);\n    LocalizationHelper.removeOnDirectionUpdated(this.handleDirectionChanged);\n    Providers.removeProviderUpdatedListener(this.handleProviderUpdates);\n    Providers.removeActiveAccountChangedListener(this.handleActiveAccountUpdates);\n  }\n\n  /**\n   * Invoked when the element is first updated. Implement to perform one time\n   * work on the element after update.\n   *\n   * Setting properties inside this method will trigger the element to update\n   * again after this update cycle completes.\n   *\n   * @param _changedProperties Map of changed properties with old values\n   */\n  protected firstUpdated(changedProperties: PropertyValueMap<unknown> | Map<PropertyKey, unknown>): void {\n    super.firstUpdated(changedProperties);\n    this._isFirstUpdated = true;\n    Providers.onProviderUpdated(this.handleProviderUpdates);\n    Providers.onActiveAccountChanged(this.handleActiveAccountUpdates);\n  }\n\n  /**\n   * Used to clear state in inherited components\n   */\n  protected clearState(): void {\n    // no-op\n  }\n\n  /**\n   * helps facilitate creation of events across components\n   *\n   * @protected\n   * @param {string} eventName\n   * @param {*} [detail]\n   * @param {boolean} [bubbles=false]\n   * @param {boolean} [cancelable=false]\n   * @param {boolean} [composed=false]\n   * @return {*}  {boolean}\n   * @memberof MgtBaseTaskComponent\n   */\n  protected fireCustomEvent(\n    eventName: string,\n    detail?: unknown,\n    bubbles = false,\n    cancelable = false,\n    composed = false\n  ): boolean {\n    const event = new CustomEvent(eventName, {\n      bubbles,\n      cancelable,\n      composed,\n      detail\n    });\n    return this.dispatchEvent(event);\n  }\n\n  /**\n   * Invoked whenever the element is updated. Implement to perform\n   * post-updating tasks via DOM APIs, for example, focusing an element.\n   *\n   * Setting properties inside this method will trigger the element to update\n   * again after this update cycle completes.\n   *\n   * * @param changedProperties Map of changed properties with old values\n   */\n  protected updated(changedProperties: PropertyValues) {\n    super.updated(changedProperties);\n    this.fireCustomEvent('updated', undefined, true, false);\n  }\n\n  /**\n   * load state into the component.\n   * Override this function to provide actual loading logic.\n   */\n  protected async loadState() {\n    return Promise.resolve();\n  }\n\n  /**\n   * Override this function to provide the actual list of properties to trigger the task to run.\n   * The default implementation returns an array with the providerState.\n   * @returns {unknown[]} the properties when changed which trigger the Task to run\n   */\n  protected args(): unknown[] {\n    return [this.providerState];\n  }\n\n  /**\n   * Task that is run whenever one of the args changes\n   * By default this task will call loadState\n   */\n  protected _task = new Task(this, {\n    task: () => this.loadState(),\n    args: () => this.args()\n  });\n\n  /**\n   * Invoked on each update to perform rendering tasks. This method must return\n   * a lit-html TemplateResult. Setting properties inside this method will *not*\n   * trigger the element to update.\n   */\n  protected render() {\n    return this._task.render({\n      pending: this.renderLoading,\n      complete: this.renderContent,\n      error: this.renderError\n    });\n  }\n\n  /**\n   * A default loading template.\n   * @returns default loading template\n   */\n  protected renderLoading = (): TemplateResult => {\n    return html`<span>Loading...</span>`;\n  };\n\n  protected renderError = (e: unknown): TemplateResult => {\n    return html`<p>Error: ${e}</p>`;\n  };\n\n  protected renderContent = (): TemplateResult => {\n    return html`<!-- baseTaskComponent, please implement renderContent -->`;\n  };\n\n  private readonly handleProviderUpdates = () => {\n    this.providerState = Providers.globalProvider?.state ?? ProviderState.Loading;\n  };\n\n  private readonly handleActiveAccountUpdates = () => {\n    this.clearState();\n  };\n\n  private readonly handleLocalizationChanged = () => {\n    LocalizationHelper.updateStringsForTag(this.tagName, this.strings);\n    this.requestUpdate();\n  };\n\n  private readonly handleDirectionChanged = () => {\n    this.direction = LocalizationHelper.getDocumentDirection();\n  };\n}\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\ntype ContextualTemplateElement = HTMLTemplateElement & {\n  /**\n   * The data context of the parent template\n   */\n  $parentTemplateContext?: object;\n};\n\n/**\n * Helper class for Template Instantiation\n *\n * @export\n * @class TemplateHelper\n */\nexport class TemplateHelper {\n  /**\n   * Render a template into a HTMLElement with the appropriate data context\n   *\n   * Ex:\n   * ```\n   * <template>\n   *  <div>{{myObj.someStr}}</div>\n   *  <div data-for=\"key in myObj.list\">\n   *    <div>{{key.anotherStr}}</div>\n   *  </div>\n   * </template>\n   * ```\n   *\n   * @param root the root element to parent the rendered content\n   * @param template the template to render\n   * @param context the data context to be applied\n   */\n  public static renderTemplate(root: HTMLElement, template: ContextualTemplateElement, context: object) {\n    // inherit context from parent template\n    if (template.$parentTemplateContext) {\n      context = { ...context, $parent: template.$parentTemplateContext };\n    }\n\n    let rendered: Node;\n\n    if (template.content?.childNodes.length) {\n      const templateContent = template.content.cloneNode(true);\n      rendered = this.renderNode(templateContent, root, context);\n    } else if (template.childNodes.length) {\n      const div = document.createElement('div');\n\n      for (const node of template.childNodes) {\n        div.appendChild(this.simpleCloneNode(node));\n      }\n      rendered = this.renderNode(div, root, context);\n    }\n\n    if (rendered) {\n      root.appendChild(rendered);\n    }\n  }\n\n  /**\n   * Set an alternative binding syntax. Default is {{ <value> }}\n   *\n   * @static\n   * @param {string} startStr start of binding syntax\n   * @param {string} endStr end of binding syntax\n   * @memberof TemplateHelper\n   */\n  public static setBindingSyntax(startStr: string, endStr: string) {\n    this._startExpression = startStr;\n    this._endExpression = endStr;\n\n    const start = this.escapeRegex(this._startExpression);\n    const end = this.escapeRegex(this._endExpression);\n\n    this._expression = new RegExp(`${start}\\\\s*([$\\\\w\\\\.,'\"\\\\s()\\\\[\\\\]]+)\\\\s*${end}`, 'g');\n  }\n\n  /**\n   * Global context containing data or functions available to\n   * all templates for binding\n   *\n   * @readonly\n   * @static\n   * @memberof TemplateHelper\n   */\n  public static get globalContext() {\n    return this._globalContext;\n  }\n\n  private static readonly _globalContext = {};\n\n  private static get expression() {\n    if (!this._expression) {\n      this.setBindingSyntax('{{', '}}');\n    }\n\n    return this._expression;\n  }\n\n  private static _startExpression: string;\n  private static _endExpression: string;\n  private static _expression: RegExp;\n\n  private static escapeRegex(string: string) {\n    return string.replace(/[-/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&');\n  }\n\n  // simple implementation of deep cloneNode\n  // required for nested templates in polyfilled browsers\n  private static simpleCloneNode(node: ChildNode) {\n    if (!node) {\n      return null;\n    }\n\n    const clone = node.cloneNode(false);\n\n    for (const child of node.childNodes) {\n      const childClone = this.simpleCloneNode(child);\n      if (childClone) {\n        clone.appendChild(childClone);\n      }\n    }\n\n    return clone;\n  }\n\n  private static expandExpressionsAsString(str: string, context: object) {\n    return str.replace(this.expression, (match: string, p1: string) => {\n      const value = this.evalInContext(p1 || this.trimExpression(match), context);\n      if (value) {\n        if (typeof value === 'object') {\n          return JSON.stringify(value);\n        } else {\n          // eslint-disable-next-line @typescript-eslint/no-base-to-string\n          return value.toString();\n        }\n      }\n      return '';\n    });\n  }\n\n  private static renderNode(node: Node, root: HTMLElement, context: object) {\n    if (node.nodeName === '#text') {\n      node.textContent = this.expandExpressionsAsString(node.textContent, context);\n      return node;\n    } else if (node.nodeName === 'TEMPLATE') {\n      (node as ContextualTemplateElement).$parentTemplateContext = context;\n      return node;\n    }\n\n    const nodeElement = node as HTMLElement;\n\n    // replace attribute values\n    if (nodeElement.attributes) {\n      for (const attribute of nodeElement.attributes) {\n        if (attribute.name === 'data-props') {\n          const propsValue = this.trimExpression(attribute.value);\n          for (const prop of propsValue.split(',')) {\n            const keyValue = prop.trim().split(':');\n            if (keyValue.length === 2) {\n              const key = keyValue[0].trim();\n              const value = this.evalInContext(keyValue[1].trim(), context);\n\n              if (key.startsWith('@')) {\n                // event\n                if (typeof value === 'function') {\n                  // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n                  nodeElement.addEventListener(key.substring(1), e => value(e, context, root));\n                }\n              } else {\n                nodeElement[key] = value;\n              }\n            }\n          }\n        } else {\n          nodeElement.setAttribute(attribute.name, this.expandExpressionsAsString(attribute.value, context));\n        }\n      }\n    }\n\n    // don't process nodes that will loop yet, but\n    // keep a reference of them\n    const loopChildren: HTMLElement[] = [];\n\n    // list of children to remove (ex, when data-if == false)\n    const removeChildren = [];\n    let previousChildWasIfAndTrue = false;\n\n    for (const childNode of node.childNodes) {\n      const childElement = childNode as HTMLElement;\n      let previousChildWasIfAndTrueSet = false;\n\n      if (childElement.dataset) {\n        let childWillBeRemoved = false;\n\n        if (childElement.dataset.if) {\n          const expression = childElement.dataset.if;\n          if (!this.evalBoolInContext(this.trimExpression(expression), context)) {\n            removeChildren.push(childElement);\n            childWillBeRemoved = true;\n          } else {\n            childElement.removeAttribute('data-if');\n            previousChildWasIfAndTrue = true;\n            previousChildWasIfAndTrueSet = true;\n          }\n        } else if (typeof childElement.dataset.else !== 'undefined') {\n          if (previousChildWasIfAndTrue) {\n            removeChildren.push(childElement);\n            childWillBeRemoved = true;\n          } else {\n            childElement.removeAttribute('data-else');\n          }\n        }\n\n        if (childElement.dataset.for && !childWillBeRemoved) {\n          loopChildren.push(childElement);\n        } else if (!childWillBeRemoved) {\n          this.renderNode(childNode, root, context);\n        }\n      } else {\n        this.renderNode(childNode, root, context);\n      }\n\n      // clear the flag if the current node wasn't data-if\n      // or if it was data-if but it wasn't true\n      if (!previousChildWasIfAndTrueSet && childNode.nodeName !== '#text') {\n        previousChildWasIfAndTrue = false;\n      }\n    }\n\n    // now handle nodes that need to be removed\n    for (const child of removeChildren) {\n      nodeElement.removeChild(child);\n    }\n\n    // now handle nodes that should loop\n    for (const childElement of loopChildren) {\n      const loopExpression = childElement.dataset.for;\n      const loopTokens = this.trimExpression(loopExpression).split(/\\s(in|of)\\s/i);\n\n      if (loopTokens.length === 3) {\n        // don't really care what's in the middle at this point\n        const itemName = loopTokens[0].trim();\n        const listKey = loopTokens[2].trim();\n\n        const list = this.evalInContext(listKey, context);\n        if (Array.isArray(list)) {\n          // first remove the child\n          // we will need to make copy of the child for\n          // each element in the list\n          childElement.removeAttribute('data-for');\n\n          for (let j = 0; j < list.length; j++) {\n            const newContext = {\n              $index: j,\n              ...context\n            };\n            // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n            newContext[itemName] = list[j];\n\n            const clone = childElement.cloneNode(true);\n            this.renderNode(clone, root, newContext);\n            nodeElement.insertBefore(clone, childElement);\n          }\n        }\n        nodeElement.removeChild(childElement);\n      }\n    }\n\n    return node;\n  }\n\n  private static evalBoolInContext(expression: string, context: object): boolean {\n    context = { ...context, ...this.globalContext };\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-return, @typescript-eslint/no-implied-eval\n    return new Function('with(this) { return !!(' + expression + ')}').call(context);\n  }\n\n  private static evalInContext(expression: string, context: object): unknown {\n    context = { ...context, ...this.globalContext };\n    // eslint-disable-next-line @typescript-eslint/no-implied-eval\n    const func = new Function('with(this) { return ' + expression + ';}');\n    let result: unknown;\n    try {\n      result = func.call(context);\n    } catch (e) {\n      /* empty */\n    }\n    return result;\n  }\n\n  private static trimExpression(expression: string) {\n    expression = expression.trim();\n\n    if (expression.startsWith(this._startExpression) && expression.endsWith(this._endExpression)) {\n      expression = expression.substr(\n        this._startExpression.length,\n        expression.length - this._startExpression.length - this._endExpression.length\n      );\n      expression = expression.trim();\n    }\n\n    return expression;\n  }\n}\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { property, state } from 'lit/decorators.js';\nimport { html, PropertyValueMap, PropertyValues, TemplateResult } from 'lit';\n\nimport { equals } from '../utils/equals';\nimport { TemplateContext } from '../utils/TemplateContext';\nimport { TemplateHelper } from '../utils/TemplateHelper';\nimport { MgtBaseTaskComponent } from './baseTaskComponent';\nimport { OrderedHtmlTemplate, RenderedTemplates, TemplateRenderedData } from './templatedComponent';\n\n/**\n * An abstract class that defines a templatable web component\n *\n * @export\n * @abstract\n * @class MgtTemplatedTaskComponent\n * @extends {MgtBaseTaskComponent}\n *\n * @fires {CustomEvent<MgtElement.TemplateRenderedData>} templateRendered - fires when a template is rendered\n */\nexport abstract class MgtTemplatedTaskComponent extends MgtBaseTaskComponent {\n  /**\n   * Additional data context to be used in template binding\n   * Use this to add event listeners or value converters\n   *\n   * @type {MgtElement.TemplateContext}\n   * @memberof MgtTemplatedTaskComponent\n   */\n  @property({ attribute: false }) public templateContext: TemplateContext;\n\n  /**\n   *\n   * Gets or sets the error (if any) of the request\n   *\n   * @type object\n   * @memberof MgtSearchResults\n   */\n  @state() protected error: object;\n\n  /**\n   * Holds all templates defined by developer\n   *\n   * @protected\n   * @memberof MgtTemplatedTaskComponent\n   */\n  protected templates: Record<string, OrderedHtmlTemplate> = {};\n\n  private _renderedSlots = false;\n  private _renderedTemplates: RenderedTemplates = {};\n  private _slotNamesAddedDuringRender = [];\n\n  constructor() {\n    super();\n\n    this.templateContext = this.templateContext || {};\n  }\n\n  /**\n   * Render the loading state\n   *\n   * @protected\n   * @returns {TemplateResult}\n   * @memberof MgtFile\n   */\n  protected renderLoading = (): TemplateResult => {\n    return this.renderTemplate('loading', null) || html``;\n  };\n\n  /**\n   * Updates the element. This method reflects property values to attributes.\n   * It can be overridden to render and keep updated element DOM.\n   * Setting properties inside this method will *not* trigger\n   * another update.\n   *\n   * * @param _changedProperties Map of changed properties with old values\n   */\n  protected update(changedProperties: PropertyValueMap<unknown> | Map<PropertyKey, unknown>) {\n    this.templates = this.getTemplates();\n    this._slotNamesAddedDuringRender = [];\n    super.update(changedProperties);\n  }\n\n  /**\n   * Invoked whenever the element is updated. Implement to perform\n   * post-updating tasks via DOM APIs, for example, focusing an element.\n   *\n   * Setting properties inside this method will trigger the element to update\n   * again after this update cycle completes.\n   *\n   * * @param changedProperties Map of changed properties with old values\n   */\n  protected updated(changedProperties: PropertyValues) {\n    super.updated(changedProperties);\n    this.removeUnusedSlottedElements();\n  }\n\n  /**\n   * Render a <template> by type and return content to render\n   *\n   * @param templateType type of template (indicated by the data-type attribute)\n   * @param context the data context that should be expanded in template\n   * @param slotName the slot name that will be used to host the new rendered template. set to a unique value if multiple templates of this type will be rendered. default is templateType\n   */\n  protected renderTemplate(templateType: string, context: object, slotName?: string): TemplateResult {\n    if (!this.hasTemplate(templateType)) {\n      return null;\n    }\n\n    slotName = slotName || templateType;\n    this._slotNamesAddedDuringRender.push(slotName);\n    this._renderedSlots = true;\n\n    const template = html`\n      <slot name=${slotName}></slot>\n    `;\n\n    const dataContext = { ...context, ...this.templateContext };\n\n    if (Object.prototype.hasOwnProperty.call(this._renderedTemplates, slotName)) {\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n      const { context: existingContext, slot } = this._renderedTemplates[slotName];\n      if (equals(existingContext, dataContext)) {\n        return template;\n      }\n      this.removeChild(slot);\n    }\n\n    const div = document.createElement('div');\n    div.slot = slotName;\n    div.dataset.generated = 'template';\n\n    TemplateHelper.renderTemplate(div, this.templates[templateType], dataContext);\n\n    this.appendChild(div);\n\n    this._renderedTemplates[slotName] = { context: dataContext, slot: div };\n\n    const templateRenderedData: TemplateRenderedData = { templateType, context: dataContext, element: div };\n    this.fireCustomEvent('templateRendered', templateRenderedData);\n\n    return template;\n  }\n\n  /**\n   * Check if a specific template has been provided.\n   *\n   * @protected\n   * @param {string} templateName\n   * @returns {boolean}\n   * @memberof MgtTemplatedTaskComponent\n   */\n  protected hasTemplate(templateName: string): boolean {\n    return Boolean(this.templates?.[templateName]);\n  }\n\n  private getTemplates() {\n    const templates: Record<string, OrderedHtmlTemplate> = {};\n\n    for (let i = 0; i < this.children.length; i++) {\n      const child = this.children[i];\n      if (child.nodeName === 'TEMPLATE') {\n        const template = child as OrderedHtmlTemplate;\n        if (template.dataset.type) {\n          templates[template.dataset.type] = template;\n        } else {\n          templates.default = template;\n        }\n\n        template.templateOrder = i;\n      }\n    }\n\n    return templates;\n  }\n\n  /**\n   * Renders an error\n   *\n   * @returns\n   */\n  protected renderError = (e: unknown): TemplateResult => {\n    if (this.hasTemplate('error')) {\n      return this.renderTemplate('error', e as object);\n    }\n\n    return html`\n      <div class=\"error\">\n        ${e}\n      </div>\n    `;\n  };\n\n  private removeUnusedSlottedElements() {\n    if (this._renderedSlots) {\n      for (let i = 0; i < this.children.length; i++) {\n        const child = this.children[i] as HTMLElement;\n        if (child.dataset?.generated && !this._slotNamesAddedDuringRender.includes(child.slot)) {\n          this.removeChild(child);\n          delete this._renderedTemplates[child.slot];\n          i--;\n        }\n      }\n      this._renderedSlots = false;\n    }\n  }\n}\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { IDBPObjectStore, openDB } from 'idb';\nimport { Providers } from '../providers/Providers';\nimport { CacheItem, CacheSchema, Index, dbListKey } from './CacheService';\n\n/**\n * Represents a store in the cache\n *\n * @class CacheStore\n * @template T\n */\n\nexport class CacheStore<T extends CacheItem> {\n  private readonly schema: CacheSchema;\n  private readonly store: string;\n\n  public constructor(schema: CacheSchema, store: string) {\n    if (!(store in schema.stores)) {\n      throw Error('\"store\" must be defined in the \"schema\"');\n    }\n\n    this.schema = schema;\n    this.store = store;\n  }\n\n  /**\n   * gets value from cache for the given key\n   *\n   * @param {string} key\n   * @returns {Promise<T>}\n   * @memberof Cache\n   */\n  public async getValue(key: string): Promise<T | null> {\n    if (!window.indexedDB) {\n      return null;\n    }\n    try {\n      const db = await this.getDb();\n      return db.get(this.store, key) as unknown as T;\n    } catch (e) {\n      return null;\n    }\n  }\n\n  /**\n   * removes a value from the cache for the given key\n   *\n   * @param {string} key\n   * @returns {Promise<void>}\n   * @memberof Cache\n   */\n  public async delete(key: string): Promise<void> {\n    if (!window.indexedDB) {\n      return;\n    }\n    try {\n      const db = await this.getDb();\n      return db.delete(this.store, key);\n    } catch (e) {\n      return;\n    }\n  }\n\n  /**\n   * inserts value into cache for the given key\n   *\n   * @param {string} key\n   * @param {T} item\n   * @returns\n   * @memberof Cache\n   */\n  public async putValue(key: string, item: T) {\n    if (!window.indexedDB) {\n      return;\n    }\n    try {\n      await (await this.getDb()).put(this.store, { ...item, timeCached: Date.now() }, key);\n    } catch (e) {\n      return;\n    }\n  }\n\n  /**\n   * Clears the store of all stored values\n   *\n   * @returns\n   * @memberof Cache\n   */\n  public async clearStore() {\n    if (!window.indexedDB) {\n      return;\n    }\n    try {\n      await (await this.getDb()).clear(this.store);\n    } catch (e) {\n      return;\n    }\n  }\n\n  /**\n   * Returns the name of the parent DB that the cache store belongs to\n   */\n  public async getDBName() {\n    const id = await Providers.getCacheId();\n    if (id) {\n      return `mgt-${this.schema.name}` + `-${id}`;\n    }\n  }\n\n  private async getDb() {\n    const dbName = await this.getDBName();\n    if (dbName) {\n      return openDB(dbName, this.schema.version, {\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        upgrade: (db, _oldVersion, _newVersion, transaction) => {\n          const dbArray: string[] = (JSON.parse(localStorage.getItem(dbListKey)) as string[]) || [];\n          if (!dbArray.includes(dbName)) {\n            dbArray.push(dbName);\n          }\n          localStorage.setItem(dbListKey, JSON.stringify(dbArray));\n          for (const storeName in this.schema.stores) {\n            if (Object.prototype.hasOwnProperty.call(this.schema.stores, storeName)) {\n              const indexes: Index[] = this.schema.indexes?.[storeName] ?? [];\n              if (!db.objectStoreNames.contains(storeName)) {\n                const objectStore = db.createObjectStore(storeName);\n                indexes.forEach(i => {\n                  objectStore.createIndex(i.name, i.field);\n                });\n              } else {\n                const store = transaction.objectStore(storeName);\n                indexes.forEach(i => {\n                  if (store && !store.indexNames.contains(i.name)) {\n                    store.createIndex(i.name, i.field);\n                  }\n                });\n              }\n            }\n          }\n        }\n      });\n    }\n  }\n\n  public async queryDb(indexName: string, query: IDBKeyRange | IDBValidKey): Promise<T[]> {\n    const db = await this.getDb();\n    return (await db.getAllFromIndex(this.store, indexName, query)) as T[];\n  }\n\n  /**\n   * Helper function to get a wrapping transaction for an action function\n   * @param action a function that takes an object store uses it to make changes to the cache\n   */\n  public async transaction(action: (store: IDBPObjectStore<unknown, [string], string, 'readwrite'>) => Promise<void>) {\n    const db = await this.getDb();\n    const tx = db.transaction(this.store, 'readwrite');\n    const store = tx.objectStore(this.store);\n    await action(store);\n    await tx.done;\n  }\n}\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { Providers } from '../providers/Providers';\nimport { ProviderState } from '../providers/IProvider';\nimport { CacheStore } from './CacheStore';\nimport { error } from './Logging';\n\n/**\n * Localstorage key for storing names of cache databases\n *\n * @type {string}\n *\n */\n\nexport const dbListKey = 'mgt-db-list';\n\n/**\n * Holds the cache options for cache store\n *\n * @export\n * @interface CacheConfig\n */\nexport interface CacheConfig {\n  /**\n   * Default global invalidation period\n   *\n   * @type {number}\n   * @memberof CacheConfig\n   */\n  defaultInvalidationPeriod: number;\n  /**\n   * Controls whether the cache is enabled globally\n   *\n   * @type {boolean}\n   * @memberof CacheConfig\n   */\n  isEnabled: boolean;\n  /**\n   * Cache options for groups store\n   *\n   * @type {CacheOptions}\n   * @memberof CacheConfig\n   */\n  groups: CacheOptions;\n  /**\n   * Cache options for people store\n   *\n   * @type {CacheOptions}\n   * @memberof CacheConfig\n   */\n  people: CacheOptions;\n  /**\n   * Cache options for photos store\n   *\n   * @type {CacheOptions}\n   * @memberof CacheConfig\n   */\n  photos: CacheOptions;\n  /**\n   * Cache options for presence store\n   *\n   * @type {CacheOptions}\n   * @memberof CacheConfig\n   */\n\n  presence: CacheOptions;\n  /**\n   * Cache options for users store\n   *\n   * @type {CacheOptions}\n   * @memberof CacheConfig\n   */\n  users: CacheOptions;\n\n  /**\n   * Cache options for a generic response store\n   *\n   * @type {CacheOptions}\n   * @memberof CacheConfig\n   */\n  response: CacheOptions;\n\n  /**\n   * Cache options for files store\n   *\n   * @type {CacheOptions}\n   * @memberof CacheConfig\n   */\n  files: CacheOptions;\n  /**\n   * Cache options for fileLists store\n   *\n   * @type {CacheOptions}\n   * @memberof CacheConfig\n   */\n  fileLists: CacheOptions;\n  /**\n   * Cache options for conversation store\n   *\n   * @type {CacheOptions}\n   * @memberof CacheConfig\n   */\n  conversation: CacheOptions;\n}\n\n/**\n * Options for each store\n *\n * @export\n * @interface CacheOptions\n */\nexport interface CacheOptions {\n  /**\n   * Defines the time (in ms) for objects in the store to expire\n   *\n   * @type {number}\n   * @memberof CacheOptions\n   */\n  invalidationPeriod: number;\n  /**\n   * Whether the store is enabled or not\n   *\n   * @type {boolean}\n   * @memberof CacheOptions\n   */\n  isEnabled: boolean;\n}\n\n/**\n * class in charge of managing all the caches and their stores\n *\n * @export\n * @class CacheService\n */\nexport class CacheService {\n  /**\n   * Looks for existing cache, otherwise creates a new one\n   *\n   * @static\n   * @template T\n   * @param {CacheSchema} schema\n   * @param {string} storeName\n   * @returns {CacheStore<T>}\n   * @memberof CacheService\n   */\n  public static getCache<T extends CacheItem>(schema: CacheSchema, storeName: string): CacheStore<T> {\n    const key = `${schema.name}/${storeName}`;\n\n    if (!this.isInitialized) {\n      this.init();\n    }\n\n    if (!this.cacheStore.has(storeName)) {\n      this.cacheStore.set(key, new CacheStore<T>(schema, storeName));\n    }\n    return this.cacheStore.get(key) as CacheStore<T>;\n  }\n\n  /**\n   * Clears cache for a single user when ID is passed\n   *\n   * @static\n   * @param {string} id\n   * @memberof CacheService\n   */\n  public static clearCacheById(id: string): Promise<unknown> {\n    const work: Promise<void>[] = [];\n    const oldDbArray: string[] = JSON.parse(localStorage.getItem(dbListKey)) as string[];\n    if (oldDbArray) {\n      const newDbArray: string[] = [];\n      oldDbArray.forEach(x => {\n        if (x.includes(id)) {\n          work.push(\n            new Promise<void>((resolve, reject) => {\n              const delReq = indexedDB.deleteDatabase(x);\n              delReq.onsuccess = () => resolve();\n              delReq.onerror = () => {\n                error(`${delReq.error.name} occurred deleting cache: ${x}`, delReq.error.message);\n                reject();\n              };\n            })\n          );\n        } else {\n          newDbArray.push(x);\n        }\n      });\n      if (newDbArray.length > 0) {\n        localStorage.setItem(dbListKey, JSON.stringify(newDbArray));\n      } else {\n        localStorage.removeItem(dbListKey);\n      }\n    }\n    return Promise.all(work);\n  }\n\n  private static readonly cacheStore = new Map<string, CacheStore<CacheItem>>();\n  private static isInitialized = false;\n\n  private static readonly cacheConfig: CacheConfig = {\n    defaultInvalidationPeriod: 3600000,\n    groups: {\n      invalidationPeriod: null,\n      isEnabled: true\n    },\n    isEnabled: true,\n    people: {\n      invalidationPeriod: null,\n      isEnabled: true\n    },\n    photos: {\n      invalidationPeriod: null,\n      isEnabled: true\n    },\n    presence: {\n      invalidationPeriod: 300000,\n      isEnabled: true\n    },\n    users: {\n      invalidationPeriod: null,\n      isEnabled: true\n    },\n    response: {\n      invalidationPeriod: null,\n      isEnabled: true\n    },\n    files: {\n      invalidationPeriod: null,\n      isEnabled: true\n    },\n    fileLists: {\n      invalidationPeriod: null,\n      isEnabled: true\n    },\n    conversation: {\n      invalidationPeriod: 5 * 24 * 60 * 60 * 1000,\n      isEnabled: true\n    }\n  };\n\n  /**\n   * returns the cacheconfig object\n   *\n   * @readonly\n   * @static\n   * @type {CacheConfig}\n   * @memberof CacheService\n   */\n  public static get config(): CacheConfig {\n    return this.cacheConfig;\n  }\n\n  /**\n   * Checks for current sign in state and see if it has changed from signed-in to signed out\n   *\n   *\n   * @private\n   * @static\n   * @memberof CacheService\n   */\n  private static init() {\n    let previousState: ProviderState;\n    if (Providers.globalProvider) {\n      previousState = Providers.globalProvider.state;\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-misused-promises\n    Providers.onProviderUpdated(async () => {\n      if (previousState === ProviderState.SignedIn && Providers.globalProvider.state === ProviderState.SignedOut) {\n        const id = await Providers.getCacheId();\n        if (id !== null) {\n          await this.clearCacheById(id);\n        }\n      }\n      previousState = Providers.globalProvider.state;\n    });\n    this.isInitialized = true;\n  }\n}\n\nexport interface Index {\n  name: string;\n  field: string;\n}\n\n/**\n * Represents organization for a cache\n *\n * @export\n * @interface CacheSchema\n */\nexport interface CacheSchema {\n  /**\n   * version number of cache, useful for upgrading\n   *\n   * @type {number}\n   * @memberof CacheSchema\n   */\n  version: number;\n  /**\n   * name of the cache\n   *\n   * @type {string}\n   * @memberof CacheSchema\n   */\n  name: string;\n  /**\n   * list of stores in the cache\n   *\n   * @type {{ [name: string]: CacheSchemaStore }}\n   * @memberof CacheSchema\n   */\n  stores: Record<string, string>;\n  /**\n   * Optional field to define indexed fields on a per store basis\n   * K is the name of the store for which the indexes should be applied\n   * T is the names of the fields on the stored data to be indexed\n   */\n  indexes?: Record<string, Index[]>;\n}\n\n/**\n * item that is stored in cache\n *\n * @export\n * @interface CacheItem\n */\nexport interface CacheItem {\n  /**\n   * date and time that item was retrieved from api/stored in cache\n   *\n   * @type {number}\n   * @memberof CacheItem\n   */\n  timeCached?: number;\n}\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { GraphRequest } from '@microsoft/microsoft-graph-client';\nimport { IGraph } from '../IGraph';\nimport { CollectionResponse } from '../CollectionResponse';\n\n/**\n * A helper class to assist in getting multiple pages from a resource\n *\n * @export\n * @class GraphPageIterator\n * @template T\n */\nexport class GraphPageIterator<T> {\n  /**\n   * Gets all the items already fetched for this request\n   *\n   * @readonly\n   * @type {T[]}\n   * @memberof GraphPageIterator\n   */\n  public get value(): T[] {\n    return this._value;\n  }\n\n  /**\n   * Gets wheather this request has more pages\n   *\n   * @readonly\n   * @type {boolean}\n   * @memberof GraphPageIterator\n   */\n  public get hasNext(): boolean {\n    return Boolean(this._nextLink);\n  }\n\n  /**\n   * Creates a new GraphPageIterator\n   *\n   * @static\n   * @template T - the type of entities expected from this request\n   * @param {IGraph} graph - the graph instance to use for making requests\n   * @param {GraphRequest} request - the initial request\n   * @param {string} [version] - optional version to use for the requests - by default uses the default version\n   * from the graph parameter\n   * @returns a GraphPageIterator\n   * @memberof GraphPageIterator\n   */\n  public static async create<T>(graph: IGraph, request: GraphRequest, version?: string): Promise<GraphPageIterator<T>> {\n    const response = (await request.get()) as CollectionResponse<T>;\n    if (response?.value) {\n      const iterator = new GraphPageIterator<T>();\n      iterator._graph = graph;\n      iterator._value = response.value;\n      iterator._nextLink = response['@odata.nextLink'] as string;\n      iterator._version = version || graph.version;\n      return iterator;\n    }\n\n    return null;\n  }\n\n  /**\n   * Creates a new GraphPageIterator from existing value\n   *\n   * @static\n   * @template T - the type of entities expected from this request\n   * @param {IGraph} graph - the graph instance to use for making requests\n   * @param value - the existing value\n   * @param nextLink - optional nextLink to use to get the next page\n   * from the graph parameter\n   * @returns a GraphPageIterator\n   * @memberof GraphPageIterator\n   */\n  public static createFromValue<T>(graph: IGraph, value: T[], nextLink: string = null): GraphPageIterator<T> {\n    const iterator = new GraphPageIterator<T>();\n\n    // create iterator from values\n    iterator._graph = graph;\n    iterator._value = value;\n    iterator._nextLink = nextLink;\n    iterator._version = graph.version;\n\n    return iterator;\n  }\n\n  private _graph: IGraph;\n  private _nextLink: string;\n  /**\n   * Gets the next link for this request\n   *\n   * @readonly\n   * @type {string}\n   * @memberof GraphPageIterator\n   */\n  public get nextLink(): string {\n    return this._nextLink || '';\n  }\n  private _version: string;\n  private _value: T[];\n\n  /**\n   * Gets the next page for this request\n   *\n   * @returns {Promise<T[]>}\n   * @memberof GraphPageIterator\n   */\n  public async next(): Promise<T[]> {\n    if (this._nextLink) {\n      const nextResource = this._nextLink.split(this._version)[1];\n      const response = (await this._graph.api(nextResource).version(this._version).get()) as CollectionResponse<T>;\n      if (response?.value?.length) {\n        this._value = this._value.concat(response.value);\n        this._nextLink = response['@odata.nextLink'] as string;\n        return response.value;\n      }\n    }\n    return null;\n  }\n}\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { EventDispatcher, EventHandler } from './EventDispatcher';\n\ntype ComponentLocalizationRecord = Record<string, string>;\ntype LocalizationRecord = Record<string, ComponentLocalizationRecord>;\n\ntype LocalizationStorage = {\n  _components: LocalizationRecord;\n} & Record<string, string | LocalizationRecord>;\n\n/**\n * Helper class for Localization\n *\n *\n * @export\n * @class LocalizationHelper\n */\nexport class LocalizationHelper {\n  static _strings: LocalizationStorage;\n\n  static _stringsEventDispatcher = new EventDispatcher<unknown>();\n\n  static _directionEventDispatcher = new EventDispatcher<unknown>();\n\n  private static mutationObserver: MutationObserver;\n\n  public static get strings() {\n    return this._strings;\n  }\n\n  /**\n   * Set strings to be localized\n   *\n   * @static\n   * @memberof LocalizationHelper\n   */\n  public static set strings(value: LocalizationStorage) {\n    this._strings = value;\n    this._stringsEventDispatcher.fire(null);\n  }\n\n  /**\n   * returns body dir attribute to determine rtl or ltr\n   *\n   * @static\n   * @returns {string} dir\n   * @memberof LocalizationHelper\n   */\n  public static getDocumentDirection(): 'rtl' | 'ltr' | 'auto' {\n    // Re-set the dir to ltr if the dir attribute is already loaded and the first two options\n    // are returning null values.\n    const parsed = document.body?.getAttribute('dir') || document.documentElement?.getAttribute('dir');\n    switch (parsed) {\n      case 'rtl':\n        return 'rtl';\n      case 'auto':\n        return 'auto';\n      case 'ltr':\n      default:\n        return 'ltr';\n    }\n  }\n\n  /**\n   * Fires event when LocalizationHelper changes state\n   *\n   * @static\n   * @param {EventHandler<ProvidersChangedState>} event\n   * @memberof LocalizationHelper\n   */\n  public static onStringsUpdated(event: EventHandler<unknown>) {\n    this._stringsEventDispatcher.add(event);\n  }\n\n  public static removeOnStringsUpdated(event: EventHandler<unknown>) {\n    this._stringsEventDispatcher.remove(event);\n  }\n\n  public static onDirectionUpdated(event: EventHandler<unknown>) {\n    this._directionEventDispatcher.add(event);\n    this.initDirection();\n  }\n\n  public static removeOnDirectionUpdated(event: EventHandler<unknown>) {\n    this._directionEventDispatcher.remove(event);\n  }\n\n  private static _isDirectionInit = false;\n\n  /**\n   * Checks for direction setup and adds mutationObserver\n   *\n   * @private\n   * @static\n   * @returns\n   * @memberof LocalizationHelper\n   */\n  private static initDirection() {\n    if (this._isDirectionInit) {\n      return;\n    }\n    this._isDirectionInit = true;\n    this.mutationObserver = new MutationObserver(mutations => {\n      mutations.forEach(mutation => {\n        if (mutation.attributeName === 'dir') {\n          this._directionEventDispatcher.fire(null);\n        }\n      });\n    });\n    const options = { attributes: true, attributeFilter: ['dir'] };\n    this.mutationObserver.observe(document.body, options);\n    this.mutationObserver.observe(document.documentElement, options);\n  }\n\n  /**\n   * Provided helper method to determine localized or defaultString for specific string is returned\n   *\n   * @static updateStringsForTag\n   * @param {string} tagName\n   * @param  stringsObj\n   * @returns\n   * @memberof LocalizationHelper\n   */\n  public static updateStringsForTag(tagName: string, stringObj: Record<string, string>) {\n    tagName = tagName.toLowerCase();\n\n    if (tagName.startsWith('mgt-')) {\n      tagName = tagName.substring(4);\n    }\n\n    if (this._strings && stringObj) {\n      // check for top level strings, applied per component, overridden by specific component def\n      for (const prop of Object.entries(stringObj)) {\n        const overrideValue = this._strings[prop[0]];\n        if (typeof overrideValue === 'string') {\n          stringObj[prop[0]] = overrideValue;\n        }\n      }\n\n      // strings defined component specific\n      if (this._strings._components?.[tagName]) {\n        const strings = this._strings._components[tagName];\n        for (const key of Object.keys(strings)) {\n          if (stringObj[key]) {\n            stringObj[key] = strings[key];\n          }\n        }\n      }\n    }\n\n    return stringObj;\n  }\n}\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\n/**\n * Crude implementation of equivalence between the two specified arguments.\n *\n * The primary intent of this function is for comparing data contexts, which\n * are expected to be object literals with potentially nested structures and\n * where leaf values are primitives.\n */\nexport const equals = (o1: unknown, o2: unknown) => {\n  return equalsInternal(o1, o2, new Set());\n};\n\n/**\n * Not exposed as it would undesirably leak implementation detail (`refs` argument).\n *\n * The `refs` argument is used to avoid infinite recursion due to circular references.\n *\n * @see equals\n */\nconst equalsInternal = (o1: unknown, o2: unknown, refs: Set<unknown>) => {\n  const o1Label = Object.prototype.toString.call(o1) as string;\n  const o2Label = Object.prototype.toString.call(o2) as string;\n  if (\n    typeof o1 === 'object' &&\n    typeof o2 === 'object' &&\n    o1Label === o2Label &&\n    o1Label === '[object Object]' &&\n    !refs.has(o1)\n  ) {\n    refs.add(o1);\n    for (const k in o1) {\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n      if (!equalsInternal(o1[k], o2[k], refs)) {\n        return false;\n      }\n    }\n    for (const k in o2) {\n      if (!Object.prototype.hasOwnProperty.call(o1, k)) {\n        return false;\n      }\n    }\n    return true;\n  }\n  if (Array.isArray(o1) && Array.isArray(o2) && !refs.has(o1)) {\n    refs.add(o1);\n    if (o1.length !== o2.length) {\n      return false;\n    }\n    for (let i = 0; i < o1.length; i++) {\n      if (!equalsInternal(o1[i], o2[i], refs)) {\n        return false;\n      }\n    }\n    return true;\n  }\n  // Everything else requires strict equality (e.g. primitives, functions, dates)\n  return o1 === o2;\n};\n\n/**\n * Compares two arrays if the elements are equals\n * Should be used for arrays of primitive types\n *\n * @export\n * @template T the type of the elements in the array (should be primitive)\n * @param {T[]} arr1\n * @param {T[]} arr2\n * @returns true if both arrays contain the same items or if both arrays are null or empty\n */\nexport const arraysAreEqual = <T>(arr1: T[], arr2: T[]) => {\n  if (arr1 === arr2) {\n    return true;\n  }\n\n  if (!arr1 || !arr2) {\n    return false;\n  }\n\n  if (arr1.length !== arr2.length) {\n    return false;\n  }\n\n  if (arr1.length === 0) {\n    return true;\n  }\n\n  const setArr1 = new Set(arr1);\n\n  for (const i of arr2) {\n    if (!setArr1.has(i)) {\n      return false;\n    }\n  }\n\n  return true;\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { HTMLTemplateResult, html } from 'lit';\nimport { customElementHelper } from '../components/customElementHelper';\n\n/**\n * stringsCache ensures that the same TemplateStringsArray object is returned on subsequent calls\n * This is needed as lit-html internally uses the TemplateStringsArray object as a cache key.\n *\n * @type {WeakMap}\n */\nconst stringsCache = new WeakMap<TemplateStringsArray, TemplateStringsArray>();\n\n/**\n * Rewrites strings in an array using the supplied matcher RegExp\n * Assumes that the RegExp returns a group on matches\n *\n * @param strings The array of strings to be re-written\n * @param matcher A RegExp to be used for matching strings for replacement\n */\nconst rewriteStrings = (strings: readonly string[], matcher: RegExp, replacement: string): readonly string[] => {\n  const temp: string[] = [];\n  for (const s of strings) {\n    temp.push(s.replace(matcher, replacement));\n  }\n  return temp;\n};\n\n/**\n * Generates a template literal tag function that returns an HTMLTemplateResult.\n */\nconst tag = (strings: TemplateStringsArray, ...values: unknown[]): HTMLTemplateResult => {\n  // re-write <mgt-([a-z]+) if necessary\n  if (customElementHelper.isDisambiguated) {\n    let cached = stringsCache.get(strings);\n    if (!cached) {\n      const matcher = new RegExp('(</?)mgt-(?!' + customElementHelper.disambiguation + '-)');\n      const newPrefix = `$1${customElementHelper.prefix}-`;\n      cached = Object.assign(rewriteStrings(strings, matcher, newPrefix), {\n        raw: rewriteStrings(strings.raw, matcher, newPrefix)\n      });\n      stringsCache.set(strings, cached);\n    }\n    strings = cached;\n  }\n\n  return html(strings, ...values);\n};\n\n/**\n * Interprets a template literal and dynamically rewrites `<mgt-` tags with the\n * configured disambiguation if necessary.\n *\n * ```ts\n * const header = (title: string) => mgtHtml`<mgt-flyout>${title}</mgt-flyout>`;\n * ```\n *\n * The `mgtHtml` tag is a wrapper for the `html` tag from `lit` which provides for dynamic tag re-writing\n */\nexport const mgtHtml = tag;\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { customElementHelper } from '../components/customElementHelper';\n\nexport const buildComponentName = (tagBase: string) => `${customElementHelper.prefix}-${tagBase}`;\n\nexport const registerComponent = (\n  tagBase: string,\n  constructor: CustomElementConstructor,\n  options?: ElementDefinitionOptions\n) => {\n  const tagName = buildComponentName(tagBase);\n  if (!customElements.get(tagName)) customElements.define(tagName, constructor, options);\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport React, { ReactNode, ReactElement } from 'react';\nimport ReactDOM from 'react-dom';\nimport { Wc, WcProps, WcTypeProps } from 'wc-react';\nimport { customElementHelper, TemplateRenderedData } from '@microsoft/mgt-element';\n\nexport class Mgt extends Wc {\n  private _templates: Record<string, ReactElement>;\n\n  constructor(props: WcTypeProps) {\n    super(props);\n  }\n\n  protected getTag(): string {\n    let tag: string = super.getTag() as string;\n    const tagPrefix = `${customElementHelper.prefix}-`;\n    if (!tag.startsWith(tagPrefix)) {\n      tag = tagPrefix + tag;\n    }\n\n    return tag;\n  }\n\n  // type mismatch due to version drift\n  // @ts-expect-error - TS2416: Property 'render' in type 'Mgt' is not assignable to the same property in base type 'Wc'\n  public render(): React.DOMElement<React.DOMAttributes<HTMLElement>, HTMLElement> {\n    const tag = this.getTag();\n    if (!tag) {\n      throw new Error('\"wcType\" must be set!');\n    }\n\n    this.processTemplates(this.props.children);\n\n    const templateElements = [];\n\n    if (this._templates) {\n      for (const t in this._templates) {\n        if (Object.prototype.hasOwnProperty.call(this._templates, t)) {\n          const element = React.createElement('template', { key: t, 'data-type': t }, null);\n          templateElements.push(element);\n        }\n      }\n    }\n\n    return React.createElement(tag, { ref: (element: HTMLElement) => this.setRef(element) }, templateElements);\n  }\n\n  /**\n   * Sets the web component reference and syncs the props\n   *\n   * @protected\n   * @param {HTMLElement} element\n   * @memberof Wc\n   */\n  protected setRef(component: HTMLElement) {\n    if (component) {\n      component.addEventListener('templateRendered', this.handleTemplateRendered);\n    }\n    super.setRef(component);\n  }\n\n  /**\n   * Removes all event listeners from web component element\n   *\n   * @protected\n   * @returns\n   * @memberof Mgt\n   */\n  protected cleanUp() {\n    if (!this.element) {\n      return;\n    }\n\n    this.element.removeEventListener('templateRendered', this.handleTemplateRendered);\n\n    super.cleanUp();\n  }\n\n  /**\n   * Renders a template\n   *\n   * @protected\n   * @param {*} e\n   * @returns\n   * @memberof Mgt\n   */\n  protected handleTemplateRendered = (e: CustomEvent<TemplateRenderedData>) => {\n    if (!this._templates) {\n      return;\n    }\n\n    const templateType = e.detail.templateType;\n    const dataContext = e.detail.context;\n    const element = e.detail.element;\n\n    let template = this._templates[templateType];\n\n    if (template) {\n      template = React.cloneElement(template, { dataContext });\n      ReactDOM.render(template, element);\n    }\n  };\n\n  /**\n   * Prepares templates for rendering\n   *\n   * @protected\n   * @param {ReactNode} children\n   * @returns\n   * @memberof Mgt\n   */\n  protected processTemplates(children: ReactNode) {\n    if (!children) {\n      return;\n    }\n\n    const templates: Record<string, ReactElement> = {};\n\n    React.Children.forEach(children, child => {\n      const element = child as ReactElement<{ template: string }>;\n      const template = element?.props?.template;\n      if (template) {\n        templates[template] = element;\n      } else {\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access, @typescript-eslint/dot-notation\n        templates['default'] = element;\n      }\n    });\n\n    this._templates = templates;\n  }\n}\n\n/**\n * Creates a new React Functional Component that wraps the\n * web component with the specified tag name\n *\n * @template T - optional props type for component\n * @param {(string | Function)} tag\n * @returns React component\n */\nexport const wrapMgt = <T = WcProps>(tag: string, registerElementFunction: () => void) => {\n  registerElementFunction();\n  const WrapMgt = (props: T, ref: React.ForwardedRef<unknown>): React.CElement<WcTypeProps, Mgt> =>\n    React.createElement(Mgt, { wcType: tag, innerRef: ref, ...props });\n  const component: React.ForwardRefExoticComponent<\n    React.PropsWithoutRef<T & React.HTMLAttributes<unknown>> & React.RefAttributes<unknown>\n  > = React.forwardRef(WrapMgt);\n  return component;\n};\n","/* eslint-disable @typescript-eslint/no-explicit-any */\n/* eslint-disable @typescript-eslint/consistent-type-definitions */\nimport { IDynamicPerson,AvatarSize,AvatarType,PersonCardInteraction,ViewType } from '@microsoft/mgt-components';\nimport { registerMgtPersonComponent } from '@microsoft/mgt-components';\nimport { TemplateContext,TemplateRenderedData } from '@microsoft/mgt-element';\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport * as MicrosoftGraph from '@microsoft/microsoft-graph-types';\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport * as MicrosoftGraphBeta from '@microsoft/microsoft-graph-types-beta';\nimport {wrapMgt} from '../Mgt';\n\nexport type PersonProps = {\n\tpersonQuery?: string;\n\tfallbackDetails?: IDynamicPerson;\n\tuserId?: string;\n\tusage?: string;\n\tshowPresence?: boolean;\n\tdisablePresenceRefresh?: boolean;\n\tavatarSize?: AvatarSize;\n\tpersonDetails?: IDynamicPerson;\n\tpersonImage?: string;\n\tfetchImage?: boolean;\n\tdisableImageFetch?: boolean;\n\tverticalLayout?: boolean;\n\tavatarType?: AvatarType;\n\tpersonPresence?: MicrosoftGraph.Presence;\n\tpersonCardInteraction?: PersonCardInteraction;\n\tline1Property?: string;\n\tline2Property?: string;\n\tline3Property?: string;\n\tline4Property?: string;\n\tview?: ViewType;\n\ttemplateContext?: TemplateContext;\n\tline1clicked?: (e: CustomEvent<IDynamicPerson>) => void;\n\tline2clicked?: (e: CustomEvent<IDynamicPerson>) => void;\n\tline3clicked?: (e: CustomEvent<IDynamicPerson>) => void;\n\tline4clicked?: (e: CustomEvent<IDynamicPerson>) => void;\n\ttemplateRendered?: (e: CustomEvent<TemplateRenderedData>) => void;\n}\n\nexport const Person = wrapMgt<PersonProps>('person', registerMgtPersonComponent);\n\n"],"names":["SearchBox","wrapMgt","registerMgtSearchBoxComponent","Login","registerMgtLoginComponent","useStyles","makeStyles","simpleLogin","SimpleLogin","props","styles","personDetails","dataContext","_jsx","Person","userId","id","avatarSize","className","availableThemes","key","displayName","icon","BrightnessHighRegular","WeatherMoonFilled","PeopleTeamRegular","PeopleTeamFilled","ThemeSwitcher","_React$useState","React","_React$useState2","_slicedToArray","selectedTheme","setSelectedTheme","appContext","useAppContext","_jsxs","Menu","children","MenuTrigger","MenuButton","MenuPopover","MenuList","map","theme","MenuItem","onClick","setState","_objectSpread","state","fluentTheme","teamsLightTheme","teamsDarkTheme","webLightTheme","webDarkTheme","onThemeChanged","root","header","display","flexDirection","flexWrap","width","height","boxSizing","alignItems","backgroundColor","tokens","colorNeutralForeground1Static","zIndex","minHeight","name","color","colorNeutralForegroundOnBrand","fontWeight","fontWeightSemibold","fontSize","fontSizeBase400","paddingLeft","wafffleIcon","fontSizeBase600","paddingTop","waffle","flexGrow","minWidth","waffleLogo","shorthands","flex","waffleTitle","search","justifyContent","searchBox","maxWidth","paddingRight","infoIcon","login","signedOut","padding","signedIn","HeaderComponent","_useIsSignedIn","useIsSignedIn","isSignedIn","setAppContext","location","useLocation","navigate","useNavigate","pathname","searchTerm","decodeURI","replace","previous","href","target","rel","GridDotsRegular","Label","process","InfoButton","size","info","_Fragment","PACKAGE_VERSION","searchTermChanged","e","detail","mergeClasses","template","Header","tab","paddingBottom","activeTab","colorSubtleBackgroundHover","SideNavigation","items","selectedTab","setSelectedTab","_React$useState3","_React$useState4","isMinimized","setIsMinimized","substring","TabList","appearance","vertical","onTabSelect","event","data","value","futureIsMinimized","sidebar","relative","selectedValue","Tab","NavigationRegular","item","index","url","DashboardPage","lazy","OutlookPage","SearchPage","HomePage","FilesPage","TaxonomyPage","ChatPage","secondaryTextDefault","secondaryTextColor","DesignToken","create","withDefault","secondaryTextHoverDefault","secondaryTextHoverColor","applyColorScheme","settings","element","arguments","length","undefined","document","body","accentBaseColor","setValueFor","SwatchRGB","from","parseColorHexRGB","neutralBaseColor","baseLayerLuminance","_a","designTokenOverrides","call","getThemeSettings","StandardLuminance","DarkMode","LightMode","accentFillRest","accentFillHover","accentFillActive","accentFillFocus","accentForegroundRest","accentForegroundHover","accentForegroundActive","accentForegroundFocus","accentStrokeControlRest","accentStrokeControlHover","accentStrokeControlActive","accentStrokeControlFocus","foregroundOnAccentActive","foregroundOnAccentRest","foregroundOnAccentHover","foregroundOnAccentFocus","colorNeutralBackground6","main","colorNeutralBackground1","minimized","page","content","margin","overflow","Layout","_process$env$REACT_AP","navigationItems","setNavigationItems","navItems","push","HomeRegular","requiresLogin","component","Suspense","fallback","exact","TextBulletListSquareRegular","CalendarMailRegular","DocumentRegular","TagMultipleRegular","ChatRegular","pattern","SearchRegular","getNavigation","applyTheme","FluentProvider","BrowserRouter","basename","concat","Routes","Route","path","AppContext","Provider","Error","_useState","useState","_useState2","setIsSignedIn","useEffect","updateState","stateEvent","ProvidersChangedState","ProviderStateChanged","Providers","globalProvider","ProviderState","SignedIn","onProviderUpdated","removeProviderUpdatedListener","interactions","personCardConverter","defaultValue","includes","isPersonCardInteraction","css","_templateObject","_taggedTemplateLiteral","strings","showMoreSubtitle","filesSectionTitle","sharedTextSubtitle","failUploadFile","cancelUploadFile","buttonUploadFile","maximumFilesTitle","maximumFiles","maximumFileSizeTitle","maximumFileSize","fileTypeTitle","fileType","checkAgain","checkApplyAll","buttonOk","buttonCancel","buttonUpload","buttonKeep","buttonReplace","buttonReselect","fileReplaceTitle","fileReplace","uploadButtonLabel","isFileSystemDirectoryEntry","entry","isDirectory","isFutureDataTransferItem","getAsEntry","MgtFileUpload","_MgtBaseComponent","_this","_classCallCheck","_callSuper","_dragCounter","_maxChunkSize","_dialogTitle","_dialogContent","_dialogPrimaryButton","_dialogSecondaryButton","_dialogCheckBox","_applyAll","_applyAllConflictBehavior","_maximumFileSize","_excludedFileType","onFileUploadChange","inputElement","files","readUploadedFiles","onFileUploadClick","renderRoot","querySelector","click","handleonDragOver","preventDefault","stopPropagation","dataTransfer","dropEffect","_dropEffect","handleonDragEnter","classList","add","handleonDragLeave","remove","handleonDrop","clearData","filesToUpload","_inherits","_createClass","get","this","parentElement","addEventListener","html","getSvg","SvgIcon","Cancel","Upload","renderFolderTemplate","fileItems","_this2","folderStructure","templateFileItems","fileItem","indexOf","fullPath","lastIndexOf","endsWith","_templateObject3","renderFileTemplate","mgtHtml","_templateObject2","folder","_templateObject4","_templateObject5","_templateObject6","folderTabStyle","completed","classMap","upload","fieldUploadResponse","description","completedTemplate","_templateObject7","renderFileUploadTemplate","_templateObject8","iconStatus","driveItem","view","_this3","_templateObject9","file","percent","deleteFileUploadSession","uploadUrl","_context","next","deleteSessionFile","fileUploadList","graph","setUploadFail","prev","t0","stop","_callee","uploaded","onCompleteCallback","getFilesFromUploadArea","_context2","sent","getSelectedFiles","_callee2","fileItemsCompleted","forEach","_iterator","_createForOfIteratorHelper","_context4","_loop","_regeneratorRuntime","mark","acceptFile","excludedFileType","conflictBehavior","wrap","_context3","_step","filter","_this4","maxFileSize","getFileUploadStatus","excludedFileExtensions","fileExtension","toLowerCase","Boolean","behavior","maxSize","minSize","s","n","done","delegateYield","t1","f","finish","sort","firstFile","secondFile","localeCompare","findIndex","splice","_fileItems","apply","promises","sendFileItemGraph","Promise","all","_callee3","DialogStatus","_this5","fileUploadDialog","_context5","getGraphfile","getGrapQuery","abrupt","_super","requestStateUpdate","resolve","fileUploadDialogClose","_this6","fileUploadDialogOk","fileUploadDialogCancel","fileUploadDialogCheck","checked","onOkDialogClick","onCancelDialogClick","onCloseDialogClick","removeEventListener","join","formatBytes","_callee4","itemPath","startsWith","itemId","groupId","driveId","siteId","graphQuery","_context6","sendFileContent","setUploadSuccess","getUploadSession","response","sendSessionUrlGraph","_callee5","_this7","_context7","mimeStreamString","readFileContent","fileSlice","Blob","slice","Math","round","sendFileChunk","isUploadSession","parseInt","nextExpectedRanges","split","_callee6","fileUpload","_this8","_get","_getPrototypeOf","prototype","setTimeout","Success","clearFilesCache","errorMessage","_this9","Fail","reject","myReader","FileReader","onloadend","result","onerror","readAsArrayBuffer","filesItems","folders","collectFilesItems","_iterator2","_step2","uploadFileItem","getAsFile","webkitGetAsEntry","writeFilePath","err","_context8","getFolderFiles","folderFiles","_toConsumableArray","_callee7","_this10","reading","contents","readEntry","readReaderContent","createReader","isFile","isFileSystemFileEntry","reader","readEntries","entries","_step3","_iterator3","Set","MgtBaseComponent","__decorate","property","type","Object","registerMgtFileListComponent","registerFluentComponents","fluentProgressRing","registerMgtFileComponent","fluentProgress","fluentButton","fluentCheckbox","fluentDialog","registerComponent","MgtFileList","_MgtTemplatedTaskComp","_isCompact","fileQueries","itemView","fileExtensions","pageSize","disableOpenOnClick","hideMoreFilesButton","enableFileUpload","maxUploadFile","_preloadedFiles","_focusedItemIndex","renderLoading","renderContent","renderTemplate","renderCompactView","renderFullView","renderNoData","onFocusFirstItem","onFileListKeyDown","focusedItem","fileList","code","updateItemBackgroundColor","fireCustomEvent","fileDetails","handleFileClick","Files","providerState","fileListQuery","insightType","renderFiles","direction","renderFileUpload","handleItemSelect","renderFile","repeat","pageIterator","hasNext","renderMoreFileButton","_isLoadingMore","renderNextPage","fileUploadConfig","forComponent","provider","Loading","SignedOut","getFromMyDrive","getFilesByListQueryIterator","getFilesByQueries","getFilesByIdIterator","getFilesByPathIterator","getMyInsightsFiles","getFilesIterator","getDriveFilesByIdIterator","getDriveFilesByPathIterator","getGroupFilesByIdIterator","getGroupFilesByPathIterator","getSiteFilesByIdIterator","getSiteFilesByPathIterator","getUserFilesByIdIterator","getUserFilesByPathIterator","getUserInsightsFiles","_b","fetchNextAndCacheForFilesPageIterator","filteredByFileExtension","getFileExtension","nodes","Array","li","closest","clickedItem","min","animate","transformOrigin","duration","easing","fill","requestUpdate","webUrl","window","open","exec","node","removeAttribute","scrollIntoView","block","inline","setAttribute","focus","_task","run","MgtFile","requiredScopes","MgtTemplatedTaskComponent","attribute","converter","_type","v","trim","viewTypeConverter","Number","fileTypeMap","PowerPoint","Word","Excel","Pdf","OneNote","OneNotePage","InfoPath","Visio","Publisher","Project","Access","Mail","Csv","Archive","Xps","Audio","Video","Image","Web","Text","Xml","Story","ExternalContent","Folder","Spsite","Other","baseUri","modifiedSubtitle","sizeSubtitle","fileTemplate","fileDetailsTemplate","renderDetails","fileTypeIconTemplate","renderFileTypeIcon","line1Property","line2Property","line3Property","fileQuery","listId","insightId","fileIcon","fileIconSrc","extension","re","package","keys","find","toString","File","details","text","getTextFromProperty","_templateObject10","_templateObject11","getDriveItemByQuery","getMyDriveItemById","getMyDriveItemByPath","getUserDriveItemById","getUserDriveItemByPath","getUserInsightsDriveItemById","getDriveItemById","getDriveItemByPath","getSiteDriveItemById","getSiteDriveItemByPath","getListDriveItemById","getGroupDriveItemById","getGroupDriveItemByPath","getMyInsightsDriveItemById","properties","propertyList","i","current","relativeDateString","lastModifiedString","lastModifiedDateTime","Date","getRelativeDisplayDate","avatarTypes","avatarTypeConverter","isAvatarType","assign","Available","Away","BeRightBack","Busy","DoNotDisturb","InACall","InAConferenceCall","Inactive","InAMeeting","Offline","OffWork","OutOfOffice","PresenceUnknown","Presenting","UrgentInterruptionsOnly","photoFor","emailAddress","PresenceService","presenceConfig","initPromise","init","then","registerPromise","config","initial","components","error","delete","isStopped","__awaiter","timeoutPromise","presenceByUserId","listOfIds","presences","_i","_Object$values","presence","_component","_id","_presence","refresh","race","log","Map","presenceId","has","set","getUsersPresenceByPeople","values","availability","activity","onPresenceChange","loop","defaultPersonProperties","registerMgtPersonComponent","MgtPerson","registerMgtFlyoutComponent","avatarType","personCardInteraction","_hasLoadedPersonCard","_mouseLeaveTimeout","_mouseEnterTimeout","person","personDetailsInternal","fallbackDetails","image","getImage","personPresence","_fetchedPresence","personImage","personTemplate","detailsTemplate","imageWithPresenceTemplate","renderAvatar","renderFlyout","rootClasses","small","isThreeLines","isFourLines","isLargeAvatar","large","noline","isNoLine","oneline","isOneLine","twolines","isTwoLines","threelines","fourlines","isVertical","handleMouseClick","handleMouseEnter","handleMouseLeave","handleKeyDown","ifDefined","loadingTemplate","avatarClasses","threeLines","fourLines","renderLoadingIcon","tagName","customElementHelper","prefix","toUpperCase","showPersonCard","clearTimeout","hidePersonCard","flyout","close","personCard","isExpanded","clearHistory","loadPersonCardResources","_assertThisInitialized","_yield$import","registerMgtPersonCardComponent","customElements","buildComponentName","_personCardShouldRender","line4Property","disableImageFetch","_isInvalidImageSrc","verticalLayout","_personQuery","_personDetails","_fallbackDetails","_userId","_usage","_personDetailsInternal","_fetchedImage","_personImage","_personPresence","showPresence","disablePresenceRefresh","unregister","noDataTemplate","renderPersonIcon","imageSrc","altText","hasImage","imageOnly","titleText","getEmailFromGraphEntity","imageTemplate","initials","getInitials","hasInitials","textClasses","contactIconTemplate","textTemplate","presenceIcon","PresenceOofAvailable","PresenceAvailable","PresenceOofBusy","PresenceBusy","PresenceOofDnd","PresenceDnd","PresenceOofAway","PresenceAway","PresenceOffline","PresenceStatusUnknown","presenceWrapperClasses","formattedActivity","nothing","renderImage","presenceTemplate","renderPresence","personProps","presenceActivity","presenceAvailability","line1text","hasTemplate","_templateObject12","handleLine1Clicked","_templateObject13","_templateObject14","handleLine2Clicked","_templateObject15","_templateObject16","handleLine3Clicked","_templateObject17","_templateObject18","handleLine4Clicked","_templateObject19","detailsClasses","_templateObject20","anchor","flyoutContent","_templateObject21","renderFlyoutContent","_templateObject22","slotClasses","_templateObject23","_templateObject24","fetchImage","personQuery","email","getGroupImage","getPersonImage","useContactApis","getUserWithPhoto","getMe","getUser","findPeople","people","findUsers","defaultPresence","register","getUserPresence","isContact","isUser","_c","givenName","_f","_e","_d","surname","isLetter","char","match","RegExp","prop","currentProp","scopes","String","isWindowSegmentAware","getWindowSegments","MgtFlyout","_MgtBaseTaskComponent","_renderedOnce","_isOpen","_smallView","handleWindowEvent","_flyout","composedPath","currentElem","handleResize","handleKeyUp","handleFlyoutWheel","avoidHidingAnchor","requestAnimationFrame","updateFlyout","oldValue","setupWindowEvents","isOpen","style","setProperty","maxHeight","top","left","bottom","dispatchEvent","Event","changedProps","flyoutClasses","visible","anchorTemplate","renderAnchor","flyoutTemplate","_windowHeight","innerHeight","documentElement","clientHeight","smallFlyoutClasses","firstPass","_anchor","windowWidth","innerWidth","clientWidth","flyoutRect","getBoundingClientRect","anchorRect","topScoutRect","_topScout","bottomScoutRect","_bottomScout","windowRect","anchorSegment","screenSegments","anchorCenterX","anchorCenterY","segment","_edgePadding","anchorRectBottomToWindowBottom","anchorRectTopToWindowTop","max","offsetLeft","isLightDismiss","MgtBaseTaskComponent","registerMgtSpinnerComponent","MgtSpinner","schemas","conversation","stores","chats","subscriptions","lastRead","version","indexes","field","users","usersQuery","userFilters","photos","contacts","groups","teams","groupPeople","peopleQuery","groupsQuery","responses","driveFiles","groupFiles","siteFiles","userFiles","insightFiles","fileLists","insightfileLists","obj","session","isArray","cache","CacheService","getCache","clearStore","getFileInvalidationTime","invalidationPeriod","defaultInvalidationPeriod","getIsFilesCacheEnabled","isEnabled","getIsFileListsCacheEnabled","validDriveItemScopes","validInsightScopes","validFileUploadScopes","resource","storeName","cachedFile","getFileFromCache","api","middlewareOptions","prepScopes","putValue","JSON","stringify","endpoint","_callee8","_callee9","_context9","_callee10","_context10","_callee11","_context11","_callee12","_context12","_callee13","_context13","_callee14","_context14","_callee15","_context15","getIterator","_callee16","filesPageIterator","request","nextLink","_context16","getFileListFromCache","getFilesPageIteratorFromCache","getFilesPageIteratorFromRequest","_callee17","cacheStore","_context17","_callee18","_context18","_callee19","_context19","_callee20","_context20","_callee21","_context21","_callee22","_context22","_callee23","_context23","_callee24","_context24","_callee25","_context25","_callee26","_context26","_callee27","_context27","listQuery","_callee28","_context28","_callee29","insightResponse","_context29","parse","getDriveItemsByInsights","_callee30","_context30","_callee32","batch","_fileQuery","_context32","createBatch","getValue","now","timeCached","executeAll","t2","_callee31","_context31","t3","_callee34","insightItems","driveItems","_item","driveItemId","driveItemResponses","_iterator4","_step4","driveItemResponse","_context34","resourceReference","insightItem","_callee33","_context33","_callee35","_context35","GraphPageIterator","createFromValue","_callee36","_context36","store","_callee37","_context37","_callee38","matches","_context38","getDocumentThumbnail","_callee39","eTag","blob","_context39","responseType","ResponseType","RAW","status","thumbnail","ok","headers","blobToBase64","_callee40","_context40","_callee41","sessionOptions","_context41","post","contentLength","contentRange","_callee42","_context42","client","put","_callee43","_context43","_callee44","_context44","personTypes","personTypeConverter","isPersonType","userTypes","userTypeConverter","isUserType","getPeopleInvalidationTime","getIsPeopleCacheEnabled","validPeopleQueryScopes","validContactQueryScopes","query","userType","filters","cacheKey","graphResult","graphRequest","results","peopleStr","maxResults","personStr","getPeople","peopleFilters","cacheRes","ppl","entity","user","contact","mail","extractEmailAddress","scoredEmailAddresses","address","emailAddresses","findContactsByEmail","encodedEmail","getPeopleFromResource","nextResource","getPhotoInvalidationTime","getIsPhotosCacheEnabled","anyUserValidPhotoScopes","currentUserValidPhotoScopes","getPhotoForResource","photo","getContactPhoto","contactId","photoDetails","validContactPhotoScopes","getUserPhoto","useContactsApis","contactMail","personType","subclass","userPrincipalName","group","validGroupPhotoScopes","getPhotoFromCache","storePhotoInCache","getPresenceInvalidationTime","getIsPresenceCacheEnabled","validScopes","bypassCacheRead","peoplePresence","peoplePresenceToQuery","presenceResult","r","_r","ids","getUserInvalidationTime","getIsUsersCacheEnabled","getUsers","allValidScopes","apiString","cacheItem","graphClient","userStr","count","allValidMeScopes","requestedProps","me","cachedData","uniqueProps","validUserByIdScopes","userPrincipleName","getUsersForUserIds","userIds","searchInput","peopleDict","peopleSearchMatches","notInCache","apiUrl","cacheUser","ConsistencyLevel","hasRequests","t4","t5","getUsersForPeopleQueries","peopleQueries","allValidPeopleScopes","_loop2","personArray","encodedQuery","graphBuilder","findGroupMembers","transitive","findUsersFromGroupIds","groupIds","groupFilters","_iterator5","_step5","groupUsers","anyUserValidScopes","currentUserValidScopes","requiredUserScopes","requiredPhotoScopes","cachedPhoto","cachedUser","fullResource","_response","photoResponse","userResponse","_cache","_response2","_response3","_cache2","isGraphError","test","statusCode","date","viewTypes","isViewType","getEventsQueryPageIterator","additionalScopes","orderby","getEventsPageIterator","startDateTime","endDateTime","sdt","edt","uri","toISOString","MgtPeople","_peoplePresence","_arrowKeyLocation","showMax","renderPeople","peopleContainer","shadowRoot","peopleElements","el","blur","childElementCount","keyName","mgtPerson","maxPeople","pple","p","renderPerson","renderOverflow","extra","reflect","registerMgtAgendaComponent","fluentCard","MgtAgenda","days","events","renderedTemplate","agendaClasses","agenda","grouped","groupByDay","renderGroups","renderEvents","onResize","_isNarrow","offsetWidth","loadEvents","eventClasses","narrow","getEventTimeString","renderTitle","renderLocation","renderAttendees","renderOther","subject","OfficeLocation","attendees","attendee","dateString","start","dateTime","end","timeZone","getDateHeaderFromDateTimeString","renderHeader","eventClicked","renderEvent","preferredTimezone","eventQuery","isAllDay","startString","endString","prettyPrintTimeFromDateTime","scope","iterator","getTime","setDate","getDate","toLocaleTimeString","navigator","language","timeStyle","dateTimeString","toLocaleDateString","dateStyle","hasChanged","newVal","oldVal","comboboxPlaceholder","isCollectionResponse","responseTypes","responseTypeConverter","isResponseType","getIsResponseCacheEnabled","registerMgtGetComponent","MgtGet","maxPages","pollingRate","cacheEnabled","cacheInvalidationPeriod","isPolling","isRefreshing","loading","renderValueContentWithDefaultTemplate","valueContent","hardRefresh","clearState","defaultContent","templates","templateOrder","shouldRetrieveCache","isDeltaLink","URL","responseValues","equals","pageCount","sanitizedResource","imageResponse","shouldUpdateCache","loadState","finally","registerMgtPickerComponent","fluentCombobox","fluentOption","MgtPicker","errorData","renderPicker","renderGet","handleComboboxKeydown","fluentOptionEl","getAttribute","res","pop","placeholder","entityType","handleClick","getNestedPropertyValue","console","warn","changedProperties","parent","handleDataChange","termsetIdRequired","noTermsFound","loadingMessage","registerMgtTaxonomyPickerComponent","MgtTaxonomyPicker","position","selectedTerm","terms","renderError","noTerms","renderTaxonomyPicker","disabled","term","renderTaxonomyPickerItem","selected","defaultSelectedTermId","labels","termsetId","termId","locale","label","l","languageTag","signInLinkSubtitle","signOutLinkSubtitle","signInWithADifferentAccount","fluentListbox","MgtLogin","loginView","logout","isMultiAccountSupportedAndEnabled","localStorage","removeItem","getActiveAccount","_userDetailsKey","userDetails","hideFlyout","renderButton","flyoutOpened","_isFlyoutOpen","flyoutClosed","onUserKeyDown","focusableEls","querySelectorAll","firstFocusableEl","lastFocusableEl","shiftKey","loginButton","fluentCardEl","handleAccountListKeyDown","list","listItems","showFlyout","_image","setItem","loginClasses","showSignedInState","buttonContentTemplate","renderSignedInButtonContent","renderSignedOutButtonContent","expandedState","TaskStatus","PENDING","renderFlyoutCommands","renderFlyoutPersonDetails","renderAccounts","renderAddAccountContent","getAllAccounts","hasMultipleAccounts","usesVerticalPersonCard","handleSignOut","SelectAccount","displayConfig","parsePersonDisplayConfiguration","accounts","ariaLabel","a","account","getItem","setActiveAccount","groupTypeValues","isGroupType","groupTypeConverter","getGroupsInvalidationTime","getIsGroupsCacheEnabled","validGroupQueryScopes","findGroups","groupTypes","cacheGroupQuery","filterQuery","batchedResult","filterGroups","_filterGroups","_i2","_filterGroups2","filterGroup","queries","_filter","x","batchedGroup","reduce","b","getGroup","getGroupsForGroupIds","groupDict","findGroupsFromGroupIds","foundGroups","graphGroups","inputPlaceholderText","maxSelectionsPlaceHolder","maxSelectionsAriaLabel","noResultsFound","removeSelectedUser","selectContact","suggestionsTitle","registerMgtPeoplePickerComponent","fluentTextField","MgtPeoplePicker","groupType","transitiveSearch","disableImages","defaultSelectedUserIds","defaultSelectedGroupIds","allowAnyEmail","userInput","_selectedPeople","_arrowSelectionCount","defaultSelectedUsers","defaultSelectedGroups","_highlightedUsers","_currentHighlightedUserPos","_isFocused","_setAnyEmail","handleSelectionChanged","selectedPeople","enableTextInput","handleInputClick","handleUserSearch","gainedFocus","clearHighlighted","lostFocus","input","peopleList","onUserKeyUp","isCmdOrCtrlKey","getModifierState","isPaste","isArrowKey","clearInput","_foundPeople","onUserInput","isValidEmail","handleAnyEmail","selectedList","isNaN","personParent","highlightSelectedPeople","handleArrowSelection","foundPerson","addPerson","hasMaxSelections","disableTextInput","handleCut","writeHighlightedText","removeHighlightedOnCut","handleCopy","handlePaste","clipboard","readText","copiedText","SyntaxError","listOfUsers","_delimiters","delimiter","selectUsersById","_","arraysAreEqual","inputControl","selectionMode","options","select","message","anyMailUser","groupDetails","defaultTemplate","selectedPeopleTemplate","renderSelectedPeople","inputTemplate","renderInput","searchIcon","Search","startSlot","renderSelectedPerson","removePerson","handleRemovePersonKeyDown","Close","handleSectionScroll","renderSearchResults","filteredPeople","handleSuggestionClick","renderPersonResult","_groupPeople","defaultPeople","displayNameMatch","peopleInGroups","isUserOrContactType","t6","t7","t8","peopleIds","t9","t10","t11","t12","filterPeople","filteredPersonArr","_debouncedSearch","debounce","copyText","_element$_personDetai","copiedTextStr","writeText","_step6","_iterator6","_step7","_iterator7","_step8","_iterator8","uniquePeople","_step9","idFilter","filtered","dupsSet","_iterator9","d","deltaY","scrollTop","scrollHeight","defaultResult","_step10","_iterator10","teamReadScopes","channelReadScopes","teamPhotoReadScopes","getAllMyTeams","getTeamsPhotosForPhotoIds","teamIds","photoDetail","_photoDetail","getChannelsForTeams","team","_team","channelsForTeam","channels","c","teamsChannels","closeButtonAriaLabel","registerMgtTeamsChannelPickerComponent","fluentBreadcrumb","fluentBreadcrumbItem","fluentTreeView","fluentTreeItem","MgtTeamsChannelPicker","teamsPhotos","_inputValue","_treeViewState","_focusList","dropdownClasses","dropdown","_isDropdownVisible","_selectedItemState","handleFocus","handleInputChanged","handleInputKeydown","renderSelected","renderChevrons","renderCloseButton","renderDropdown","onClickCloseButton","removeSelectedChannel","onKeydownCloseButton","renderLoadingIndicator","onKeydownTreeView","handleTeamTreeItemClick","stopImmediatePropagation","debouncedSearch","filterList","loadTeamsIfNotLoaded","handleWindowClick","_input","toggleChevron","resetFocusState","textContent","wrapper","_inputWrapper","showCloseIcon","handleUpChevronClick","channel","_items","generateTreeViewState","ownerDocument","channelId","selectChannel","markSelectedChannelInDropdown","treeItem","renderSearchIcon","src","parentName","channelName","TeamSeparator","downChevron","upChevron","closeIcon","renderUpChevron","renderDownChevron","renderDropdownList","itemObj","renderItem","itemState","handleItemClick","t","isArchived","teamsIds","treeItems","tree","filterString","treeView","stateItem","newStateItem","array","generateFocusList","selectedItem","hideCloseIcon","writeTaskScopes","readTaskScopes","getTodoTasks","tasks","getTodoTaskLists","taskLists","getTodoTaskList","createTodoTask","taskData","deleteTodoTask","taskId","updateTodoTask","patch","cancelNewTaskSubtitle","newTaskPlaceholder","newTaskLabel","editTaskLabel","addTaskButtonSubtitle","deleteTaskOption","editTaskOption","dueDate","newTaskDateInputLabel","changeTaskDateInputLabel","newTaskNameInputLabel","cancelAddingTask","removeTaskSubtitle","MgtTasksBase","renderLoadingTask","picker","newTaskTemplate","renderNewTask","tasksTemplate","renderTasks","handleTaskClick","task","mediaQuery","_previousMediaQuery","fluentCalendar","targetId","initialId","getTimezoneOffset","registerMgtTodoComponent","fluentRadioGroup","MgtTodo","_MgtTasksBase","_thisSuper","_isChangedDueDate","_isDarkMode","luminance","getValueFor","isDark","isElementDark","addIcon","_newTaskName","addTask","Add","cancelIcon","clearNewTaskData","dateClass","dark","calendarTemplate","dateToInputValue","_newTaskDueDate","handleDateChange","newTaskDetails","readOnly","handleInput","currentList","loadTasks","renderTaskDetails","context","taskDetailsTemplate","taskDeleteTemplate","removeTask","Delete","dueDateTime","_taskBeingUpdated","handleDateUpdate","updatingTask","handleBlur","changeTaskDetailsTemplate","title","_changedTaskName","handleChange","renderTask","isCompleted","taskClasses","complete","checkboxClasses","taskCheckContent","CheckMark","handleTaskCheckClick","handleTaskCheckKeydown","lists","defaultList","_graph","wellknownListName","_tasks","_isNewTaskBeingAdded","createNewTask","updateTask","updateTaskItem","focusOnTaskInput","taskInputWrapper","updateTaskStatus","taskStatus","taskIndex","_updatingTaskDate","targets","taskFilter","completedTasks","taskTemplates","completedTaskTemplates","unshift","updatedTask","fluentSearch","MgtSearchBox","_searchTerm","onInputChanged","debounceDelay","fireSearchTermChanged","debouncedSearchTermChanged","modified","back","pages","registerMgtSearchResultsComponent","fluentSkeleton","fluentTooltip","fluentDivider","MgtSearchResults","_size","entityTypes","contentSources","pagingMax","enableTopResults","defaultFields","currentPage","footerTemplate","headerTemplate","renderFooter","hitsContainers","_h","_g","hits","renderResult","fetchThumbnail","onFirstPageClick","scrollToFirstResult","onPageBackClick","onPageNextClick","_queryString","maxPageSize","queryString","queryTemplate","fields","requestOptions","getRequestOptions","searchEndpoint","getResponseInvalidationTime","requests","thumbnailBatch","thumbnailBatchBeta","BetaGraph","fromGraph","hitId","parentReference","augmentResponse","thumbnailResponse","_step2$value","k","thumbnailWebUrl","getResourceType","renderDriveItem","renderSite","renderList","renderListItem","renderBookmark","renderAcronym","renderQnA","renderDefault","hitsContainer","pagingRequired","getActivePages","total","renderPreviousPage","renderFirstPage","renderAllPages","moreResultsAvailable","totalResults","firstPage","medianPage","floor","getFirstPage","ceil","onPageClick","some","getDotButtonTitle","ChevronLeft","isLastPage","ChevronRight","pageNumber","trimFileExtension","lastModifiedBy","sanitizeSummary","summary","getResourceIcon","getNameFromUrl","News","FileOuter","renderAnswer","DoubleBookmark","BookOpen","BookQuestion","getResourceUrl","resourceUrl","_templateObject25","getResourceName","_templateObject26","getResultSummary","webLink","Globe","Email","SmallChat","getFields","designSystem","provideFluentDesignSystem","_len","fluentComponents","_key","_fluentComponents","svgIcon","ArrowDown","SkypeArrow","SmallEmail","ExpandDown","Overview","Send","Contact","Call","Confirmation","Copy","Phone","CellPhone","Chat","Department","Dot","Birthday","Messages","Organization","ExpandRight","Profile","_templateObject27","_templateObject28","_templateObject29","Back","_templateObject30","_templateObject31","_templateObject32","FileCloud","_templateObject33","DragFile","_templateObject34","_templateObject35","_templateObject36","_templateObject37","Radio","_templateObject38","_templateObject39","_templateObject40","_templateObject41","_templateObject42","_templateObject43","_templateObject44","_templateObject45","_templateObject46","Calendar","_templateObject47","Planner","_templateObject48","Milestone","_templateObject49","PersonAdd","_templateObject50","_templateObject51","_templateObject52","_templateObject53","_templateObject54","_templateObject55","_templateObject56","_templateObject57","_templateObject58","_templateObject59","_templateObject60","_templateObject61","_templateObject62","_templateObject63","_templateObject64","_templateObject65","_templateObject66","today","getFullYear","getMonth","toLocaleString","hour","minute","sunday","getDay","weekday","lastTwoWeeks","day","month","year","func","time","timeout","_arguments","onload","readAsDataURL","emailString","bytes","decimals","dm","parseFloat","pow","toFixed","fileName","currentInvalidationPeriod","_Graph","setComponent","betaGraph","componentName","Graph","ComponentMediaQuery","_LitElement","_isLoadingState","_isFirstUpdated","setLoadingState","handleProviderUpdates","handleActiveAccountUpdates","handleLocalizationChanged","LocalizationHelper","updateStringsForTag","handleDirectionChanged","getDocumentDirection","mobile","tablet","desktop","onStringsUpdated","onDirectionUpdated","removeOnStringsUpdated","removeOnDirectionUpdated","removeActiveAccountChangedListener","onActiveAccountChanged","eventName","CustomEvent","bubbles","cancelable","composed","force","isLoadingState","_currentLoadStatePromise","loadStatePromise","LitElement","Task","args","render","pending","TemplateHelper","rendered","$parentTemplateContext","$parent","childNodes","templateContent","cloneNode","renderNode","div","createElement","appendChild","simpleCloneNode","startStr","endStr","_startExpression","_endExpression","escapeRegex","_expression","_globalContext","setBindingSyntax","string","clone","child","childClone","str","expression","p1","evalInContext","trimExpression","nodeName","expandExpressionsAsString","nodeElement","attributes","propsValue","keyValue","loopChildren","removeChildren","previousChildWasIfAndTrue","childNode","childElement","previousChildWasIfAndTrueSet","dataset","childWillBeRemoved","if","evalBoolInContext","else","for","_removeChildren","removeChild","_loopChildren","loopExpression","loopTokens","itemName","listKey","j","newContext","$index","insertBefore","globalContext","Function","substr","_renderedSlots","_renderedTemplates","_slotNamesAddedDuringRender","templateContext","getTemplates","removeUnusedSlottedElements","templateType","slotName","hasOwnProperty","_this$_renderedTempla","existingContext","slot","generated","templateRenderedData","templateName","default","CacheStore","schema","indexedDB","getDb","db","clear","getCacheId","getDBName","dbName","openDB","upgrade","_oldVersion","_newVersion","transaction","dbArray","dbListKey","objectStoreNames","contains","objectStore","indexNames","createIndex","createObjectStore","indexName","getAllFromIndex","action","tx","isInitialized","work","oldDbArray","newDbArray","delReq","deleteDatabase","onsuccess","cacheConfig","previousState","clearCacheById","_value","_nextLink","_version","_strings","_stringsEventDispatcher","fire","_directionEventDispatcher","initDirection","_isDirectionInit","mutationObserver","MutationObserver","mutations","mutation","attributeName","attributeFilter","observe","stringObj","_Object$entries","overrideValue","_components","_Object$keys","EventDispatcher","o1","o2","equalsInternal","refs","o1Label","o2Label","arr1","arr2","setArr1","stringsCache","WeakMap","rewriteStrings","matcher","replacement","temp","isDisambiguated","cached","disambiguation","newPrefix","raw","tagBase","constructor","define","Mgt","_Wc","handleTemplateRendered","_templates","ReactDOM","tag","tagPrefix","getTag","processTemplates","templateElements","ref","setRef","Wc","registerElementFunction","wcType","innerRef"],"sourceRoot":""}