{"version":3,"file":"static/js/timer-worker.2b558275.chunk.js","mappings":"yBAAe,SAASA,EAAQC,GAG9B,OAAOD,EAAU,mBAAqBE,QAAU,iBAAmBA,OAAOC,SAAW,SAAUF,GAC7F,cAAcA,CAChB,EAAI,SAAUA,GACZ,OAAOA,GAAK,mBAAqBC,QAAUD,EAAEG,cAAgBF,QAAUD,IAAMC,OAAOG,UAAY,gBAAkBJ,CACpH,EAAGD,EAAQC,EACb,CCNe,SAASK,EAAeC,GACrC,IAAIC,ECFS,SAAsBC,EAAOC,GAC1C,GAAuB,WAAnBV,EAAQS,IAAiC,OAAVA,EAAgB,OAAOA,EAC1D,IAAIE,EAAOF,EAAMP,OAAOU,aACxB,QAAaC,IAATF,EAAoB,CACtB,IAAIG,EAAMH,EAAKI,KAAKN,EAAOC,GAAQ,WACnC,GAAqB,WAAjBV,EAAQc,GAAmB,OAAOA,EACtC,MAAM,IAAIE,UAAU,+CACtB,CACA,OAAiB,WAATN,EAAoBO,OAASC,QAAQT,EAC/C,CDPY,CAAYF,EAAK,UAC3B,MAAwB,WAAjBP,EAAQQ,GAAoBA,EAAMS,OAAOT,EAClD,CEJA,SAASW,EAAQC,EAAGC,GAClB,IAAIC,EAAIC,OAAOC,KAAKJ,GACpB,GAAIG,OAAOE,sBAAuB,CAChC,IAAIxB,EAAIsB,OAAOE,sBAAsBL,GACrCC,IAAMpB,EAAIA,EAAEyB,QAAO,SAAUL,GAC3B,OAAOE,OAAOI,yBAAyBP,EAAGC,GAAGO,UAC/C,KAAKN,EAAEO,KAAKC,MAAMR,EAAGrB,EACvB,CACA,OAAOqB,CACT,CACe,SAASS,EAAeX,GACrC,IAAK,IAAIC,EAAI,EAAGA,EAAIW,UAAUC,OAAQZ,IAAK,CACzC,IAAIC,EAAI,MAAQU,UAAUX,GAAKW,UAAUX,GAAK,CAAC,EAC/CA,EAAI,EAAIF,EAAQI,OAAOD,IAAI,GAAIY,SAAQ,SAAUb,GCbtC,IAAyBc,EAAK3B,EAAK4B,EAAVD,EDcnBf,ECdwBZ,EDcrBa,ECd0Be,EDcvBd,EAAED,ICb3Bb,EAAM,EAAcA,MACT2B,EACTZ,OAAOc,eAAeF,EAAK3B,EAAK,CAC9B4B,MAAOA,EACPR,YAAY,EACZU,cAAc,EACdC,UAAU,IAGZJ,EAAI3B,GAAO4B,CDKX,IAAKb,OAAOiB,0BAA4BjB,OAAOkB,iBAAiBrB,EAAGG,OAAOiB,0BAA0BlB,IAAMH,EAAQI,OAAOD,IAAIY,SAAQ,SAAUb,GAC7IE,OAAOc,eAAejB,EAAGC,EAAGE,OAAOI,yBAAyBL,EAAGD,GACjE,GACF,CACA,OAAOD,CACT,CEfA,IAAMsB,EAA+BC,KAE/BC,EAAY,IAAIC,IAEtBH,EAAII,UAAY,SAAC1B,GACf,IAAM2B,EAAO3B,EAAE4B,MAAM,GAgCrBD,EAAKE,UA/BiB,SAACC,GACrB,IAAMC,EAAkBD,EAAMC,KACxBC,EAAQD,EAAKC,MACbC,EAAQF,EAAKG,GACnB,OAAQH,EAAKI,MACX,IAAK,cACH,IAAMC,EAAWC,aAAY,WAC3B,IAAMC,EAAOC,EAAAA,EAAA,GAAmBT,EAAMC,MAAS,CAAEI,KAAM,gBACvDR,EAAKa,YAAYF,EACnB,GAAGN,GACHR,EAAUiB,IAAIR,EAAOG,GACrB,MAEF,IAAK,aACH,IAAMM,EAAUC,YAAW,WACzB,IAAML,EAAOC,EAAAA,EAAA,GAAmBT,EAAMC,MAAS,CAAEI,KAAM,gBACvDR,EAAKa,YAAYF,EACnB,GAAGN,GACHR,EAAUiB,IAAIR,EAAOS,GACrB,MAEF,IAAK,eACHE,aAAapB,EAAUqB,IAAIZ,IAC3BT,EAAUsB,OAAOb,GACjB,MAEF,IAAK,gBACHc,cAAcvB,EAAUqB,IAAIZ,IAC5BT,EAAUsB,OAAOb,GAEvB,CAEF,C","sources":["../../../node_modules/@babel/runtime/helpers/esm/typeof.js","../../../node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","../../../node_modules/@babel/runtime/helpers/esm/toPrimitive.js","../../../node_modules/@babel/runtime/helpers/esm/objectSpread2.js","../../../node_modules/@babel/runtime/helpers/esm/defineProperty.js","../../../packages/mgt-chat/src/utils/timerWorker.ts"],"sourcesContent":["export default function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nexport default function _toPropertyKey(arg) {\n  var key = toPrimitive(arg, \"string\");\n  return _typeof(key) === \"symbol\" ? key : String(key);\n}","import _typeof from \"./typeof.js\";\nexport default function _toPrimitive(input, hint) {\n  if (_typeof(input) !== \"object\" || input === null) return input;\n  var prim = input[Symbol.toPrimitive];\n  if (prim !== undefined) {\n    var res = prim.call(input, hint || \"default\");\n    if (_typeof(res) !== \"object\") return res;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (hint === \"string\" ? String : Number)(input);\n}","import defineProperty from \"./defineProperty.js\";\nfunction ownKeys(e, r) {\n  var t = Object.keys(e);\n  if (Object.getOwnPropertySymbols) {\n    var o = Object.getOwnPropertySymbols(e);\n    r && (o = o.filter(function (r) {\n      return Object.getOwnPropertyDescriptor(e, r).enumerable;\n    })), t.push.apply(t, o);\n  }\n  return t;\n}\nexport default function _objectSpread2(e) {\n  for (var r = 1; r < arguments.length; r++) {\n    var t = null != arguments[r] ? arguments[r] : {};\n    r % 2 ? ownKeys(Object(t), !0).forEach(function (r) {\n      defineProperty(e, r, t[r]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) {\n      Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r));\n    });\n  }\n  return e;\n}","import toPropertyKey from \"./toPropertyKey.js\";\nexport default function _defineProperty(obj, key, value) {\n  key = toPropertyKey(key);\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}","export interface TimerWork {\n  id: string;\n  type: 'clearInterval' | 'setInterval' | 'runCallback' | 'setTimeout' | 'clearTimeout';\n  delay?: number;\n}\n\nconst ctx: SharedWorkerGlobalScope = self as unknown as SharedWorkerGlobalScope;\n\nconst intervals = new Map<string, ReturnType<typeof setInterval>>();\n\nctx.onconnect = (e: MessageEvent<unknown>) => {\n  const port = e.ports[0];\n  const handleMessage = (event: MessageEvent<TimerWork>) => {\n    const data: TimerWork = event.data;\n    const delay = data.delay;\n    const jobId = data.id;\n    switch (data.type) {\n      case 'setInterval': {\n        const interval = setInterval(() => {\n          const message: TimerWork = { ...event.data, ...{ type: 'runCallback' } };\n          port.postMessage(message);\n        }, delay);\n        intervals.set(jobId, interval);\n        break;\n      }\n      case 'setTimeout': {\n        const timeout = setTimeout(() => {\n          const message: TimerWork = { ...event.data, ...{ type: 'runCallback' } };\n          port.postMessage(message);\n        }, delay);\n        intervals.set(jobId, timeout);\n        break;\n      }\n      case 'clearTimeout': {\n        clearTimeout(intervals.get(jobId));\n        intervals.delete(jobId);\n        break;\n      }\n      case 'clearInterval':\n        clearInterval(intervals.get(jobId));\n        intervals.delete(jobId);\n    }\n  };\n  port.onmessage = handleMessage;\n};\n"],"names":["_typeof","o","Symbol","iterator","constructor","prototype","_toPropertyKey","arg","key","input","hint","prim","toPrimitive","undefined","res","call","TypeError","String","Number","ownKeys","e","r","t","Object","keys","getOwnPropertySymbols","filter","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread2","arguments","length","forEach","obj","value","defineProperty","configurable","writable","getOwnPropertyDescriptors","defineProperties","ctx","self","intervals","Map","onconnect","port","ports","onmessage","event","data","delay","jobId","id","type","interval","setInterval","message","_objectSpread","postMessage","set","timeout","setTimeout","clearTimeout","get","delete","clearInterval"],"sourceRoot":""}