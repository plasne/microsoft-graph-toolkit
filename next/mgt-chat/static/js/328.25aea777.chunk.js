"use strict";(self.webpackChunkreact_contoso=self.webpackChunkreact_contoso||[]).push([[328],{37328:function(e,t,n){n.r(t),n.d(t,{default:function(){return Ve}});var r,o,i,a,l,s,c,d,u,h,p,f,v,m,g,b,k=n(96234),y=n(33028),x=n(30969),w=n(90505),S=n(26823),C=n(17908),Z=(0,C.$)("file-list",S.K),I=n(69719),_=n(94220),L=n(48783),F=n(35349),V=n(68079),R=n(71171),E=n(32723),P=n(41361),j=n(9249),D=n(87371),T=n(80753),N=n(93069),z=n(95058),U=n(45754),A=n(86906),B=n(73836),q=n(84761),O=n(90322),W=n(72742),M=n(42292),K=n(33022),H=n(19155),G=n(66429),$=n(34223),J=n(49698),X=[(0,B.iv)(r||(r=(0,R.Z)(['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}:host .container{display:flex;flex-direction:column;position:relative}:host .dropdown{display:none;position:absolute;z-index:1000;top:34px}:host .dropdown.visible{display:flex}:host .dropdown .team-photo{width:24px;position:inherit;border-radius:50%;margin:0 6px}:host .dropdown .team-start-slot{width:max-content}:host .dropdown .team-parent-name{width:auto}:host .loading-text,:host .search-error-text{font-style:normal;font-weight:400;font-size:14px;line-height:20px}:host .message-parent{display:flex;flex-direction:row;gap:5px;padding:5px}:host .message-parent .loading-text{margin:auto}:host fluent-card{background:var(--channel-picker-dropdown-background-color,var(--fill-color));padding:2px;--card-height:auto;--width:var(--card-width)}:host fluent-text-field{width:100%}:host fluent-text-field::part(root){background:padding-box linear-gradient(var(--channel-picker-input-background-color,var(--neutral-fill-input-rest)),var(--channel-picker-input-background-color,var(--neutral-fill-input-rest))),border-box var(--channel-picker-input-border-color,var(--neutral-stroke-input-rest))}:host fluent-text-field::part(root):hover{background:padding-box linear-gradient(var(--channel-picker-input-background-color-hover,var(--neutral-fill-input-hover)),var(--channel-picker-input-background-color-hover,var(--neutral-fill-input-hover))),border-box var(--channel-picker-input-hover-border-color,var(--neutral-stroke-input-hover))}:host fluent-text-field::part(root):focus,:host fluent-text-field::part(root):focus-within{background:padding-box linear-gradient(var(--channel-picker-input-background-color-focus,var(--neutral-fill-input-focus)),var(--channel-picker-input-background-color-focus,var(--neutral-fill-input-focus))),border-box var(--channel-picker-input-focus-border-color,var(--neutral-stroke-input-focus))}:host fluent-text-field::part(control){word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host fluent-text-field::part(control)::placeholder{color:var(--channel-picker-input-placeholder-text-color,var(--input-placeholder-rest))}:host fluent-text-field::part(control):hover::placeholder{color:var(--channel-picker-input-placeholder-text-color-hover,var(--input-placeholder-hover))}:host fluent-text-field::part(control):focus-within::placeholder,:host fluent-text-field::part(control):focus::placeholder{color:var(--channel-picker-input-placeholder-text-color-focus,var(--input-placeholder-filled))}:host fluent-text-field .search-icon svg path{fill:var(--channel-picker-search-icon-color,currentColor)}:host fluent-text-field .down-chevron{height:auto;min-width:auto}:host fluent-text-field .down-chevron svg path{fill:var(--channel-picker-down-chevron-color,currentColor)}:host fluent-text-field .up-chevron{height:auto;min-width:auto}:host fluent-text-field .up-chevron svg path{fill:var(--channel-picker-up-chevron-color,currentColor)}:host fluent-text-field .close-icon{height:auto;min-width:auto}:host fluent-text-field .close-icon svg path{fill:var(--channel-picker-close-icon-color,currentColor)}:host fluent-tree-view{min-width:100%;--tree-item-nested-width:2em}:host fluent-tree-item{width:100%;--tree-item-nested-width:2em}:host fluent-tree-item:focus-visible{outline:0}:host fluent-tree-item::part(expand-collapse-button){background:0 0}:host fluent-tree-item::part(content-region),:host fluent-tree-item::part(positioning-region){color:var(--channel-picker-dropdown-item-text-color,currentColor);background:var(--channel-picker-dropdown-background-color,transparent);border:calc(var(--stroke-width) * 2px) solid transparent;height:auto}:host fluent-tree-item::part(content-region):hover,:host fluent-tree-item::part(positioning-region):hover{background:var(--channel-picker-dropdown-item-background-color-hover,var(--neutral-fill-stealth-hover))}:host fluent-tree-item::part(content-region):hover::part(expand-collapse-button),:host fluent-tree-item::part(positioning-region):hover::part(expand-collapse-button){background:var(--channel-picker-dropdown-item-background-color-hover,var(--neutral-fill-stealth-hover))}:host fluent-tree-item fluent-tree-item::part(content-region){height:auto}:host fluent-breadcrumb-item{color:var(--channel-picker-dropdown-item-text-color-selected,var(--neutral-foreground-rest))}:host fluent-breadcrumb-item .team-parent-name{font-weight:700}:host fluent-breadcrumb-item .team-photo{width:19px;position:inherit;border-radius:50%}:host fluent-breadcrumb-item .arrow{margin-left:8px;margin-right:8px}:host fluent-breadcrumb-item .arrow svg{stroke:var(--channel-picker-arrow-fill,var(--neutral-foreground-rest))}[dir=rtl] :host{--direction:rtl}[dir=rtl] .dropdown{text-align:right}[dir=rtl] .arrow{transform:scaleX(-1);filter:fliph;filter:FlipH;margin-right:0;margin-left:5px}[dir=rtl] .selected-team{padding-left:10px}[dir=rtl] .message-parent .loading-text{right:auto;left:10px;padding-right:8px;text-align:right}@media (forced-colors:active) and (prefers-color-scheme:dark){:host fluent-text-field svg{stroke:#fff!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host fluent-text-field svg{stroke:#000!important}}\n'],['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}:host .container{display:flex;flex-direction:column;position:relative}:host .dropdown{display:none;position:absolute;z-index:1000;top:34px}:host .dropdown.visible{display:flex}:host .dropdown .team-photo{width:24px;position:inherit;border-radius:50%;margin:0 6px}:host .dropdown .team-start-slot{width:max-content}:host .dropdown .team-parent-name{width:auto}:host .loading-text,:host .search-error-text{font-style:normal;font-weight:400;font-size:14px;line-height:20px}:host .message-parent{display:flex;flex-direction:row;gap:5px;padding:5px}:host .message-parent .loading-text{margin:auto}:host fluent-card{background:var(--channel-picker-dropdown-background-color,var(--fill-color));padding:2px;--card-height:auto;--width:var(--card-width)}:host fluent-text-field{width:100%}:host fluent-text-field::part(root){background:padding-box linear-gradient(var(--channel-picker-input-background-color,var(--neutral-fill-input-rest)),var(--channel-picker-input-background-color,var(--neutral-fill-input-rest))),border-box var(--channel-picker-input-border-color,var(--neutral-stroke-input-rest))}:host fluent-text-field::part(root):hover{background:padding-box linear-gradient(var(--channel-picker-input-background-color-hover,var(--neutral-fill-input-hover)),var(--channel-picker-input-background-color-hover,var(--neutral-fill-input-hover))),border-box var(--channel-picker-input-hover-border-color,var(--neutral-stroke-input-hover))}:host fluent-text-field::part(root):focus,:host fluent-text-field::part(root):focus-within{background:padding-box linear-gradient(var(--channel-picker-input-background-color-focus,var(--neutral-fill-input-focus)),var(--channel-picker-input-background-color-focus,var(--neutral-fill-input-focus))),border-box var(--channel-picker-input-focus-border-color,var(--neutral-stroke-input-focus))}:host fluent-text-field::part(control){word-spacing:inherit;text-indent:inherit;letter-spacing:inherit}:host fluent-text-field::part(control)::placeholder{color:var(--channel-picker-input-placeholder-text-color,var(--input-placeholder-rest))}:host fluent-text-field::part(control):hover::placeholder{color:var(--channel-picker-input-placeholder-text-color-hover,var(--input-placeholder-hover))}:host fluent-text-field::part(control):focus-within::placeholder,:host fluent-text-field::part(control):focus::placeholder{color:var(--channel-picker-input-placeholder-text-color-focus,var(--input-placeholder-filled))}:host fluent-text-field .search-icon svg path{fill:var(--channel-picker-search-icon-color,currentColor)}:host fluent-text-field .down-chevron{height:auto;min-width:auto}:host fluent-text-field .down-chevron svg path{fill:var(--channel-picker-down-chevron-color,currentColor)}:host fluent-text-field .up-chevron{height:auto;min-width:auto}:host fluent-text-field .up-chevron svg path{fill:var(--channel-picker-up-chevron-color,currentColor)}:host fluent-text-field .close-icon{height:auto;min-width:auto}:host fluent-text-field .close-icon svg path{fill:var(--channel-picker-close-icon-color,currentColor)}:host fluent-tree-view{min-width:100%;--tree-item-nested-width:2em}:host fluent-tree-item{width:100%;--tree-item-nested-width:2em}:host fluent-tree-item:focus-visible{outline:0}:host fluent-tree-item::part(expand-collapse-button){background:0 0}:host fluent-tree-item::part(content-region),:host fluent-tree-item::part(positioning-region){color:var(--channel-picker-dropdown-item-text-color,currentColor);background:var(--channel-picker-dropdown-background-color,transparent);border:calc(var(--stroke-width) * 2px) solid transparent;height:auto}:host fluent-tree-item::part(content-region):hover,:host fluent-tree-item::part(positioning-region):hover{background:var(--channel-picker-dropdown-item-background-color-hover,var(--neutral-fill-stealth-hover))}:host fluent-tree-item::part(content-region):hover::part(expand-collapse-button),:host fluent-tree-item::part(positioning-region):hover::part(expand-collapse-button){background:var(--channel-picker-dropdown-item-background-color-hover,var(--neutral-fill-stealth-hover))}:host fluent-tree-item fluent-tree-item::part(content-region){height:auto}:host fluent-breadcrumb-item{color:var(--channel-picker-dropdown-item-text-color-selected,var(--neutral-foreground-rest))}:host fluent-breadcrumb-item .team-parent-name{font-weight:700}:host fluent-breadcrumb-item .team-photo{width:19px;position:inherit;border-radius:50%}:host fluent-breadcrumb-item .arrow{margin-left:8px;margin-right:8px}:host fluent-breadcrumb-item .arrow svg{stroke:var(--channel-picker-arrow-fill,var(--neutral-foreground-rest))}[dir=rtl] :host{--direction:rtl}[dir=rtl] .dropdown{text-align:right}[dir=rtl] .arrow{transform:scaleX(-1);filter:fliph;filter:FlipH;margin-right:0;margin-left:5px}[dir=rtl] .selected-team{padding-left:10px}[dir=rtl] .message-parent .loading-text{right:auto;left:10px;padding-right:8px;text-align:right}@media (forced-colors:active) and (prefers-color-scheme:dark){:host fluent-text-field svg{stroke:#fff!important}}@media (forced-colors:active) and (prefers-color-scheme:light){:host fluent-text-field svg{stroke:#000!important}}\n'])))],Q=n(98556),Y=n(46222),ee=n(65854),te=n(72097),ne=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(t){i(t)}}function l(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))},re=function(e,t){return ne(void 0,void 0,void 0,(0,E.Z)().mark((function n(){var r;return(0,E.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.api("/me/joinedTeams").select(["displayName","id","isArchived"]).middlewareOptions(Q.z.apply(void 0,(0,V.Z)(t))).get();case 2:return r=n.sent,n.abrupt("return",null===r||void 0===r?void 0:r.value);case 4:case"end":return n.stop()}}),n)})))},oe=function(e,t){return ne(void 0,void 0,void 0,(0,E.Z)().mark((function n(){var r,o,i,a,l,s,c,d,u,h,p;return(0,E.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o={},!(0,ee.bt)()){n.next=29;break}r=Y.Q.getCache(te.O.photos,te.O.photos.stores.teams),i=(0,P.Z)(t),n.prev=4,i.s();case 6:if((a=i.n()).done){n.next=19;break}return l=a.value,n.prev=8,n.next=11,r.getValue(l);case 11:(s=n.sent)&&(0,ee.Kf)()>Date.now()-s.timeCached&&(o[l]=s),n.next=17;break;case 15:n.prev=15,n.t0=n.catch(8);case 17:n.next=6;break;case 19:n.next=24;break;case 21:n.prev=21,n.t1=n.catch(4),i.e(n.t1);case 24:return n.prev=24,i.f(),n.finish(24);case 27:if(!Object.keys(o).length){n.next=29;break}return n.abrupt("return",o);case 29:c=["team.readbasic.all"],o={},d=(0,P.Z)(t),n.prev=32,d.s();case 34:if((u=d.n()).done){n.next=50;break}return h=u.value,n.prev=36,n.next=39,(0,ee.E0)(e,"/teams/".concat(h),c);case 39:if(p=n.sent,!(0,ee.bt)()||!p){n.next=43;break}return n.next=43,r.putValue(h,p);case 43:o[h]=p,n.next=48;break;case 46:n.prev=46,n.t2=n.catch(36);case 48:n.next=34;break;case 50:n.next=55;break;case 52:n.prev=52,n.t3=n.catch(32),d.e(n.t3);case 55:return n.prev=55,d.f(),n.finish(55);case 58:return n.abrupt("return",o);case 59:case"end":return n.stop()}}),n,null,[[4,21,24,27],[8,15],[32,52,55,58],[36,46]])})))},ie={inputPlaceholderText:"Select a channel",noResultsFound:"We didn't find any matches.",loadingMessage:"Loading...",photoFor:"Teams photo for",teamsChannels:"Teams and channels results",closeButtonAriaLabel:"remove the selected channel"},ae=n(51687),le=n(66552),se=n(12484),ce=n(31984),de=n(12572),ue=n(99125),he=n(30193),pe=n(39586),fe=n(58097),ve=n(91734),me=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},ge=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},be=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(t){i(t)}}function l(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))},ke=function(e){(0,U.Z)(n,e);var t=(0,A.Z)(n);function n(){var e;return(0,j.Z)(this,n),(e=t.call(this)).teamsPhotos={},e._inputValue="",e._treeViewState=[],e._focusList=[],e.handleInputClick=function(t){t.stopPropagation(),e.gainedFocus()},e.handleInputKeydown=function(t){var n=t.key;["ArrowDown","Enter"].includes(n)?e._isDropdownVisible?e.renderRoot.querySelector("fluent-tree-item").focus():e.gainedFocus():"Escape"===n&&e.lostFocus()},e.onClickCloseButton=function(){e.removeSelectedChannel(null)},e.onKeydownCloseButton=function(t){"Enter"===t.key&&e.removeSelectedChannel(null)},e.onKeydownTreeView=function(t){"Escape"===t.key&&e.lostFocus()},e.handleTeamTreeItemClick=function(e){e.preventDefault(),e.stopImmediatePropagation();var t=e.target;t&&(t.getAttribute("expanded")?t.removeAttribute("expanded"):t.setAttribute("expanded","true"),t.removeAttribute("selected"),t.getAttribute("id")&&t.setAttribute("selected","true"))},e.handleInputChanged=function(t){var n=t.target;e._inputValue!==(null===n||void 0===n?void 0:n.value)&&(e._inputValue=null===n||void 0===n?void 0:n.value,e.gainedFocus(),e.debouncedSearch||(e.debouncedSearch=(0,J.Ds)((function(){e.filterList()}),400)),e.debouncedSearch())},e.handleWindowClick=function(t){t.target!==(0,T.Z)(e)&&e.lostFocus()},e.gainedFocus=function(){var t=e._input;t&&t.focus(),e._isDropdownVisible=!0,e.toggleChevron(),e.resetFocusState(),e.requestUpdate()},e.lostFocus=function(){e._input.value=e._inputValue="",e._input.textContent="",e._inputWrapper.value="",e._isDropdownVisible=!1,e.filterList(),e.toggleChevron(),e.requestUpdate(),void 0!==e._selectedItemState&&e.showCloseIcon()},e.handleFocus=function(){e.lostFocus(),e.gainedFocus()},e.handleUpChevronClick=function(t){t.stopPropagation(),e.lostFocus()},e.addEventListener("focus",(function(){return e.loadTeamsIfNotLoaded()})),e.addEventListener("mouseover",(function(){return e.loadTeamsIfNotLoaded()})),e.addEventListener("blur",(function(){return e.lostFocus()})),e._inputValue="",e._treeViewState=[],e._focusList=[],e._isDropdownVisible=!1,e}return(0,D.Z)(n,[{key:"strings",get:function(){return ie}},{key:"selectedItem",get:function(){return this._selectedItemState?{channel:this._selectedItemState.item,team:this._selectedItemState.parent.item}:null}},{key:"items",get:function(){return this._items},set:function(e){this._items!==e&&(this._items=e,this._treeViewState=e?this.generateTreeViewState(e):[],this.resetFocusState())}},{key:"_inputWrapper",get:function(){return this.renderRoot.querySelector("fluent-text-field")}},{key:"_input",get:function(){return this._inputWrapper.shadowRoot.querySelector("input")}},{key:"connectedCallback",value:function(){(0,N.Z)((0,z.Z)(n.prototype),"connectedCallback",this).call(this),window.addEventListener("click",this.handleWindowClick);var e=this.renderRoot.ownerDocument;e&&e.documentElement.setAttribute("dir",this.direction)}},{key:"disconnectedCallback",value:function(){window.removeEventListener("click",this.handleWindowClick),(0,N.Z)((0,z.Z)(n.prototype),"disconnectedCallback",this).call(this)}},{key:"selectChannelById",value:function(e){return be(this,void 0,void 0,(0,E.Z)().mark((function t(){var n,r,o,i,a,l,s;return(0,E.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(n=W.C.globalProvider)||n.state!==M.Aw.SignedIn){t.next=40;break}if(this.items){t.next=5;break}return t.next=5,this.requestStateUpdate();case 5:r=(0,P.Z)(this._treeViewState),t.prev=6,r.s();case 8:if((o=r.n()).done){t.next=32;break}i=o.value,a=(0,P.Z)(i.channels),t.prev=11,a.s();case 13:if((l=a.n()).done){t.next=22;break}if((s=l.value).item.id!==e){t.next=20;break}return i.isExpanded=!0,this.selectChannel(s),this.markSelectedChannelInDropdown(e),t.abrupt("return",!0);case 20:t.next=13;break;case 22:t.next=27;break;case 24:t.prev=24,t.t0=t.catch(11),a.e(t.t0);case 27:return t.prev=27,a.f(),t.finish(27);case 30:t.next=8;break;case 32:t.next=37;break;case 34:t.prev=34,t.t1=t.catch(6),r.e(t.t1);case 37:return t.prev=37,r.f(),t.finish(37);case 40:return t.abrupt("return",!1);case 41:case"end":return t.stop()}}),t,this,[[6,34,37,40],[11,24,27,30]])})))}},{key:"markSelectedChannelInDropdown",value:function(e){var t=this.renderRoot.querySelector("[id='".concat(e,"']"));t&&(t.setAttribute("selected","true"),t.parentElement&&t.parentElement.setAttribute("expanded","true"))}},{key:"render",value:function(){var e,t={dropdown:!0,visible:this._isDropdownVisible};return this.renderTemplate("default",{teams:null!==(e=this.items)&&void 0!==e?e:[]})||(0,B.dy)(o||(o=(0,R.Z)(['\n        <div class="container" @blur=','>\n          <fluent-text-field\n            autocomplete="off"\n            appearance="outline"\n            id="teams-channel-picker-input"\n            role="combobox"\n            placeholder="',' "\n            aria-label=','\n            aria-expanded="','"\n            label="teams-channel-picker-input"\n            @focus=',"\n            @keyup=","\n            @click=","\n            @keydown=",'\n          >\n            <div tabindex="0" slot="start" style="width: max-content;">','</div>\n            <div tabindex="0" slot="end">',"","</div>\n          </fluent-text-field>\n          <fluent-card\n            class=","\n          >\n            ","\n          </fluent-card>\n        </div>"])),this.lostFocus,this._selectedItemState?"":this.strings.inputPlaceholderText,this.strings.inputPlaceholderText,this._isDropdownVisible,this.handleFocus,this.handleInputChanged,this.handleInputClick,this.handleInputKeydown,this.renderSelected(),this.renderChevrons(),this.renderCloseButton(),(0,O.$)(t),this.renderDropdown())}},{key:"renderSelected",value:function(){var e,t,n,r,o,l,s;if(!this._selectedItemState)return this.renderSearchIcon();if(this._selectedItemState.parent.channels){var c=null===(e=this.teamsPhotos[this._selectedItemState.parent.item.id])||void 0===e?void 0:e.photo;s=(0,B.dy)(i||(i=(0,R.Z)(['<img\n        class="team-photo"\n        alt="','"\n        role="img"\n        src='," />"])),this._selectedItemState.parent.item.displayName,c)}var d=null===(r=null===(n=null===(t=this._selectedItemState)||void 0===t?void 0:t.parent)||void 0===n?void 0:n.item)||void 0===r?void 0:r.displayName.trim(),u=null===(l=null===(o=this._selectedItemState)||void 0===o?void 0:o.item)||void 0===l?void 0:l.displayName.trim();return(0,B.dy)(a||(a=(0,R.Z)(["\n      <fluent-breadcrumb title=",'>\n        <fluent-breadcrumb-item>\n          <span slot="start">','</span>\n          <span class="team-parent-name">','</span>\n          <span slot="separator" class="arrow">',"</span>\n        </fluent-breadcrumb-item>\n        <fluent-breadcrumb-item>","</fluent-breadcrumb-item>\n      </fluent-breadcrumb>"])),this._selectedItemState.item.displayName,s,d,(0,$.d)($.l.TeamSeparator,"#000000"),u)}},{key:"clearState",value:function(){this._inputValue="",this._treeViewState=[],this._focusList=[],this._isDropdownVisible=!1}},{key:"renderSearchIcon",value:function(){return(0,B.dy)(l||(l=(0,R.Z)(['\n      <div class="search-icon">\n        ',"\n      </div>\n    "])),(0,$.d)($.l.Search,"#252424"))}},{key:"renderCloseButton",value:function(){return(0,B.dy)(s||(s=(0,R.Z)(['\n      <fluent-button\n        appearance="stealth"\n        class="close-icon"\n        style="display:none"\n        aria-label=',"\n        @click=","\n        @keydown=",'>\n        <svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path d="M0.0885911 0.215694L0.146447 0.146447C0.320013 -0.0271197 0.589437 -0.046405 0.784306 0.0885911L0.853553 0.146447L4 3.293L7.14645 0.146447C7.34171 -0.0488154 7.65829 -0.0488154 7.85355 0.146447C8.04882 0.341709 8.04882 0.658291 7.85355 0.853553L4.707 4L7.85355 7.14645C8.02712 7.32001 8.0464 7.58944 7.91141 7.78431L7.85355 7.85355C7.67999 8.02712 7.41056 8.0464 7.21569 7.91141L7.14645 7.85355L4 4.707L0.853553 7.85355C0.658291 8.04882 0.341709 8.04882 0.146447 7.85355C-0.0488154 7.65829 -0.0488154 7.34171 0.146447 7.14645L3.293 4L0.146447 0.853553C-0.0271197 0.679987 -0.046405 0.410563 0.0885911 0.215694L0.146447 0.146447L0.0885911 0.215694Z" fill="#212121"/>\n        </svg>\n      </fluent-button>\n    '])),this.strings.closeButtonAriaLabel,this.onClickCloseButton,this.onKeydownCloseButton)}},{key:"showCloseIcon",value:function(){var e=this.renderRoot.querySelector(".down-chevron"),t=this.renderRoot.querySelector(".up-chevron"),n=this.renderRoot.querySelector(".close-icon");e&&(e.style.display="none"),t&&(t.style.display="none"),n&&(n.style.display=null)}},{key:"renderDownChevron",value:function(){return(0,B.dy)(c||(c=(0,R.Z)(['\n      <fluent-button appearance="stealth" class="down-chevron" @click=','>\n        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path d="M2.21967 4.46967C2.51256 4.17678 2.98744 4.17678 3.28033 4.46967L6 7.18934L8.71967 4.46967C9.01256 4.17678 9.48744 4.17678 9.78033 4.46967C10.0732 4.76256 10.0732 5.23744 9.78033 5.53033L6.53033 8.78033C6.23744 9.07322 5.76256 9.07322 5.46967 8.78033L2.21967 5.53033C1.92678 5.23744 1.92678 4.76256 2.21967 4.46967Z" fill="#212121" />\n        </svg>\n      </fluent-button>'])),this.gainedFocus)}},{key:"renderUpChevron",value:function(){return(0,B.dy)(d||(d=(0,R.Z)(['\n      <fluent-button appearance="stealth" style="display:none" class="up-chevron" @click=','>\n        <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path d="M2.21967 7.53033C2.51256 7.82322 2.98744 7.82322 3.28033 7.53033L6 4.81066L8.71967 7.53033C9.01256 7.82322 9.48744 7.82322 9.78033 7.53033C10.0732 7.23744 10.0732 6.76256 9.78033 6.46967L6.53033 3.21967C6.23744 2.92678 5.76256 2.92678 5.46967 3.21967L2.21967 6.46967C1.92678 6.76256 1.92678 7.23744 2.21967 7.53033Z" fill="#212121" />\n        </svg>\n      </fluent-button>'])),this.handleUpChevronClick)}},{key:"renderChevrons",value:function(){return(0,B.dy)(u||(u=(0,R.Z)(["","",""])),this.renderUpChevron(),this.renderDownChevron())}},{key:"renderDropdown",value:function(){return this.isLoadingState||!this._treeViewState?this.renderLoading():this._treeViewState?!this.isLoadingState&&0===this._treeViewState.length&&this._inputValue.length>0?this.renderError():this.renderDropdownList(this._treeViewState):(0,B.dy)(h||(h=(0,R.Z)([""])))}},{key:"renderDropdownList",value:function(e){var t=this;if(e&&e.length>0){var n=null;return(0,B.dy)(p||(p=(0,R.Z)(['\n        <fluent-tree-view\n          class="tree-view"\n          dir=','\n          aria-live="polite"\n          aria-relevant="all"\n          aria-atomic="true"\n          aria-label=','\n          aria-orientation="horizontal"\n          @keydown=',">\n          ","\n        </fluent-tree-view>"])),this.direction,this.strings.teamsChannels,this.onKeydownTreeView,(0,ae.r)(e,(function(e){return null===e||void 0===e?void 0:e.item}),(function(e){var r;return e.channels&&(n=(0,B.dy)(f||(f=(0,R.Z)(['<img\n                  class="team-photo"\n                  alt="'," ",'"\n                  src=',"\n                />"])),t.strings.photoFor,e.item.displayName,null===(r=t.teamsPhotos[e.item.id])||void 0===r?void 0:r.photo)),(0,B.dy)(v||(v=(0,R.Z)(["\n                <fluent-tree-item\n                  ?expanded=","\n                  @click=",'>\n                    <span slot="start">',"</span>","\n                    ","\n                </fluent-tree-item>"])),null===e||void 0===e?void 0:e.isExpanded,t.handleTeamTreeItemClick,n,e.item.displayName,(0,ae.r)(null===e||void 0===e?void 0:e.channels,(function(e){return e.item}),(function(e){return t.renderItem(e)})))})))}return null}},{key:"renderItem",value:function(e){var t,n=this;return(0,B.dy)(m||(m=(0,R.Z)(["\n      <fluent-tree-item\n        id=","\n        @keydown=","\n        @click=",">\n          ","\n      </fluent-tree-item>"])),null===(t=null===e||void 0===e?void 0:e.item)||void 0===t?void 0:t.id,(function(t){return n.onUserKeyDown(t,e)}),(function(){return n.handleItemClick(e)}),null===e||void 0===e?void 0:e.item.displayName)}},{key:"renderError",value:function(){return this.renderTemplate("error",null,"error")||(0,B.dy)(g||(g=(0,R.Z)(['\n        <div class="message-parent">\n          <div\n            label="search-error-text"\n            aria-live="polite"\n            aria-relevant="all"\n            aria-atomic="true"\n            class="search-error-text"\n          >\n            ',"\n          </div>\n        </div>\n      "])),this.strings.noResultsFound)}},{key:"renderLoading",value:function(){return this.renderTemplate("loading",null,"loading")||(0,K.b)(b||(b=(0,R.Z)(['\n        <div class="message-parent">\n          <mgt-spinner></mgt-spinner>\n          <div label="loading-text" aria-label="loading" class="loading-text">\n            ',"\n          </div>\n        </div>\n      "])),this.strings.loadingMessage)}},{key:"loadState",value:function(){var e,t;return be(this,void 0,void 0,(0,E.Z)().mark((function r(){var o,i,a,l,s,c,d,u,h,p,f,v,m,g;return(0,E.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!(o=W.C.globalProvider)||o.state!==M.Aw.SignedIn){r.next=38;break}return a=o.graph.forComponent(this),r.next=5,re(a,n.requiredScopes);case 5:return i=(i=r.sent).filter((function(e){return!e.isArchived})),l=H.g.fromGraph(a),s=i.map((function(e){return e.id})),r.next=11,oe(l,s);case 11:this.teamsPhotos=r.sent,c=a.createBatch(),d=(0,P.Z)(i);try{for(d.s();!(u=d.n()).done;)h=u.value,c.get(h.id,"teams/".concat(h.id,"/channels"),n.requiredScopes)}catch(b){d.e(b)}finally{d.f()}return r.next=17,c.executeAll();case 17:p=r.sent,this._items=[],f=(0,P.Z)(i),r.prev=20,f.s();case 22:if((v=f.n()).done){r.next=30;break}if(m=v.value,g=p.get(m.id),null===(t=null===(e=g.content)||void 0===e?void 0:e.value)||void 0===t?void 0:t.length){r.next=27;break}return r.abrupt("continue",28);case 27:this.items.push({item:m,channels:g.content.value.map((function(e){return{item:e}}))});case 28:r.next=22;break;case 30:r.next=35;break;case 32:r.prev=32,r.t0=r.catch(20),f.e(r.t0);case 35:return r.prev=35,f.f(),r.finish(35);case 38:this.filterList(),this.resetFocusState();case 40:case"end":return r.stop()}}),r,this,[[20,32,35,38]])})))}},{key:"removeSelectedChannel",value:function(e){this.selectChannel(e);var t=this.renderRoot.querySelectorAll("fluent-tree-item");t&&t.forEach((function(e){e.removeAttribute("expanded"),e.removeAttribute("selected")}))}},{key:"handleItemClick",value:function(e){e.channels?e.isExpanded=!e.isExpanded:(this.selectChannel(e),this.lostFocus())}},{key:"onUserKeyDown",value:function(e,t){switch(e.code){case"Enter":this.selectChannel(t),this.resetFocusState(),this.lostFocus(),e.preventDefault();break;case"Backspace":0===this._inputValue.length&&this._selectedItemState&&(this.selectChannel(null),this.resetFocusState(),e.preventDefault())}}},{key:"filterList",value:function(){this.items&&(this._treeViewState=this.generateTreeViewState(this.items,this._inputValue),this.resetFocusState())}},{key:"generateTreeViewState",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=[];if(t=t.toLowerCase(),e){var o,i=(0,P.Z)(e);try{for(i.s();!(o=i.n()).done;){var a=o.value,l=void 0;if(0===t.length||a.item.displayName.toLowerCase().includes(t))l={item:a.item,parent:n},a.channels&&(l.channels=this.generateTreeViewState(a.channels,"",l),l.isExpanded=t.length>0);else if(a.channels){var s={item:a.item,parent:n},c=this.generateTreeViewState(a.channels,t,s);c.length>0&&((l=s).channels=c,l.isExpanded=!0)}l&&r.push(l)}}catch(d){i.e(d)}finally{i.f()}}return r}},{key:"generateFocusList",value:function(e){if(!e||0===e.length)return[];var t,n=[],r=(0,P.Z)(e);try{for(r.s();!(t=r.n()).done;){var o=t.value;n.push(o),o.channels&&o.isExpanded&&(n=[].concat((0,V.Z)(n),(0,V.Z)(this.generateFocusList(o.channels))))}}catch(i){r.e(i)}finally{r.f()}return n}},{key:"resetFocusState",value:function(){this._focusList=this.generateFocusList(this._treeViewState),this.requestUpdate()}},{key:"loadTeamsIfNotLoaded",value:function(){this.items||this.isLoadingState||this.requestStateUpdate()}},{key:"selectChannel",value:function(e){e&&this._selectedItemState!==e?this._input.setAttribute("disabled","true"):this._input.removeAttribute("disabled"),this._selectedItemState=e,this.lostFocus(),this.fireCustomEvent("selectionChanged",this.selectedItem)}},{key:"hideCloseIcon",value:function(){var e=this.renderRoot.querySelector(".close-icon");e&&(e.style.display="none")}},{key:"toggleChevron",value:function(){var e=this.renderRoot.querySelector(".down-chevron"),t=this.renderRoot.querySelector(".up-chevron");this._isDropdownVisible?(e&&(e.style.display="none"),t&&(t.style.display=null)):(e&&(e.style.display=null,this.hideCloseIcon()),t&&(t.style.display="none")),this.hideCloseIcon()}}],[{key:"styles",get:function(){return X}},{key:"requiredScopes",get:function(){return["team.readbasic.all","channel.readbasic.all"]}}]),n}(G.h);me([(0,q.SB)(),ge("design:type",Object)],ke.prototype,"_selectedItemState",void 0),me([(0,q.SB)(),ge("design:type",Boolean)],ke.prototype,"_isDropdownVisible",void 0);var ye=(0,C.$)("teams-channel-picker",(function(){(0,le.J)(se.lu,ce.gx,de.ay,ue.wF,he.TI,pe.i0),(0,ve.Y)(),(0,fe.R)("teams-channel-picker",ke)})),xe=n(37574),we=(0,I.Z)({fileGrid:{paddingBottom:"10px"}}),Se=function(){var e=x.useState(null),t=(0,k.Z)(e,2),n=t[0],r=t[1],o=we();return(0,xe.jsxs)("div",{children:[(0,xe.jsx)(ye,{selectionChanged:function(e){return r(e.detail)},className:o.fileGrid}),n&&(0,xe.jsx)(Z,{groupId:n.team.id,itemPath:n.channel.displayName,pageSize:100})]})},Ce=n(34795),Ze=n(57151),Ie=(0,C.$)("picker",Ze.C),_e=(0,I.Z)({picker:{paddingBottom:"10px",display:"block"}}),Le=function(){var e=x.useState(null),t=(0,k.Z)(e,2),n=t[0],r=t[1],o=x.useState(""),i=(0,k.Z)(o,2),a=i[0],l=i[1],s=x.useState(""),c=(0,k.Z)(s,2),d=c[0],u=c[1],h=_e(),p=function(){var e=(0,Ce.Z)((0,E.Z)().mark((function e(t){var n;return(0,E.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("documentLibrary"!==t.detail.list.template){e.next=9;break}return e.next=3,W.C.globalProvider.graph.client.api("/sites/root/lists/".concat(t.detail.id,"/drive")).get();case 3:n=e.sent,r(t.detail),l(n.id),u(""),e.next=12;break;case 9:r(null),l(""),u("Please select a document library");case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,xe.jsxs)("div",{children:[(0,xe.jsx)(Ie,{resource:"/sites/root/lists",placeholder:"Select a list",keyName:"displayName",selectionChanged:p,className:h.picker}),n&&a&&(0,xe.jsx)(Z,{itemPath:"/",driveId:a,pageSize:100}),d&&(0,xe.jsx)("div",{children:d})]})},Fe=(0,I.Z)({panels:(0,y.Z)({},_.q5.padding("10px"))}),Ve=function(){var e=Fe(),t=x.useState("my"),n=(0,k.Z)(t,2),r=n[0],o=n[1];return(0,xe.jsxs)(xe.Fragment,{children:[(0,xe.jsx)(w.m,{title:"Files",description:"View your files from accross your OneDrive, channels you are a member of and your SharePoint sites"}),(0,xe.jsxs)("div",{children:[(0,xe.jsxs)(L.t,{selectedValue:r,onTabSelect:function(e,t){o(t.value)},children:[(0,xe.jsx)(F.O,{value:"my",children:"My Files"}),(0,xe.jsx)(F.O,{value:"recent",children:"Recent Files"}),(0,xe.jsx)(F.O,{value:"site",children:"Site Files"}),(0,xe.jsx)(F.O,{value:"channel",children:"Channel Files"})]}),(0,xe.jsxs)("div",{className:e.panels,children:["my"===r&&(0,xe.jsx)(Z,{pageSize:100}),"recent"===r&&(0,xe.jsx)(Z,{insightType:"used",enableFileUpload:!1,pageSize:100}),"site"===r&&(0,xe.jsx)(Le,{}),"channel"===r&&(0,xe.jsx)(Se,{})]})]})]})}},57151:function(e,t,n){n.d(t,{C:function(){return F}});var r,o,i,a,l=n(32723),s=n(71171),c=n(9249),d=n(87371),u=n(45754),h=n(86906),p=n(73836),f=n(84761),v=n(15450),m=n(33022),g=n(48970),b=n(66429),k={comboboxPlaceholder:"Select an item"},y=n(59932),x=n(77788),w=n(66552),S=n(57724),C=[(0,p.iv)(r||(r=(0,s.Z)(['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\e70d"}.ms-icon-chevron-up::before{content:"\\e70e"}.ms-icon-contact::before{content:"\\e77b"}.ms-icon-add-friend::before{content:"\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\eb6d"}:host{--max-height:var(--picker-max-height, 380px);font-family:var(--default-font-family)}:host .picker{background-color:var(--picker-background-color,transparent)}:host fluent-combobox::part(selected-value)::placeholder{color:var(--picker-text-color,var(--input-filled-placeholder-rest))}:host fluent-combobox::part(selected-value):hover::placeholder{color:var(--picker-text-color-hover,var(--secondary-text-hover-color))}[dir=rtl] .picker{direction:rtl}\n'],['\n:host([hidden]){display:none}:host{display:block;font-family:var(--default-font-family, "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, "BlinkMacSystemFont", "Roboto", "Helvetica Neue", sans-serif);font-size:var(--default-font-size,14px);--theme-primary-color:#0078d7;--theme-dark-color:#005a9e}:focus-visible{outline-color:var(--focus-ring-color,Highlight);outline-color:var(--focus-ring-color,-webkit-focus-ring-color);outline-style:var(--focus-ring-style,auto)}.ms-icon{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;font-size:16px;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;margin:4px 0}.error{background-color:#fde7e9;padding-block:8px;padding-inline:8px 12px}.ms-icon-chevron-down::before{content:"\\\\\\e70d"}.ms-icon-chevron-up::before{content:"\\\\\\e70e"}.ms-icon-contact::before{content:"\\\\\\e77b"}.ms-icon-add-friend::before{content:"\\\\\\e8fa"}.ms-icon-outlook-logo-inverser::before{content:"\\\\\\eb6d"}:host{--max-height:var(--picker-max-height, 380px);font-family:var(--default-font-family)}:host .picker{background-color:var(--picker-background-color,transparent)}:host fluent-combobox::part(selected-value)::placeholder{color:var(--picker-text-color,var(--input-filled-placeholder-rest))}:host fluent-combobox::part(selected-value):hover::placeholder{color:var(--picker-text-color-hover,var(--secondary-text-hover-color))}[dir=rtl] .picker{direction:rtl}\n'])))],Z=n(58097),I=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},_=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},L=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(t){i(t)}}function l(e){try{s(r.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))},F=function(){(0,w.J)(y.ee,x.P),(0,S.xV)(),(0,Z.R)("picker",V)},V=function(e){(0,u.Z)(n,e);var t=(0,h.Z)(n);function n(){var e;return(0,c.Z)(this,n),(e=t.call(this)).version="v1.0",e.maxPages=3,e.scopes=[],e.cacheEnabled=!1,e.cacheInvalidationPeriod=0,e.handleComboboxKeydown=function(t){var n,r,o=t.key,i=t.target.querySelector(".selected");i&&(n=i.getAttribute("value")),"Enter"===o&&n&&(r=e.response.filter((function(e){return e.id===n})).pop(),e.fireCustomEvent("selectionChanged",r,!0,!1,!0))},e.placeholder=e.strings.comboboxPlaceholder,e.entityType=null,e.keyName=null,e.isRefreshing=!1,e}return(0,d.Z)(n,[{key:"strings",get:function(){return k}},{key:"refresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.isRefreshing=!0,e&&this.clearState(),this.requestStateUpdate(e)}},{key:"clearState",value:function(){this.response=null,this.error=null}},{key:"render",value:function(){var e;if(this.isLoadingState&&!this.response)return this.renderTemplate("loading",null);if(this.hasTemplate("error")){var t=this.error?this.error:null;return this.renderTemplate("error",{error:t},"error")}return this.hasTemplate("no-data")?this.renderTemplate("no-data",null):(null===(e=this.response)||void 0===e?void 0:e.length)>0?this.renderPicker():this.renderGet()}},{key:"renderPicker",value:function(){var e=this;return(0,m.b)(o||(o=(0,s.Z)(["\n      <fluent-combobox\n        @keydown=","\n        current-value=",'\n        part="picker"\n        class="picker"\n        id="combobox"\n        autocomplete="list"\n        placeholder=',">\n        ","\n      </fluent-combobox>\n     "])),this.handleComboboxKeydown,(0,v.o)(this.selectedValue),this.placeholder,this.response.map((function(t){return(0,p.dy)(i||(i=(0,s.Z)(["\n          <fluent-option\n            value=","\n            @click=","\n          >\n            ","\n          </fluent-option>"])),t.id,(function(n){return e.handleClick(n,t)}),t[e.keyName])})))}},{key:"renderGet",value:function(){return(0,m.b)(a||(a=(0,s.Z)(['\n      <mgt-get\n        class="mgt-get"\n        resource=',"\n        version=","\n        .scopes=","\n        max-pages=","\n        ?cache-enabled=","\n        ?cache-invalidation-period=",">\n      </mgt-get>"])),this.resource,this.version,this.scopes,this.maxPages,this.cacheEnabled,this.cacheInvalidationPeriod)}},{key:"loadState",value:function(){return L(this,void 0,void 0,(0,l.Z)().mark((function e(){var t,n=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.response||((t=this.renderRoot.querySelector(".mgt-get"))?t.addEventListener("dataChange",(function(e){return n.handleDataChange(e)})):(0,g.vU)("mgt-picker component requires a child mgt-get component. Something has gone horribly wrong.")),this.isRefreshing=!1,e.next=4,Promise.resolve();case 4:case"end":return e.stop()}}),e,this)})))}},{key:"handleDataChange",value:function(e){var t=e.detail.response.value,n=e.detail.error?e.detail.error:null;this.response=t,this.error=n}},{key:"handleClick",value:function(e,t){this.fireCustomEvent("selectionChanged",t,!0,!1,!0)}}],[{key:"styles",get:function(){return C}}]),n}(b.h);I([(0,f.Cb)({attribute:"resource",type:String}),_("design:type",String)],V.prototype,"resource",void 0),I([(0,f.Cb)({attribute:"version",type:String}),_("design:type",Object)],V.prototype,"version",void 0),I([(0,f.Cb)({attribute:"max-pages",type:Number}),_("design:type",Object)],V.prototype,"maxPages",void 0),I([(0,f.Cb)({attribute:"placeholder",type:String}),_("design:type",String)],V.prototype,"placeholder",void 0),I([(0,f.Cb)({attribute:"key-name",type:String}),_("design:type",String)],V.prototype,"keyName",void 0),I([(0,f.Cb)({attribute:"entity-type",type:String}),_("design:type",String)],V.prototype,"entityType",void 0),I([(0,f.Cb)({attribute:"scopes",converter:function(e){return e?e.toLowerCase().split(","):null}}),_("design:type",Array)],V.prototype,"scopes",void 0),I([(0,f.Cb)({attribute:"cache-enabled",type:Boolean}),_("design:type",Object)],V.prototype,"cacheEnabled",void 0),I([(0,f.Cb)({attribute:"cache-invalidation-period",type:Number}),_("design:type",Object)],V.prototype,"cacheInvalidationPeriod",void 0),I([(0,f.Cb)({attribute:"selected-value",type:String}),_("design:type",String)],V.prototype,"selectedValue",void 0),I([(0,f.SB)(),_("design:type",Array)],V.prototype,"response",void 0)},19155:function(e,t,n){n.d(t,{g:function(){return s}});var r=n(9249),o=n(87371),i=n(45754),a=n(86906),l=n(34629),s=function(e){(0,i.Z)(n,e);var t=(0,a.Z)(n);function n(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"beta";return(0,r.Z)(this,n),t.call(this,e,o)}return(0,o.Z)(n,[{key:"forComponent",value:function(e){var t=new n(this.client);return this.setComponent(e),t}}],[{key:"fromGraph",value:function(e){var t=new n(e.client);return t.setComponent(e.componentName),t}}]),n}(l.k)}}]);
//# sourceMappingURL=328.25aea777.chunk.js.map