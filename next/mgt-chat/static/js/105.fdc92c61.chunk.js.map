{"version":3,"file":"static/js/105.fdc92c61.chunk.js","mappings":"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","sources":["components/PageHeader.tsx","../../../packages/mgt-components/dist/es6/components/mgt-get/src/components/mgt-get/mgt-get.ts"],"sourcesContent":["import * as React from 'react';\nimport { Divider, makeStyles } from '@fluentui/react-components';\n\nexport interface IPageHeaderProps {\n  title: string;\n  description: string;\n}\n\nconst useStyles = makeStyles({\n  divider: {\n    alignItems: 'self-start',\n    paddingTop: '20px',\n    marginBottom: '20px'\n  }\n});\n\nexport const PageHeader: React.FunctionComponent<IPageHeaderProps> = props => {\n  const styles = useStyles();\n  return (\n    <div>\n      <h1>{props.title}</h1>\n      <div>{props.description}</div>\n      <Divider className={styles.divider} />\n    </div>\n  );\n};\n","/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { html, TemplateResult } from 'lit';\nimport { property } from 'lit/decorators.js';\nimport {\n  CacheService,\n  CacheStore,\n  equals,\n  MgtTemplatedComponent,\n  prepScopes,\n  Providers,\n  ProviderState,\n  CollectionResponse,\n  IGraph\n} from '@microsoft/mgt-element';\n\nimport { getPhotoForResource } from '../../graph/graph.photos';\nimport { getDocumentThumbnail } from '../../graph/graph.files';\nimport { schemas } from '../../graph/cacheStores';\nimport { CacheResponse } from '../CacheResponse';\nimport { Entity } from '@microsoft/microsoft-graph-types';\nimport { GraphRequest } from '@microsoft/microsoft-graph-client';\nimport { registerComponent } from '@microsoft/mgt-element';\n\n/**\n * Simple holder type for an image\n */\ninterface ImageValue {\n  image: string;\n}\n\n/**\n * A type guard to check if a value is a collection response\n *\n * @param value {*} the value to check\n * @returns {boolean} true if the value is a collection response\n */\nexport const isCollectionResponse = (value: unknown): value is CollectionResponse<unknown> =>\n  Array.isArray((value as CollectionResponse<unknown>)?.value);\n\n/**\n * Enumeration to define what types of query are available\n *\n * @export\n * @enum {string}\n */\nexport enum ResponseType {\n  /**\n   * Fetches a call as JSON\n   */\n  json = 'json',\n\n  /**\n   * Fetches a call as image\n   */\n  image = 'image'\n}\n\n/**\n * Defines the expiration time\n */\nconst getResponseInvalidationTime = (currentInvalidationPeriod: number): number =>\n  currentInvalidationPeriod ||\n  CacheService.config.response.invalidationPeriod ||\n  CacheService.config.defaultInvalidationPeriod;\n\n/**\n * Whether the response store is enabled\n */\nconst getIsResponseCacheEnabled = (): boolean =>\n  CacheService.config.response.isEnabled && CacheService.config.isEnabled;\n\n/**\n * Holder type emitted with the dataChange event\n */\nexport interface DataChangedDetail {\n  response?: CollectionResponse<Entity>;\n  error?: object;\n}\n\nexport const registerMgtGetComponent = () => registerComponent('get', MgtGet);\n\n/**\n * Custom element for making Microsoft Graph get queries\n *\n * @fires {CustomEvent<DataChangedDetail>} dataChange - Fired when data changes\n *\n * @export\n * @class mgt-get\n * @extends {MgtTemplatedComponent}\n */\nexport class MgtGet extends MgtTemplatedComponent {\n  /**\n   * The resource to get\n   *\n   * @type {string}\n   * @memberof MgtGet\n   */\n  @property({\n    attribute: 'resource',\n    reflect: true,\n    type: String\n  })\n  public resource: string;\n\n  /**\n   * The scopes to request\n   *\n   * @type {string[]}\n   * @memberof MgtGet\n   */\n  @property({\n    attribute: 'scopes',\n    converter: (value, _type) => {\n      return value ? value.toLowerCase().split(',') : null;\n    },\n    reflect: true\n  })\n  public scopes: string[] = [];\n\n  /**\n   * Api version to use for request\n   *\n   * @type {string}\n   * @memberof MgtGet\n   */\n  @property({\n    attribute: 'version',\n    reflect: true,\n    type: String\n  })\n  public version = 'v1.0';\n\n  /**\n   * Type of response\n   * Default = json\n   * Supported values = json, image\n   *\n   * @type {ResponseType}\n   * @memberof MgtGet\n   */\n  @property({\n    attribute: 'type',\n    reflect: true,\n    type: ResponseType\n  })\n  public type: ResponseType = ResponseType.json;\n\n  /**\n   * Maximum number of pages to get for the resource\n   * default = 3\n   * if <= 0, all pages will be fetched\n   *\n   * @type {number}\n   * @memberof MgtGet\n   */\n  @property({\n    attribute: 'max-pages',\n    reflect: true,\n    type: Number\n  })\n  public maxPages = 3;\n\n  /**\n   * Number of milliseconds to poll the delta API and\n   * update the response. Set to positive value to enable\n   *\n   * @type {number}\n   * @memberof MgtGet\n   */\n  @property({\n    attribute: 'polling-rate',\n    reflect: true,\n    type: Number\n  })\n  public pollingRate = 0;\n\n  /**\n   * Enables cache on the response from the specified resource\n   * default = false\n   *\n   * @type {boolean}\n   * @memberof MgtGet\n   */\n  @property({\n    attribute: 'cache-enabled',\n    reflect: true,\n    type: Boolean\n  })\n  public cacheEnabled = false;\n\n  /**\n   * Invalidation period of the cache for the responses in milliseconds\n   *\n   * @type {number}\n   * @memberof MgtGet\n   */\n  @property({\n    attribute: 'cache-invalidation-period',\n    type: Number\n  })\n  public cacheInvalidationPeriod = 0;\n\n  /**\n   * Gets or sets the response of the request\n   *\n   * @type any\n   * @memberof MgtGet\n   */\n  @property({ attribute: false }) public response: CollectionResponse<Entity> | Entity | ImageValue;\n\n  /**\n   *\n   * Gets or sets the error (if any) of the request\n   *\n   * @type any\n   * @memberof MgtGet\n   */\n  @property({ attribute: false }) public error: object;\n\n  private isPolling = false;\n  private isRefreshing = false;\n\n  /**\n   * Synchronizes property values when attributes change.\n   *\n   * @param {*} name\n   * @param {*} oldValue\n   * @param {*} newValue\n   * @memberof MgtPersonCard\n   */\n  public attributeChangedCallback(name, oldval, newval) {\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-argument\n    super.attributeChangedCallback(name, oldval, newval);\n    void this.requestStateUpdate();\n  }\n\n  /**\n   * Refresh the data\n   *\n   * @param {boolean} [hardRefresh=false]\n   * if false (default), the component will only update if the data changed\n   * if true, the data will be first cleared and reloaded completely\n   * @memberof MgtGet\n   */\n  public refresh(hardRefresh = false) {\n    this.isRefreshing = true;\n    if (hardRefresh) {\n      this.clearState();\n    }\n    void this.requestStateUpdate(hardRefresh);\n  }\n\n  /**\n   * Clears state of the component\n   *\n   * @protected\n   * @memberof MgtGet\n   */\n  protected clearState(): void {\n    this.response = null;\n  }\n\n  /**\n   * Invoked on each update to perform rendering tasks. This method must return\n   * a lit-html TemplateResult. Setting properties inside this method will *not*\n   * trigger the element to update.\n   */\n  protected render() {\n    if (this.isLoadingState && !this.response) {\n      return this.renderTemplate('loading', null);\n    } else if (this.error) {\n      return this.renderTemplate('error', this.error);\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access, @typescript-eslint/dot-notation\n    } else if (this.hasTemplate('value') && isCollectionResponse(this.response)) {\n      let valueContent: TemplateResult;\n\n      if (isCollectionResponse(this.response)) {\n        let loading = null;\n        if (this.isLoadingState && !this.isPolling) {\n          loading = this.renderTemplate('loading', null);\n        }\n        valueContent = html`\n          ${this.response.value.map(v => this.renderTemplate('value', v, v.id))} ${loading}\n        `;\n      } else {\n        valueContent = this.renderTemplate('value', this.response);\n      }\n\n      if (this.hasTemplate('default')) {\n        const defaultContent = this.renderTemplate('default', this.response);\n\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access, @typescript-eslint/dot-notation\n        if (this.templates['value'].templateOrder > this.templates['default'].templateOrder) {\n          return html`\n            ${defaultContent}${valueContent}\n          `;\n        } else {\n          return html`\n            ${valueContent}${defaultContent}\n          `;\n        }\n      } else {\n        return valueContent;\n      }\n    } else if (this.response) {\n      return this.renderTemplate('default', this.response) || html``;\n    } else if (this.hasTemplate('no-data')) {\n      return this.renderTemplate('no-data', null);\n    } else {\n      return html``;\n    }\n  }\n\n  /**\n   * load state into the component.\n   *\n   * @protected\n   * @returns\n   * @memberof MgtGet\n   */\n  protected async loadState() {\n    const provider = Providers.globalProvider;\n\n    this.error = null;\n\n    if (!provider || provider.state !== ProviderState.SignedIn) {\n      return;\n    }\n\n    if (this.resource) {\n      try {\n        let cache: CacheStore<CacheResponse>;\n        const key = `${this.version}${this.resource}`;\n        let response: Entity | CollectionResponse<Entity> | ImageValue = null;\n\n        if (this.shouldRetrieveCache()) {\n          cache = CacheService.getCache<CacheResponse>(schemas.get, schemas.get.stores.responses);\n          const result: CacheResponse = getIsResponseCacheEnabled() ? await cache.getValue(key) : null;\n          if (result && getResponseInvalidationTime(this.cacheInvalidationPeriod) > Date.now() - result.timeCached) {\n            response = JSON.parse(result.response) as CollectionResponse<Entity>;\n          }\n        }\n\n        if (!response) {\n          let uri = this.resource;\n          let isDeltaLink = false;\n\n          // if we had a response earlier with a delta link, use it instead\n          if (this.response?.['@odata.deltaLink']) {\n            uri = this.response['@odata.deltaLink'] as string;\n            isDeltaLink = true;\n          } else {\n            // TODO: Check this against the base url for the cloud in use.\n            isDeltaLink = new URL(uri, 'https://graph.microsoft.com').pathname.endsWith('delta');\n          }\n\n          const graph: IGraph = provider.graph.forComponent(this);\n          let request: GraphRequest = graph.api(uri).version(this.version);\n\n          if (this.scopes?.length) {\n            request = request.middlewareOptions(prepScopes(...this.scopes));\n          }\n\n          if (this.type === ResponseType.json) {\n            response = (await request.get()) as CollectionResponse<Entity> | Entity;\n\n            if (isDeltaLink && isCollectionResponse(this.response) && isCollectionResponse(response)) {\n              const responseValues: Entity[] = response.value;\n              response.value = this.response.value.concat(responseValues);\n            }\n\n            if (!this.isPolling && !equals(this.response, response)) {\n              this.response = response;\n            }\n\n            // get more pages if there are available\n            if (isCollectionResponse(response) && response['@odata.nextLink']) {\n              let pageCount = 1;\n              let page = response;\n\n              while (\n                (pageCount < this.maxPages || this.maxPages <= 0 || (isDeltaLink && this.pollingRate)) &&\n                page?.['@odata.nextLink']\n              ) {\n                pageCount++;\n                const nextResource = (page['@odata.nextLink'] as string).split(this.version)[1];\n                page = (await graph.client.api(nextResource).version(this.version).get()) as CollectionResponse<Entity>;\n                if (page?.value?.length) {\n                  page.value = response.value.concat(page.value);\n                  response = page;\n                  if (!this.isPolling) {\n                    this.response = response;\n                  }\n                }\n              }\n            }\n          } else {\n            if (this.resource.indexOf('/photo/$value') === -1 && this.resource.indexOf('/thumbnails/') === -1) {\n              throw new Error('Only /photo/$value and /thumbnails/ endpoints support the image type');\n            }\n\n            let image: string;\n            if (this.resource.indexOf('/photo/$value') > -1) {\n              // Sanitizing the resource to ensure getPhotoForResource gets the right format\n              const sanitizedResource = this.resource.replace('/photo/$value', '');\n              const photoResponse = await getPhotoForResource(graph, sanitizedResource, this.scopes);\n              if (photoResponse) {\n                image = photoResponse.photo;\n              }\n            } else if (this.resource.indexOf('/thumbnails/') > -1) {\n              const imageResponse = await getDocumentThumbnail(graph, this.resource, this.scopes);\n              if (imageResponse) {\n                image = imageResponse.thumbnail;\n              }\n            }\n\n            if (image) {\n              response = {\n                image\n              };\n            }\n          }\n\n          if (this.shouldUpdateCache() && response) {\n            cache = CacheService.getCache<CacheResponse>(schemas.get, schemas.get.stores.responses);\n            await cache.putValue(key, { response: JSON.stringify(response) });\n          }\n        }\n\n        if (!equals(this.response, response)) {\n          this.response = response;\n        }\n      } catch (e: unknown) {\n        this.error = e as object;\n      }\n\n      if (this.response) {\n        this.error = null;\n\n        if (this.pollingRate) {\n          setTimeout(() => {\n            this.isPolling = true;\n            void this.loadState().finally(() => {\n              this.isPolling = false;\n            });\n          }, this.pollingRate);\n        }\n      }\n    } else {\n      this.response = null;\n    }\n    this.isRefreshing = false;\n    this.fireCustomEvent('dataChange', { response: this.response, error: this.error });\n  }\n\n  private shouldRetrieveCache(): boolean {\n    return getIsResponseCacheEnabled() && this.cacheEnabled && !(this.isRefreshing || this.isPolling);\n  }\n\n  private shouldUpdateCache(): boolean {\n    return getIsResponseCacheEnabled() && this.cacheEnabled;\n  }\n}\n"],"names":["useStyles","makeStyles","divider","alignItems","paddingTop","marginBottom","PageHeader","props","styles","_jsxs","children","_jsx","title","description","Divider","className","ResponseType","isCollectionResponse","value","Array","isArray","getIsResponseCacheEnabled","CacheService","config","response","isEnabled","registerMgtGetComponent","registerComponent","MgtGet","_MgtTemplatedComponen","_inherits","_super","_createSuper","_this","_classCallCheck","scopes","version","type","json","maxPages","pollingRate","cacheEnabled","cacheInvalidationPeriod","isPolling","isRefreshing","_createClass","key","name","oldval","newval","_get","_getPrototypeOf","prototype","call","this","requestStateUpdate","hardRefresh","arguments","length","undefined","clearState","_this2","isLoadingState","renderTemplate","error","hasTemplate","valueContent","loading","html","_templateObject","_taggedTemplateLiteral","map","v","id","defaultContent","templates","templateOrder","_templateObject2","_templateObject3","_templateObject4","_templateObject5","provider","Providers","globalProvider","state","ProviderState","SignedIn","_context","next","abrupt","resource","prev","concat","shouldRetrieveCache","cache","getCache","schemas","get","stores","responses","getValue","t0","sent","result","invalidationPeriod","defaultInvalidationPeriod","Date","now","timeCached","JSON","parse","uri","isDeltaLink","_a","URL","pathname","endsWith","graph","forComponent","request","api","_b","middlewareOptions","prepScopes","apply","_toConsumableArray","responseValues","equals","pageCount","page","nextResource","split","client","_c","indexOf","Error","sanitizedResource","replace","getPhotoForResource","photoResponse","image","photo","getDocumentThumbnail","imageResponse","thumbnail","shouldUpdateCache","putValue","stringify","t1","setTimeout","_this3","loadState","finally","fireCustomEvent","stop","_callee","MgtTemplatedComponent","__decorate","property","attribute","reflect","String","converter","_type","toLowerCase","Number","Boolean"],"sourceRoot":""}